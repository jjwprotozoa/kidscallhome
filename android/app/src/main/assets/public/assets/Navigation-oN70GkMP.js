import{r as i,j as e,b2 as _,b3 as ee,b4 as se,b5 as ae,b6 as q,b7 as V,b8 as X,aM as te,b9 as $,ba as G,bb as K,N as ne,bc as Q,bd as oe,be as W,bf as Z,n as re,u as ie,H as k,bg as D,U as L,bh as I,a9 as le,aI as ce,aX as A,bi as M}from"./vendor-react-LQlp3yIU.js";import{c as l,u as de,p as me,q as ue,B as T,A as R,g as z,h as O,i as U,j as B,k as E,l as H,m as J,s as g,o as F}from"./index-4JrybDns.js";const m=i.forwardRef(({className:s,activeClassName:a,pendingClassName:t,to:n,...c},d)=>e.jsx(_,{ref:d,to:n,className:({isActive:j,isPending:b})=>l(s,j&&a,b&&t),...c}));m.displayName="NavLink";const P=ee,Y=se,he=i.forwardRef(({className:s,inset:a,children:t,...n},c)=>e.jsxs(X,{ref:c,className:l("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",a&&"pl-8",s),...n,children:[t,e.jsx(te,{className:"ml-auto h-4 w-4"})]}));he.displayName=X.displayName;const xe=i.forwardRef(({className:s,...a},t)=>e.jsx($,{ref:t,className:l("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));xe.displayName=$.displayName;const N=i.forwardRef(({className:s,sideOffset:a=4,...t},n)=>e.jsx(ae,{children:e.jsx(q,{ref:n,sideOffset:a,className:l("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t})}));N.displayName=q.displayName;const x=i.forwardRef(({className:s,inset:a,...t},n)=>e.jsx(V,{ref:n,className:l("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",a&&"pl-8",s),...t}));x.displayName=V.displayName;const pe=i.forwardRef(({className:s,children:a,checked:t,...n},c)=>e.jsxs(G,{ref:c,className:l("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",s),checked:t,...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(K,{children:e.jsx(ne,{className:"h-4 w-4"})})}),a]}));pe.displayName=G.displayName;const fe=i.forwardRef(({className:s,children:a,...t},n)=>e.jsxs(Q,{ref:n,className:l("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(K,{children:e.jsx(oe,{className:"h-2 w-2 fill-current"})})}),a]}));fe.displayName=Q.displayName;const ge=i.forwardRef(({className:s,inset:a,...t},n)=>e.jsx(W,{ref:n,className:l("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",s),...t}));ge.displayName=W.displayName;const je=i.forwardRef(({className:s,...a},t)=>e.jsx(Z,{ref:t,className:l("-mx-1 my-1 h-px bg-muted",s),...a}));je.displayName=Z.displayName;const we=()=>{const s=re(),a=ie(),{toast:t}=de(),n=()=>{const o=s.pathname;if(o.includes("/child/"))return"child";if(o.includes("/parent/"))return null;if(document.cookie.includes("sb-")||localStorage.getItem("sb-"))return"parent";const r=localStorage.getItem("childSession");if(r)try{return JSON.parse(r),"child"}catch{}return null},[c,d]=i.useState(n),[j,b]=i.useState(!1),[w,p]=i.useState(!1),v=me(),y=ue();i.useEffect(()=>{(async()=>{const h=s.pathname;if(h.includes("/child/")){const r=localStorage.getItem("childSession");if(r)try{JSON.parse(r),d("child");return}catch{}}if(h.includes("/parent/"))try{const{data:{session:r}}=await g.auth.getSession();if(r){d("parent");return}}catch(r){console.error("Error checking parent session:",r)}try{const{data:{session:r}}=await g.auth.getSession();if(r)d("parent");else{const C=localStorage.getItem("childSession");if(C)try{JSON.parse(C),d("child")}catch{d(null)}else d(null)}}catch(r){console.error("Error checking parent session:",r),d(null)}})()},[s.pathname]);const S=async()=>{if(c==="child"){const o=localStorage.getItem("childSession");if(o)try{const h=JSON.parse(o)}catch{}localStorage.removeItem("childSession"),F.getState().reset(),t({title:"Logged out"}),a("/child/login")}else if(c==="parent"){const{data:{user:o}}=await g.auth.getUser();await g.auth.signOut(),F.getState().reset(),t({title:"Logged out"}),a("/parent/auth")}};if(j||!c||s.pathname.includes("/auth")||s.pathname.includes("/login")||s.pathname.includes("/call/")||s.pathname.includes("/chat/"))return null;const u=({isActive:o})=>l("flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors relative",o?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"),f=({count:o})=>o===0?null:e.jsx("span",{className:"absolute -top-1 -right-1 bg-destructive text-destructive-foreground text-xs font-bold rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1 border-2 border-background",children:o>99?"99+":o});return c==="parent"?e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:"fixed top-0 left-0 right-0 z-50 border-b bg-background w-full overflow-x-hidden",style:{paddingTop:"calc(var(--safe-area-inset-top) * 0.15)"},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full",children:e.jsxs("div",{className:"flex items-center justify-between h-16 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-4 min-w-0 flex-shrink","data-tour":"parent-menu",children:[e.jsxs(m,{to:"/parent",className:u,children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:"Home"})]}),e.jsxs(m,{to:"/parent/dashboard",className:u,children:[e.jsxs("div",{className:"relative flex items-center justify-center",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx(f,{count:y})]}),e.jsx("span",{children:"Dashboard"})]}),e.jsxs(m,{to:"/parent/children",className:u,children:[e.jsxs("div",{className:"relative flex items-center justify-center",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx(f,{count:v})]}),e.jsx("span",{children:"Children"})]}),e.jsxs(P,{children:[e.jsx(Y,{asChild:!0,children:e.jsxs("button",{className:l("flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors",s.pathname==="/parent/devices"||s.pathname==="/parent/settings"||s.pathname==="/info"?"bg-accent text-accent-foreground":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"),children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"More"})]})}),e.jsxs(N,{align:"end",className:"w-48",children:[e.jsxs(x,{onClick:()=>a("/parent/devices"),children:[e.jsx(le,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Devices"})]}),e.jsxs(x,{onClick:()=>a("/parent/settings"),children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Settings"})]}),e.jsxs(x,{onClick:()=>a("/info"),children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"App Information"})]})]})]})]}),e.jsxs(T,{variant:"outline",size:"sm",onClick:()=>p(!0),className:"flex-shrink-0",children:[e.jsx(M,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Logout"})]})]})})}),e.jsx(R,{open:w,onOpenChange:p,children:e.jsxs(z,{children:[e.jsxs(O,{children:[e.jsx(U,{children:"Confirm Logout"}),e.jsx(B,{children:"Are you sure you want to log out? You'll need to sign in again to access your account."})]}),e.jsxs(E,{children:[e.jsx(H,{children:"Cancel"}),e.jsx(J,{onClick:S,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Logout"})]})]})})]}):c==="child"?e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:"fixed top-0 left-0 right-0 z-50 border-b bg-background w-full overflow-x-hidden",style:{paddingTop:"calc(var(--safe-area-inset-top) * 0.15)"},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full",children:e.jsxs("div",{className:"flex items-center justify-between h-16 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-4 min-w-0 flex-shrink","data-tour":"child-help",children:[e.jsxs(m,{to:"/child",className:u,children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:"Home"})]}),e.jsxs(m,{to:"/child/dashboard",className:u,children:[e.jsxs("div",{className:"relative flex items-center justify-center",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx(f,{count:y})]}),e.jsx("span",{children:"Dashboard"})]}),e.jsxs(m,{to:"/child/parents",className:u,children:[e.jsxs("div",{className:"relative flex items-center justify-center",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx(f,{count:v})]}),e.jsx("span",{children:"Parents"})]}),e.jsxs(P,{children:[e.jsx(Y,{asChild:!0,children:e.jsxs("button",{className:l("flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors",s.pathname==="/info"?"bg-accent text-accent-foreground":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"),children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"More"})]})}),e.jsx(N,{align:"end",className:"w-48",children:e.jsxs(x,{onClick:()=>a("/info"),children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"App Information"})]})})]})]}),e.jsxs(T,{variant:"outline",size:"sm",onClick:()=>p(!0),className:"flex-shrink-0",children:[e.jsx(M,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Logout"})]})]})})}),e.jsx(R,{open:w,onOpenChange:p,children:e.jsxs(z,{children:[e.jsxs(O,{children:[e.jsx(U,{children:"Confirm Logout"}),e.jsx(B,{children:"Are you sure you want to log out? You'll need to sign in again to access your account."})]}),e.jsxs(E,{children:[e.jsx(H,{children:"Cancel"}),e.jsx(J,{onClick:S,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Logout"})]})]})})]}):null};export{we as N};

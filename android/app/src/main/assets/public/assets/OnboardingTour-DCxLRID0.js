import{r as m,j as a,aP as ot,X as nt,aL as at,aM as it}from"./vendor-react-LQlp3yIU.js";import{B,c as O}from"./index-4JrybDns.js";import{generateDeviceIdentifier as F}from"./deviceTracking-lBUE_lfK.js";const I=[{id:"parent-child-name-status",selector:'[data-tour="parent-child-name-status"]',title:"Child Status",description:"Your child's name and online status. Green dot means they're online and available to call.",placement:"bottom"},{id:"parent-login-code",selector:'[data-tour="parent-login-code"]',title:"Login Code",description:"This is your child's unique login code. Share this code with them so they can log in to their account.",placement:"bottom"},{id:"parent-copy-code",selector:'[data-tour="parent-copy-code"]',title:"Copy Code",description:"Tap this button to copy the login code to your clipboard. Easy way to share it via text or email.",placement:"bottom"},{id:"parent-copy-link",selector:'[data-tour="parent-copy-link"]',title:"Copy Link",description:"Copy a magic link that includes the login code. Your child can tap the link to log in automatically.",placement:"bottom"},{id:"parent-print-code",selector:'[data-tour="parent-print-code"]',title:"Print Code",description:"Print the login code on a card or paper. Great for giving to your child to keep handy.",placement:"bottom"},{id:"parent-view-qr",selector:'[data-tour="parent-view-qr"]',title:"View QR Code",description:"See a QR code version of the login code. Your child can scan it with their device camera to log in.",placement:"bottom"},{id:"parent-call-button",selector:'[data-tour="parent-call-button"]',title:"Start a Video Call",description:"Tap this button to start a video call with your child. Make sure they're online (green dot) for best results.",placement:"bottom"},{id:"parent-messages",selector:'[data-tour="parent-messages"]',title:"Send Messages",description:"Send text messages to your child. Perfect for quick notes when they can't answer a call.",placement:"bottom"},{id:"parent-delete-child",selector:'[data-tour="parent-delete-child"]',title:"Delete Child",description:"Remove this child from your account. Use with caution - this action cannot be undone.",placement:"bottom"},{id:"parent-upgrade-plan",selector:'[data-tour="parent-upgrade-plan"]',title:"Upgrade Plan",description:"Tap here to upgrade your subscription and add more children to your account. View available plans and pricing.",placement:"bottom"},{id:"parent-upgrade-limit",selector:'[data-tour="parent-upgrade-limit"]',title:"Upgrade When Limit Reached",description:"When you reach your subscription limit, tap this button to upgrade and add more children to your account.",placement:"bottom"},{id:"parent-menu",selector:'[data-tour="parent-menu"]',title:"Navigation Menu",description:"Use the menu at the top to navigate between pages: Home, Dashboard, Children, Devices, Settings, and App Information.",placement:"bottom"}],P=[{id:"child-answer-button",selector:'[data-tour="child-answer-button"]',description:"Tap this to talk to mom or dad. ðŸ‘‹",placement:"bottom"},{id:"child-messages",selector:'[data-tour="child-messages"]',description:"Tap here to see messages. ðŸ’¬",placement:"bottom"},{id:"child-help",selector:'[data-tour="child-help"]',description:"Use the navigation menu to switch between pages.",placement:"bottom"}],st=[{id:"parent-home-view-children",selector:'[data-tour="parent-home-view-children"]',title:"View Children",description:"Tap here to see all your children and their profiles.",placement:"bottom"},{id:"parent-home-dashboard",selector:'[data-tour="parent-home-dashboard"]',title:"Go to Dashboard",description:"Access the full dashboard to manage children, login codes, and more.",placement:"bottom"}],rt=[{id:"parent-children-list-card",selector:'[data-tour="parent-children-list-card"]',title:"Child Profile",description:"Each card shows your child's name, online status, and login code.",placement:"bottom"},{id:"parent-children-list-call",selector:'[data-tour="parent-children-list-call"]',title:"Call Your Child",description:"Tap the Call button to start a video call with your child.",placement:"bottom"},{id:"parent-children-list-message",selector:'[data-tour="parent-children-list-message"]',title:"Send Message",description:"Tap the Message button to send a text message to your child.",placement:"bottom"}],lt=[{id:"parent-devices-list",selector:'[data-tour="parent-devices-list"]',title:"Device Management",description:"View and manage all devices that can access your account. You can remove devices for security.",placement:"bottom"}],ct=[{id:"parent-upgrade-plans",selector:'[data-tour="parent-upgrade-plans"]',title:"Subscription Plans",description:"Choose a plan that fits your needs. Monthly or annual billing available.",placement:"bottom"}],dt=[{id:"parent-settings-account",selector:'[data-tour="parent-settings-account"]',title:"Account Settings",description:"Manage your account information, subscription, and children limit here.",placement:"bottom"},{id:"parent-settings-upgrade",selector:'[data-tour="parent-settings-upgrade"]',title:"Upgrade Subscription",description:"Tap here to upgrade your plan and add more children to your account.",placement:"bottom"}],pt=[{id:"child-home-parents",selector:'[data-tour="child-home-parents"]',description:"Tap here to see your parents and start a call. ðŸ‘‹",placement:"bottom"}],ut=[{id:"child-parents-list-card",selector:'[data-tour="child-parents-list-card"]',description:"Tap a parent's card to call them. ðŸ“ž",placement:"bottom"}];function ht(t,e){if(e)switch(e){case"parent_home":return st;case"parent_dashboard":return I;case"parent_children_list":return rt;case"parent_devices":return lt;case"parent_upgrade":return ct;case"parent_settings":return dt;case"child_home":return pt;case"child_dashboard":return P;case"child_parents_list":return ut;default:return t==="parent"?I:P}return t==="parent"?I:P}const A="kch_tour_";function U(t,e){return`${A}${t}_${e}_done`}function G(t,e){return`${A}${t}_${e}_device`}function mt(t,e){const l=U(t,e);return localStorage.getItem(l)==="true"}function H(t,e){const l=U(t,e);localStorage.setItem(l,"true");const c=G(t,e),h=F();localStorage.setItem(c,h)}function gt(t,e){const l=G(t,e),c=localStorage.getItem(l);if(!c)return!0;const h=F();return c!==h}function V({role:t,pageKey:e}){const l=ht(t,e),[c,h]=m.useState(0),[y,x]=m.useState(!1);m.useEffect(()=>{!mt(t,e)&&gt(t,e)&&(x(!0),h(0))},[t,e]),m.useEffect(()=>{const T=_=>{_.detail.role===t&&_.detail.pageKey===e&&(x(!0),h(0))};return window.addEventListener("onboarding:restart",T),()=>{window.removeEventListener("onboarding:restart",T)}},[t,e]);const $=m.useCallback(()=>{x(!0),h(0)},[]),k=m.useCallback(()=>{c<l.length-1?h(c+1):N()},[c,l.length]),L=m.useCallback(()=>{c>0&&h(c-1)},[c]),R=m.useCallback(()=>{H(t,e),x(!1),h(0)},[t,e]),N=m.useCallback(()=>{H(t,e),x(!1),h(0)},[t,e]);return{activeStep:y&&c<l.length?l[c]:null,stepIndex:c,totalSteps:l.length,isRunning:y,start:$,next:k,back:L,skip:R,finish:N}}const q="kch_tour_";function bt(t,e){return`${q}${t}_${e}_done`}function St({role:t,pageKey:e}){const{isRunning:l}=V({role:t,pageKey:e}),c=()=>{const h=bt(t,e);localStorage.removeItem(h);const y=`${q}${t}_${e}_device`;localStorage.removeItem(y),window.dispatchEvent(new CustomEvent("onboarding:restart",{detail:{role:t,pageKey:e}}))};return l?null:a.jsx(B,{onClick:c,className:"fixed right-4 sm:right-6 h-12 w-12 rounded-full shadow-lg z-50 safe-area-bottom",style:{bottom:"calc(1rem + var(--safe-area-inset-bottom))"},size:"icon",variant:"default","aria-label":"Show help tour",title:"Show me around",children:a.jsx(ot,{className:"h-5 w-5"})})}function Ct({role:t,pageKey:e}){const{activeStep:l,stepIndex:c,totalSteps:h,isRunning:y,next:x,back:$,skip:k,finish:L}=V({role:t,pageKey:e}),[R,N]=m.useState(null),[i,T]=m.useState(null),_=m.useRef(null);m.useEffect(()=>{if(!l||!y){T(null),N(null);return}const g=document.querySelector(l.selector);if(!g){console.warn(`Onboarding: Element not found for selector "${l.selector}"`),setTimeout(()=>{x()},100);return}T(g);const w=()=>{const s=g.getBoundingClientRect(),b=l.placement||"bottom",p=24,f=window.innerWidth,d=f<640?Math.min(f-32,320):320,u=140,o=16,S=window.innerHeight;let n=0,r=0;const C=s.top-8,M=s.bottom+8,E=s.left-8,j=s.right+8;switch(b){case"top":n=C-u-p,r=s.left+s.width/2-d/2;break;case"bottom":n=M+p,r=s.left+s.width/2-d/2;break;case"left":n=s.top+s.height/2-u/2,r=E-d-p;break;case"right":n=s.top+s.height/2-u/2,r=j+p;break}const Y=r+d,X=n+u,Q=r,Z=n,J=Q<j&&Y>E,K=Z<M&&X>C;J&&K&&(b==="top"||b==="bottom"?j+p+d<f-o?(r=j+p,n=Math.max(o,Math.min(s.top+s.height/2-u/2,S-u-o))):E-p-d>o?(r=E-p-d,n=Math.max(o,Math.min(s.top+s.height/2-u/2,S-u-o))):b==="top"?(n=C-u-p*2,r=Math.max(o,Math.min(r,f-d-o))):(n=M+p*2,r=Math.max(o,Math.min(r,f-d-o))):(b==="left"||b==="right")&&(M+p+u<S-o?(n=M+p,r=Math.max(o,Math.min(s.left+s.width/2-d/2,f-d-o))):C-p-u>o?(n=C-p-u,r=Math.max(o,Math.min(s.left+s.width/2-d/2,f-d-o))):b==="left"?(r=E-d-p*2,n=Math.max(o,Math.min(n,S-u-o))):(r=j+p*2,n=Math.max(o,Math.min(n,S-u-o))))),r<o&&(r=o),r+d>f-o&&(r=f-d-o),n<o&&(n=o),n+u>S-o&&(n=S-u-o);const tt=r+d,et=n+u;r<j&&tt>E&&n<M&&et>C&&(n=C-u-p*2,r=Math.max(o,Math.min(s.left+s.width/2-d/2,f-d-o)),n<o&&(n=M+p*2)),N({top:n,left:r,placement:b})};return w(),window.addEventListener("resize",w),window.addEventListener("scroll",w,!0),()=>{window.removeEventListener("resize",w),window.removeEventListener("scroll",w,!0)}},[l,y,x]);const[v,D]=m.useState(null);if(m.useEffect(()=>{if(!i){D(null);return}const g=()=>{const w=i.getBoundingClientRect();D(w)};return g(),window.addEventListener("resize",g),window.addEventListener("scroll",g,!0),()=>{window.removeEventListener("resize",g),window.removeEventListener("scroll",g,!0)}},[i]),m.useEffect(()=>{if(!i)return;const g=i.style.zIndex,w=i.style.position,s=i.style.outline,b=i.style.boxShadow;return i.style.zIndex="10002",getComputedStyle(i).position==="static"&&(i.style.position="relative"),i.style.outline="3px solid hsl(var(--primary))",i.style.outlineOffset="4px",i.style.borderRadius="8px",i.style.boxShadow="0 0 0 4px rgba(0, 0, 0, 0.1), 0 4px 12px rgba(0, 0, 0, 0.15)",i.style.pointerEvents="auto",()=>{i.style.zIndex=g,i.style.position=w,i.style.outline=s,i.style.outlineOffset="",i.style.borderRadius="",i.style.boxShadow=b}},[i]),!y||!l||!R)return null;const z=c===h-1,W=c===0;return a.jsxs(a.Fragment,{children:[v?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed z-[10000] bg-black/50",style:{top:0,left:0,right:0,height:`${Math.max(0,v.top-8)}px`},onClick:k,"aria-hidden":"true"}),a.jsx("div",{className:"fixed z-[10000] bg-black/50",style:{top:`${v.bottom+8}px`,left:0,right:0,bottom:0},onClick:k,"aria-hidden":"true"}),a.jsx("div",{className:"fixed z-[10000] bg-black/50",style:{top:`${Math.max(0,v.top-8)}px`,left:0,width:`${Math.max(0,v.left-8)}px`,height:`${v.height+16}px`},onClick:k,"aria-hidden":"true"}),a.jsx("div",{className:"fixed z-[10000] bg-black/50",style:{top:`${Math.max(0,v.top-8)}px`,left:`${v.right+8}px`,right:0,height:`${v.height+16}px`},onClick:k,"aria-hidden":"true"})]}):a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[10000]",onClick:k,"aria-hidden":"true"}),a.jsxs("div",{ref:_,className:"fixed z-[10003] bg-background border-2 border-primary rounded-lg shadow-xl p-4 max-w-[calc(100vw-2rem)] sm:max-w-[320px] mx-4 sm:mx-0 pointer-events-auto",style:{top:`${R.top}px`,left:`${R.left}px`},onClick:g=>g.stopPropagation(),children:[a.jsx("button",{onClick:k,className:"absolute top-2 right-2 text-muted-foreground hover:text-foreground transition-colors","aria-label":"Skip tour",children:a.jsx(nt,{className:"h-4 w-4"})}),a.jsxs("div",{className:O("pr-6 sm:pr-8",t==="child"&&"text-base sm:text-lg"),children:[l.title&&t==="parent"&&a.jsx("h3",{className:"font-bold text-base sm:text-lg mb-2",children:l.title}),a.jsx("p",{className:O("text-sm sm:text-base text-muted-foreground",t==="child"&&"text-base sm:text-lg"),children:l.description})]}),a.jsxs("div",{className:"flex items-center justify-between mt-4 gap-2 flex-wrap",children:[a.jsx("div",{className:"flex items-center gap-2",children:!W&&a.jsxs(B,{variant:"outline",size:"sm",onClick:$,className:"text-xs sm:text-sm",children:[a.jsx(at,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Back"})]})}),a.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[a.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:[c+1," / ",h]}),a.jsxs(B,{onClick:z?L:x,size:"sm",className:"text-xs sm:text-sm",children:[z?"Got it!":"Next",!z&&a.jsx(it,{className:"h-4 w-4 ml-1"})]})]})]})]})]})}export{St as H,Ct as O};

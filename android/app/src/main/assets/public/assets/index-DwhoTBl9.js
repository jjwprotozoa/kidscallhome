function qw(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in e)){const l=Object.getOwnPropertyDescriptor(s,i);l&&Object.defineProperty(e,i,l.get?l:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}})();function Wh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function sN(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var n=function s(){var i=!1;try{i=this instanceof s}catch{}return i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var i=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:function(){return e[s]}})}),n}var ff={exports:{}},Wi={},hf={exports:{}},Ve={};var Iv;function oN(){if(Iv)return Ve;Iv=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.iterator;function w(D){return D===null||typeof D!="object"?null:(D=v&&D[v]||D["@@iterator"],typeof D=="function"?D:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,C={};function b(D,Q,le){this.props=D,this.context=Q,this.refs=C,this.updater=le||x}b.prototype.isReactComponent={},b.prototype.setState=function(D,Q){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,Q,"setState")},b.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function k(){}k.prototype=b.prototype;function _(D,Q,le){this.props=D,this.context=Q,this.refs=C,this.updater=le||x}var N=_.prototype=new k;N.constructor=_,E(N,b.prototype),N.isPureReactComponent=!0;var j=Array.isArray,R=Object.prototype.hasOwnProperty,T={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function O(D,Q,le){var X,K={},te=null,q=null;if(Q!=null)for(X in Q.ref!==void 0&&(q=Q.ref),Q.key!==void 0&&(te=""+Q.key),Q)R.call(Q,X)&&!P.hasOwnProperty(X)&&(K[X]=Q[X]);var se=arguments.length-2;if(se===1)K.children=le;else if(1<se){for(var fe=Array(se),ge=0;ge<se;ge++)fe[ge]=arguments[ge+2];K.children=fe}if(D&&D.defaultProps)for(X in se=D.defaultProps,se)K[X]===void 0&&(K[X]=se[X]);return{$$typeof:e,type:D,key:te,ref:q,props:K,_owner:T.current}}function G(D,Q){return{$$typeof:e,type:D.type,key:Q,ref:D.ref,props:D.props,_owner:D._owner}}function L(D){return typeof D=="object"&&D!==null&&D.$$typeof===e}function F(D){var Q={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(le){return Q[le]})}var I=/\/+/g;function U(D,Q){return typeof D=="object"&&D!==null&&D.key!=null?F(""+D.key):Q.toString(36)}function M(D,Q,le,X,K){var te=typeof D;(te==="undefined"||te==="boolean")&&(D=null);var q=!1;if(D===null)q=!0;else switch(te){case"string":case"number":q=!0;break;case"object":switch(D.$$typeof){case e:case t:q=!0}}if(q)return q=D,K=K(q),D=X===""?"."+U(q,0):X,j(K)?(le="",D!=null&&(le=D.replace(I,"$&/")+"/"),M(K,Q,le,"",function(ge){return ge})):K!=null&&(L(K)&&(K=G(K,le+(!K.key||q&&q.key===K.key?"":(""+K.key).replace(I,"$&/")+"/")+D)),Q.push(K)),1;if(q=0,X=X===""?".":X+":",j(D))for(var se=0;se<D.length;se++){te=D[se];var fe=X+U(te,se);q+=M(te,Q,le,fe,K)}else if(fe=w(D),typeof fe=="function")for(D=fe.call(D),se=0;!(te=D.next()).done;)te=te.value,fe=X+U(te,se++),q+=M(te,Q,le,fe,K);else if(te==="object")throw Q=String(D),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.");return q}function B(D,Q,le){if(D==null)return D;var X=[],K=0;return M(D,X,"","",function(te){return Q.call(le,te,K++)}),X}function V(D){if(D._status===-1){var Q=D._result;Q=Q(),Q.then(function(le){(D._status===0||D._status===-1)&&(D._status=1,D._result=le)},function(le){(D._status===0||D._status===-1)&&(D._status=2,D._result=le)}),D._status===-1&&(D._status=0,D._result=Q)}if(D._status===1)return D._result.default;throw D._result}var ee={current:null},z={transition:null},$={ReactCurrentDispatcher:ee,ReactCurrentBatchConfig:z,ReactCurrentOwner:T};function W(){throw Error("act(...) is not supported in production builds of React.")}return Ve.Children={map:B,forEach:function(D,Q,le){B(D,function(){Q.apply(this,arguments)},le)},count:function(D){var Q=0;return B(D,function(){Q++}),Q},toArray:function(D){return B(D,function(Q){return Q})||[]},only:function(D){if(!L(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},Ve.Component=b,Ve.Fragment=n,Ve.Profiler=i,Ve.PureComponent=_,Ve.StrictMode=s,Ve.Suspense=f,Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$,Ve.act=W,Ve.cloneElement=function(D,Q,le){if(D==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+D+".");var X=E({},D.props),K=D.key,te=D.ref,q=D._owner;if(Q!=null){if(Q.ref!==void 0&&(te=Q.ref,q=T.current),Q.key!==void 0&&(K=""+Q.key),D.type&&D.type.defaultProps)var se=D.type.defaultProps;for(fe in Q)R.call(Q,fe)&&!P.hasOwnProperty(fe)&&(X[fe]=Q[fe]===void 0&&se!==void 0?se[fe]:Q[fe])}var fe=arguments.length-2;if(fe===1)X.children=le;else if(1<fe){se=Array(fe);for(var ge=0;ge<fe;ge++)se[ge]=arguments[ge+2];X.children=se}return{$$typeof:e,type:D.type,key:K,ref:te,props:X,_owner:q}},Ve.createContext=function(D){return D={$$typeof:c,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},D.Provider={$$typeof:l,_context:D},D.Consumer=D},Ve.createElement=O,Ve.createFactory=function(D){var Q=O.bind(null,D);return Q.type=D,Q},Ve.createRef=function(){return{current:null}},Ve.forwardRef=function(D){return{$$typeof:u,render:D}},Ve.isValidElement=L,Ve.lazy=function(D){return{$$typeof:g,_payload:{_status:-1,_result:D},_init:V}},Ve.memo=function(D,Q){return{$$typeof:h,type:D,compare:Q===void 0?null:Q}},Ve.startTransition=function(D){var Q=z.transition;z.transition={};try{D()}finally{z.transition=Q}},Ve.unstable_act=W,Ve.useCallback=function(D,Q){return ee.current.useCallback(D,Q)},Ve.useContext=function(D){return ee.current.useContext(D)},Ve.useDebugValue=function(){},Ve.useDeferredValue=function(D){return ee.current.useDeferredValue(D)},Ve.useEffect=function(D,Q){return ee.current.useEffect(D,Q)},Ve.useId=function(){return ee.current.useId()},Ve.useImperativeHandle=function(D,Q,le){return ee.current.useImperativeHandle(D,Q,le)},Ve.useInsertionEffect=function(D,Q){return ee.current.useInsertionEffect(D,Q)},Ve.useLayoutEffect=function(D,Q){return ee.current.useLayoutEffect(D,Q)},Ve.useMemo=function(D,Q){return ee.current.useMemo(D,Q)},Ve.useReducer=function(D,Q,le){return ee.current.useReducer(D,Q,le)},Ve.useRef=function(D){return ee.current.useRef(D)},Ve.useState=function(D){return ee.current.useState(D)},Ve.useSyncExternalStore=function(D,Q,le){return ee.current.useSyncExternalStore(D,Q,le)},Ve.useTransition=function(){return ee.current.useTransition()},Ve.version="18.3.1",Ve}var Dv;function qh(){return Dv||(Dv=1,hf.exports=oN()),hf.exports}var Ov;function iN(){if(Ov)return Wi;Ov=1;var e=qh(),t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(u,f,h){var g,v={},w=null,x=null;h!==void 0&&(w=""+h),f.key!==void 0&&(w=""+f.key),f.ref!==void 0&&(x=f.ref);for(g in f)s.call(f,g)&&!l.hasOwnProperty(g)&&(v[g]=f[g]);if(u&&u.defaultProps)for(g in f=u.defaultProps,f)v[g]===void 0&&(v[g]=f[g]);return{$$typeof:t,type:u,key:w,ref:x,props:v,_owner:i.current}}return Wi.Fragment=n,Wi.jsx=c,Wi.jsxs=c,Wi}var Lv;function aN(){return Lv||(Lv=1,ff.exports=iN()),ff.exports}var a=aN(),Kl={},mf={exports:{}},sn={},pf={exports:{}},gf={};var Mv;function lN(){return Mv||(Mv=1,(function(e){function t(z,$){var W=z.length;z.push($);e:for(;0<W;){var D=W-1>>>1,Q=z[D];if(0<i(Q,$))z[D]=$,z[W]=Q,W=D;else break e}}function n(z){return z.length===0?null:z[0]}function s(z){if(z.length===0)return null;var $=z[0],W=z.pop();if(W!==$){z[0]=W;e:for(var D=0,Q=z.length,le=Q>>>1;D<le;){var X=2*(D+1)-1,K=z[X],te=X+1,q=z[te];if(0>i(K,W))te<Q&&0>i(q,K)?(z[D]=q,z[te]=W,D=te):(z[D]=K,z[X]=W,D=X);else if(te<Q&&0>i(q,W))z[D]=q,z[te]=W,D=te;else break e}}return $}function i(z,$){var W=z.sortIndex-$.sortIndex;return W!==0?W:z.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var f=[],h=[],g=1,v=null,w=3,x=!1,E=!1,C=!1,b=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(z){for(var $=n(h);$!==null;){if($.callback===null)s(h);else if($.startTime<=z)s(h),$.sortIndex=$.expirationTime,t(f,$);else break;$=n(h)}}function j(z){if(C=!1,N(z),!E)if(n(f)!==null)E=!0,V(R);else{var $=n(h);$!==null&&ee(j,$.startTime-z)}}function R(z,$){E=!1,C&&(C=!1,k(O),O=-1),x=!0;var W=w;try{for(N($),v=n(f);v!==null&&(!(v.expirationTime>$)||z&&!F());){var D=v.callback;if(typeof D=="function"){v.callback=null,w=v.priorityLevel;var Q=D(v.expirationTime<=$);$=e.unstable_now(),typeof Q=="function"?v.callback=Q:v===n(f)&&s(f),N($)}else s(f);v=n(f)}if(v!==null)var le=!0;else{var X=n(h);X!==null&&ee(j,X.startTime-$),le=!1}return le}finally{v=null,w=W,x=!1}}var T=!1,P=null,O=-1,G=5,L=-1;function F(){return!(e.unstable_now()-L<G)}function I(){if(P!==null){var z=e.unstable_now();L=z;var $=!0;try{$=P(!0,z)}finally{$?U():(T=!1,P=null)}}else T=!1}var U;if(typeof _=="function")U=function(){_(I)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,B=M.port2;M.port1.onmessage=I,U=function(){B.postMessage(null)}}else U=function(){b(I,0)};function V(z){P=z,T||(T=!0,U())}function ee(z,$){O=b(function(){z(e.unstable_now())},$)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(z){z.callback=null},e.unstable_continueExecution=function(){E||x||(E=!0,V(R))},e.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<z?Math.floor(1e3/z):5},e.unstable_getCurrentPriorityLevel=function(){return w},e.unstable_getFirstCallbackNode=function(){return n(f)},e.unstable_next=function(z){switch(w){case 1:case 2:case 3:var $=3;break;default:$=w}var W=w;w=$;try{return z()}finally{w=W}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(z,$){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var W=w;w=z;try{return $()}finally{w=W}},e.unstable_scheduleCallback=function(z,$,W){var D=e.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?D+W:D):W=D,z){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=W+Q,z={id:g++,callback:$,priorityLevel:z,startTime:W,expirationTime:Q,sortIndex:-1},W>D?(z.sortIndex=W,t(h,z),n(f)===null&&z===n(h)&&(C?(k(O),O=-1):C=!0,ee(j,W-D))):(z.sortIndex=Q,t(f,z),E||x||(E=!0,V(R))),z},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(z){var $=w;return function(){var W=w;w=$;try{return z.apply(this,arguments)}finally{w=W}}}})(gf)),gf}var $v;function cN(){return $v||($v=1,pf.exports=lN()),pf.exports}var Fv;function dN(){if(Fv)return sn;Fv=1;var e=qh(),t=cN();function n(r){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+r,d=1;d<arguments.length;d++)o+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,i={};function l(r,o){c(r,o),c(r+"Capture",o)}function c(r,o){for(i[r]=o,r=0;r<o.length;r++)s.add(o[r])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},v={};function w(r){return f.call(v,r)?!0:f.call(g,r)?!1:h.test(r)?v[r]=!0:(g[r]=!0,!1)}function x(r,o,d,m){if(d!==null&&d.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return m?!1:d!==null?!d.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function E(r,o,d,m){if(o===null||typeof o>"u"||x(r,o,d,m))return!0;if(m)return!1;if(d!==null)switch(d.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function C(r,o,d,m,y,S,A){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=m,this.attributeNamespace=y,this.mustUseProperty=d,this.propertyName=r,this.type=o,this.sanitizeURL=S,this.removeEmptyString=A}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){b[r]=new C(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var o=r[0];b[o]=new C(o,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){b[r]=new C(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){b[r]=new C(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){b[r]=new C(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){b[r]=new C(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){b[r]=new C(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){b[r]=new C(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){b[r]=new C(r,5,!1,r.toLowerCase(),null,!1,!1)});var k=/[\-:]([a-z])/g;function _(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var o=r.replace(k,_);b[o]=new C(o,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var o=r.replace(k,_);b[o]=new C(o,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var o=r.replace(k,_);b[o]=new C(o,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){b[r]=new C(r,1,!1,r.toLowerCase(),null,!1,!1)}),b.xlinkHref=new C("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){b[r]=new C(r,1,!1,r.toLowerCase(),null,!0,!0)});function N(r,o,d,m){var y=b.hasOwnProperty(o)?b[o]:null;(y!==null?y.type!==0:m||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(E(o,d,y,m)&&(d=null),m||y===null?w(o)&&(d===null?r.removeAttribute(o):r.setAttribute(o,""+d)):y.mustUseProperty?r[y.propertyName]=d===null?y.type===3?!1:"":d:(o=y.attributeName,m=y.attributeNamespace,d===null?r.removeAttribute(o):(y=y.type,d=y===3||y===4&&d===!0?"":""+d,m?r.setAttributeNS(m,o,d):r.setAttribute(o,d))))}var j=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R=Symbol.for("react.element"),T=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),G=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),F=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),ee=Symbol.for("react.offscreen"),z=Symbol.iterator;function $(r){return r===null||typeof r!="object"?null:(r=z&&r[z]||r["@@iterator"],typeof r=="function"?r:null)}var W=Object.assign,D;function Q(r){if(D===void 0)try{throw Error()}catch(d){var o=d.stack.trim().match(/\n( *(at )?)/);D=o&&o[1]||""}return`
`+D+r}var le=!1;function X(r,o){if(!r||le)return"";le=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(oe){var m=oe}Reflect.construct(r,[],o)}else{try{o.call()}catch(oe){m=oe}r.call(o.prototype)}else{try{throw Error()}catch(oe){m=oe}r()}}catch(oe){if(oe&&m&&typeof oe.stack=="string"){for(var y=oe.stack.split(`
`),S=m.stack.split(`
`),A=y.length-1,H=S.length-1;1<=A&&0<=H&&y[A]!==S[H];)H--;for(;1<=A&&0<=H;A--,H--)if(y[A]!==S[H]){if(A!==1||H!==1)do if(A--,H--,0>H||y[A]!==S[H]){var J=`
`+y[A].replace(" at new "," at ");return r.displayName&&J.includes("<anonymous>")&&(J=J.replace("<anonymous>",r.displayName)),J}while(1<=A&&0<=H);break}}}finally{le=!1,Error.prepareStackTrace=d}return(r=r?r.displayName||r.name:"")?Q(r):""}function K(r){switch(r.tag){case 5:return Q(r.type);case 16:return Q("Lazy");case 13:return Q("Suspense");case 19:return Q("SuspenseList");case 0:case 2:case 15:return r=X(r.type,!1),r;case 11:return r=X(r.type.render,!1),r;case 1:return r=X(r.type,!0),r;default:return""}}function te(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case P:return"Fragment";case T:return"Portal";case G:return"Profiler";case O:return"StrictMode";case U:return"Suspense";case M:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case F:return(r.displayName||"Context")+".Consumer";case L:return(r._context.displayName||"Context")+".Provider";case I:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case B:return o=r.displayName||null,o!==null?o:te(r.type)||"Memo";case V:o=r._payload,r=r._init;try{return te(r(o))}catch{}}return null}function q(r){var o=r.type;switch(r.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=o.render,r=r.displayName||r.name||"",o.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return te(o);case 8:return o===O?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function se(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function fe(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function ge(r){var o=fe(r)?"checked":"value",d=Object.getOwnPropertyDescriptor(r.constructor.prototype,o),m=""+r[o];if(!r.hasOwnProperty(o)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var y=d.get,S=d.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return y.call(this)},set:function(A){m=""+A,S.call(this,A)}}),Object.defineProperty(r,o,{enumerable:d.enumerable}),{getValue:function(){return m},setValue:function(A){m=""+A},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function we(r){r._valueTracker||(r._valueTracker=ge(r))}function Re(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var d=o.getValue(),m="";return r&&(m=fe(r)?r.checked?"true":"false":r.value),r=m,r!==d?(o.setValue(r),!0):!1}function Be(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function We(r,o){var d=o.checked;return W({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??r._wrapperState.initialChecked})}function Ge(r,o){var d=o.defaultValue==null?"":o.defaultValue,m=o.checked!=null?o.checked:o.defaultChecked;d=se(o.value!=null?o.value:d),r._wrapperState={initialChecked:m,initialValue:d,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function ie(r,o){o=o.checked,o!=null&&N(r,"checked",o,!1)}function Pe(r,o){ie(r,o);var d=se(o.value),m=o.type;if(d!=null)m==="number"?(d===0&&r.value===""||r.value!=d)&&(r.value=""+d):r.value!==""+d&&(r.value=""+d);else if(m==="submit"||m==="reset"){r.removeAttribute("value");return}o.hasOwnProperty("value")?ve(r,o.type,d):o.hasOwnProperty("defaultValue")&&ve(r,o.type,se(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(r.defaultChecked=!!o.defaultChecked)}function ae(r,o,d){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var m=o.type;if(!(m!=="submit"&&m!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+r._wrapperState.initialValue,d||o===r.value||(r.value=o),r.defaultValue=o}d=r.name,d!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,d!==""&&(r.name=d)}function ve(r,o,d){(o!=="number"||Be(r.ownerDocument)!==r)&&(d==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+d&&(r.defaultValue=""+d))}var _e=Array.isArray;function Ue(r,o,d,m){if(r=r.options,o){o={};for(var y=0;y<d.length;y++)o["$"+d[y]]=!0;for(d=0;d<r.length;d++)y=o.hasOwnProperty("$"+r[d].value),r[d].selected!==y&&(r[d].selected=y),y&&m&&(r[d].defaultSelected=!0)}else{for(d=""+se(d),o=null,y=0;y<r.length;y++){if(r[y].value===d){r[y].selected=!0,m&&(r[y].defaultSelected=!0);return}o!==null||r[y].disabled||(o=r[y])}o!==null&&(o.selected=!0)}}function ft(r,o){if(o.dangerouslySetInnerHTML!=null)throw Error(n(91));return W({},o,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Je(r,o){var d=o.value;if(d==null){if(d=o.children,o=o.defaultValue,d!=null){if(o!=null)throw Error(n(92));if(_e(d)){if(1<d.length)throw Error(n(93));d=d[0]}o=d}o==null&&(o=""),d=o}r._wrapperState={initialValue:se(d)}}function wt(r,o){var d=se(o.value),m=se(o.defaultValue);d!=null&&(d=""+d,d!==r.value&&(r.value=d),o.defaultValue==null&&r.defaultValue!==d&&(r.defaultValue=d)),m!=null&&(r.defaultValue=""+m)}function at(r){var o=r.textContent;o===r._wrapperState.initialValue&&o!==""&&o!==null&&(r.value=o)}function ht(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function He(r,o){return r==null||r==="http://www.w3.org/1999/xhtml"?ht(o):r==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var $e,Mt=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,d,m,y){MSApp.execUnsafeLocalFunction(function(){return r(o,d,m,y)})}:r})(function(r,o){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=o;else{for($e=$e||document.createElement("div"),$e.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=$e.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;o.firstChild;)r.appendChild(o.firstChild)}});function Tt(r,o){if(o){var d=r.firstChild;if(d&&d===r.lastChild&&d.nodeType===3){d.nodeValue=o;return}}r.textContent=o}var yr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_s=["Webkit","ms","Moz","O"];Object.keys(yr).forEach(function(r){_s.forEach(function(o){o=o+r.charAt(0).toUpperCase()+r.substring(1),yr[o]=yr[r]})});function Mr(r,o,d){return o==null||typeof o=="boolean"||o===""?"":d||typeof o!="number"||o===0||yr.hasOwnProperty(r)&&yr[r]?(""+o).trim():o+"px"}function wr(r,o){r=r.style;for(var d in o)if(o.hasOwnProperty(d)){var m=d.indexOf("--")===0,y=Mr(d,o[d],m);d==="float"&&(d="cssFloat"),m?r.setProperty(d,y):r[d]=y}}var Fa=W({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nr(r,o){if(o){if(Fa[r]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(n(137,r));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(n(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(n(61))}if(o.style!=null&&typeof o.style!="object")throw Error(n(62))}}function ci(r,o){if(r.indexOf("-")===-1)return typeof o.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var di=null;function ro(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var so=null,$r=null,rr=null;function Dn(r){if(r=Ai(r)){if(typeof so!="function")throw Error(n(280));var o=r.stateNode;o&&(o=cl(o),so(r.stateNode,r.type,o))}}function Ua(r){$r?rr?rr.push(r):rr=[r]:$r=r}function Fe(){if($r){var r=$r,o=rr;if(rr=$r=null,Dn(r),o)for(r=0;r<o.length;r++)Dn(o[r])}}function Qe(r,o){return r(o)}function et(){}var Vt=!1;function Qt(r,o,d){if(Vt)return r(o,d);Vt=!0;try{return Qe(r,o,d)}finally{Vt=!1,($r!==null||rr!==null)&&(et(),Fe())}}function Xt(r,o){var d=r.stateNode;if(d===null)return null;var m=cl(d);if(m===null)return null;d=m[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(r=r.type,m=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!m;break e;default:r=!1}if(r)return null;if(d&&typeof d!="function")throw Error(n(231,o,typeof d));return d}var On=!1;if(u)try{var At={};Object.defineProperty(At,"passive",{get:function(){On=!0}}),window.addEventListener("test",At,At),window.removeEventListener("test",At,At)}catch{On=!1}function sr(r,o,d,m,y,S,A,H,J){var oe=Array.prototype.slice.call(arguments,3);try{o.apply(d,oe)}catch(ue){this.onError(ue)}}var ui=!1,Ba=null,za=!1,Ad=null,u_={onError:function(r){ui=!0,Ba=r}};function f_(r,o,d,m,y,S,A,H,J){ui=!1,Ba=null,sr.apply(u_,arguments)}function h_(r,o,d,m,y,S,A,H,J){if(f_.apply(this,arguments),ui){if(ui){var oe=Ba;ui=!1,Ba=null}else throw Error(n(198));za||(za=!0,Ad=oe)}}function Ns(r){var o=r,d=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(d=o.return),r=o.return;while(r)}return o.tag===3?d:null}function np(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function rp(r){if(Ns(r)!==r)throw Error(n(188))}function m_(r){var o=r.alternate;if(!o){if(o=Ns(r),o===null)throw Error(n(188));return o!==r?null:r}for(var d=r,m=o;;){var y=d.return;if(y===null)break;var S=y.alternate;if(S===null){if(m=y.return,m!==null){d=m;continue}break}if(y.child===S.child){for(S=y.child;S;){if(S===d)return rp(y),r;if(S===m)return rp(y),o;S=S.sibling}throw Error(n(188))}if(d.return!==m.return)d=y,m=S;else{for(var A=!1,H=y.child;H;){if(H===d){A=!0,d=y,m=S;break}if(H===m){A=!0,m=y,d=S;break}H=H.sibling}if(!A){for(H=S.child;H;){if(H===d){A=!0,d=S,m=y;break}if(H===m){A=!0,m=S,d=y;break}H=H.sibling}if(!A)throw Error(n(189))}}if(d.alternate!==m)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?r:o}function sp(r){return r=m_(r),r!==null?op(r):null}function op(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var o=op(r);if(o!==null)return o;r=r.sibling}return null}var ip=t.unstable_scheduleCallback,ap=t.unstable_cancelCallback,p_=t.unstable_shouldYield,g_=t.unstable_requestPaint,gt=t.unstable_now,v_=t.unstable_getCurrentPriorityLevel,Rd=t.unstable_ImmediatePriority,lp=t.unstable_UserBlockingPriority,Va=t.unstable_NormalPriority,y_=t.unstable_LowPriority,cp=t.unstable_IdlePriority,Ha=null,or=null;function w_(r){if(or&&typeof or.onCommitFiberRoot=="function")try{or.onCommitFiberRoot(Ha,r,void 0,(r.current.flags&128)===128)}catch{}}var Ln=Math.clz32?Math.clz32:C_,x_=Math.log,b_=Math.LN2;function C_(r){return r>>>=0,r===0?32:31-(x_(r)/b_|0)|0}var Wa=64,qa=4194304;function fi(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function Ga(r,o){var d=r.pendingLanes;if(d===0)return 0;var m=0,y=r.suspendedLanes,S=r.pingedLanes,A=d&268435455;if(A!==0){var H=A&~y;H!==0?m=fi(H):(S&=A,S!==0&&(m=fi(S)))}else A=d&~y,A!==0?m=fi(A):S!==0&&(m=fi(S));if(m===0)return 0;if(o!==0&&o!==m&&(o&y)===0&&(y=m&-m,S=o&-o,y>=S||y===16&&(S&4194240)!==0))return o;if((m&4)!==0&&(m|=d&16),o=r.entangledLanes,o!==0)for(r=r.entanglements,o&=m;0<o;)d=31-Ln(o),y=1<<d,m|=r[d],o&=~y;return m}function S_(r,o){switch(r){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function E_(r,o){for(var d=r.suspendedLanes,m=r.pingedLanes,y=r.expirationTimes,S=r.pendingLanes;0<S;){var A=31-Ln(S),H=1<<A,J=y[A];J===-1?((H&d)===0||(H&m)!==0)&&(y[A]=S_(H,o)):J<=o&&(r.expiredLanes|=H),S&=~H}}function Pd(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function dp(){var r=Wa;return Wa<<=1,(Wa&4194240)===0&&(Wa=64),r}function Id(r){for(var o=[],d=0;31>d;d++)o.push(r);return o}function hi(r,o,d){r.pendingLanes|=o,o!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,o=31-Ln(o),r[o]=d}function __(r,o){var d=r.pendingLanes&~o;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=o,r.mutableReadLanes&=o,r.entangledLanes&=o,o=r.entanglements;var m=r.eventTimes;for(r=r.expirationTimes;0<d;){var y=31-Ln(d),S=1<<y;o[y]=0,m[y]=-1,r[y]=-1,d&=~S}}function Dd(r,o){var d=r.entangledLanes|=o;for(r=r.entanglements;d;){var m=31-Ln(d),y=1<<m;y&o|r[m]&o&&(r[m]|=o),d&=~y}}var Xe=0;function up(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var fp,Od,hp,mp,pp,Ld=!1,Ka=[],Fr=null,Ur=null,Br=null,mi=new Map,pi=new Map,zr=[],N_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gp(r,o){switch(r){case"focusin":case"focusout":Fr=null;break;case"dragenter":case"dragleave":Ur=null;break;case"mouseover":case"mouseout":Br=null;break;case"pointerover":case"pointerout":mi.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":pi.delete(o.pointerId)}}function gi(r,o,d,m,y,S){return r===null||r.nativeEvent!==S?(r={blockedOn:o,domEventName:d,eventSystemFlags:m,nativeEvent:S,targetContainers:[y]},o!==null&&(o=Ai(o),o!==null&&Od(o)),r):(r.eventSystemFlags|=m,o=r.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),r)}function k_(r,o,d,m,y){switch(o){case"focusin":return Fr=gi(Fr,r,o,d,m,y),!0;case"dragenter":return Ur=gi(Ur,r,o,d,m,y),!0;case"mouseover":return Br=gi(Br,r,o,d,m,y),!0;case"pointerover":var S=y.pointerId;return mi.set(S,gi(mi.get(S)||null,r,o,d,m,y)),!0;case"gotpointercapture":return S=y.pointerId,pi.set(S,gi(pi.get(S)||null,r,o,d,m,y)),!0}return!1}function vp(r){var o=ks(r.target);if(o!==null){var d=Ns(o);if(d!==null){if(o=d.tag,o===13){if(o=np(d),o!==null){r.blockedOn=o,pp(r.priority,function(){hp(d)});return}}else if(o===3&&d.stateNode.current.memoizedState.isDehydrated){r.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Ya(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var d=$d(r.domEventName,r.eventSystemFlags,o[0],r.nativeEvent);if(d===null){d=r.nativeEvent;var m=new d.constructor(d.type,d);di=m,d.target.dispatchEvent(m),di=null}else return o=Ai(d),o!==null&&Od(o),r.blockedOn=d,!1;o.shift()}return!0}function yp(r,o,d){Ya(r)&&d.delete(o)}function j_(){Ld=!1,Fr!==null&&Ya(Fr)&&(Fr=null),Ur!==null&&Ya(Ur)&&(Ur=null),Br!==null&&Ya(Br)&&(Br=null),mi.forEach(yp),pi.forEach(yp)}function vi(r,o){r.blockedOn===o&&(r.blockedOn=null,Ld||(Ld=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,j_)))}function yi(r){function o(y){return vi(y,r)}if(0<Ka.length){vi(Ka[0],r);for(var d=1;d<Ka.length;d++){var m=Ka[d];m.blockedOn===r&&(m.blockedOn=null)}}for(Fr!==null&&vi(Fr,r),Ur!==null&&vi(Ur,r),Br!==null&&vi(Br,r),mi.forEach(o),pi.forEach(o),d=0;d<zr.length;d++)m=zr[d],m.blockedOn===r&&(m.blockedOn=null);for(;0<zr.length&&(d=zr[0],d.blockedOn===null);)vp(d),d.blockedOn===null&&zr.shift()}var oo=j.ReactCurrentBatchConfig,Ja=!0;function T_(r,o,d,m){var y=Xe,S=oo.transition;oo.transition=null;try{Xe=1,Md(r,o,d,m)}finally{Xe=y,oo.transition=S}}function A_(r,o,d,m){var y=Xe,S=oo.transition;oo.transition=null;try{Xe=4,Md(r,o,d,m)}finally{Xe=y,oo.transition=S}}function Md(r,o,d,m){if(Ja){var y=$d(r,o,d,m);if(y===null)tu(r,o,m,Qa,d),gp(r,m);else if(k_(y,r,o,d,m))m.stopPropagation();else if(gp(r,m),o&4&&-1<N_.indexOf(r)){for(;y!==null;){var S=Ai(y);if(S!==null&&fp(S),S=$d(r,o,d,m),S===null&&tu(r,o,m,Qa,d),S===y)break;y=S}y!==null&&m.stopPropagation()}else tu(r,o,m,null,d)}}var Qa=null;function $d(r,o,d,m){if(Qa=null,r=ro(m),r=ks(r),r!==null)if(o=Ns(r),o===null)r=null;else if(d=o.tag,d===13){if(r=np(o),r!==null)return r;r=null}else if(d===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null);return Qa=r,null}function wp(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(v_()){case Rd:return 1;case lp:return 4;case Va:case y_:return 16;case cp:return 536870912;default:return 16}default:return 16}}var Vr=null,Fd=null,Xa=null;function xp(){if(Xa)return Xa;var r,o=Fd,d=o.length,m,y="value"in Vr?Vr.value:Vr.textContent,S=y.length;for(r=0;r<d&&o[r]===y[r];r++);var A=d-r;for(m=1;m<=A&&o[d-m]===y[S-m];m++);return Xa=y.slice(r,1<m?1-m:void 0)}function Za(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function el(){return!0}function bp(){return!1}function ln(r){function o(d,m,y,S,A){this._reactName=d,this._targetInst=y,this.type=m,this.nativeEvent=S,this.target=A,this.currentTarget=null;for(var H in r)r.hasOwnProperty(H)&&(d=r[H],this[H]=d?d(S):S[H]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?el:bp,this.isPropagationStopped=bp,this}return W(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=el)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=el)},persist:function(){},isPersistent:el}),o}var io={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ud=ln(io),wi=W({},io,{view:0,detail:0}),R_=ln(wi),Bd,zd,xi,tl=W({},wi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hd,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==xi&&(xi&&r.type==="mousemove"?(Bd=r.screenX-xi.screenX,zd=r.screenY-xi.screenY):zd=Bd=0,xi=r),Bd)},movementY:function(r){return"movementY"in r?r.movementY:zd}}),Cp=ln(tl),P_=W({},tl,{dataTransfer:0}),I_=ln(P_),D_=W({},wi,{relatedTarget:0}),Vd=ln(D_),O_=W({},io,{animationName:0,elapsedTime:0,pseudoElement:0}),L_=ln(O_),M_=W({},io,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),$_=ln(M_),F_=W({},io,{data:0}),Sp=ln(F_),U_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},B_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},z_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function V_(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=z_[r])?!!o[r]:!1}function Hd(){return V_}var H_=W({},wi,{key:function(r){if(r.key){var o=U_[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=Za(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?B_[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hd,charCode:function(r){return r.type==="keypress"?Za(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Za(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),W_=ln(H_),q_=W({},tl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ep=ln(q_),G_=W({},wi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hd}),K_=ln(G_),Y_=W({},io,{propertyName:0,elapsedTime:0,pseudoElement:0}),J_=ln(Y_),Q_=W({},tl,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),X_=ln(Q_),Z_=[9,13,27,32],Wd=u&&"CompositionEvent"in window,bi=null;u&&"documentMode"in document&&(bi=document.documentMode);var e1=u&&"TextEvent"in window&&!bi,_p=u&&(!Wd||bi&&8<bi&&11>=bi),Np=" ",kp=!1;function jp(r,o){switch(r){case"keyup":return Z_.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tp(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ao=!1;function t1(r,o){switch(r){case"compositionend":return Tp(o);case"keypress":return o.which!==32?null:(kp=!0,Np);case"textInput":return r=o.data,r===Np&&kp?null:r;default:return null}}function n1(r,o){if(ao)return r==="compositionend"||!Wd&&jp(r,o)?(r=xp(),Xa=Fd=Vr=null,ao=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return _p&&o.locale!=="ko"?null:o.data;default:return null}}var r1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ap(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!r1[r.type]:o==="textarea"}function Rp(r,o,d,m){Ua(m),o=il(o,"onChange"),0<o.length&&(d=new Ud("onChange","change",null,d,m),r.push({event:d,listeners:o}))}var Ci=null,Si=null;function s1(r){Yp(r,0)}function nl(r){var o=ho(r);if(Re(o))return r}function o1(r,o){if(r==="change")return o}var Pp=!1;if(u){var qd;if(u){var Gd="oninput"in document;if(!Gd){var Ip=document.createElement("div");Ip.setAttribute("oninput","return;"),Gd=typeof Ip.oninput=="function"}qd=Gd}else qd=!1;Pp=qd&&(!document.documentMode||9<document.documentMode)}function Dp(){Ci&&(Ci.detachEvent("onpropertychange",Op),Si=Ci=null)}function Op(r){if(r.propertyName==="value"&&nl(Si)){var o=[];Rp(o,Si,r,ro(r)),Qt(s1,o)}}function i1(r,o,d){r==="focusin"?(Dp(),Ci=o,Si=d,Ci.attachEvent("onpropertychange",Op)):r==="focusout"&&Dp()}function a1(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return nl(Si)}function l1(r,o){if(r==="click")return nl(o)}function c1(r,o){if(r==="input"||r==="change")return nl(o)}function d1(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var Mn=typeof Object.is=="function"?Object.is:d1;function Ei(r,o){if(Mn(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var d=Object.keys(r),m=Object.keys(o);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var y=d[m];if(!f.call(o,y)||!Mn(r[y],o[y]))return!1}return!0}function Lp(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Mp(r,o){var d=Lp(r);r=0;for(var m;d;){if(d.nodeType===3){if(m=r+d.textContent.length,r<=o&&m>=o)return{node:d,offset:o-r};r=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Lp(d)}}function $p(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?$p(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function Fp(){for(var r=window,o=Be();o instanceof r.HTMLIFrameElement;){try{var d=typeof o.contentWindow.location.href=="string"}catch{d=!1}if(d)r=o.contentWindow;else break;o=Be(r.document)}return o}function Kd(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}function u1(r){var o=Fp(),d=r.focusedElem,m=r.selectionRange;if(o!==d&&d&&d.ownerDocument&&$p(d.ownerDocument.documentElement,d)){if(m!==null&&Kd(d)){if(o=m.start,r=m.end,r===void 0&&(r=o),"selectionStart"in d)d.selectionStart=o,d.selectionEnd=Math.min(r,d.value.length);else if(r=(o=d.ownerDocument||document)&&o.defaultView||window,r.getSelection){r=r.getSelection();var y=d.textContent.length,S=Math.min(m.start,y);m=m.end===void 0?S:Math.min(m.end,y),!r.extend&&S>m&&(y=m,m=S,S=y),y=Mp(d,S);var A=Mp(d,m);y&&A&&(r.rangeCount!==1||r.anchorNode!==y.node||r.anchorOffset!==y.offset||r.focusNode!==A.node||r.focusOffset!==A.offset)&&(o=o.createRange(),o.setStart(y.node,y.offset),r.removeAllRanges(),S>m?(r.addRange(o),r.extend(A.node,A.offset)):(o.setEnd(A.node,A.offset),r.addRange(o)))}}for(o=[],r=d;r=r.parentNode;)r.nodeType===1&&o.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<o.length;d++)r=o[d],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var f1=u&&"documentMode"in document&&11>=document.documentMode,lo=null,Yd=null,_i=null,Jd=!1;function Up(r,o,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Jd||lo==null||lo!==Be(m)||(m=lo,"selectionStart"in m&&Kd(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),_i&&Ei(_i,m)||(_i=m,m=il(Yd,"onSelect"),0<m.length&&(o=new Ud("onSelect","select",null,o,d),r.push({event:o,listeners:m}),o.target=lo)))}function rl(r,o){var d={};return d[r.toLowerCase()]=o.toLowerCase(),d["Webkit"+r]="webkit"+o,d["Moz"+r]="moz"+o,d}var co={animationend:rl("Animation","AnimationEnd"),animationiteration:rl("Animation","AnimationIteration"),animationstart:rl("Animation","AnimationStart"),transitionend:rl("Transition","TransitionEnd")},Qd={},Bp={};u&&(Bp=document.createElement("div").style,"AnimationEvent"in window||(delete co.animationend.animation,delete co.animationiteration.animation,delete co.animationstart.animation),"TransitionEvent"in window||delete co.transitionend.transition);function sl(r){if(Qd[r])return Qd[r];if(!co[r])return r;var o=co[r],d;for(d in o)if(o.hasOwnProperty(d)&&d in Bp)return Qd[r]=o[d];return r}var zp=sl("animationend"),Vp=sl("animationiteration"),Hp=sl("animationstart"),Wp=sl("transitionend"),qp=new Map,Gp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hr(r,o){qp.set(r,o),l(o,[r])}for(var Xd=0;Xd<Gp.length;Xd++){var Zd=Gp[Xd],h1=Zd.toLowerCase(),m1=Zd[0].toUpperCase()+Zd.slice(1);Hr(h1,"on"+m1)}Hr(zp,"onAnimationEnd"),Hr(Vp,"onAnimationIteration"),Hr(Hp,"onAnimationStart"),Hr("dblclick","onDoubleClick"),Hr("focusin","onFocus"),Hr("focusout","onBlur"),Hr(Wp,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ni="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),p1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ni));function Kp(r,o,d){var m=r.type||"unknown-event";r.currentTarget=d,h_(m,o,void 0,r),r.currentTarget=null}function Yp(r,o){o=(o&4)!==0;for(var d=0;d<r.length;d++){var m=r[d],y=m.event;m=m.listeners;e:{var S=void 0;if(o)for(var A=m.length-1;0<=A;A--){var H=m[A],J=H.instance,oe=H.currentTarget;if(H=H.listener,J!==S&&y.isPropagationStopped())break e;Kp(y,H,oe),S=J}else for(A=0;A<m.length;A++){if(H=m[A],J=H.instance,oe=H.currentTarget,H=H.listener,J!==S&&y.isPropagationStopped())break e;Kp(y,H,oe),S=J}}}if(za)throw r=Ad,za=!1,Ad=null,r}function st(r,o){var d=o[au];d===void 0&&(d=o[au]=new Set);var m=r+"__bubble";d.has(m)||(Jp(o,r,2,!1),d.add(m))}function eu(r,o,d){var m=0;o&&(m|=4),Jp(d,r,m,o)}var ol="_reactListening"+Math.random().toString(36).slice(2);function ki(r){if(!r[ol]){r[ol]=!0,s.forEach(function(d){d!=="selectionchange"&&(p1.has(d)||eu(d,!1,r),eu(d,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[ol]||(o[ol]=!0,eu("selectionchange",!1,o))}}function Jp(r,o,d,m){switch(wp(o)){case 1:var y=T_;break;case 4:y=A_;break;default:y=Md}d=y.bind(null,o,d,r),y=void 0,!On||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),m?y!==void 0?r.addEventListener(o,d,{capture:!0,passive:y}):r.addEventListener(o,d,!0):y!==void 0?r.addEventListener(o,d,{passive:y}):r.addEventListener(o,d,!1)}function tu(r,o,d,m,y){var S=m;if((o&1)===0&&(o&2)===0&&m!==null)e:for(;;){if(m===null)return;var A=m.tag;if(A===3||A===4){var H=m.stateNode.containerInfo;if(H===y||H.nodeType===8&&H.parentNode===y)break;if(A===4)for(A=m.return;A!==null;){var J=A.tag;if((J===3||J===4)&&(J=A.stateNode.containerInfo,J===y||J.nodeType===8&&J.parentNode===y))return;A=A.return}for(;H!==null;){if(A=ks(H),A===null)return;if(J=A.tag,J===5||J===6){m=S=A;continue e}H=H.parentNode}}m=m.return}Qt(function(){var oe=S,ue=ro(d),he=[];e:{var de=qp.get(r);if(de!==void 0){var xe=Ud,Se=r;switch(r){case"keypress":if(Za(d)===0)break e;case"keydown":case"keyup":xe=W_;break;case"focusin":Se="focus",xe=Vd;break;case"focusout":Se="blur",xe=Vd;break;case"beforeblur":case"afterblur":xe=Vd;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=Cp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=I_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=K_;break;case zp:case Vp:case Hp:xe=L_;break;case Wp:xe=J_;break;case"scroll":xe=R_;break;case"wheel":xe=X_;break;case"copy":case"cut":case"paste":xe=$_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=Ep}var Ee=(o&4)!==0,vt=!Ee&&r==="scroll",ne=Ee?de!==null?de+"Capture":null:de;Ee=[];for(var Z=oe,re;Z!==null;){re=Z;var me=re.stateNode;if(re.tag===5&&me!==null&&(re=me,ne!==null&&(me=Xt(Z,ne),me!=null&&Ee.push(ji(Z,me,re)))),vt)break;Z=Z.return}0<Ee.length&&(de=new xe(de,Se,null,d,ue),he.push({event:de,listeners:Ee}))}}if((o&7)===0){e:{if(de=r==="mouseover"||r==="pointerover",xe=r==="mouseout"||r==="pointerout",de&&d!==di&&(Se=d.relatedTarget||d.fromElement)&&(ks(Se)||Se[xr]))break e;if((xe||de)&&(de=ue.window===ue?ue:(de=ue.ownerDocument)?de.defaultView||de.parentWindow:window,xe?(Se=d.relatedTarget||d.toElement,xe=oe,Se=Se?ks(Se):null,Se!==null&&(vt=Ns(Se),Se!==vt||Se.tag!==5&&Se.tag!==6)&&(Se=null)):(xe=null,Se=oe),xe!==Se)){if(Ee=Cp,me="onMouseLeave",ne="onMouseEnter",Z="mouse",(r==="pointerout"||r==="pointerover")&&(Ee=Ep,me="onPointerLeave",ne="onPointerEnter",Z="pointer"),vt=xe==null?de:ho(xe),re=Se==null?de:ho(Se),de=new Ee(me,Z+"leave",xe,d,ue),de.target=vt,de.relatedTarget=re,me=null,ks(ue)===oe&&(Ee=new Ee(ne,Z+"enter",Se,d,ue),Ee.target=re,Ee.relatedTarget=vt,me=Ee),vt=me,xe&&Se)t:{for(Ee=xe,ne=Se,Z=0,re=Ee;re;re=uo(re))Z++;for(re=0,me=ne;me;me=uo(me))re++;for(;0<Z-re;)Ee=uo(Ee),Z--;for(;0<re-Z;)ne=uo(ne),re--;for(;Z--;){if(Ee===ne||ne!==null&&Ee===ne.alternate)break t;Ee=uo(Ee),ne=uo(ne)}Ee=null}else Ee=null;xe!==null&&Qp(he,de,xe,Ee,!1),Se!==null&&vt!==null&&Qp(he,vt,Se,Ee,!0)}}e:{if(de=oe?ho(oe):window,xe=de.nodeName&&de.nodeName.toLowerCase(),xe==="select"||xe==="input"&&de.type==="file")var ke=o1;else if(Ap(de))if(Pp)ke=c1;else{ke=a1;var Ie=i1}else(xe=de.nodeName)&&xe.toLowerCase()==="input"&&(de.type==="checkbox"||de.type==="radio")&&(ke=l1);if(ke&&(ke=ke(r,oe))){Rp(he,ke,d,ue);break e}Ie&&Ie(r,de,oe),r==="focusout"&&(Ie=de._wrapperState)&&Ie.controlled&&de.type==="number"&&ve(de,"number",de.value)}switch(Ie=oe?ho(oe):window,r){case"focusin":(Ap(Ie)||Ie.contentEditable==="true")&&(lo=Ie,Yd=oe,_i=null);break;case"focusout":_i=Yd=lo=null;break;case"mousedown":Jd=!0;break;case"contextmenu":case"mouseup":case"dragend":Jd=!1,Up(he,d,ue);break;case"selectionchange":if(f1)break;case"keydown":case"keyup":Up(he,d,ue)}var De;if(Wd)e:{switch(r){case"compositionstart":var Me="onCompositionStart";break e;case"compositionend":Me="onCompositionEnd";break e;case"compositionupdate":Me="onCompositionUpdate";break e}Me=void 0}else ao?jp(r,d)&&(Me="onCompositionEnd"):r==="keydown"&&d.keyCode===229&&(Me="onCompositionStart");Me&&(_p&&d.locale!=="ko"&&(ao||Me!=="onCompositionStart"?Me==="onCompositionEnd"&&ao&&(De=xp()):(Vr=ue,Fd="value"in Vr?Vr.value:Vr.textContent,ao=!0)),Ie=il(oe,Me),0<Ie.length&&(Me=new Sp(Me,r,null,d,ue),he.push({event:Me,listeners:Ie}),De?Me.data=De:(De=Tp(d),De!==null&&(Me.data=De)))),(De=e1?t1(r,d):n1(r,d))&&(oe=il(oe,"onBeforeInput"),0<oe.length&&(ue=new Sp("onBeforeInput","beforeinput",null,d,ue),he.push({event:ue,listeners:oe}),ue.data=De))}Yp(he,o)})}function ji(r,o,d){return{instance:r,listener:o,currentTarget:d}}function il(r,o){for(var d=o+"Capture",m=[];r!==null;){var y=r,S=y.stateNode;y.tag===5&&S!==null&&(y=S,S=Xt(r,d),S!=null&&m.unshift(ji(r,S,y)),S=Xt(r,o),S!=null&&m.push(ji(r,S,y))),r=r.return}return m}function uo(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Qp(r,o,d,m,y){for(var S=o._reactName,A=[];d!==null&&d!==m;){var H=d,J=H.alternate,oe=H.stateNode;if(J!==null&&J===m)break;H.tag===5&&oe!==null&&(H=oe,y?(J=Xt(d,S),J!=null&&A.unshift(ji(d,J,H))):y||(J=Xt(d,S),J!=null&&A.push(ji(d,J,H)))),d=d.return}A.length!==0&&r.push({event:o,listeners:A})}var g1=/\r\n?/g,v1=/\u0000|\uFFFD/g;function Xp(r){return(typeof r=="string"?r:""+r).replace(g1,`
`).replace(v1,"")}function al(r,o,d){if(o=Xp(o),Xp(r)!==o&&d)throw Error(n(425))}function ll(){}var nu=null,ru=null;function su(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var ou=typeof setTimeout=="function"?setTimeout:void 0,y1=typeof clearTimeout=="function"?clearTimeout:void 0,Zp=typeof Promise=="function"?Promise:void 0,w1=typeof queueMicrotask=="function"?queueMicrotask:typeof Zp<"u"?function(r){return Zp.resolve(null).then(r).catch(x1)}:ou;function x1(r){setTimeout(function(){throw r})}function iu(r,o){var d=o,m=0;do{var y=d.nextSibling;if(r.removeChild(d),y&&y.nodeType===8)if(d=y.data,d==="/$"){if(m===0){r.removeChild(y),yi(o);return}m--}else d!=="$"&&d!=="$?"&&d!=="$!"||m++;d=y}while(d);yi(o)}function Wr(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return r}function eg(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var d=r.data;if(d==="$"||d==="$!"||d==="$?"){if(o===0)return r;o--}else d==="/$"&&o++}r=r.previousSibling}return null}var fo=Math.random().toString(36).slice(2),ir="__reactFiber$"+fo,Ti="__reactProps$"+fo,xr="__reactContainer$"+fo,au="__reactEvents$"+fo,b1="__reactListeners$"+fo,C1="__reactHandles$"+fo;function ks(r){var o=r[ir];if(o)return o;for(var d=r.parentNode;d;){if(o=d[xr]||d[ir]){if(d=o.alternate,o.child!==null||d!==null&&d.child!==null)for(r=eg(r);r!==null;){if(d=r[ir])return d;r=eg(r)}return o}r=d,d=r.parentNode}return null}function Ai(r){return r=r[ir]||r[xr],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function ho(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(n(33))}function cl(r){return r[Ti]||null}var lu=[],mo=-1;function qr(r){return{current:r}}function ot(r){0>mo||(r.current=lu[mo],lu[mo]=null,mo--)}function nt(r,o){mo++,lu[mo]=r.current,r.current=o}var Gr={},$t=qr(Gr),Zt=qr(!1),js=Gr;function po(r,o){var d=r.type.contextTypes;if(!d)return Gr;var m=r.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===o)return m.__reactInternalMemoizedMaskedChildContext;var y={},S;for(S in d)y[S]=o[S];return m&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=o,r.__reactInternalMemoizedMaskedChildContext=y),y}function en(r){return r=r.childContextTypes,r!=null}function dl(){ot(Zt),ot($t)}function tg(r,o,d){if($t.current!==Gr)throw Error(n(168));nt($t,o),nt(Zt,d)}function ng(r,o,d){var m=r.stateNode;if(o=o.childContextTypes,typeof m.getChildContext!="function")return d;m=m.getChildContext();for(var y in m)if(!(y in o))throw Error(n(108,q(r)||"Unknown",y));return W({},d,m)}function ul(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Gr,js=$t.current,nt($t,r),nt(Zt,Zt.current),!0}function rg(r,o,d){var m=r.stateNode;if(!m)throw Error(n(169));d?(r=ng(r,o,js),m.__reactInternalMemoizedMergedChildContext=r,ot(Zt),ot($t),nt($t,r)):ot(Zt),nt(Zt,d)}var br=null,fl=!1,cu=!1;function sg(r){br===null?br=[r]:br.push(r)}function S1(r){fl=!0,sg(r)}function Kr(){if(!cu&&br!==null){cu=!0;var r=0,o=Xe;try{var d=br;for(Xe=1;r<d.length;r++){var m=d[r];do m=m(!0);while(m!==null)}br=null,fl=!1}catch(y){throw br!==null&&(br=br.slice(r+1)),ip(Rd,Kr),y}finally{Xe=o,cu=!1}}return null}var go=[],vo=0,hl=null,ml=0,vn=[],yn=0,Ts=null,Cr=1,Sr="";function As(r,o){go[vo++]=ml,go[vo++]=hl,hl=r,ml=o}function og(r,o,d){vn[yn++]=Cr,vn[yn++]=Sr,vn[yn++]=Ts,Ts=r;var m=Cr;r=Sr;var y=32-Ln(m)-1;m&=~(1<<y),d+=1;var S=32-Ln(o)+y;if(30<S){var A=y-y%5;S=(m&(1<<A)-1).toString(32),m>>=A,y-=A,Cr=1<<32-Ln(o)+y|d<<y|m,Sr=S+r}else Cr=1<<S|d<<y|m,Sr=r}function du(r){r.return!==null&&(As(r,1),og(r,1,0))}function uu(r){for(;r===hl;)hl=go[--vo],go[vo]=null,ml=go[--vo],go[vo]=null;for(;r===Ts;)Ts=vn[--yn],vn[yn]=null,Sr=vn[--yn],vn[yn]=null,Cr=vn[--yn],vn[yn]=null}var cn=null,dn=null,lt=!1,$n=null;function ig(r,o){var d=Cn(5,null,null,0);d.elementType="DELETED",d.stateNode=o,d.return=r,o=r.deletions,o===null?(r.deletions=[d],r.flags|=16):o.push(d)}function ag(r,o){switch(r.tag){case 5:var d=r.type;return o=o.nodeType!==1||d.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(r.stateNode=o,cn=r,dn=Wr(o.firstChild),!0):!1;case 6:return o=r.pendingProps===""||o.nodeType!==3?null:o,o!==null?(r.stateNode=o,cn=r,dn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(d=Ts!==null?{id:Cr,overflow:Sr}:null,r.memoizedState={dehydrated:o,treeContext:d,retryLane:1073741824},d=Cn(18,null,null,0),d.stateNode=o,d.return=r,r.child=d,cn=r,dn=null,!0):!1;default:return!1}}function fu(r){return(r.mode&1)!==0&&(r.flags&128)===0}function hu(r){if(lt){var o=dn;if(o){var d=o;if(!ag(r,o)){if(fu(r))throw Error(n(418));o=Wr(d.nextSibling);var m=cn;o&&ag(r,o)?ig(m,d):(r.flags=r.flags&-4097|2,lt=!1,cn=r)}}else{if(fu(r))throw Error(n(418));r.flags=r.flags&-4097|2,lt=!1,cn=r}}}function lg(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;cn=r}function pl(r){if(r!==cn)return!1;if(!lt)return lg(r),lt=!0,!1;var o;if((o=r.tag!==3)&&!(o=r.tag!==5)&&(o=r.type,o=o!=="head"&&o!=="body"&&!su(r.type,r.memoizedProps)),o&&(o=dn)){if(fu(r))throw cg(),Error(n(418));for(;o;)ig(r,o),o=Wr(o.nextSibling)}if(lg(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));e:{for(r=r.nextSibling,o=0;r;){if(r.nodeType===8){var d=r.data;if(d==="/$"){if(o===0){dn=Wr(r.nextSibling);break e}o--}else d!=="$"&&d!=="$!"&&d!=="$?"||o++}r=r.nextSibling}dn=null}}else dn=cn?Wr(r.stateNode.nextSibling):null;return!0}function cg(){for(var r=dn;r;)r=Wr(r.nextSibling)}function yo(){dn=cn=null,lt=!1}function mu(r){$n===null?$n=[r]:$n.push(r)}var E1=j.ReactCurrentBatchConfig;function Ri(r,o,d){if(r=d.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(n(309));var m=d.stateNode}if(!m)throw Error(n(147,r));var y=m,S=""+r;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===S?o.ref:(o=function(A){var H=y.refs;A===null?delete H[S]:H[S]=A},o._stringRef=S,o)}if(typeof r!="string")throw Error(n(284));if(!d._owner)throw Error(n(290,r))}return r}function gl(r,o){throw r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r))}function dg(r){var o=r._init;return o(r._payload)}function ug(r){function o(ne,Z){if(r){var re=ne.deletions;re===null?(ne.deletions=[Z],ne.flags|=16):re.push(Z)}}function d(ne,Z){if(!r)return null;for(;Z!==null;)o(ne,Z),Z=Z.sibling;return null}function m(ne,Z){for(ne=new Map;Z!==null;)Z.key!==null?ne.set(Z.key,Z):ne.set(Z.index,Z),Z=Z.sibling;return ne}function y(ne,Z){return ne=ns(ne,Z),ne.index=0,ne.sibling=null,ne}function S(ne,Z,re){return ne.index=re,r?(re=ne.alternate,re!==null?(re=re.index,re<Z?(ne.flags|=2,Z):re):(ne.flags|=2,Z)):(ne.flags|=1048576,Z)}function A(ne){return r&&ne.alternate===null&&(ne.flags|=2),ne}function H(ne,Z,re,me){return Z===null||Z.tag!==6?(Z=of(re,ne.mode,me),Z.return=ne,Z):(Z=y(Z,re),Z.return=ne,Z)}function J(ne,Z,re,me){var ke=re.type;return ke===P?ue(ne,Z,re.props.children,me,re.key):Z!==null&&(Z.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===V&&dg(ke)===Z.type)?(me=y(Z,re.props),me.ref=Ri(ne,Z,re),me.return=ne,me):(me=Ul(re.type,re.key,re.props,null,ne.mode,me),me.ref=Ri(ne,Z,re),me.return=ne,me)}function oe(ne,Z,re,me){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==re.containerInfo||Z.stateNode.implementation!==re.implementation?(Z=af(re,ne.mode,me),Z.return=ne,Z):(Z=y(Z,re.children||[]),Z.return=ne,Z)}function ue(ne,Z,re,me,ke){return Z===null||Z.tag!==7?(Z=$s(re,ne.mode,me,ke),Z.return=ne,Z):(Z=y(Z,re),Z.return=ne,Z)}function he(ne,Z,re){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return Z=of(""+Z,ne.mode,re),Z.return=ne,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case R:return re=Ul(Z.type,Z.key,Z.props,null,ne.mode,re),re.ref=Ri(ne,null,Z),re.return=ne,re;case T:return Z=af(Z,ne.mode,re),Z.return=ne,Z;case V:var me=Z._init;return he(ne,me(Z._payload),re)}if(_e(Z)||$(Z))return Z=$s(Z,ne.mode,re,null),Z.return=ne,Z;gl(ne,Z)}return null}function de(ne,Z,re,me){var ke=Z!==null?Z.key:null;if(typeof re=="string"&&re!==""||typeof re=="number")return ke!==null?null:H(ne,Z,""+re,me);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case R:return re.key===ke?J(ne,Z,re,me):null;case T:return re.key===ke?oe(ne,Z,re,me):null;case V:return ke=re._init,de(ne,Z,ke(re._payload),me)}if(_e(re)||$(re))return ke!==null?null:ue(ne,Z,re,me,null);gl(ne,re)}return null}function xe(ne,Z,re,me,ke){if(typeof me=="string"&&me!==""||typeof me=="number")return ne=ne.get(re)||null,H(Z,ne,""+me,ke);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case R:return ne=ne.get(me.key===null?re:me.key)||null,J(Z,ne,me,ke);case T:return ne=ne.get(me.key===null?re:me.key)||null,oe(Z,ne,me,ke);case V:var Ie=me._init;return xe(ne,Z,re,Ie(me._payload),ke)}if(_e(me)||$(me))return ne=ne.get(re)||null,ue(Z,ne,me,ke,null);gl(Z,me)}return null}function Se(ne,Z,re,me){for(var ke=null,Ie=null,De=Z,Me=Z=0,jt=null;De!==null&&Me<re.length;Me++){De.index>Me?(jt=De,De=null):jt=De.sibling;var Ye=de(ne,De,re[Me],me);if(Ye===null){De===null&&(De=jt);break}r&&De&&Ye.alternate===null&&o(ne,De),Z=S(Ye,Z,Me),Ie===null?ke=Ye:Ie.sibling=Ye,Ie=Ye,De=jt}if(Me===re.length)return d(ne,De),lt&&As(ne,Me),ke;if(De===null){for(;Me<re.length;Me++)De=he(ne,re[Me],me),De!==null&&(Z=S(De,Z,Me),Ie===null?ke=De:Ie.sibling=De,Ie=De);return lt&&As(ne,Me),ke}for(De=m(ne,De);Me<re.length;Me++)jt=xe(De,ne,Me,re[Me],me),jt!==null&&(r&&jt.alternate!==null&&De.delete(jt.key===null?Me:jt.key),Z=S(jt,Z,Me),Ie===null?ke=jt:Ie.sibling=jt,Ie=jt);return r&&De.forEach(function(rs){return o(ne,rs)}),lt&&As(ne,Me),ke}function Ee(ne,Z,re,me){var ke=$(re);if(typeof ke!="function")throw Error(n(150));if(re=ke.call(re),re==null)throw Error(n(151));for(var Ie=ke=null,De=Z,Me=Z=0,jt=null,Ye=re.next();De!==null&&!Ye.done;Me++,Ye=re.next()){De.index>Me?(jt=De,De=null):jt=De.sibling;var rs=de(ne,De,Ye.value,me);if(rs===null){De===null&&(De=jt);break}r&&De&&rs.alternate===null&&o(ne,De),Z=S(rs,Z,Me),Ie===null?ke=rs:Ie.sibling=rs,Ie=rs,De=jt}if(Ye.done)return d(ne,De),lt&&As(ne,Me),ke;if(De===null){for(;!Ye.done;Me++,Ye=re.next())Ye=he(ne,Ye.value,me),Ye!==null&&(Z=S(Ye,Z,Me),Ie===null?ke=Ye:Ie.sibling=Ye,Ie=Ye);return lt&&As(ne,Me),ke}for(De=m(ne,De);!Ye.done;Me++,Ye=re.next())Ye=xe(De,ne,Me,Ye.value,me),Ye!==null&&(r&&Ye.alternate!==null&&De.delete(Ye.key===null?Me:Ye.key),Z=S(Ye,Z,Me),Ie===null?ke=Ye:Ie.sibling=Ye,Ie=Ye);return r&&De.forEach(function(rN){return o(ne,rN)}),lt&&As(ne,Me),ke}function vt(ne,Z,re,me){if(typeof re=="object"&&re!==null&&re.type===P&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case R:e:{for(var ke=re.key,Ie=Z;Ie!==null;){if(Ie.key===ke){if(ke=re.type,ke===P){if(Ie.tag===7){d(ne,Ie.sibling),Z=y(Ie,re.props.children),Z.return=ne,ne=Z;break e}}else if(Ie.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===V&&dg(ke)===Ie.type){d(ne,Ie.sibling),Z=y(Ie,re.props),Z.ref=Ri(ne,Ie,re),Z.return=ne,ne=Z;break e}d(ne,Ie);break}else o(ne,Ie);Ie=Ie.sibling}re.type===P?(Z=$s(re.props.children,ne.mode,me,re.key),Z.return=ne,ne=Z):(me=Ul(re.type,re.key,re.props,null,ne.mode,me),me.ref=Ri(ne,Z,re),me.return=ne,ne=me)}return A(ne);case T:e:{for(Ie=re.key;Z!==null;){if(Z.key===Ie)if(Z.tag===4&&Z.stateNode.containerInfo===re.containerInfo&&Z.stateNode.implementation===re.implementation){d(ne,Z.sibling),Z=y(Z,re.children||[]),Z.return=ne,ne=Z;break e}else{d(ne,Z);break}else o(ne,Z);Z=Z.sibling}Z=af(re,ne.mode,me),Z.return=ne,ne=Z}return A(ne);case V:return Ie=re._init,vt(ne,Z,Ie(re._payload),me)}if(_e(re))return Se(ne,Z,re,me);if($(re))return Ee(ne,Z,re,me);gl(ne,re)}return typeof re=="string"&&re!==""||typeof re=="number"?(re=""+re,Z!==null&&Z.tag===6?(d(ne,Z.sibling),Z=y(Z,re),Z.return=ne,ne=Z):(d(ne,Z),Z=of(re,ne.mode,me),Z.return=ne,ne=Z),A(ne)):d(ne,Z)}return vt}var wo=ug(!0),fg=ug(!1),vl=qr(null),yl=null,xo=null,pu=null;function gu(){pu=xo=yl=null}function vu(r){var o=vl.current;ot(vl),r._currentValue=o}function yu(r,o,d){for(;r!==null;){var m=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,m!==null&&(m.childLanes|=o)):m!==null&&(m.childLanes&o)!==o&&(m.childLanes|=o),r===d)break;r=r.return}}function bo(r,o){yl=r,pu=xo=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&o)!==0&&(tn=!0),r.firstContext=null)}function wn(r){var o=r._currentValue;if(pu!==r)if(r={context:r,memoizedValue:o,next:null},xo===null){if(yl===null)throw Error(n(308));xo=r,yl.dependencies={lanes:0,firstContext:r}}else xo=xo.next=r;return o}var Rs=null;function wu(r){Rs===null?Rs=[r]:Rs.push(r)}function hg(r,o,d,m){var y=o.interleaved;return y===null?(d.next=d,wu(o)):(d.next=y.next,y.next=d),o.interleaved=d,Er(r,m)}function Er(r,o){r.lanes|=o;var d=r.alternate;for(d!==null&&(d.lanes|=o),d=r,r=r.return;r!==null;)r.childLanes|=o,d=r.alternate,d!==null&&(d.childLanes|=o),d=r,r=r.return;return d.tag===3?d.stateNode:null}var Yr=!1;function xu(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mg(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function _r(r,o){return{eventTime:r,lane:o,tag:0,payload:null,callback:null,next:null}}function Jr(r,o,d){var m=r.updateQueue;if(m===null)return null;if(m=m.shared,(Ke&2)!==0){var y=m.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),m.pending=o,Er(r,d)}return y=m.interleaved,y===null?(o.next=o,wu(m)):(o.next=y.next,y.next=o),m.interleaved=o,Er(r,d)}function wl(r,o,d){if(o=o.updateQueue,o!==null&&(o=o.shared,(d&4194240)!==0)){var m=o.lanes;m&=r.pendingLanes,d|=m,o.lanes=d,Dd(r,d)}}function pg(r,o){var d=r.updateQueue,m=r.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var y=null,S=null;if(d=d.firstBaseUpdate,d!==null){do{var A={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};S===null?y=S=A:S=S.next=A,d=d.next}while(d!==null);S===null?y=S=o:S=S.next=o}else y=S=o;d={baseState:m.baseState,firstBaseUpdate:y,lastBaseUpdate:S,shared:m.shared,effects:m.effects},r.updateQueue=d;return}r=d.lastBaseUpdate,r===null?d.firstBaseUpdate=o:r.next=o,d.lastBaseUpdate=o}function xl(r,o,d,m){var y=r.updateQueue;Yr=!1;var S=y.firstBaseUpdate,A=y.lastBaseUpdate,H=y.shared.pending;if(H!==null){y.shared.pending=null;var J=H,oe=J.next;J.next=null,A===null?S=oe:A.next=oe,A=J;var ue=r.alternate;ue!==null&&(ue=ue.updateQueue,H=ue.lastBaseUpdate,H!==A&&(H===null?ue.firstBaseUpdate=oe:H.next=oe,ue.lastBaseUpdate=J))}if(S!==null){var he=y.baseState;A=0,ue=oe=J=null,H=S;do{var de=H.lane,xe=H.eventTime;if((m&de)===de){ue!==null&&(ue=ue.next={eventTime:xe,lane:0,tag:H.tag,payload:H.payload,callback:H.callback,next:null});e:{var Se=r,Ee=H;switch(de=o,xe=d,Ee.tag){case 1:if(Se=Ee.payload,typeof Se=="function"){he=Se.call(xe,he,de);break e}he=Se;break e;case 3:Se.flags=Se.flags&-65537|128;case 0:if(Se=Ee.payload,de=typeof Se=="function"?Se.call(xe,he,de):Se,de==null)break e;he=W({},he,de);break e;case 2:Yr=!0}}H.callback!==null&&H.lane!==0&&(r.flags|=64,de=y.effects,de===null?y.effects=[H]:de.push(H))}else xe={eventTime:xe,lane:de,tag:H.tag,payload:H.payload,callback:H.callback,next:null},ue===null?(oe=ue=xe,J=he):ue=ue.next=xe,A|=de;if(H=H.next,H===null){if(H=y.shared.pending,H===null)break;de=H,H=de.next,de.next=null,y.lastBaseUpdate=de,y.shared.pending=null}}while(!0);if(ue===null&&(J=he),y.baseState=J,y.firstBaseUpdate=oe,y.lastBaseUpdate=ue,o=y.shared.interleaved,o!==null){y=o;do A|=y.lane,y=y.next;while(y!==o)}else S===null&&(y.shared.lanes=0);Ds|=A,r.lanes=A,r.memoizedState=he}}function gg(r,o,d){if(r=o.effects,o.effects=null,r!==null)for(o=0;o<r.length;o++){var m=r[o],y=m.callback;if(y!==null){if(m.callback=null,m=d,typeof y!="function")throw Error(n(191,y));y.call(m)}}}var Pi={},ar=qr(Pi),Ii=qr(Pi),Di=qr(Pi);function Ps(r){if(r===Pi)throw Error(n(174));return r}function bu(r,o){switch(nt(Di,o),nt(Ii,r),nt(ar,Pi),r=o.nodeType,r){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:He(null,"");break;default:r=r===8?o.parentNode:o,o=r.namespaceURI||null,r=r.tagName,o=He(o,r)}ot(ar),nt(ar,o)}function Co(){ot(ar),ot(Ii),ot(Di)}function vg(r){Ps(Di.current);var o=Ps(ar.current),d=He(o,r.type);o!==d&&(nt(Ii,r),nt(ar,d))}function Cu(r){Ii.current===r&&(ot(ar),ot(Ii))}var ct=qr(0);function bl(r){for(var o=r;o!==null;){if(o.tag===13){var d=o.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Su=[];function Eu(){for(var r=0;r<Su.length;r++)Su[r]._workInProgressVersionPrimary=null;Su.length=0}var Cl=j.ReactCurrentDispatcher,_u=j.ReactCurrentBatchConfig,Is=0,dt=null,St=null,Nt=null,Sl=!1,Oi=!1,Li=0,_1=0;function Ft(){throw Error(n(321))}function Nu(r,o){if(o===null)return!1;for(var d=0;d<o.length&&d<r.length;d++)if(!Mn(r[d],o[d]))return!1;return!0}function ku(r,o,d,m,y,S){if(Is=S,dt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Cl.current=r===null||r.memoizedState===null?T1:A1,r=d(m,y),Oi){S=0;do{if(Oi=!1,Li=0,25<=S)throw Error(n(301));S+=1,Nt=St=null,o.updateQueue=null,Cl.current=R1,r=d(m,y)}while(Oi)}if(Cl.current=Nl,o=St!==null&&St.next!==null,Is=0,Nt=St=dt=null,Sl=!1,o)throw Error(n(300));return r}function ju(){var r=Li!==0;return Li=0,r}function lr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nt===null?dt.memoizedState=Nt=r:Nt=Nt.next=r,Nt}function xn(){if(St===null){var r=dt.alternate;r=r!==null?r.memoizedState:null}else r=St.next;var o=Nt===null?dt.memoizedState:Nt.next;if(o!==null)Nt=o,St=r;else{if(r===null)throw Error(n(310));St=r,r={memoizedState:St.memoizedState,baseState:St.baseState,baseQueue:St.baseQueue,queue:St.queue,next:null},Nt===null?dt.memoizedState=Nt=r:Nt=Nt.next=r}return Nt}function Mi(r,o){return typeof o=="function"?o(r):o}function Tu(r){var o=xn(),d=o.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=r;var m=St,y=m.baseQueue,S=d.pending;if(S!==null){if(y!==null){var A=y.next;y.next=S.next,S.next=A}m.baseQueue=y=S,d.pending=null}if(y!==null){S=y.next,m=m.baseState;var H=A=null,J=null,oe=S;do{var ue=oe.lane;if((Is&ue)===ue)J!==null&&(J=J.next={lane:0,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),m=oe.hasEagerState?oe.eagerState:r(m,oe.action);else{var he={lane:ue,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null};J===null?(H=J=he,A=m):J=J.next=he,dt.lanes|=ue,Ds|=ue}oe=oe.next}while(oe!==null&&oe!==S);J===null?A=m:J.next=H,Mn(m,o.memoizedState)||(tn=!0),o.memoizedState=m,o.baseState=A,o.baseQueue=J,d.lastRenderedState=m}if(r=d.interleaved,r!==null){y=r;do S=y.lane,dt.lanes|=S,Ds|=S,y=y.next;while(y!==r)}else y===null&&(d.lanes=0);return[o.memoizedState,d.dispatch]}function Au(r){var o=xn(),d=o.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=r;var m=d.dispatch,y=d.pending,S=o.memoizedState;if(y!==null){d.pending=null;var A=y=y.next;do S=r(S,A.action),A=A.next;while(A!==y);Mn(S,o.memoizedState)||(tn=!0),o.memoizedState=S,o.baseQueue===null&&(o.baseState=S),d.lastRenderedState=S}return[S,m]}function yg(){}function wg(r,o){var d=dt,m=xn(),y=o(),S=!Mn(m.memoizedState,y);if(S&&(m.memoizedState=y,tn=!0),m=m.queue,Ru(Cg.bind(null,d,m,r),[r]),m.getSnapshot!==o||S||Nt!==null&&Nt.memoizedState.tag&1){if(d.flags|=2048,$i(9,bg.bind(null,d,m,y,o),void 0,null),kt===null)throw Error(n(349));(Is&30)!==0||xg(d,o,y)}return y}function xg(r,o,d){r.flags|=16384,r={getSnapshot:o,value:d},o=dt.updateQueue,o===null?(o={lastEffect:null,stores:null},dt.updateQueue=o,o.stores=[r]):(d=o.stores,d===null?o.stores=[r]:d.push(r))}function bg(r,o,d,m){o.value=d,o.getSnapshot=m,Sg(o)&&Eg(r)}function Cg(r,o,d){return d(function(){Sg(o)&&Eg(r)})}function Sg(r){var o=r.getSnapshot;r=r.value;try{var d=o();return!Mn(r,d)}catch{return!0}}function Eg(r){var o=Er(r,1);o!==null&&zn(o,r,1,-1)}function _g(r){var o=lr();return typeof r=="function"&&(r=r()),o.memoizedState=o.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mi,lastRenderedState:r},o.queue=r,r=r.dispatch=j1.bind(null,dt,r),[o.memoizedState,r]}function $i(r,o,d,m){return r={tag:r,create:o,destroy:d,deps:m,next:null},o=dt.updateQueue,o===null?(o={lastEffect:null,stores:null},dt.updateQueue=o,o.lastEffect=r.next=r):(d=o.lastEffect,d===null?o.lastEffect=r.next=r:(m=d.next,d.next=r,r.next=m,o.lastEffect=r)),r}function Ng(){return xn().memoizedState}function El(r,o,d,m){var y=lr();dt.flags|=r,y.memoizedState=$i(1|o,d,void 0,m===void 0?null:m)}function _l(r,o,d,m){var y=xn();m=m===void 0?null:m;var S=void 0;if(St!==null){var A=St.memoizedState;if(S=A.destroy,m!==null&&Nu(m,A.deps)){y.memoizedState=$i(o,d,S,m);return}}dt.flags|=r,y.memoizedState=$i(1|o,d,S,m)}function kg(r,o){return El(8390656,8,r,o)}function Ru(r,o){return _l(2048,8,r,o)}function jg(r,o){return _l(4,2,r,o)}function Tg(r,o){return _l(4,4,r,o)}function Ag(r,o){if(typeof o=="function")return r=r(),o(r),function(){o(null)};if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function Rg(r,o,d){return d=d!=null?d.concat([r]):null,_l(4,4,Ag.bind(null,o,r),d)}function Pu(){}function Pg(r,o){var d=xn();o=o===void 0?null:o;var m=d.memoizedState;return m!==null&&o!==null&&Nu(o,m[1])?m[0]:(d.memoizedState=[r,o],r)}function Ig(r,o){var d=xn();o=o===void 0?null:o;var m=d.memoizedState;return m!==null&&o!==null&&Nu(o,m[1])?m[0]:(r=r(),d.memoizedState=[r,o],r)}function Dg(r,o,d){return(Is&21)===0?(r.baseState&&(r.baseState=!1,tn=!0),r.memoizedState=d):(Mn(d,o)||(d=dp(),dt.lanes|=d,Ds|=d,r.baseState=!0),o)}function N1(r,o){var d=Xe;Xe=d!==0&&4>d?d:4,r(!0);var m=_u.transition;_u.transition={};try{r(!1),o()}finally{Xe=d,_u.transition=m}}function Og(){return xn().memoizedState}function k1(r,o,d){var m=es(r);if(d={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null},Lg(r))Mg(o,d);else if(d=hg(r,o,d,m),d!==null){var y=Wt();zn(d,r,m,y),$g(d,o,m)}}function j1(r,o,d){var m=es(r),y={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null};if(Lg(r))Mg(o,y);else{var S=r.alternate;if(r.lanes===0&&(S===null||S.lanes===0)&&(S=o.lastRenderedReducer,S!==null))try{var A=o.lastRenderedState,H=S(A,d);if(y.hasEagerState=!0,y.eagerState=H,Mn(H,A)){var J=o.interleaved;J===null?(y.next=y,wu(o)):(y.next=J.next,J.next=y),o.interleaved=y;return}}catch{}finally{}d=hg(r,o,y,m),d!==null&&(y=Wt(),zn(d,r,m,y),$g(d,o,m))}}function Lg(r){var o=r.alternate;return r===dt||o!==null&&o===dt}function Mg(r,o){Oi=Sl=!0;var d=r.pending;d===null?o.next=o:(o.next=d.next,d.next=o),r.pending=o}function $g(r,o,d){if((d&4194240)!==0){var m=o.lanes;m&=r.pendingLanes,d|=m,o.lanes=d,Dd(r,d)}}var Nl={readContext:wn,useCallback:Ft,useContext:Ft,useEffect:Ft,useImperativeHandle:Ft,useInsertionEffect:Ft,useLayoutEffect:Ft,useMemo:Ft,useReducer:Ft,useRef:Ft,useState:Ft,useDebugValue:Ft,useDeferredValue:Ft,useTransition:Ft,useMutableSource:Ft,useSyncExternalStore:Ft,useId:Ft,unstable_isNewReconciler:!1},T1={readContext:wn,useCallback:function(r,o){return lr().memoizedState=[r,o===void 0?null:o],r},useContext:wn,useEffect:kg,useImperativeHandle:function(r,o,d){return d=d!=null?d.concat([r]):null,El(4194308,4,Ag.bind(null,o,r),d)},useLayoutEffect:function(r,o){return El(4194308,4,r,o)},useInsertionEffect:function(r,o){return El(4,2,r,o)},useMemo:function(r,o){var d=lr();return o=o===void 0?null:o,r=r(),d.memoizedState=[r,o],r},useReducer:function(r,o,d){var m=lr();return o=d!==void 0?d(o):o,m.memoizedState=m.baseState=o,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:o},m.queue=r,r=r.dispatch=k1.bind(null,dt,r),[m.memoizedState,r]},useRef:function(r){var o=lr();return r={current:r},o.memoizedState=r},useState:_g,useDebugValue:Pu,useDeferredValue:function(r){return lr().memoizedState=r},useTransition:function(){var r=_g(!1),o=r[0];return r=N1.bind(null,r[1]),lr().memoizedState=r,[o,r]},useMutableSource:function(){},useSyncExternalStore:function(r,o,d){var m=dt,y=lr();if(lt){if(d===void 0)throw Error(n(407));d=d()}else{if(d=o(),kt===null)throw Error(n(349));(Is&30)!==0||xg(m,o,d)}y.memoizedState=d;var S={value:d,getSnapshot:o};return y.queue=S,kg(Cg.bind(null,m,S,r),[r]),m.flags|=2048,$i(9,bg.bind(null,m,S,d,o),void 0,null),d},useId:function(){var r=lr(),o=kt.identifierPrefix;if(lt){var d=Sr,m=Cr;d=(m&~(1<<32-Ln(m)-1)).toString(32)+d,o=":"+o+"R"+d,d=Li++,0<d&&(o+="H"+d.toString(32)),o+=":"}else d=_1++,o=":"+o+"r"+d.toString(32)+":";return r.memoizedState=o},unstable_isNewReconciler:!1},A1={readContext:wn,useCallback:Pg,useContext:wn,useEffect:Ru,useImperativeHandle:Rg,useInsertionEffect:jg,useLayoutEffect:Tg,useMemo:Ig,useReducer:Tu,useRef:Ng,useState:function(){return Tu(Mi)},useDebugValue:Pu,useDeferredValue:function(r){var o=xn();return Dg(o,St.memoizedState,r)},useTransition:function(){var r=Tu(Mi)[0],o=xn().memoizedState;return[r,o]},useMutableSource:yg,useSyncExternalStore:wg,useId:Og,unstable_isNewReconciler:!1},R1={readContext:wn,useCallback:Pg,useContext:wn,useEffect:Ru,useImperativeHandle:Rg,useInsertionEffect:jg,useLayoutEffect:Tg,useMemo:Ig,useReducer:Au,useRef:Ng,useState:function(){return Au(Mi)},useDebugValue:Pu,useDeferredValue:function(r){var o=xn();return St===null?o.memoizedState=r:Dg(o,St.memoizedState,r)},useTransition:function(){var r=Au(Mi)[0],o=xn().memoizedState;return[r,o]},useMutableSource:yg,useSyncExternalStore:wg,useId:Og,unstable_isNewReconciler:!1};function Fn(r,o){if(r&&r.defaultProps){o=W({},o),r=r.defaultProps;for(var d in r)o[d]===void 0&&(o[d]=r[d]);return o}return o}function Iu(r,o,d,m){o=r.memoizedState,d=d(m,o),d=d==null?o:W({},o,d),r.memoizedState=d,r.lanes===0&&(r.updateQueue.baseState=d)}var kl={isMounted:function(r){return(r=r._reactInternals)?Ns(r)===r:!1},enqueueSetState:function(r,o,d){r=r._reactInternals;var m=Wt(),y=es(r),S=_r(m,y);S.payload=o,d!=null&&(S.callback=d),o=Jr(r,S,y),o!==null&&(zn(o,r,y,m),wl(o,r,y))},enqueueReplaceState:function(r,o,d){r=r._reactInternals;var m=Wt(),y=es(r),S=_r(m,y);S.tag=1,S.payload=o,d!=null&&(S.callback=d),o=Jr(r,S,y),o!==null&&(zn(o,r,y,m),wl(o,r,y))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var d=Wt(),m=es(r),y=_r(d,m);y.tag=2,o!=null&&(y.callback=o),o=Jr(r,y,m),o!==null&&(zn(o,r,m,d),wl(o,r,m))}};function Fg(r,o,d,m,y,S,A){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(m,S,A):o.prototype&&o.prototype.isPureReactComponent?!Ei(d,m)||!Ei(y,S):!0}function Ug(r,o,d){var m=!1,y=Gr,S=o.contextType;return typeof S=="object"&&S!==null?S=wn(S):(y=en(o)?js:$t.current,m=o.contextTypes,S=(m=m!=null)?po(r,y):Gr),o=new o(d,S),r.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=kl,r.stateNode=o,o._reactInternals=r,m&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=y,r.__reactInternalMemoizedMaskedChildContext=S),o}function Bg(r,o,d,m){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(d,m),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(d,m),o.state!==r&&kl.enqueueReplaceState(o,o.state,null)}function Du(r,o,d,m){var y=r.stateNode;y.props=d,y.state=r.memoizedState,y.refs={},xu(r);var S=o.contextType;typeof S=="object"&&S!==null?y.context=wn(S):(S=en(o)?js:$t.current,y.context=po(r,S)),y.state=r.memoizedState,S=o.getDerivedStateFromProps,typeof S=="function"&&(Iu(r,o,S,d),y.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(o=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),o!==y.state&&kl.enqueueReplaceState(y,y.state,null),xl(r,d,y,m),y.state=r.memoizedState),typeof y.componentDidMount=="function"&&(r.flags|=4194308)}function So(r,o){try{var d="",m=o;do d+=K(m),m=m.return;while(m);var y=d}catch(S){y=`
Error generating stack: `+S.message+`
`+S.stack}return{value:r,source:o,stack:y,digest:null}}function Ou(r,o,d){return{value:r,source:null,stack:d??null,digest:o??null}}function Lu(r,o){try{console.error(o.value)}catch(d){setTimeout(function(){throw d})}}var P1=typeof WeakMap=="function"?WeakMap:Map;function zg(r,o,d){d=_r(-1,d),d.tag=3,d.payload={element:null};var m=o.value;return d.callback=function(){Dl||(Dl=!0,Qu=m),Lu(r,o)},d}function Vg(r,o,d){d=_r(-1,d),d.tag=3;var m=r.type.getDerivedStateFromError;if(typeof m=="function"){var y=o.value;d.payload=function(){return m(y)},d.callback=function(){Lu(r,o)}}var S=r.stateNode;return S!==null&&typeof S.componentDidCatch=="function"&&(d.callback=function(){Lu(r,o),typeof m!="function"&&(Xr===null?Xr=new Set([this]):Xr.add(this));var A=o.stack;this.componentDidCatch(o.value,{componentStack:A!==null?A:""})}),d}function Hg(r,o,d){var m=r.pingCache;if(m===null){m=r.pingCache=new P1;var y=new Set;m.set(o,y)}else y=m.get(o),y===void 0&&(y=new Set,m.set(o,y));y.has(d)||(y.add(d),r=q1.bind(null,r,o,d),o.then(r,r))}function Wg(r){do{var o;if((o=r.tag===13)&&(o=r.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return r;r=r.return}while(r!==null);return null}function qg(r,o,d,m,y){return(r.mode&1)===0?(r===o?r.flags|=65536:(r.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(o=_r(-1,1),o.tag=2,Jr(d,o,1))),d.lanes|=1),r):(r.flags|=65536,r.lanes=y,r)}var I1=j.ReactCurrentOwner,tn=!1;function Ht(r,o,d,m){o.child=r===null?fg(o,null,d,m):wo(o,r.child,d,m)}function Gg(r,o,d,m,y){d=d.render;var S=o.ref;return bo(o,y),m=ku(r,o,d,m,S,y),d=ju(),r!==null&&!tn?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~y,Nr(r,o,y)):(lt&&d&&du(o),o.flags|=1,Ht(r,o,m,y),o.child)}function Kg(r,o,d,m,y){if(r===null){var S=d.type;return typeof S=="function"&&!sf(S)&&S.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(o.tag=15,o.type=S,Yg(r,o,S,m,y)):(r=Ul(d.type,null,m,o,o.mode,y),r.ref=o.ref,r.return=o,o.child=r)}if(S=r.child,(r.lanes&y)===0){var A=S.memoizedProps;if(d=d.compare,d=d!==null?d:Ei,d(A,m)&&r.ref===o.ref)return Nr(r,o,y)}return o.flags|=1,r=ns(S,m),r.ref=o.ref,r.return=o,o.child=r}function Yg(r,o,d,m,y){if(r!==null){var S=r.memoizedProps;if(Ei(S,m)&&r.ref===o.ref)if(tn=!1,o.pendingProps=m=S,(r.lanes&y)!==0)(r.flags&131072)!==0&&(tn=!0);else return o.lanes=r.lanes,Nr(r,o,y)}return Mu(r,o,d,m,y)}function Jg(r,o,d){var m=o.pendingProps,y=m.children,S=r!==null?r.memoizedState:null;if(m.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},nt(_o,un),un|=d;else{if((d&1073741824)===0)return r=S!==null?S.baseLanes|d:d,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:r,cachePool:null,transitions:null},o.updateQueue=null,nt(_o,un),un|=r,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=S!==null?S.baseLanes:d,nt(_o,un),un|=m}else S!==null?(m=S.baseLanes|d,o.memoizedState=null):m=d,nt(_o,un),un|=m;return Ht(r,o,y,d),o.child}function Qg(r,o){var d=o.ref;(r===null&&d!==null||r!==null&&r.ref!==d)&&(o.flags|=512,o.flags|=2097152)}function Mu(r,o,d,m,y){var S=en(d)?js:$t.current;return S=po(o,S),bo(o,y),d=ku(r,o,d,m,S,y),m=ju(),r!==null&&!tn?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~y,Nr(r,o,y)):(lt&&m&&du(o),o.flags|=1,Ht(r,o,d,y),o.child)}function Xg(r,o,d,m,y){if(en(d)){var S=!0;ul(o)}else S=!1;if(bo(o,y),o.stateNode===null)Tl(r,o),Ug(o,d,m),Du(o,d,m,y),m=!0;else if(r===null){var A=o.stateNode,H=o.memoizedProps;A.props=H;var J=A.context,oe=d.contextType;typeof oe=="object"&&oe!==null?oe=wn(oe):(oe=en(d)?js:$t.current,oe=po(o,oe));var ue=d.getDerivedStateFromProps,he=typeof ue=="function"||typeof A.getSnapshotBeforeUpdate=="function";he||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(H!==m||J!==oe)&&Bg(o,A,m,oe),Yr=!1;var de=o.memoizedState;A.state=de,xl(o,m,A,y),J=o.memoizedState,H!==m||de!==J||Zt.current||Yr?(typeof ue=="function"&&(Iu(o,d,ue,m),J=o.memoizedState),(H=Yr||Fg(o,d,H,m,de,J,oe))?(he||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(o.flags|=4194308)):(typeof A.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=m,o.memoizedState=J),A.props=m,A.state=J,A.context=oe,m=H):(typeof A.componentDidMount=="function"&&(o.flags|=4194308),m=!1)}else{A=o.stateNode,mg(r,o),H=o.memoizedProps,oe=o.type===o.elementType?H:Fn(o.type,H),A.props=oe,he=o.pendingProps,de=A.context,J=d.contextType,typeof J=="object"&&J!==null?J=wn(J):(J=en(d)?js:$t.current,J=po(o,J));var xe=d.getDerivedStateFromProps;(ue=typeof xe=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(H!==he||de!==J)&&Bg(o,A,m,J),Yr=!1,de=o.memoizedState,A.state=de,xl(o,m,A,y);var Se=o.memoizedState;H!==he||de!==Se||Zt.current||Yr?(typeof xe=="function"&&(Iu(o,d,xe,m),Se=o.memoizedState),(oe=Yr||Fg(o,d,oe,m,de,Se,J)||!1)?(ue||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(m,Se,J),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(m,Se,J)),typeof A.componentDidUpdate=="function"&&(o.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof A.componentDidUpdate!="function"||H===r.memoizedProps&&de===r.memoizedState||(o.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||H===r.memoizedProps&&de===r.memoizedState||(o.flags|=1024),o.memoizedProps=m,o.memoizedState=Se),A.props=m,A.state=Se,A.context=J,m=oe):(typeof A.componentDidUpdate!="function"||H===r.memoizedProps&&de===r.memoizedState||(o.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||H===r.memoizedProps&&de===r.memoizedState||(o.flags|=1024),m=!1)}return $u(r,o,d,m,S,y)}function $u(r,o,d,m,y,S){Qg(r,o);var A=(o.flags&128)!==0;if(!m&&!A)return y&&rg(o,d,!1),Nr(r,o,S);m=o.stateNode,I1.current=o;var H=A&&typeof d.getDerivedStateFromError!="function"?null:m.render();return o.flags|=1,r!==null&&A?(o.child=wo(o,r.child,null,S),o.child=wo(o,null,H,S)):Ht(r,o,H,S),o.memoizedState=m.state,y&&rg(o,d,!0),o.child}function Zg(r){var o=r.stateNode;o.pendingContext?tg(r,o.pendingContext,o.pendingContext!==o.context):o.context&&tg(r,o.context,!1),bu(r,o.containerInfo)}function ev(r,o,d,m,y){return yo(),mu(y),o.flags|=256,Ht(r,o,d,m),o.child}var Fu={dehydrated:null,treeContext:null,retryLane:0};function Uu(r){return{baseLanes:r,cachePool:null,transitions:null}}function tv(r,o,d){var m=o.pendingProps,y=ct.current,S=!1,A=(o.flags&128)!==0,H;if((H=A)||(H=r!==null&&r.memoizedState===null?!1:(y&2)!==0),H?(S=!0,o.flags&=-129):(r===null||r.memoizedState!==null)&&(y|=1),nt(ct,y&1),r===null)return hu(o),r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((o.mode&1)===0?o.lanes=1:r.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(A=m.children,r=m.fallback,S?(m=o.mode,S=o.child,A={mode:"hidden",children:A},(m&1)===0&&S!==null?(S.childLanes=0,S.pendingProps=A):S=Bl(A,m,0,null),r=$s(r,m,d,null),S.return=o,r.return=o,S.sibling=r,o.child=S,o.child.memoizedState=Uu(d),o.memoizedState=Fu,r):Bu(o,A));if(y=r.memoizedState,y!==null&&(H=y.dehydrated,H!==null))return D1(r,o,A,m,H,y,d);if(S){S=m.fallback,A=o.mode,y=r.child,H=y.sibling;var J={mode:"hidden",children:m.children};return(A&1)===0&&o.child!==y?(m=o.child,m.childLanes=0,m.pendingProps=J,o.deletions=null):(m=ns(y,J),m.subtreeFlags=y.subtreeFlags&14680064),H!==null?S=ns(H,S):(S=$s(S,A,d,null),S.flags|=2),S.return=o,m.return=o,m.sibling=S,o.child=m,m=S,S=o.child,A=r.child.memoizedState,A=A===null?Uu(d):{baseLanes:A.baseLanes|d,cachePool:null,transitions:A.transitions},S.memoizedState=A,S.childLanes=r.childLanes&~d,o.memoizedState=Fu,m}return S=r.child,r=S.sibling,m=ns(S,{mode:"visible",children:m.children}),(o.mode&1)===0&&(m.lanes=d),m.return=o,m.sibling=null,r!==null&&(d=o.deletions,d===null?(o.deletions=[r],o.flags|=16):d.push(r)),o.child=m,o.memoizedState=null,m}function Bu(r,o){return o=Bl({mode:"visible",children:o},r.mode,0,null),o.return=r,r.child=o}function jl(r,o,d,m){return m!==null&&mu(m),wo(o,r.child,null,d),r=Bu(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function D1(r,o,d,m,y,S,A){if(d)return o.flags&256?(o.flags&=-257,m=Ou(Error(n(422))),jl(r,o,A,m)):o.memoizedState!==null?(o.child=r.child,o.flags|=128,null):(S=m.fallback,y=o.mode,m=Bl({mode:"visible",children:m.children},y,0,null),S=$s(S,y,A,null),S.flags|=2,m.return=o,S.return=o,m.sibling=S,o.child=m,(o.mode&1)!==0&&wo(o,r.child,null,A),o.child.memoizedState=Uu(A),o.memoizedState=Fu,S);if((o.mode&1)===0)return jl(r,o,A,null);if(y.data==="$!"){if(m=y.nextSibling&&y.nextSibling.dataset,m)var H=m.dgst;return m=H,S=Error(n(419)),m=Ou(S,m,void 0),jl(r,o,A,m)}if(H=(A&r.childLanes)!==0,tn||H){if(m=kt,m!==null){switch(A&-A){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(m.suspendedLanes|A))!==0?0:y,y!==0&&y!==S.retryLane&&(S.retryLane=y,Er(r,y),zn(m,r,y,-1))}return rf(),m=Ou(Error(n(421))),jl(r,o,A,m)}return y.data==="$?"?(o.flags|=128,o.child=r.child,o=G1.bind(null,r),y._reactRetry=o,null):(r=S.treeContext,dn=Wr(y.nextSibling),cn=o,lt=!0,$n=null,r!==null&&(vn[yn++]=Cr,vn[yn++]=Sr,vn[yn++]=Ts,Cr=r.id,Sr=r.overflow,Ts=o),o=Bu(o,m.children),o.flags|=4096,o)}function nv(r,o,d){r.lanes|=o;var m=r.alternate;m!==null&&(m.lanes|=o),yu(r.return,o,d)}function zu(r,o,d,m,y){var S=r.memoizedState;S===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:y}:(S.isBackwards=o,S.rendering=null,S.renderingStartTime=0,S.last=m,S.tail=d,S.tailMode=y)}function rv(r,o,d){var m=o.pendingProps,y=m.revealOrder,S=m.tail;if(Ht(r,o,m.children,d),m=ct.current,(m&2)!==0)m=m&1|2,o.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&nv(r,d,o);else if(r.tag===19)nv(r,d,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}m&=1}if(nt(ct,m),(o.mode&1)===0)o.memoizedState=null;else switch(y){case"forwards":for(d=o.child,y=null;d!==null;)r=d.alternate,r!==null&&bl(r)===null&&(y=d),d=d.sibling;d=y,d===null?(y=o.child,o.child=null):(y=d.sibling,d.sibling=null),zu(o,!1,y,d,S);break;case"backwards":for(d=null,y=o.child,o.child=null;y!==null;){if(r=y.alternate,r!==null&&bl(r)===null){o.child=y;break}r=y.sibling,y.sibling=d,d=y,y=r}zu(o,!0,d,null,S);break;case"together":zu(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Tl(r,o){(o.mode&1)===0&&r!==null&&(r.alternate=null,o.alternate=null,o.flags|=2)}function Nr(r,o,d){if(r!==null&&(o.dependencies=r.dependencies),Ds|=o.lanes,(d&o.childLanes)===0)return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,d=ns(r,r.pendingProps),o.child=d,d.return=o;r.sibling!==null;)r=r.sibling,d=d.sibling=ns(r,r.pendingProps),d.return=o;d.sibling=null}return o.child}function O1(r,o,d){switch(o.tag){case 3:Zg(o),yo();break;case 5:vg(o);break;case 1:en(o.type)&&ul(o);break;case 4:bu(o,o.stateNode.containerInfo);break;case 10:var m=o.type._context,y=o.memoizedProps.value;nt(vl,m._currentValue),m._currentValue=y;break;case 13:if(m=o.memoizedState,m!==null)return m.dehydrated!==null?(nt(ct,ct.current&1),o.flags|=128,null):(d&o.child.childLanes)!==0?tv(r,o,d):(nt(ct,ct.current&1),r=Nr(r,o,d),r!==null?r.sibling:null);nt(ct,ct.current&1);break;case 19:if(m=(d&o.childLanes)!==0,(r.flags&128)!==0){if(m)return rv(r,o,d);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),nt(ct,ct.current),m)break;return null;case 22:case 23:return o.lanes=0,Jg(r,o,d)}return Nr(r,o,d)}var sv,Vu,ov,iv;sv=function(r,o){for(var d=o.child;d!==null;){if(d.tag===5||d.tag===6)r.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===o)break;for(;d.sibling===null;){if(d.return===null||d.return===o)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},Vu=function(){},ov=function(r,o,d,m){var y=r.memoizedProps;if(y!==m){r=o.stateNode,Ps(ar.current);var S=null;switch(d){case"input":y=We(r,y),m=We(r,m),S=[];break;case"select":y=W({},y,{value:void 0}),m=W({},m,{value:void 0}),S=[];break;case"textarea":y=ft(r,y),m=ft(r,m),S=[];break;default:typeof y.onClick!="function"&&typeof m.onClick=="function"&&(r.onclick=ll)}nr(d,m);var A;d=null;for(oe in y)if(!m.hasOwnProperty(oe)&&y.hasOwnProperty(oe)&&y[oe]!=null)if(oe==="style"){var H=y[oe];for(A in H)H.hasOwnProperty(A)&&(d||(d={}),d[A]="")}else oe!=="dangerouslySetInnerHTML"&&oe!=="children"&&oe!=="suppressContentEditableWarning"&&oe!=="suppressHydrationWarning"&&oe!=="autoFocus"&&(i.hasOwnProperty(oe)?S||(S=[]):(S=S||[]).push(oe,null));for(oe in m){var J=m[oe];if(H=y?.[oe],m.hasOwnProperty(oe)&&J!==H&&(J!=null||H!=null))if(oe==="style")if(H){for(A in H)!H.hasOwnProperty(A)||J&&J.hasOwnProperty(A)||(d||(d={}),d[A]="");for(A in J)J.hasOwnProperty(A)&&H[A]!==J[A]&&(d||(d={}),d[A]=J[A])}else d||(S||(S=[]),S.push(oe,d)),d=J;else oe==="dangerouslySetInnerHTML"?(J=J?J.__html:void 0,H=H?H.__html:void 0,J!=null&&H!==J&&(S=S||[]).push(oe,J)):oe==="children"?typeof J!="string"&&typeof J!="number"||(S=S||[]).push(oe,""+J):oe!=="suppressContentEditableWarning"&&oe!=="suppressHydrationWarning"&&(i.hasOwnProperty(oe)?(J!=null&&oe==="onScroll"&&st("scroll",r),S||H===J||(S=[])):(S=S||[]).push(oe,J))}d&&(S=S||[]).push("style",d);var oe=S;(o.updateQueue=oe)&&(o.flags|=4)}},iv=function(r,o,d,m){d!==m&&(o.flags|=4)};function Fi(r,o){if(!lt)switch(r.tailMode){case"hidden":o=r.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?r.tail=null:d.sibling=null;break;case"collapsed":d=r.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:m.sibling=null}}function Ut(r){var o=r.alternate!==null&&r.alternate.child===r.child,d=0,m=0;if(o)for(var y=r.child;y!==null;)d|=y.lanes|y.childLanes,m|=y.subtreeFlags&14680064,m|=y.flags&14680064,y.return=r,y=y.sibling;else for(y=r.child;y!==null;)d|=y.lanes|y.childLanes,m|=y.subtreeFlags,m|=y.flags,y.return=r,y=y.sibling;return r.subtreeFlags|=m,r.childLanes=d,o}function L1(r,o,d){var m=o.pendingProps;switch(uu(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ut(o),null;case 1:return en(o.type)&&dl(),Ut(o),null;case 3:return m=o.stateNode,Co(),ot(Zt),ot($t),Eu(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(r===null||r.child===null)&&(pl(o)?o.flags|=4:r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,$n!==null&&(ef($n),$n=null))),Vu(r,o),Ut(o),null;case 5:Cu(o);var y=Ps(Di.current);if(d=o.type,r!==null&&o.stateNode!=null)ov(r,o,d,m,y),r.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!m){if(o.stateNode===null)throw Error(n(166));return Ut(o),null}if(r=Ps(ar.current),pl(o)){m=o.stateNode,d=o.type;var S=o.memoizedProps;switch(m[ir]=o,m[Ti]=S,r=(o.mode&1)!==0,d){case"dialog":st("cancel",m),st("close",m);break;case"iframe":case"object":case"embed":st("load",m);break;case"video":case"audio":for(y=0;y<Ni.length;y++)st(Ni[y],m);break;case"source":st("error",m);break;case"img":case"image":case"link":st("error",m),st("load",m);break;case"details":st("toggle",m);break;case"input":Ge(m,S),st("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!S.multiple},st("invalid",m);break;case"textarea":Je(m,S),st("invalid",m)}nr(d,S),y=null;for(var A in S)if(S.hasOwnProperty(A)){var H=S[A];A==="children"?typeof H=="string"?m.textContent!==H&&(S.suppressHydrationWarning!==!0&&al(m.textContent,H,r),y=["children",H]):typeof H=="number"&&m.textContent!==""+H&&(S.suppressHydrationWarning!==!0&&al(m.textContent,H,r),y=["children",""+H]):i.hasOwnProperty(A)&&H!=null&&A==="onScroll"&&st("scroll",m)}switch(d){case"input":we(m),ae(m,S,!0);break;case"textarea":we(m),at(m);break;case"select":case"option":break;default:typeof S.onClick=="function"&&(m.onclick=ll)}m=y,o.updateQueue=m,m!==null&&(o.flags|=4)}else{A=y.nodeType===9?y:y.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=ht(d)),r==="http://www.w3.org/1999/xhtml"?d==="script"?(r=A.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof m.is=="string"?r=A.createElement(d,{is:m.is}):(r=A.createElement(d),d==="select"&&(A=r,m.multiple?A.multiple=!0:m.size&&(A.size=m.size))):r=A.createElementNS(r,d),r[ir]=o,r[Ti]=m,sv(r,o,!1,!1),o.stateNode=r;e:{switch(A=ci(d,m),d){case"dialog":st("cancel",r),st("close",r),y=m;break;case"iframe":case"object":case"embed":st("load",r),y=m;break;case"video":case"audio":for(y=0;y<Ni.length;y++)st(Ni[y],r);y=m;break;case"source":st("error",r),y=m;break;case"img":case"image":case"link":st("error",r),st("load",r),y=m;break;case"details":st("toggle",r),y=m;break;case"input":Ge(r,m),y=We(r,m),st("invalid",r);break;case"option":y=m;break;case"select":r._wrapperState={wasMultiple:!!m.multiple},y=W({},m,{value:void 0}),st("invalid",r);break;case"textarea":Je(r,m),y=ft(r,m),st("invalid",r);break;default:y=m}nr(d,y),H=y;for(S in H)if(H.hasOwnProperty(S)){var J=H[S];S==="style"?wr(r,J):S==="dangerouslySetInnerHTML"?(J=J?J.__html:void 0,J!=null&&Mt(r,J)):S==="children"?typeof J=="string"?(d!=="textarea"||J!=="")&&Tt(r,J):typeof J=="number"&&Tt(r,""+J):S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&S!=="autoFocus"&&(i.hasOwnProperty(S)?J!=null&&S==="onScroll"&&st("scroll",r):J!=null&&N(r,S,J,A))}switch(d){case"input":we(r),ae(r,m,!1);break;case"textarea":we(r),at(r);break;case"option":m.value!=null&&r.setAttribute("value",""+se(m.value));break;case"select":r.multiple=!!m.multiple,S=m.value,S!=null?Ue(r,!!m.multiple,S,!1):m.defaultValue!=null&&Ue(r,!!m.multiple,m.defaultValue,!0);break;default:typeof y.onClick=="function"&&(r.onclick=ll)}switch(d){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Ut(o),null;case 6:if(r&&o.stateNode!=null)iv(r,o,r.memoizedProps,m);else{if(typeof m!="string"&&o.stateNode===null)throw Error(n(166));if(d=Ps(Di.current),Ps(ar.current),pl(o)){if(m=o.stateNode,d=o.memoizedProps,m[ir]=o,(S=m.nodeValue!==d)&&(r=cn,r!==null))switch(r.tag){case 3:al(m.nodeValue,d,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&al(m.nodeValue,d,(r.mode&1)!==0)}S&&(o.flags|=4)}else m=(d.nodeType===9?d:d.ownerDocument).createTextNode(m),m[ir]=o,o.stateNode=m}return Ut(o),null;case 13:if(ot(ct),m=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(lt&&dn!==null&&(o.mode&1)!==0&&(o.flags&128)===0)cg(),yo(),o.flags|=98560,S=!1;else if(S=pl(o),m!==null&&m.dehydrated!==null){if(r===null){if(!S)throw Error(n(318));if(S=o.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(n(317));S[ir]=o}else yo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Ut(o),S=!1}else $n!==null&&(ef($n),$n=null),S=!0;if(!S)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=d,o):(m=m!==null,m!==(r!==null&&r.memoizedState!==null)&&m&&(o.child.flags|=8192,(o.mode&1)!==0&&(r===null||(ct.current&1)!==0?Et===0&&(Et=3):rf())),o.updateQueue!==null&&(o.flags|=4),Ut(o),null);case 4:return Co(),Vu(r,o),r===null&&ki(o.stateNode.containerInfo),Ut(o),null;case 10:return vu(o.type._context),Ut(o),null;case 17:return en(o.type)&&dl(),Ut(o),null;case 19:if(ot(ct),S=o.memoizedState,S===null)return Ut(o),null;if(m=(o.flags&128)!==0,A=S.rendering,A===null)if(m)Fi(S,!1);else{if(Et!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(A=bl(r),A!==null){for(o.flags|=128,Fi(S,!1),m=A.updateQueue,m!==null&&(o.updateQueue=m,o.flags|=4),o.subtreeFlags=0,m=d,d=o.child;d!==null;)S=d,r=m,S.flags&=14680066,A=S.alternate,A===null?(S.childLanes=0,S.lanes=r,S.child=null,S.subtreeFlags=0,S.memoizedProps=null,S.memoizedState=null,S.updateQueue=null,S.dependencies=null,S.stateNode=null):(S.childLanes=A.childLanes,S.lanes=A.lanes,S.child=A.child,S.subtreeFlags=0,S.deletions=null,S.memoizedProps=A.memoizedProps,S.memoizedState=A.memoizedState,S.updateQueue=A.updateQueue,S.type=A.type,r=A.dependencies,S.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),d=d.sibling;return nt(ct,ct.current&1|2),o.child}r=r.sibling}S.tail!==null&&gt()>No&&(o.flags|=128,m=!0,Fi(S,!1),o.lanes=4194304)}else{if(!m)if(r=bl(A),r!==null){if(o.flags|=128,m=!0,d=r.updateQueue,d!==null&&(o.updateQueue=d,o.flags|=4),Fi(S,!0),S.tail===null&&S.tailMode==="hidden"&&!A.alternate&&!lt)return Ut(o),null}else 2*gt()-S.renderingStartTime>No&&d!==1073741824&&(o.flags|=128,m=!0,Fi(S,!1),o.lanes=4194304);S.isBackwards?(A.sibling=o.child,o.child=A):(d=S.last,d!==null?d.sibling=A:o.child=A,S.last=A)}return S.tail!==null?(o=S.tail,S.rendering=o,S.tail=o.sibling,S.renderingStartTime=gt(),o.sibling=null,d=ct.current,nt(ct,m?d&1|2:d&1),o):(Ut(o),null);case 22:case 23:return nf(),m=o.memoizedState!==null,r!==null&&r.memoizedState!==null!==m&&(o.flags|=8192),m&&(o.mode&1)!==0?(un&1073741824)!==0&&(Ut(o),o.subtreeFlags&6&&(o.flags|=8192)):Ut(o),null;case 24:return null;case 25:return null}throw Error(n(156,o.tag))}function M1(r,o){switch(uu(o),o.tag){case 1:return en(o.type)&&dl(),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return Co(),ot(Zt),ot($t),Eu(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 5:return Cu(o),null;case 13:if(ot(ct),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));yo()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return ot(ct),null;case 4:return Co(),null;case 10:return vu(o.type._context),null;case 22:case 23:return nf(),null;case 24:return null;default:return null}}var Al=!1,Bt=!1,$1=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function Eo(r,o){var d=r.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(m){mt(r,o,m)}else d.current=null}function Hu(r,o,d){try{d()}catch(m){mt(r,o,m)}}var av=!1;function F1(r,o){if(nu=Ja,r=Fp(),Kd(r)){if("selectionStart"in r)var d={start:r.selectionStart,end:r.selectionEnd};else e:{d=(d=r.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var y=m.anchorOffset,S=m.focusNode;m=m.focusOffset;try{d.nodeType,S.nodeType}catch{d=null;break e}var A=0,H=-1,J=-1,oe=0,ue=0,he=r,de=null;t:for(;;){for(var xe;he!==d||y!==0&&he.nodeType!==3||(H=A+y),he!==S||m!==0&&he.nodeType!==3||(J=A+m),he.nodeType===3&&(A+=he.nodeValue.length),(xe=he.firstChild)!==null;)de=he,he=xe;for(;;){if(he===r)break t;if(de===d&&++oe===y&&(H=A),de===S&&++ue===m&&(J=A),(xe=he.nextSibling)!==null)break;he=de,de=he.parentNode}he=xe}d=H===-1||J===-1?null:{start:H,end:J}}else d=null}d=d||{start:0,end:0}}else d=null;for(ru={focusedElem:r,selectionRange:d},Ja=!1,Ce=o;Ce!==null;)if(o=Ce,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,Ce=r;else for(;Ce!==null;){o=Ce;try{var Se=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(Se!==null){var Ee=Se.memoizedProps,vt=Se.memoizedState,ne=o.stateNode,Z=ne.getSnapshotBeforeUpdate(o.elementType===o.type?Ee:Fn(o.type,Ee),vt);ne.__reactInternalSnapshotBeforeUpdate=Z}break;case 3:var re=o.stateNode.containerInfo;re.nodeType===1?re.textContent="":re.nodeType===9&&re.documentElement&&re.removeChild(re.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(me){mt(o,o.return,me)}if(r=o.sibling,r!==null){r.return=o.return,Ce=r;break}Ce=o.return}return Se=av,av=!1,Se}function Ui(r,o,d){var m=o.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var y=m=m.next;do{if((y.tag&r)===r){var S=y.destroy;y.destroy=void 0,S!==void 0&&Hu(o,d,S)}y=y.next}while(y!==m)}}function Rl(r,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var d=o=o.next;do{if((d.tag&r)===r){var m=d.create;d.destroy=m()}d=d.next}while(d!==o)}}function Wu(r){var o=r.ref;if(o!==null){var d=r.stateNode;switch(r.tag){case 5:r=d;break;default:r=d}typeof o=="function"?o(r):o.current=r}}function lv(r){var o=r.alternate;o!==null&&(r.alternate=null,lv(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&(delete o[ir],delete o[Ti],delete o[au],delete o[b1],delete o[C1])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function cv(r){return r.tag===5||r.tag===3||r.tag===4}function dv(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||cv(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function qu(r,o,d){var m=r.tag;if(m===5||m===6)r=r.stateNode,o?d.nodeType===8?d.parentNode.insertBefore(r,o):d.insertBefore(r,o):(d.nodeType===8?(o=d.parentNode,o.insertBefore(r,d)):(o=d,o.appendChild(r)),d=d._reactRootContainer,d!=null||o.onclick!==null||(o.onclick=ll));else if(m!==4&&(r=r.child,r!==null))for(qu(r,o,d),r=r.sibling;r!==null;)qu(r,o,d),r=r.sibling}function Gu(r,o,d){var m=r.tag;if(m===5||m===6)r=r.stateNode,o?d.insertBefore(r,o):d.appendChild(r);else if(m!==4&&(r=r.child,r!==null))for(Gu(r,o,d),r=r.sibling;r!==null;)Gu(r,o,d),r=r.sibling}var Rt=null,Un=!1;function Qr(r,o,d){for(d=d.child;d!==null;)uv(r,o,d),d=d.sibling}function uv(r,o,d){if(or&&typeof or.onCommitFiberUnmount=="function")try{or.onCommitFiberUnmount(Ha,d)}catch{}switch(d.tag){case 5:Bt||Eo(d,o);case 6:var m=Rt,y=Un;Rt=null,Qr(r,o,d),Rt=m,Un=y,Rt!==null&&(Un?(r=Rt,d=d.stateNode,r.nodeType===8?r.parentNode.removeChild(d):r.removeChild(d)):Rt.removeChild(d.stateNode));break;case 18:Rt!==null&&(Un?(r=Rt,d=d.stateNode,r.nodeType===8?iu(r.parentNode,d):r.nodeType===1&&iu(r,d),yi(r)):iu(Rt,d.stateNode));break;case 4:m=Rt,y=Un,Rt=d.stateNode.containerInfo,Un=!0,Qr(r,o,d),Rt=m,Un=y;break;case 0:case 11:case 14:case 15:if(!Bt&&(m=d.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){y=m=m.next;do{var S=y,A=S.destroy;S=S.tag,A!==void 0&&((S&2)!==0||(S&4)!==0)&&Hu(d,o,A),y=y.next}while(y!==m)}Qr(r,o,d);break;case 1:if(!Bt&&(Eo(d,o),m=d.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=d.memoizedProps,m.state=d.memoizedState,m.componentWillUnmount()}catch(H){mt(d,o,H)}Qr(r,o,d);break;case 21:Qr(r,o,d);break;case 22:d.mode&1?(Bt=(m=Bt)||d.memoizedState!==null,Qr(r,o,d),Bt=m):Qr(r,o,d);break;default:Qr(r,o,d)}}function fv(r){var o=r.updateQueue;if(o!==null){r.updateQueue=null;var d=r.stateNode;d===null&&(d=r.stateNode=new $1),o.forEach(function(m){var y=K1.bind(null,r,m);d.has(m)||(d.add(m),m.then(y,y))})}}function Bn(r,o){var d=o.deletions;if(d!==null)for(var m=0;m<d.length;m++){var y=d[m];try{var S=r,A=o,H=A;e:for(;H!==null;){switch(H.tag){case 5:Rt=H.stateNode,Un=!1;break e;case 3:Rt=H.stateNode.containerInfo,Un=!0;break e;case 4:Rt=H.stateNode.containerInfo,Un=!0;break e}H=H.return}if(Rt===null)throw Error(n(160));uv(S,A,y),Rt=null,Un=!1;var J=y.alternate;J!==null&&(J.return=null),y.return=null}catch(oe){mt(y,o,oe)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)hv(o,r),o=o.sibling}function hv(r,o){var d=r.alternate,m=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(Bn(o,r),cr(r),m&4){try{Ui(3,r,r.return),Rl(3,r)}catch(Ee){mt(r,r.return,Ee)}try{Ui(5,r,r.return)}catch(Ee){mt(r,r.return,Ee)}}break;case 1:Bn(o,r),cr(r),m&512&&d!==null&&Eo(d,d.return);break;case 5:if(Bn(o,r),cr(r),m&512&&d!==null&&Eo(d,d.return),r.flags&32){var y=r.stateNode;try{Tt(y,"")}catch(Ee){mt(r,r.return,Ee)}}if(m&4&&(y=r.stateNode,y!=null)){var S=r.memoizedProps,A=d!==null?d.memoizedProps:S,H=r.type,J=r.updateQueue;if(r.updateQueue=null,J!==null)try{H==="input"&&S.type==="radio"&&S.name!=null&&ie(y,S),ci(H,A);var oe=ci(H,S);for(A=0;A<J.length;A+=2){var ue=J[A],he=J[A+1];ue==="style"?wr(y,he):ue==="dangerouslySetInnerHTML"?Mt(y,he):ue==="children"?Tt(y,he):N(y,ue,he,oe)}switch(H){case"input":Pe(y,S);break;case"textarea":wt(y,S);break;case"select":var de=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!S.multiple;var xe=S.value;xe!=null?Ue(y,!!S.multiple,xe,!1):de!==!!S.multiple&&(S.defaultValue!=null?Ue(y,!!S.multiple,S.defaultValue,!0):Ue(y,!!S.multiple,S.multiple?[]:"",!1))}y[Ti]=S}catch(Ee){mt(r,r.return,Ee)}}break;case 6:if(Bn(o,r),cr(r),m&4){if(r.stateNode===null)throw Error(n(162));y=r.stateNode,S=r.memoizedProps;try{y.nodeValue=S}catch(Ee){mt(r,r.return,Ee)}}break;case 3:if(Bn(o,r),cr(r),m&4&&d!==null&&d.memoizedState.isDehydrated)try{yi(o.containerInfo)}catch(Ee){mt(r,r.return,Ee)}break;case 4:Bn(o,r),cr(r);break;case 13:Bn(o,r),cr(r),y=r.child,y.flags&8192&&(S=y.memoizedState!==null,y.stateNode.isHidden=S,!S||y.alternate!==null&&y.alternate.memoizedState!==null||(Ju=gt())),m&4&&fv(r);break;case 22:if(ue=d!==null&&d.memoizedState!==null,r.mode&1?(Bt=(oe=Bt)||ue,Bn(o,r),Bt=oe):Bn(o,r),cr(r),m&8192){if(oe=r.memoizedState!==null,(r.stateNode.isHidden=oe)&&!ue&&(r.mode&1)!==0)for(Ce=r,ue=r.child;ue!==null;){for(he=Ce=ue;Ce!==null;){switch(de=Ce,xe=de.child,de.tag){case 0:case 11:case 14:case 15:Ui(4,de,de.return);break;case 1:Eo(de,de.return);var Se=de.stateNode;if(typeof Se.componentWillUnmount=="function"){m=de,d=de.return;try{o=m,Se.props=o.memoizedProps,Se.state=o.memoizedState,Se.componentWillUnmount()}catch(Ee){mt(m,d,Ee)}}break;case 5:Eo(de,de.return);break;case 22:if(de.memoizedState!==null){gv(he);continue}}xe!==null?(xe.return=de,Ce=xe):gv(he)}ue=ue.sibling}e:for(ue=null,he=r;;){if(he.tag===5){if(ue===null){ue=he;try{y=he.stateNode,oe?(S=y.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none"):(H=he.stateNode,J=he.memoizedProps.style,A=J!=null&&J.hasOwnProperty("display")?J.display:null,H.style.display=Mr("display",A))}catch(Ee){mt(r,r.return,Ee)}}}else if(he.tag===6){if(ue===null)try{he.stateNode.nodeValue=oe?"":he.memoizedProps}catch(Ee){mt(r,r.return,Ee)}}else if((he.tag!==22&&he.tag!==23||he.memoizedState===null||he===r)&&he.child!==null){he.child.return=he,he=he.child;continue}if(he===r)break e;for(;he.sibling===null;){if(he.return===null||he.return===r)break e;ue===he&&(ue=null),he=he.return}ue===he&&(ue=null),he.sibling.return=he.return,he=he.sibling}}break;case 19:Bn(o,r),cr(r),m&4&&fv(r);break;case 21:break;default:Bn(o,r),cr(r)}}function cr(r){var o=r.flags;if(o&2){try{e:{for(var d=r.return;d!==null;){if(cv(d)){var m=d;break e}d=d.return}throw Error(n(160))}switch(m.tag){case 5:var y=m.stateNode;m.flags&32&&(Tt(y,""),m.flags&=-33);var S=dv(r);Gu(r,S,y);break;case 3:case 4:var A=m.stateNode.containerInfo,H=dv(r);qu(r,H,A);break;default:throw Error(n(161))}}catch(J){mt(r,r.return,J)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function U1(r,o,d){Ce=r,mv(r)}function mv(r,o,d){for(var m=(r.mode&1)!==0;Ce!==null;){var y=Ce,S=y.child;if(y.tag===22&&m){var A=y.memoizedState!==null||Al;if(!A){var H=y.alternate,J=H!==null&&H.memoizedState!==null||Bt;H=Al;var oe=Bt;if(Al=A,(Bt=J)&&!oe)for(Ce=y;Ce!==null;)A=Ce,J=A.child,A.tag===22&&A.memoizedState!==null?vv(y):J!==null?(J.return=A,Ce=J):vv(y);for(;S!==null;)Ce=S,mv(S),S=S.sibling;Ce=y,Al=H,Bt=oe}pv(r)}else(y.subtreeFlags&8772)!==0&&S!==null?(S.return=y,Ce=S):pv(r)}}function pv(r){for(;Ce!==null;){var o=Ce;if((o.flags&8772)!==0){var d=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:Bt||Rl(5,o);break;case 1:var m=o.stateNode;if(o.flags&4&&!Bt)if(d===null)m.componentDidMount();else{var y=o.elementType===o.type?d.memoizedProps:Fn(o.type,d.memoizedProps);m.componentDidUpdate(y,d.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var S=o.updateQueue;S!==null&&gg(o,S,m);break;case 3:var A=o.updateQueue;if(A!==null){if(d=null,o.child!==null)switch(o.child.tag){case 5:d=o.child.stateNode;break;case 1:d=o.child.stateNode}gg(o,A,d)}break;case 5:var H=o.stateNode;if(d===null&&o.flags&4){d=H;var J=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":J.autoFocus&&d.focus();break;case"img":J.src&&(d.src=J.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var oe=o.alternate;if(oe!==null){var ue=oe.memoizedState;if(ue!==null){var he=ue.dehydrated;he!==null&&yi(he)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Bt||o.flags&512&&Wu(o)}catch(de){mt(o,o.return,de)}}if(o===r){Ce=null;break}if(d=o.sibling,d!==null){d.return=o.return,Ce=d;break}Ce=o.return}}function gv(r){for(;Ce!==null;){var o=Ce;if(o===r){Ce=null;break}var d=o.sibling;if(d!==null){d.return=o.return,Ce=d;break}Ce=o.return}}function vv(r){for(;Ce!==null;){var o=Ce;try{switch(o.tag){case 0:case 11:case 15:var d=o.return;try{Rl(4,o)}catch(J){mt(o,d,J)}break;case 1:var m=o.stateNode;if(typeof m.componentDidMount=="function"){var y=o.return;try{m.componentDidMount()}catch(J){mt(o,y,J)}}var S=o.return;try{Wu(o)}catch(J){mt(o,S,J)}break;case 5:var A=o.return;try{Wu(o)}catch(J){mt(o,A,J)}}}catch(J){mt(o,o.return,J)}if(o===r){Ce=null;break}var H=o.sibling;if(H!==null){H.return=o.return,Ce=H;break}Ce=o.return}}var B1=Math.ceil,Pl=j.ReactCurrentDispatcher,Ku=j.ReactCurrentOwner,bn=j.ReactCurrentBatchConfig,Ke=0,kt=null,xt=null,Pt=0,un=0,_o=qr(0),Et=0,Bi=null,Ds=0,Il=0,Yu=0,zi=null,nn=null,Ju=0,No=1/0,kr=null,Dl=!1,Qu=null,Xr=null,Ol=!1,Zr=null,Ll=0,Vi=0,Xu=null,Ml=-1,$l=0;function Wt(){return(Ke&6)!==0?gt():Ml!==-1?Ml:Ml=gt()}function es(r){return(r.mode&1)===0?1:(Ke&2)!==0&&Pt!==0?Pt&-Pt:E1.transition!==null?($l===0&&($l=dp()),$l):(r=Xe,r!==0||(r=window.event,r=r===void 0?16:wp(r.type)),r)}function zn(r,o,d,m){if(50<Vi)throw Vi=0,Xu=null,Error(n(185));hi(r,d,m),((Ke&2)===0||r!==kt)&&(r===kt&&((Ke&2)===0&&(Il|=d),Et===4&&ts(r,Pt)),rn(r,m),d===1&&Ke===0&&(o.mode&1)===0&&(No=gt()+500,fl&&Kr()))}function rn(r,o){var d=r.callbackNode;E_(r,o);var m=Ga(r,r===kt?Pt:0);if(m===0)d!==null&&ap(d),r.callbackNode=null,r.callbackPriority=0;else if(o=m&-m,r.callbackPriority!==o){if(d!=null&&ap(d),o===1)r.tag===0?S1(wv.bind(null,r)):sg(wv.bind(null,r)),w1(function(){(Ke&6)===0&&Kr()}),d=null;else{switch(up(m)){case 1:d=Rd;break;case 4:d=lp;break;case 16:d=Va;break;case 536870912:d=cp;break;default:d=Va}d=kv(d,yv.bind(null,r))}r.callbackPriority=o,r.callbackNode=d}}function yv(r,o){if(Ml=-1,$l=0,(Ke&6)!==0)throw Error(n(327));var d=r.callbackNode;if(ko()&&r.callbackNode!==d)return null;var m=Ga(r,r===kt?Pt:0);if(m===0)return null;if((m&30)!==0||(m&r.expiredLanes)!==0||o)o=Fl(r,m);else{o=m;var y=Ke;Ke|=2;var S=bv();(kt!==r||Pt!==o)&&(kr=null,No=gt()+500,Ls(r,o));do try{H1();break}catch(H){xv(r,H)}while(!0);gu(),Pl.current=S,Ke=y,xt!==null?o=0:(kt=null,Pt=0,o=Et)}if(o!==0){if(o===2&&(y=Pd(r),y!==0&&(m=y,o=Zu(r,y))),o===1)throw d=Bi,Ls(r,0),ts(r,m),rn(r,gt()),d;if(o===6)ts(r,m);else{if(y=r.current.alternate,(m&30)===0&&!z1(y)&&(o=Fl(r,m),o===2&&(S=Pd(r),S!==0&&(m=S,o=Zu(r,S))),o===1))throw d=Bi,Ls(r,0),ts(r,m),rn(r,gt()),d;switch(r.finishedWork=y,r.finishedLanes=m,o){case 0:case 1:throw Error(n(345));case 2:Ms(r,nn,kr);break;case 3:if(ts(r,m),(m&130023424)===m&&(o=Ju+500-gt(),10<o)){if(Ga(r,0)!==0)break;if(y=r.suspendedLanes,(y&m)!==m){Wt(),r.pingedLanes|=r.suspendedLanes&y;break}r.timeoutHandle=ou(Ms.bind(null,r,nn,kr),o);break}Ms(r,nn,kr);break;case 4:if(ts(r,m),(m&4194240)===m)break;for(o=r.eventTimes,y=-1;0<m;){var A=31-Ln(m);S=1<<A,A=o[A],A>y&&(y=A),m&=~S}if(m=y,m=gt()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*B1(m/1960))-m,10<m){r.timeoutHandle=ou(Ms.bind(null,r,nn,kr),m);break}Ms(r,nn,kr);break;case 5:Ms(r,nn,kr);break;default:throw Error(n(329))}}}return rn(r,gt()),r.callbackNode===d?yv.bind(null,r):null}function Zu(r,o){var d=zi;return r.current.memoizedState.isDehydrated&&(Ls(r,o).flags|=256),r=Fl(r,o),r!==2&&(o=nn,nn=d,o!==null&&ef(o)),r}function ef(r){nn===null?nn=r:nn.push.apply(nn,r)}function z1(r){for(var o=r;;){if(o.flags&16384){var d=o.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var m=0;m<d.length;m++){var y=d[m],S=y.getSnapshot;y=y.value;try{if(!Mn(S(),y))return!1}catch{return!1}}}if(d=o.child,o.subtreeFlags&16384&&d!==null)d.return=o,o=d;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ts(r,o){for(o&=~Yu,o&=~Il,r.suspendedLanes|=o,r.pingedLanes&=~o,r=r.expirationTimes;0<o;){var d=31-Ln(o),m=1<<d;r[d]=-1,o&=~m}}function wv(r){if((Ke&6)!==0)throw Error(n(327));ko();var o=Ga(r,0);if((o&1)===0)return rn(r,gt()),null;var d=Fl(r,o);if(r.tag!==0&&d===2){var m=Pd(r);m!==0&&(o=m,d=Zu(r,m))}if(d===1)throw d=Bi,Ls(r,0),ts(r,o),rn(r,gt()),d;if(d===6)throw Error(n(345));return r.finishedWork=r.current.alternate,r.finishedLanes=o,Ms(r,nn,kr),rn(r,gt()),null}function tf(r,o){var d=Ke;Ke|=1;try{return r(o)}finally{Ke=d,Ke===0&&(No=gt()+500,fl&&Kr())}}function Os(r){Zr!==null&&Zr.tag===0&&(Ke&6)===0&&ko();var o=Ke;Ke|=1;var d=bn.transition,m=Xe;try{if(bn.transition=null,Xe=1,r)return r()}finally{Xe=m,bn.transition=d,Ke=o,(Ke&6)===0&&Kr()}}function nf(){un=_o.current,ot(_o)}function Ls(r,o){r.finishedWork=null,r.finishedLanes=0;var d=r.timeoutHandle;if(d!==-1&&(r.timeoutHandle=-1,y1(d)),xt!==null)for(d=xt.return;d!==null;){var m=d;switch(uu(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&dl();break;case 3:Co(),ot(Zt),ot($t),Eu();break;case 5:Cu(m);break;case 4:Co();break;case 13:ot(ct);break;case 19:ot(ct);break;case 10:vu(m.type._context);break;case 22:case 23:nf()}d=d.return}if(kt=r,xt=r=ns(r.current,null),Pt=un=o,Et=0,Bi=null,Yu=Il=Ds=0,nn=zi=null,Rs!==null){for(o=0;o<Rs.length;o++)if(d=Rs[o],m=d.interleaved,m!==null){d.interleaved=null;var y=m.next,S=d.pending;if(S!==null){var A=S.next;S.next=y,m.next=A}d.pending=m}Rs=null}return r}function xv(r,o){do{var d=xt;try{if(gu(),Cl.current=Nl,Sl){for(var m=dt.memoizedState;m!==null;){var y=m.queue;y!==null&&(y.pending=null),m=m.next}Sl=!1}if(Is=0,Nt=St=dt=null,Oi=!1,Li=0,Ku.current=null,d===null||d.return===null){Et=1,Bi=o,xt=null;break}e:{var S=r,A=d.return,H=d,J=o;if(o=Pt,H.flags|=32768,J!==null&&typeof J=="object"&&typeof J.then=="function"){var oe=J,ue=H,he=ue.tag;if((ue.mode&1)===0&&(he===0||he===11||he===15)){var de=ue.alternate;de?(ue.updateQueue=de.updateQueue,ue.memoizedState=de.memoizedState,ue.lanes=de.lanes):(ue.updateQueue=null,ue.memoizedState=null)}var xe=Wg(A);if(xe!==null){xe.flags&=-257,qg(xe,A,H,S,o),xe.mode&1&&Hg(S,oe,o),o=xe,J=oe;var Se=o.updateQueue;if(Se===null){var Ee=new Set;Ee.add(J),o.updateQueue=Ee}else Se.add(J);break e}else{if((o&1)===0){Hg(S,oe,o),rf();break e}J=Error(n(426))}}else if(lt&&H.mode&1){var vt=Wg(A);if(vt!==null){(vt.flags&65536)===0&&(vt.flags|=256),qg(vt,A,H,S,o),mu(So(J,H));break e}}S=J=So(J,H),Et!==4&&(Et=2),zi===null?zi=[S]:zi.push(S),S=A;do{switch(S.tag){case 3:S.flags|=65536,o&=-o,S.lanes|=o;var ne=zg(S,J,o);pg(S,ne);break e;case 1:H=J;var Z=S.type,re=S.stateNode;if((S.flags&128)===0&&(typeof Z.getDerivedStateFromError=="function"||re!==null&&typeof re.componentDidCatch=="function"&&(Xr===null||!Xr.has(re)))){S.flags|=65536,o&=-o,S.lanes|=o;var me=Vg(S,H,o);pg(S,me);break e}}S=S.return}while(S!==null)}Sv(d)}catch(ke){o=ke,xt===d&&d!==null&&(xt=d=d.return);continue}break}while(!0)}function bv(){var r=Pl.current;return Pl.current=Nl,r===null?Nl:r}function rf(){(Et===0||Et===3||Et===2)&&(Et=4),kt===null||(Ds&268435455)===0&&(Il&268435455)===0||ts(kt,Pt)}function Fl(r,o){var d=Ke;Ke|=2;var m=bv();(kt!==r||Pt!==o)&&(kr=null,Ls(r,o));do try{V1();break}catch(y){xv(r,y)}while(!0);if(gu(),Ke=d,Pl.current=m,xt!==null)throw Error(n(261));return kt=null,Pt=0,Et}function V1(){for(;xt!==null;)Cv(xt)}function H1(){for(;xt!==null&&!p_();)Cv(xt)}function Cv(r){var o=Nv(r.alternate,r,un);r.memoizedProps=r.pendingProps,o===null?Sv(r):xt=o,Ku.current=null}function Sv(r){var o=r;do{var d=o.alternate;if(r=o.return,(o.flags&32768)===0){if(d=L1(d,o,un),d!==null){xt=d;return}}else{if(d=M1(d,o),d!==null){d.flags&=32767,xt=d;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Et=6,xt=null;return}}if(o=o.sibling,o!==null){xt=o;return}xt=o=r}while(o!==null);Et===0&&(Et=5)}function Ms(r,o,d){var m=Xe,y=bn.transition;try{bn.transition=null,Xe=1,W1(r,o,d,m)}finally{bn.transition=y,Xe=m}return null}function W1(r,o,d,m){do ko();while(Zr!==null);if((Ke&6)!==0)throw Error(n(327));d=r.finishedWork;var y=r.finishedLanes;if(d===null)return null;if(r.finishedWork=null,r.finishedLanes=0,d===r.current)throw Error(n(177));r.callbackNode=null,r.callbackPriority=0;var S=d.lanes|d.childLanes;if(__(r,S),r===kt&&(xt=kt=null,Pt=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Ol||(Ol=!0,kv(Va,function(){return ko(),null})),S=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||S){S=bn.transition,bn.transition=null;var A=Xe;Xe=1;var H=Ke;Ke|=4,Ku.current=null,F1(r,d),hv(d,r),u1(ru),Ja=!!nu,ru=nu=null,r.current=d,U1(d),g_(),Ke=H,Xe=A,bn.transition=S}else r.current=d;if(Ol&&(Ol=!1,Zr=r,Ll=y),S=r.pendingLanes,S===0&&(Xr=null),w_(d.stateNode),rn(r,gt()),o!==null)for(m=r.onRecoverableError,d=0;d<o.length;d++)y=o[d],m(y.value,{componentStack:y.stack,digest:y.digest});if(Dl)throw Dl=!1,r=Qu,Qu=null,r;return(Ll&1)!==0&&r.tag!==0&&ko(),S=r.pendingLanes,(S&1)!==0?r===Xu?Vi++:(Vi=0,Xu=r):Vi=0,Kr(),null}function ko(){if(Zr!==null){var r=up(Ll),o=bn.transition,d=Xe;try{if(bn.transition=null,Xe=16>r?16:r,Zr===null)var m=!1;else{if(r=Zr,Zr=null,Ll=0,(Ke&6)!==0)throw Error(n(331));var y=Ke;for(Ke|=4,Ce=r.current;Ce!==null;){var S=Ce,A=S.child;if((Ce.flags&16)!==0){var H=S.deletions;if(H!==null){for(var J=0;J<H.length;J++){var oe=H[J];for(Ce=oe;Ce!==null;){var ue=Ce;switch(ue.tag){case 0:case 11:case 15:Ui(8,ue,S)}var he=ue.child;if(he!==null)he.return=ue,Ce=he;else for(;Ce!==null;){ue=Ce;var de=ue.sibling,xe=ue.return;if(lv(ue),ue===oe){Ce=null;break}if(de!==null){de.return=xe,Ce=de;break}Ce=xe}}}var Se=S.alternate;if(Se!==null){var Ee=Se.child;if(Ee!==null){Se.child=null;do{var vt=Ee.sibling;Ee.sibling=null,Ee=vt}while(Ee!==null)}}Ce=S}}if((S.subtreeFlags&2064)!==0&&A!==null)A.return=S,Ce=A;else e:for(;Ce!==null;){if(S=Ce,(S.flags&2048)!==0)switch(S.tag){case 0:case 11:case 15:Ui(9,S,S.return)}var ne=S.sibling;if(ne!==null){ne.return=S.return,Ce=ne;break e}Ce=S.return}}var Z=r.current;for(Ce=Z;Ce!==null;){A=Ce;var re=A.child;if((A.subtreeFlags&2064)!==0&&re!==null)re.return=A,Ce=re;else e:for(A=Z;Ce!==null;){if(H=Ce,(H.flags&2048)!==0)try{switch(H.tag){case 0:case 11:case 15:Rl(9,H)}}catch(ke){mt(H,H.return,ke)}if(H===A){Ce=null;break e}var me=H.sibling;if(me!==null){me.return=H.return,Ce=me;break e}Ce=H.return}}if(Ke=y,Kr(),or&&typeof or.onPostCommitFiberRoot=="function")try{or.onPostCommitFiberRoot(Ha,r)}catch{}m=!0}return m}finally{Xe=d,bn.transition=o}}return!1}function Ev(r,o,d){o=So(d,o),o=zg(r,o,1),r=Jr(r,o,1),o=Wt(),r!==null&&(hi(r,1,o),rn(r,o))}function mt(r,o,d){if(r.tag===3)Ev(r,r,d);else for(;o!==null;){if(o.tag===3){Ev(o,r,d);break}else if(o.tag===1){var m=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Xr===null||!Xr.has(m))){r=So(d,r),r=Vg(o,r,1),o=Jr(o,r,1),r=Wt(),o!==null&&(hi(o,1,r),rn(o,r));break}}o=o.return}}function q1(r,o,d){var m=r.pingCache;m!==null&&m.delete(o),o=Wt(),r.pingedLanes|=r.suspendedLanes&d,kt===r&&(Pt&d)===d&&(Et===4||Et===3&&(Pt&130023424)===Pt&&500>gt()-Ju?Ls(r,0):Yu|=d),rn(r,o)}function _v(r,o){o===0&&((r.mode&1)===0?o=1:(o=qa,qa<<=1,(qa&130023424)===0&&(qa=4194304)));var d=Wt();r=Er(r,o),r!==null&&(hi(r,o,d),rn(r,d))}function G1(r){var o=r.memoizedState,d=0;o!==null&&(d=o.retryLane),_v(r,d)}function K1(r,o){var d=0;switch(r.tag){case 13:var m=r.stateNode,y=r.memoizedState;y!==null&&(d=y.retryLane);break;case 19:m=r.stateNode;break;default:throw Error(n(314))}m!==null&&m.delete(o),_v(r,d)}var Nv;Nv=function(r,o,d){if(r!==null)if(r.memoizedProps!==o.pendingProps||Zt.current)tn=!0;else{if((r.lanes&d)===0&&(o.flags&128)===0)return tn=!1,O1(r,o,d);tn=(r.flags&131072)!==0}else tn=!1,lt&&(o.flags&1048576)!==0&&og(o,ml,o.index);switch(o.lanes=0,o.tag){case 2:var m=o.type;Tl(r,o),r=o.pendingProps;var y=po(o,$t.current);bo(o,d),y=ku(null,o,m,r,y,d);var S=ju();return o.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,en(m)?(S=!0,ul(o)):S=!1,o.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,xu(o),y.updater=kl,o.stateNode=y,y._reactInternals=o,Du(o,m,r,d),o=$u(null,o,m,!0,S,d)):(o.tag=0,lt&&S&&du(o),Ht(null,o,y,d),o=o.child),o;case 16:m=o.elementType;e:{switch(Tl(r,o),r=o.pendingProps,y=m._init,m=y(m._payload),o.type=m,y=o.tag=J1(m),r=Fn(m,r),y){case 0:o=Mu(null,o,m,r,d);break e;case 1:o=Xg(null,o,m,r,d);break e;case 11:o=Gg(null,o,m,r,d);break e;case 14:o=Kg(null,o,m,Fn(m.type,r),d);break e}throw Error(n(306,m,""))}return o;case 0:return m=o.type,y=o.pendingProps,y=o.elementType===m?y:Fn(m,y),Mu(r,o,m,y,d);case 1:return m=o.type,y=o.pendingProps,y=o.elementType===m?y:Fn(m,y),Xg(r,o,m,y,d);case 3:e:{if(Zg(o),r===null)throw Error(n(387));m=o.pendingProps,S=o.memoizedState,y=S.element,mg(r,o),xl(o,m,null,d);var A=o.memoizedState;if(m=A.element,S.isDehydrated)if(S={element:m,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},o.updateQueue.baseState=S,o.memoizedState=S,o.flags&256){y=So(Error(n(423)),o),o=ev(r,o,m,d,y);break e}else if(m!==y){y=So(Error(n(424)),o),o=ev(r,o,m,d,y);break e}else for(dn=Wr(o.stateNode.containerInfo.firstChild),cn=o,lt=!0,$n=null,d=fg(o,null,m,d),o.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(yo(),m===y){o=Nr(r,o,d);break e}Ht(r,o,m,d)}o=o.child}return o;case 5:return vg(o),r===null&&hu(o),m=o.type,y=o.pendingProps,S=r!==null?r.memoizedProps:null,A=y.children,su(m,y)?A=null:S!==null&&su(m,S)&&(o.flags|=32),Qg(r,o),Ht(r,o,A,d),o.child;case 6:return r===null&&hu(o),null;case 13:return tv(r,o,d);case 4:return bu(o,o.stateNode.containerInfo),m=o.pendingProps,r===null?o.child=wo(o,null,m,d):Ht(r,o,m,d),o.child;case 11:return m=o.type,y=o.pendingProps,y=o.elementType===m?y:Fn(m,y),Gg(r,o,m,y,d);case 7:return Ht(r,o,o.pendingProps,d),o.child;case 8:return Ht(r,o,o.pendingProps.children,d),o.child;case 12:return Ht(r,o,o.pendingProps.children,d),o.child;case 10:e:{if(m=o.type._context,y=o.pendingProps,S=o.memoizedProps,A=y.value,nt(vl,m._currentValue),m._currentValue=A,S!==null)if(Mn(S.value,A)){if(S.children===y.children&&!Zt.current){o=Nr(r,o,d);break e}}else for(S=o.child,S!==null&&(S.return=o);S!==null;){var H=S.dependencies;if(H!==null){A=S.child;for(var J=H.firstContext;J!==null;){if(J.context===m){if(S.tag===1){J=_r(-1,d&-d),J.tag=2;var oe=S.updateQueue;if(oe!==null){oe=oe.shared;var ue=oe.pending;ue===null?J.next=J:(J.next=ue.next,ue.next=J),oe.pending=J}}S.lanes|=d,J=S.alternate,J!==null&&(J.lanes|=d),yu(S.return,d,o),H.lanes|=d;break}J=J.next}}else if(S.tag===10)A=S.type===o.type?null:S.child;else if(S.tag===18){if(A=S.return,A===null)throw Error(n(341));A.lanes|=d,H=A.alternate,H!==null&&(H.lanes|=d),yu(A,d,o),A=S.sibling}else A=S.child;if(A!==null)A.return=S;else for(A=S;A!==null;){if(A===o){A=null;break}if(S=A.sibling,S!==null){S.return=A.return,A=S;break}A=A.return}S=A}Ht(r,o,y.children,d),o=o.child}return o;case 9:return y=o.type,m=o.pendingProps.children,bo(o,d),y=wn(y),m=m(y),o.flags|=1,Ht(r,o,m,d),o.child;case 14:return m=o.type,y=Fn(m,o.pendingProps),y=Fn(m.type,y),Kg(r,o,m,y,d);case 15:return Yg(r,o,o.type,o.pendingProps,d);case 17:return m=o.type,y=o.pendingProps,y=o.elementType===m?y:Fn(m,y),Tl(r,o),o.tag=1,en(m)?(r=!0,ul(o)):r=!1,bo(o,d),Ug(o,m,y),Du(o,m,y,d),$u(null,o,m,!0,r,d);case 19:return rv(r,o,d);case 22:return Jg(r,o,d)}throw Error(n(156,o.tag))};function kv(r,o){return ip(r,o)}function Y1(r,o,d,m){this.tag=r,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cn(r,o,d,m){return new Y1(r,o,d,m)}function sf(r){return r=r.prototype,!(!r||!r.isReactComponent)}function J1(r){if(typeof r=="function")return sf(r)?1:0;if(r!=null){if(r=r.$$typeof,r===I)return 11;if(r===B)return 14}return 2}function ns(r,o){var d=r.alternate;return d===null?(d=Cn(r.tag,o,r.key,r.mode),d.elementType=r.elementType,d.type=r.type,d.stateNode=r.stateNode,d.alternate=r,r.alternate=d):(d.pendingProps=o,d.type=r.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=r.flags&14680064,d.childLanes=r.childLanes,d.lanes=r.lanes,d.child=r.child,d.memoizedProps=r.memoizedProps,d.memoizedState=r.memoizedState,d.updateQueue=r.updateQueue,o=r.dependencies,d.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},d.sibling=r.sibling,d.index=r.index,d.ref=r.ref,d}function Ul(r,o,d,m,y,S){var A=2;if(m=r,typeof r=="function")sf(r)&&(A=1);else if(typeof r=="string")A=5;else e:switch(r){case P:return $s(d.children,y,S,o);case O:A=8,y|=8;break;case G:return r=Cn(12,d,o,y|2),r.elementType=G,r.lanes=S,r;case U:return r=Cn(13,d,o,y),r.elementType=U,r.lanes=S,r;case M:return r=Cn(19,d,o,y),r.elementType=M,r.lanes=S,r;case ee:return Bl(d,y,S,o);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case L:A=10;break e;case F:A=9;break e;case I:A=11;break e;case B:A=14;break e;case V:A=16,m=null;break e}throw Error(n(130,r==null?r:typeof r,""))}return o=Cn(A,d,o,y),o.elementType=r,o.type=m,o.lanes=S,o}function $s(r,o,d,m){return r=Cn(7,r,m,o),r.lanes=d,r}function Bl(r,o,d,m){return r=Cn(22,r,m,o),r.elementType=ee,r.lanes=d,r.stateNode={isHidden:!1},r}function of(r,o,d){return r=Cn(6,r,null,o),r.lanes=d,r}function af(r,o,d){return o=Cn(4,r.children!==null?r.children:[],r.key,o),o.lanes=d,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}function Q1(r,o,d,m,y){this.tag=o,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Id(0),this.expirationTimes=Id(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Id(0),this.identifierPrefix=m,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function lf(r,o,d,m,y,S,A,H,J){return r=new Q1(r,o,d,H,J),o===1?(o=1,S===!0&&(o|=8)):o=0,S=Cn(3,null,null,o),r.current=S,S.stateNode=r,S.memoizedState={element:m,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},xu(S),r}function X1(r,o,d){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:T,key:m==null?null:""+m,children:r,containerInfo:o,implementation:d}}function jv(r){if(!r)return Gr;r=r._reactInternals;e:{if(Ns(r)!==r||r.tag!==1)throw Error(n(170));var o=r;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(en(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(n(171))}if(r.tag===1){var d=r.type;if(en(d))return ng(r,d,o)}return o}function Tv(r,o,d,m,y,S,A,H,J){return r=lf(d,m,!0,r,y,S,A,H,J),r.context=jv(null),d=r.current,m=Wt(),y=es(d),S=_r(m,y),S.callback=o??null,Jr(d,S,y),r.current.lanes=y,hi(r,y,m),rn(r,m),r}function zl(r,o,d,m){var y=o.current,S=Wt(),A=es(y);return d=jv(d),o.context===null?o.context=d:o.pendingContext=d,o=_r(S,A),o.payload={element:r},m=m===void 0?null:m,m!==null&&(o.callback=m),r=Jr(y,o,A),r!==null&&(zn(r,y,A,S),wl(r,y,A)),A}function Vl(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function Av(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var d=r.retryLane;r.retryLane=d!==0&&d<o?d:o}}function cf(r,o){Av(r,o),(r=r.alternate)&&Av(r,o)}function Z1(){return null}var Rv=typeof reportError=="function"?reportError:function(r){console.error(r)};function df(r){this._internalRoot=r}Hl.prototype.render=df.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));zl(r,o,null,null)},Hl.prototype.unmount=df.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;Os(function(){zl(null,r,null,null)}),o[xr]=null}};function Hl(r){this._internalRoot=r}Hl.prototype.unstable_scheduleHydration=function(r){if(r){var o=mp();r={blockedOn:null,target:r,priority:o};for(var d=0;d<zr.length&&o!==0&&o<zr[d].priority;d++);zr.splice(d,0,r),d===0&&vp(r)}};function uf(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function Wl(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Pv(){}function eN(r,o,d,m,y){if(y){if(typeof m=="function"){var S=m;m=function(){var oe=Vl(A);S.call(oe)}}var A=Tv(o,m,r,0,null,!1,!1,"",Pv);return r._reactRootContainer=A,r[xr]=A.current,ki(r.nodeType===8?r.parentNode:r),Os(),A}for(;y=r.lastChild;)r.removeChild(y);if(typeof m=="function"){var H=m;m=function(){var oe=Vl(J);H.call(oe)}}var J=lf(r,0,!1,null,null,!1,!1,"",Pv);return r._reactRootContainer=J,r[xr]=J.current,ki(r.nodeType===8?r.parentNode:r),Os(function(){zl(o,J,d,m)}),J}function ql(r,o,d,m,y){var S=d._reactRootContainer;if(S){var A=S;if(typeof y=="function"){var H=y;y=function(){var J=Vl(A);H.call(J)}}zl(o,A,r,y)}else A=eN(d,o,r,y,m);return Vl(A)}fp=function(r){switch(r.tag){case 3:var o=r.stateNode;if(o.current.memoizedState.isDehydrated){var d=fi(o.pendingLanes);d!==0&&(Dd(o,d|1),rn(o,gt()),(Ke&6)===0&&(No=gt()+500,Kr()))}break;case 13:Os(function(){var m=Er(r,1);if(m!==null){var y=Wt();zn(m,r,1,y)}}),cf(r,1)}},Od=function(r){if(r.tag===13){var o=Er(r,134217728);if(o!==null){var d=Wt();zn(o,r,134217728,d)}cf(r,134217728)}},hp=function(r){if(r.tag===13){var o=es(r),d=Er(r,o);if(d!==null){var m=Wt();zn(d,r,o,m)}cf(r,o)}},mp=function(){return Xe},pp=function(r,o){var d=Xe;try{return Xe=r,o()}finally{Xe=d}},so=function(r,o,d){switch(o){case"input":if(Pe(r,d),o=d.name,d.type==="radio"&&o!=null){for(d=r;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<d.length;o++){var m=d[o];if(m!==r&&m.form===r.form){var y=cl(m);if(!y)throw Error(n(90));Re(m),Pe(m,y)}}}break;case"textarea":wt(r,d);break;case"select":o=d.value,o!=null&&Ue(r,!!d.multiple,o,!1)}},Qe=tf,et=Os;var tN={usingClientEntryPoint:!1,Events:[Ai,ho,cl,Ua,Fe,tf]},Hi={findFiberByHostInstance:ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nN={bundleType:Hi.bundleType,version:Hi.version,rendererPackageName:Hi.rendererPackageName,rendererConfig:Hi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:j.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=sp(r),r===null?null:r.stateNode},findFiberByHostInstance:Hi.findFiberByHostInstance||Z1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gl.isDisabled&&Gl.supportsFiber)try{Ha=Gl.inject(nN),or=Gl}catch{}}return sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tN,sn.createPortal=function(r,o){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!uf(o))throw Error(n(200));return X1(r,o,null,d)},sn.createRoot=function(r,o){if(!uf(r))throw Error(n(299));var d=!1,m="",y=Rv;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onRecoverableError!==void 0&&(y=o.onRecoverableError)),o=lf(r,1,!1,null,null,d,!1,m,y),r[xr]=o.current,ki(r.nodeType===8?r.parentNode:r),new df(o)},sn.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=sp(o),r=r===null?null:r.stateNode,r},sn.flushSync=function(r){return Os(r)},sn.hydrate=function(r,o,d){if(!Wl(o))throw Error(n(200));return ql(null,r,o,!0,d)},sn.hydrateRoot=function(r,o,d){if(!uf(r))throw Error(n(405));var m=d!=null&&d.hydratedSources||null,y=!1,S="",A=Rv;if(d!=null&&(d.unstable_strictMode===!0&&(y=!0),d.identifierPrefix!==void 0&&(S=d.identifierPrefix),d.onRecoverableError!==void 0&&(A=d.onRecoverableError)),o=Tv(o,null,r,1,d??null,y,!1,S,A),r[xr]=o.current,ki(r),m)for(r=0;r<m.length;r++)d=m[r],y=d._getVersion,y=y(d._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[d,y]:o.mutableSourceEagerHydrationData.push(d,y);return new Hl(o)},sn.render=function(r,o,d){if(!Wl(o))throw Error(n(200));return ql(null,r,o,!1,d)},sn.unmountComponentAtNode=function(r){if(!Wl(r))throw Error(n(40));return r._reactRootContainer?(Os(function(){ql(null,null,r,!1,function(){r._reactRootContainer=null,r[xr]=null})}),!0):!1},sn.unstable_batchedUpdates=tf,sn.unstable_renderSubtreeIntoContainer=function(r,o,d,m){if(!Wl(d))throw Error(n(200));if(r==null||r._reactInternals===void 0)throw Error(n(38));return ql(r,o,d,!1,m)},sn.version="18.3.1-next-f1338f8080-20240426",sn}var Uv;function Gw(){if(Uv)return mf.exports;Uv=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),mf.exports=dN(),mf.exports}var Bv;function uN(){if(Bv)return Kl;Bv=1;var e=Gw();return Kl.createRoot=e.createRoot,Kl.hydrateRoot=e.hydrateRoot,Kl}var fN=uN(),p=qh();const pe=Wh(p),Gh=qw({__proto__:null,default:pe},[p]),hN=1,mN=1e6;let vf=0;function pN(){return vf=(vf+1)%Number.MAX_SAFE_INTEGER,vf.toString()}const yf=new Map,zv=e=>{if(yf.has(e))return;const t=setTimeout(()=>{yf.delete(e),ra({type:"REMOVE_TOAST",toastId:e})},mN);yf.set(e,t)},gN=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,hN)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(n=>n.id===t.toast.id?{...n,...t.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=t;return n?zv(n):e.toasts.forEach(s=>{zv(s.id)}),{...e,toasts:e.toasts.map(s=>s.id===n||n===void 0?{...s,open:!1}:s)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(n=>n.id!==t.toastId)}}},yc=[];let wc={toasts:[]};function ra(e){wc=gN(wc,e),yc.forEach(t=>{t(wc)})}function vN({...e}){const t=pN(),n=i=>ra({type:"UPDATE_TOAST",toast:{...i,id:t}}),s=()=>ra({type:"DISMISS_TOAST",toastId:t});return ra({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:i=>{i||s()}}}),{id:t,dismiss:s,update:n}}function Ct(){const[e,t]=p.useState(wc);return p.useEffect(()=>(yc.push(t),()=>{const n=yc.indexOf(t);n>-1&&yc.splice(n,1)}),[e]),{...e,toast:vN,dismiss:n=>ra({type:"DISMISS_TOAST",toastId:n})}}var Xo=Gw();const Kw=Wh(Xo);function ye(e,t,{checkForDefaultPrevented:n=!0}={}){return function(i){if(e?.(i),n===!1||!i.defaultPrevented)return t?.(i)}}function Vv(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Kc(...e){return t=>{let n=!1;const s=e.map(i=>{const l=Vv(i,t);return!n&&typeof l=="function"&&(n=!0),l});if(n)return()=>{for(let i=0;i<s.length;i++){const l=s[i];typeof l=="function"?l():Vv(e[i],null)}}}}function qe(...e){return p.useCallback(Kc(...e),e)}function yN(e,t){const n=p.createContext(t),s=l=>{const{children:c,...u}=l,f=p.useMemo(()=>u,Object.values(u));return a.jsx(n.Provider,{value:f,children:c})};s.displayName=e+"Provider";function i(l){const c=p.useContext(n);if(c)return c;if(t!==void 0)return t;throw new Error(`\`${l}\` must be used within \`${e}\``)}return[s,i]}function Pn(e,t=[]){let n=[];function s(l,c){const u=p.createContext(c),f=n.length;n=[...n,c];const h=v=>{const{scope:w,children:x,...E}=v,C=w?.[e]?.[f]||u,b=p.useMemo(()=>E,Object.values(E));return a.jsx(C.Provider,{value:b,children:x})};h.displayName=l+"Provider";function g(v,w){const x=w?.[e]?.[f]||u,E=p.useContext(x);if(E)return E;if(c!==void 0)return c;throw new Error(`\`${v}\` must be used within \`${l}\``)}return[h,g]}const i=()=>{const l=n.map(c=>p.createContext(c));return function(u){const f=u?.[e]||l;return p.useMemo(()=>({[`__scope${e}`]:{...u,[e]:f}}),[u,f])}};return i.scopeName=e,[s,wN(i,...t)]}function wN(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const s=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(l){const c=s.reduce((u,{useScope:f,scopeName:h})=>{const v=f(l)[`__scope${h}`];return{...u,...v}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:c}),[c])}};return n.scopeName=t.scopeName,n}function Ks(e){const t=bN(e),n=p.forwardRef((s,i)=>{const{children:l,...c}=s,u=p.Children.toArray(l),f=u.find(CN);if(f){const h=f.props.children,g=u.map(v=>v===f?p.Children.count(h)>1?p.Children.only(null):p.isValidElement(h)?h.props.children:null:v);return a.jsx(t,{...c,ref:i,children:p.isValidElement(h)?p.cloneElement(h,void 0,g):null})}return a.jsx(t,{...c,ref:i,children:l})});return n.displayName=`${e}.Slot`,n}var xN=Ks("Slot");function bN(e){const t=p.forwardRef((n,s)=>{const{children:i,...l}=n;if(p.isValidElement(i)){const c=EN(i),u=SN(l,i.props);return i.type!==p.Fragment&&(u.ref=s?Kc(s,c):c),p.cloneElement(i,u)}return p.Children.count(i)>1?p.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Yw=Symbol("radix.slottable");function Jw(e){const t=({children:n})=>a.jsx(a.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=Yw,t}function CN(e){return p.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Yw}function SN(e,t){const n={...t};for(const s in t){const i=e[s],l=t[s];/^on[A-Z]/.test(s)?i&&l?n[s]=(...u)=>{const f=l(...u);return i(...u),f}:i&&(n[s]=i):s==="style"?n[s]={...i,...l}:s==="className"&&(n[s]=[i,l].filter(Boolean).join(" "))}return{...e,...n}}function EN(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function Yc(e){const t=e+"CollectionProvider",[n,s]=Pn(t),[i,l]=n(t,{collectionRef:{current:null},itemMap:new Map}),c=C=>{const{scope:b,children:k}=C,_=pe.useRef(null),N=pe.useRef(new Map).current;return a.jsx(i,{scope:b,itemMap:N,collectionRef:_,children:k})};c.displayName=t;const u=e+"CollectionSlot",f=Ks(u),h=pe.forwardRef((C,b)=>{const{scope:k,children:_}=C,N=l(u,k),j=qe(b,N.collectionRef);return a.jsx(f,{ref:j,children:_})});h.displayName=u;const g=e+"CollectionItemSlot",v="data-radix-collection-item",w=Ks(g),x=pe.forwardRef((C,b)=>{const{scope:k,children:_,...N}=C,j=pe.useRef(null),R=qe(b,j),T=l(g,k);return pe.useEffect(()=>(T.itemMap.set(j,{ref:j,...N}),()=>void T.itemMap.delete(j))),a.jsx(w,{[v]:"",ref:R,children:_})});x.displayName=g;function E(C){const b=l(e+"CollectionConsumer",C);return pe.useCallback(()=>{const _=b.collectionRef.current;if(!_)return[];const N=Array.from(_.querySelectorAll(`[${v}]`));return Array.from(b.itemMap.values()).sort((T,P)=>N.indexOf(T.ref.current)-N.indexOf(P.ref.current))},[b.collectionRef,b.itemMap])}return[{Provider:c,Slot:h,ItemSlot:x},E,s]}var _N=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Oe=_N.reduce((e,t)=>{const n=Ks(`Primitive.${t}`),s=p.forwardRef((i,l)=>{const{asChild:c,...u}=i,f=c?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(f,{...u,ref:l})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});function Kh(e,t){e&&Xo.flushSync(()=>e.dispatchEvent(t))}function an(e){const t=p.useRef(e);return p.useEffect(()=>{t.current=e}),p.useMemo(()=>(...n)=>t.current?.(...n),[])}function NN(e,t=globalThis?.document){const n=an(e);p.useEffect(()=>{const s=i=>{i.key==="Escape"&&n(i)};return t.addEventListener("keydown",s,{capture:!0}),()=>t.removeEventListener("keydown",s,{capture:!0})},[n,t])}var kN="DismissableLayer",eh="dismissableLayer.update",jN="dismissableLayer.pointerDownOutside",TN="dismissableLayer.focusOutside",Hv,Qw=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Zo=p.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:l,onInteractOutside:c,onDismiss:u,...f}=e,h=p.useContext(Qw),[g,v]=p.useState(null),w=g?.ownerDocument??globalThis?.document,[,x]=p.useState({}),E=qe(t,P=>v(P)),C=Array.from(h.layers),[b]=[...h.layersWithOutsidePointerEventsDisabled].slice(-1),k=C.indexOf(b),_=g?C.indexOf(g):-1,N=h.layersWithOutsidePointerEventsDisabled.size>0,j=_>=k,R=RN(P=>{const O=P.target,G=[...h.branches].some(L=>L.contains(O));!j||G||(i?.(P),c?.(P),P.defaultPrevented||u?.())},w),T=PN(P=>{const O=P.target;[...h.branches].some(L=>L.contains(O))||(l?.(P),c?.(P),P.defaultPrevented||u?.())},w);return NN(P=>{_===h.layers.size-1&&(s?.(P),!P.defaultPrevented&&u&&(P.preventDefault(),u()))},w),p.useEffect(()=>{if(g)return n&&(h.layersWithOutsidePointerEventsDisabled.size===0&&(Hv=w.body.style.pointerEvents,w.body.style.pointerEvents="none"),h.layersWithOutsidePointerEventsDisabled.add(g)),h.layers.add(g),Wv(),()=>{n&&h.layersWithOutsidePointerEventsDisabled.size===1&&(w.body.style.pointerEvents=Hv)}},[g,w,n,h]),p.useEffect(()=>()=>{g&&(h.layers.delete(g),h.layersWithOutsidePointerEventsDisabled.delete(g),Wv())},[g,h]),p.useEffect(()=>{const P=()=>x({});return document.addEventListener(eh,P),()=>document.removeEventListener(eh,P)},[]),a.jsx(Oe.div,{...f,ref:E,style:{pointerEvents:N?j?"auto":"none":void 0,...e.style},onFocusCapture:ye(e.onFocusCapture,T.onFocusCapture),onBlurCapture:ye(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:ye(e.onPointerDownCapture,R.onPointerDownCapture)})});Zo.displayName=kN;var AN="DismissableLayerBranch",Xw=p.forwardRef((e,t)=>{const n=p.useContext(Qw),s=p.useRef(null),i=qe(t,s);return p.useEffect(()=>{const l=s.current;if(l)return n.branches.add(l),()=>{n.branches.delete(l)}},[n.branches]),a.jsx(Oe.div,{...e,ref:i})});Xw.displayName=AN;function RN(e,t=globalThis?.document){const n=an(e),s=p.useRef(!1),i=p.useRef(()=>{});return p.useEffect(()=>{const l=u=>{if(u.target&&!s.current){let f=function(){Zw(jN,n,h,{discrete:!0})};const h={originalEvent:u};u.pointerType==="touch"?(t.removeEventListener("click",i.current),i.current=f,t.addEventListener("click",i.current,{once:!0})):f()}else t.removeEventListener("click",i.current);s.current=!1},c=window.setTimeout(()=>{t.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(c),t.removeEventListener("pointerdown",l),t.removeEventListener("click",i.current)}},[t,n]),{onPointerDownCapture:()=>s.current=!0}}function PN(e,t=globalThis?.document){const n=an(e),s=p.useRef(!1);return p.useEffect(()=>{const i=l=>{l.target&&!s.current&&Zw(TN,n,{originalEvent:l},{discrete:!1})};return t.addEventListener("focusin",i),()=>t.removeEventListener("focusin",i)},[t,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function Wv(){const e=new CustomEvent(eh);document.dispatchEvent(e)}function Zw(e,t,n,{discrete:s}){const i=n.originalEvent.target,l=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&i.addEventListener(e,t,{once:!0}),s?Kh(i,l):i.dispatchEvent(l)}var IN=Zo,DN=Xw,Lt=globalThis?.document?p.useLayoutEffect:()=>{},ON="Portal",Ea=p.forwardRef((e,t)=>{const{container:n,...s}=e,[i,l]=p.useState(!1);Lt(()=>l(!0),[]);const c=n||i&&globalThis?.document?.body;return c?Kw.createPortal(a.jsx(Oe.div,{...s,ref:t}),c):null});Ea.displayName=ON;function LN(e,t){return p.useReducer((n,s)=>t[n][s]??n,e)}var In=e=>{const{present:t,children:n}=e,s=MN(t),i=typeof n=="function"?n({present:s.isPresent}):p.Children.only(n),l=qe(s.ref,$N(i));return typeof n=="function"||s.isPresent?p.cloneElement(i,{ref:l}):null};In.displayName="Presence";function MN(e){const[t,n]=p.useState(),s=p.useRef(null),i=p.useRef(e),l=p.useRef("none"),c=e?"mounted":"unmounted",[u,f]=LN(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const h=Yl(s.current);l.current=u==="mounted"?h:"none"},[u]),Lt(()=>{const h=s.current,g=i.current;if(g!==e){const w=l.current,x=Yl(h);e?f("MOUNT"):x==="none"||h?.display==="none"?f("UNMOUNT"):f(g&&w!==x?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,f]),Lt(()=>{if(t){let h;const g=t.ownerDocument.defaultView??window,v=x=>{const C=Yl(s.current).includes(x.animationName);if(x.target===t&&C&&(f("ANIMATION_END"),!i.current)){const b=t.style.animationFillMode;t.style.animationFillMode="forwards",h=g.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=b)})}},w=x=>{x.target===t&&(l.current=Yl(s.current))};return t.addEventListener("animationstart",w),t.addEventListener("animationcancel",v),t.addEventListener("animationend",v),()=>{g.clearTimeout(h),t.removeEventListener("animationstart",w),t.removeEventListener("animationcancel",v),t.removeEventListener("animationend",v)}}else f("ANIMATION_END")},[t,f]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:p.useCallback(h=>{s.current=h?getComputedStyle(h):null,n(h)},[])}}function Yl(e){return e?.animationName||"none"}function $N(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var FN=Gh[" useInsertionEffect ".trim().toString()]||Lt;function gs({prop:e,defaultProp:t,onChange:n=()=>{},caller:s}){const[i,l,c]=UN({defaultProp:t,onChange:n}),u=e!==void 0,f=u?e:i;{const g=p.useRef(e!==void 0);p.useEffect(()=>{const v=g.current;v!==u&&console.warn(`${s} is changing from ${v?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),g.current=u},[u,s])}const h=p.useCallback(g=>{if(u){const v=BN(g)?g(e):g;v!==e&&c.current?.(v)}else l(g)},[u,e,l,c]);return[f,h]}function UN({defaultProp:e,onChange:t}){const[n,s]=p.useState(e),i=p.useRef(n),l=p.useRef(t);return FN(()=>{l.current=t},[t]),p.useEffect(()=>{i.current!==n&&(l.current?.(n),i.current=n)},[n,i]),[n,s,l]}function BN(e){return typeof e=="function"}var ex=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),zN="VisuallyHidden",Jc=p.forwardRef((e,t)=>a.jsx(Oe.span,{...e,ref:t,style:{...ex,...e.style}}));Jc.displayName=zN;var VN=Jc,Yh="ToastProvider",[Jh,HN,WN]=Yc("Toast"),[tx]=Pn("Toast",[WN]),[qN,Qc]=tx(Yh),nx=e=>{const{__scopeToast:t,label:n="Notification",duration:s=5e3,swipeDirection:i="right",swipeThreshold:l=50,children:c}=e,[u,f]=p.useState(null),[h,g]=p.useState(0),v=p.useRef(!1),w=p.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${Yh}\`. Expected non-empty \`string\`.`),a.jsx(Jh.Provider,{scope:t,children:a.jsx(qN,{scope:t,label:n,duration:s,swipeDirection:i,swipeThreshold:l,toastCount:h,viewport:u,onViewportChange:f,onToastAdd:p.useCallback(()=>g(x=>x+1),[]),onToastRemove:p.useCallback(()=>g(x=>x-1),[]),isFocusedToastEscapeKeyDownRef:v,isClosePausedRef:w,children:c})})};nx.displayName=Yh;var rx="ToastViewport",GN=["F8"],th="toast.viewportPause",nh="toast.viewportResume",sx=p.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:s=GN,label:i="Notifications ({hotkey})",...l}=e,c=Qc(rx,n),u=HN(n),f=p.useRef(null),h=p.useRef(null),g=p.useRef(null),v=p.useRef(null),w=qe(t,v,c.onViewportChange),x=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),E=c.toastCount>0;p.useEffect(()=>{const b=k=>{s.length!==0&&s.every(N=>k[N]||k.code===N)&&v.current?.focus()};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[s]),p.useEffect(()=>{const b=f.current,k=v.current;if(E&&b&&k){const _=()=>{if(!c.isClosePausedRef.current){const T=new CustomEvent(th);k.dispatchEvent(T),c.isClosePausedRef.current=!0}},N=()=>{if(c.isClosePausedRef.current){const T=new CustomEvent(nh);k.dispatchEvent(T),c.isClosePausedRef.current=!1}},j=T=>{!b.contains(T.relatedTarget)&&N()},R=()=>{b.contains(document.activeElement)||N()};return b.addEventListener("focusin",_),b.addEventListener("focusout",j),b.addEventListener("pointermove",_),b.addEventListener("pointerleave",R),window.addEventListener("blur",_),window.addEventListener("focus",N),()=>{b.removeEventListener("focusin",_),b.removeEventListener("focusout",j),b.removeEventListener("pointermove",_),b.removeEventListener("pointerleave",R),window.removeEventListener("blur",_),window.removeEventListener("focus",N)}}},[E,c.isClosePausedRef]);const C=p.useCallback(({tabbingDirection:b})=>{const _=u().map(N=>{const j=N.ref.current,R=[j,...ik(j)];return b==="forwards"?R:R.reverse()});return(b==="forwards"?_.reverse():_).flat()},[u]);return p.useEffect(()=>{const b=v.current;if(b){const k=_=>{const N=_.altKey||_.ctrlKey||_.metaKey;if(_.key==="Tab"&&!N){const R=document.activeElement,T=_.shiftKey;if(_.target===b&&T){h.current?.focus();return}const G=C({tabbingDirection:T?"backwards":"forwards"}),L=G.findIndex(F=>F===R);wf(G.slice(L+1))?_.preventDefault():T?h.current?.focus():g.current?.focus()}};return b.addEventListener("keydown",k),()=>b.removeEventListener("keydown",k)}},[u,C]),a.jsxs(DN,{ref:f,role:"region","aria-label":i.replace("{hotkey}",x),tabIndex:-1,style:{pointerEvents:E?void 0:"none"},children:[E&&a.jsx(rh,{ref:h,onFocusFromOutsideViewport:()=>{const b=C({tabbingDirection:"forwards"});wf(b)}}),a.jsx(Jh.Slot,{scope:n,children:a.jsx(Oe.ol,{tabIndex:-1,...l,ref:w})}),E&&a.jsx(rh,{ref:g,onFocusFromOutsideViewport:()=>{const b=C({tabbingDirection:"backwards"});wf(b)}})]})});sx.displayName=rx;var ox="ToastFocusProxy",rh=p.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:s,...i}=e,l=Qc(ox,n);return a.jsx(Jc,{"aria-hidden":!0,tabIndex:0,...i,ref:t,style:{position:"fixed"},onFocus:c=>{const u=c.relatedTarget;!l.viewport?.contains(u)&&s()}})});rh.displayName=ox;var _a="Toast",KN="toast.swipeStart",YN="toast.swipeMove",JN="toast.swipeCancel",QN="toast.swipeEnd",ix=p.forwardRef((e,t)=>{const{forceMount:n,open:s,defaultOpen:i,onOpenChange:l,...c}=e,[u,f]=gs({prop:s,defaultProp:i??!0,onChange:l,caller:_a});return a.jsx(In,{present:n||u,children:a.jsx(ek,{open:u,...c,ref:t,onClose:()=>f(!1),onPause:an(e.onPause),onResume:an(e.onResume),onSwipeStart:ye(e.onSwipeStart,h=>{h.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ye(e.onSwipeMove,h=>{const{x:g,y:v}=h.detail.delta;h.currentTarget.setAttribute("data-swipe","move"),h.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${g}px`),h.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${v}px`)}),onSwipeCancel:ye(e.onSwipeCancel,h=>{h.currentTarget.setAttribute("data-swipe","cancel"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),h.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),h.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ye(e.onSwipeEnd,h=>{const{x:g,y:v}=h.detail.delta;h.currentTarget.setAttribute("data-swipe","end"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),h.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${g}px`),h.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${v}px`),f(!1)})})})});ix.displayName=_a;var[XN,ZN]=tx(_a,{onClose(){}}),ek=p.forwardRef((e,t)=>{const{__scopeToast:n,type:s="foreground",duration:i,open:l,onClose:c,onEscapeKeyDown:u,onPause:f,onResume:h,onSwipeStart:g,onSwipeMove:v,onSwipeCancel:w,onSwipeEnd:x,...E}=e,C=Qc(_a,n),[b,k]=p.useState(null),_=qe(t,M=>k(M)),N=p.useRef(null),j=p.useRef(null),R=i||C.duration,T=p.useRef(0),P=p.useRef(R),O=p.useRef(0),{onToastAdd:G,onToastRemove:L}=C,F=an(()=>{b?.contains(document.activeElement)&&C.viewport?.focus(),c()}),I=p.useCallback(M=>{!M||M===1/0||(window.clearTimeout(O.current),T.current=new Date().getTime(),O.current=window.setTimeout(F,M))},[F]);p.useEffect(()=>{const M=C.viewport;if(M){const B=()=>{I(P.current),h?.()},V=()=>{const ee=new Date().getTime()-T.current;P.current=P.current-ee,window.clearTimeout(O.current),f?.()};return M.addEventListener(th,V),M.addEventListener(nh,B),()=>{M.removeEventListener(th,V),M.removeEventListener(nh,B)}}},[C.viewport,R,f,h,I]),p.useEffect(()=>{l&&!C.isClosePausedRef.current&&I(R)},[l,R,C.isClosePausedRef,I]),p.useEffect(()=>(G(),()=>L()),[G,L]);const U=p.useMemo(()=>b?hx(b):null,[b]);return C.viewport?a.jsxs(a.Fragment,{children:[U&&a.jsx(tk,{__scopeToast:n,role:"status","aria-live":s==="foreground"?"assertive":"polite","aria-atomic":!0,children:U}),a.jsx(XN,{scope:n,onClose:F,children:Xo.createPortal(a.jsx(Jh.ItemSlot,{scope:n,children:a.jsx(IN,{asChild:!0,onEscapeKeyDown:ye(u,()=>{C.isFocusedToastEscapeKeyDownRef.current||F(),C.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(Oe.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":l?"open":"closed","data-swipe-direction":C.swipeDirection,...E,ref:_,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:ye(e.onKeyDown,M=>{M.key==="Escape"&&(u?.(M.nativeEvent),M.nativeEvent.defaultPrevented||(C.isFocusedToastEscapeKeyDownRef.current=!0,F()))}),onPointerDown:ye(e.onPointerDown,M=>{M.button===0&&(N.current={x:M.clientX,y:M.clientY})}),onPointerMove:ye(e.onPointerMove,M=>{if(!N.current)return;const B=M.clientX-N.current.x,V=M.clientY-N.current.y,ee=!!j.current,z=["left","right"].includes(C.swipeDirection),$=["left","up"].includes(C.swipeDirection)?Math.min:Math.max,W=z?$(0,B):0,D=z?0:$(0,V),Q=M.pointerType==="touch"?10:2,le={x:W,y:D},X={originalEvent:M,delta:le};ee?(j.current=le,Jl(YN,v,X,{discrete:!1})):qv(le,C.swipeDirection,Q)?(j.current=le,Jl(KN,g,X,{discrete:!1}),M.target.setPointerCapture(M.pointerId)):(Math.abs(B)>Q||Math.abs(V)>Q)&&(N.current=null)}),onPointerUp:ye(e.onPointerUp,M=>{const B=j.current,V=M.target;if(V.hasPointerCapture(M.pointerId)&&V.releasePointerCapture(M.pointerId),j.current=null,N.current=null,B){const ee=M.currentTarget,z={originalEvent:M,delta:B};qv(B,C.swipeDirection,C.swipeThreshold)?Jl(QN,x,z,{discrete:!0}):Jl(JN,w,z,{discrete:!0}),ee.addEventListener("click",$=>$.preventDefault(),{once:!0})}})})})}),C.viewport)})]}):null}),tk=e=>{const{__scopeToast:t,children:n,...s}=e,i=Qc(_a,t),[l,c]=p.useState(!1),[u,f]=p.useState(!1);return sk(()=>c(!0)),p.useEffect(()=>{const h=window.setTimeout(()=>f(!0),1e3);return()=>window.clearTimeout(h)},[]),u?null:a.jsx(Ea,{asChild:!0,children:a.jsx(Jc,{...s,children:l&&a.jsxs(a.Fragment,{children:[i.label," ",n]})})})},nk="ToastTitle",ax=p.forwardRef((e,t)=>{const{__scopeToast:n,...s}=e;return a.jsx(Oe.div,{...s,ref:t})});ax.displayName=nk;var rk="ToastDescription",lx=p.forwardRef((e,t)=>{const{__scopeToast:n,...s}=e;return a.jsx(Oe.div,{...s,ref:t})});lx.displayName=rk;var cx="ToastAction",dx=p.forwardRef((e,t)=>{const{altText:n,...s}=e;return n.trim()?a.jsx(fx,{altText:n,asChild:!0,children:a.jsx(Qh,{...s,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${cx}\`. Expected non-empty \`string\`.`),null)});dx.displayName=cx;var ux="ToastClose",Qh=p.forwardRef((e,t)=>{const{__scopeToast:n,...s}=e,i=ZN(ux,n);return a.jsx(fx,{asChild:!0,children:a.jsx(Oe.button,{type:"button",...s,ref:t,onClick:ye(e.onClick,i.onClose)})})});Qh.displayName=ux;var fx=p.forwardRef((e,t)=>{const{__scopeToast:n,altText:s,...i}=e;return a.jsx(Oe.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":s||void 0,...i,ref:t})});function hx(e){const t=[];return Array.from(e.childNodes).forEach(s=>{if(s.nodeType===s.TEXT_NODE&&s.textContent&&t.push(s.textContent),ok(s)){const i=s.ariaHidden||s.hidden||s.style.display==="none",l=s.dataset.radixToastAnnounceExclude==="";if(!i)if(l){const c=s.dataset.radixToastAnnounceAlt;c&&t.push(c)}else t.push(...hx(s))}}),t}function Jl(e,t,n,{discrete:s}){const i=n.originalEvent.currentTarget,l=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&i.addEventListener(e,t,{once:!0}),s?Kh(i,l):i.dispatchEvent(l)}var qv=(e,t,n=0)=>{const s=Math.abs(e.x),i=Math.abs(e.y),l=s>i;return t==="left"||t==="right"?l&&s>n:!l&&i>n};function sk(e=()=>{}){const t=an(e);Lt(()=>{let n=0,s=0;return n=window.requestAnimationFrame(()=>s=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(s)}},[t])}function ok(e){return e.nodeType===e.ELEMENT_NODE}function ik(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const i=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||i?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function wf(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}var ak=nx,mx=sx,px=ix,gx=ax,vx=lx,yx=dx,wx=Qh;function xx(e){var t,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=xx(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function bx(){for(var e,t,n=0,s="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=xx(e))&&(s&&(s+=" "),s+=t);return s}const Gv=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Kv=bx,Xc=(e,t)=>n=>{var s;if(t?.variants==null)return Kv(e,n?.class,n?.className);const{variants:i,defaultVariants:l}=t,c=Object.keys(i).map(h=>{const g=n?.[h],v=l?.[h];if(g===null)return null;const w=Gv(g)||Gv(v);return i[h][w]}),u=n&&Object.entries(n).reduce((h,g)=>{let[v,w]=g;return w===void 0||(h[v]=w),h},{}),f=t==null||(s=t.compoundVariants)===null||s===void 0?void 0:s.reduce((h,g)=>{let{class:v,className:w,...x}=g;return Object.entries(x).every(E=>{let[C,b]=E;return Array.isArray(b)?b.includes({...l,...u}[C]):{...l,...u}[C]===b})?[...h,v,w]:h},[]);return Kv(e,c,f,n?.class,n?.className)};const lk=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Cx=(...e)=>e.filter((t,n,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===n).join(" ").trim();var ck={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const dk=p.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:i="",children:l,iconNode:c,...u},f)=>p.createElement("svg",{ref:f,...ck,width:t,height:t,stroke:e,strokeWidth:s?Number(n)*24/Number(t):n,className:Cx("lucide",i),...u},[...c.map(([h,g])=>p.createElement(h,g)),...Array.isArray(l)?l:[l]]));const Ne=(e,t)=>{const n=p.forwardRef(({className:s,...i},l)=>p.createElement(dk,{ref:l,iconNode:t,className:Cx(`lucide-${lk(e)}`,s),...i}));return n.displayName=`${e}`,n};const Sx=Ne("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const uk=Ne("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const Ex=Ne("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);const fk=Ne("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const Jn=Ne("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const _x=Ne("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const Nx=Ne("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const Xh=Ne("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const hk=Ne("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);const kx=Ne("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const Yv=Ne("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const mk=Ne("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const pk=Ne("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const gk=Ne("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const vk=Ne("Cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]);const xf=Ne("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);const Nc=Ne("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);const Jv=Ne("Delete",[["path",{d:"M10 5a2 2 0 0 0-1.344.519l-6.328 5.74a1 1 0 0 0 0 1.481l6.328 5.741A2 2 0 0 0 10 19h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z",key:"1yo7s0"}],["path",{d:"m12 9 6 6",key:"anjzzh"}],["path",{d:"m18 9-6 6",key:"1fp51s"}]]);const yk=Ne("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);const Qv=Ne("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);const kc=Ne("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);const wk=Ne("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const Xv=Ne("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);const bf=Ne("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);const Ys=Ne("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);const jc=Ne("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);const Zv=Ne("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);const cs=Ne("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const xk=Ne("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);const ey=Ne("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const bk=Ne("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);const Ck=Ne("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);const Na=Ne("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);const Sk=Ne("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);const Ek=Ne("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);const _k=Ne("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);const Nk=Ne("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);const kk=Ne("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);const ka=Ne("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);const jk=Ne("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const Cf=Ne("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);const Tk=Ne("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);const ds=Ne("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const Ak=Ne("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const Rk=Ne("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);const jx=Ne("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const Zc=Ne("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);const xc=Ne("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);const ty=Ne("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);const Gs=Ne("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);const Pk=Ne("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);const Ik=Ne("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]);const Zh=Ne("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const aa=Ne("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const Dk=Ne("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);const la=Ne("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);const Ok=Ne("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const em=Ne("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);const ny=Ne("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const Lk=Ne("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);const Rr=Ne("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),tm="-",Mk=e=>{const t=Fk(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:c=>{const u=c.split(tm);return u[0]===""&&u.length!==1&&u.shift(),Tx(u,t)||$k(c)},getConflictingClassGroupIds:(c,u)=>{const f=n[c]||[];return u&&s[c]?[...f,...s[c]]:f}}},Tx=(e,t)=>{if(e.length===0)return t.classGroupId;const n=e[0],s=t.nextPart.get(n),i=s?Tx(e.slice(1),s):void 0;if(i)return i;if(t.validators.length===0)return;const l=e.join(tm);return t.validators.find(({validator:c})=>c(l))?.classGroupId},ry=/^\[(.+)\]$/,$k=e=>{if(ry.test(e)){const t=ry.exec(e)[1],n=t?.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},Fk=e=>{const{theme:t,prefix:n}=e,s={nextPart:new Map,validators:[]};return Bk(Object.entries(e.classGroups),n).forEach(([l,c])=>{sh(c,s,l,t)}),s},sh=(e,t,n,s)=>{e.forEach(i=>{if(typeof i=="string"){const l=i===""?t:sy(t,i);l.classGroupId=n;return}if(typeof i=="function"){if(Uk(i)){sh(i(s),t,n,s);return}t.validators.push({validator:i,classGroupId:n});return}Object.entries(i).forEach(([l,c])=>{sh(c,sy(t,l),n,s)})})},sy=(e,t)=>{let n=e;return t.split(tm).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},Uk=e=>e.isThemeGetter,Bk=(e,t)=>t?e.map(([n,s])=>{const i=s.map(l=>typeof l=="string"?t+l:typeof l=="object"?Object.fromEntries(Object.entries(l).map(([c,u])=>[t+c,u])):l);return[n,i]}):e,zk=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,s=new Map;const i=(l,c)=>{n.set(l,c),t++,t>e&&(t=0,s=n,n=new Map)};return{get(l){let c=n.get(l);if(c!==void 0)return c;if((c=s.get(l))!==void 0)return i(l,c),c},set(l,c){n.has(l)?n.set(l,c):i(l,c)}}},Ax="!",Vk=e=>{const{separator:t,experimentalParseClassName:n}=e,s=t.length===1,i=t[0],l=t.length,c=u=>{const f=[];let h=0,g=0,v;for(let b=0;b<u.length;b++){let k=u[b];if(h===0){if(k===i&&(s||u.slice(b,b+l)===t)){f.push(u.slice(g,b)),g=b+l;continue}if(k==="/"){v=b;continue}}k==="["?h++:k==="]"&&h--}const w=f.length===0?u:u.substring(g),x=w.startsWith(Ax),E=x?w.substring(1):w,C=v&&v>g?v-g:void 0;return{modifiers:f,hasImportantModifier:x,baseClassName:E,maybePostfixModifierPosition:C}};return n?u=>n({className:u,parseClassName:c}):c},Hk=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(s=>{s[0]==="["?(t.push(...n.sort(),s),n=[]):n.push(s)}),t.push(...n.sort()),t},Wk=e=>({cache:zk(e.cacheSize),parseClassName:Vk(e),...Mk(e)}),qk=/\s+/,Gk=(e,t)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:i}=t,l=[],c=e.trim().split(qk);let u="";for(let f=c.length-1;f>=0;f-=1){const h=c[f],{modifiers:g,hasImportantModifier:v,baseClassName:w,maybePostfixModifierPosition:x}=n(h);let E=!!x,C=s(E?w.substring(0,x):w);if(!C){if(!E){u=h+(u.length>0?" "+u:u);continue}if(C=s(w),!C){u=h+(u.length>0?" "+u:u);continue}E=!1}const b=Hk(g).join(":"),k=v?b+Ax:b,_=k+C;if(l.includes(_))continue;l.push(_);const N=i(C,E);for(let j=0;j<N.length;++j){const R=N[j];l.push(k+R)}u=h+(u.length>0?" "+u:u)}return u};function Kk(){let e=0,t,n,s="";for(;e<arguments.length;)(t=arguments[e++])&&(n=Rx(t))&&(s&&(s+=" "),s+=n);return s}const Rx=e=>{if(typeof e=="string")return e;let t,n="";for(let s=0;s<e.length;s++)e[s]&&(t=Rx(e[s]))&&(n&&(n+=" "),n+=t);return n};function Yk(e,...t){let n,s,i,l=c;function c(f){const h=t.reduce((g,v)=>v(g),e());return n=Wk(h),s=n.cache.get,i=n.cache.set,l=u,u(f)}function u(f){const h=s(f);if(h)return h;const g=Gk(f,n);return i(f,g),g}return function(){return l(Kk.apply(null,arguments))}}const it=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},Px=/^\[(?:([a-z-]+):)?(.+)\]$/i,Jk=/^\d+\/\d+$/,Qk=new Set(["px","full","screen"]),Xk=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Zk=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ej=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,tj=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,nj=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,jr=e=>Uo(e)||Qk.has(e)||Jk.test(e),ss=e=>ei(e,"length",dj),Uo=e=>!!e&&!Number.isNaN(Number(e)),Sf=e=>ei(e,"number",Uo),qi=e=>!!e&&Number.isInteger(Number(e)),rj=e=>e.endsWith("%")&&Uo(e.slice(0,-1)),ze=e=>Px.test(e),os=e=>Xk.test(e),sj=new Set(["length","size","percentage"]),oj=e=>ei(e,sj,Ix),ij=e=>ei(e,"position",Ix),aj=new Set(["image","url"]),lj=e=>ei(e,aj,fj),cj=e=>ei(e,"",uj),Gi=()=>!0,ei=(e,t,n)=>{const s=Px.exec(e);return s?s[1]?typeof t=="string"?s[1]===t:t.has(s[1]):n(s[2]):!1},dj=e=>Zk.test(e)&&!ej.test(e),Ix=()=>!1,uj=e=>tj.test(e),fj=e=>nj.test(e),hj=()=>{const e=it("colors"),t=it("spacing"),n=it("blur"),s=it("brightness"),i=it("borderColor"),l=it("borderRadius"),c=it("borderSpacing"),u=it("borderWidth"),f=it("contrast"),h=it("grayscale"),g=it("hueRotate"),v=it("invert"),w=it("gap"),x=it("gradientColorStops"),E=it("gradientColorStopPositions"),C=it("inset"),b=it("margin"),k=it("opacity"),_=it("padding"),N=it("saturate"),j=it("scale"),R=it("sepia"),T=it("skew"),P=it("space"),O=it("translate"),G=()=>["auto","contain","none"],L=()=>["auto","hidden","clip","visible","scroll"],F=()=>["auto",ze,t],I=()=>[ze,t],U=()=>["",jr,ss],M=()=>["auto",Uo,ze],B=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],V=()=>["solid","dashed","dotted","double","none"],ee=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],z=()=>["start","end","center","between","around","evenly","stretch"],$=()=>["","0",ze],W=()=>["auto","avoid","all","avoid-page","page","left","right","column"],D=()=>[Uo,ze];return{cacheSize:500,separator:":",theme:{colors:[Gi],spacing:[jr,ss],blur:["none","",os,ze],brightness:D(),borderColor:[e],borderRadius:["none","","full",os,ze],borderSpacing:I(),borderWidth:U(),contrast:D(),grayscale:$(),hueRotate:D(),invert:$(),gap:I(),gradientColorStops:[e],gradientColorStopPositions:[rj,ss],inset:F(),margin:F(),opacity:D(),padding:I(),saturate:D(),scale:D(),sepia:$(),skew:D(),space:I(),translate:I()},classGroups:{aspect:[{aspect:["auto","square","video",ze]}],container:["container"],columns:[{columns:[os]}],"break-after":[{"break-after":W()}],"break-before":[{"break-before":W()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...B(),ze]}],overflow:[{overflow:L()}],"overflow-x":[{"overflow-x":L()}],"overflow-y":[{"overflow-y":L()}],overscroll:[{overscroll:G()}],"overscroll-x":[{"overscroll-x":G()}],"overscroll-y":[{"overscroll-y":G()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[C]}],"inset-x":[{"inset-x":[C]}],"inset-y":[{"inset-y":[C]}],start:[{start:[C]}],end:[{end:[C]}],top:[{top:[C]}],right:[{right:[C]}],bottom:[{bottom:[C]}],left:[{left:[C]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",qi,ze]}],basis:[{basis:F()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ze]}],grow:[{grow:$()}],shrink:[{shrink:$()}],order:[{order:["first","last","none",qi,ze]}],"grid-cols":[{"grid-cols":[Gi]}],"col-start-end":[{col:["auto",{span:["full",qi,ze]},ze]}],"col-start":[{"col-start":M()}],"col-end":[{"col-end":M()}],"grid-rows":[{"grid-rows":[Gi]}],"row-start-end":[{row:["auto",{span:[qi,ze]},ze]}],"row-start":[{"row-start":M()}],"row-end":[{"row-end":M()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ze]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ze]}],gap:[{gap:[w]}],"gap-x":[{"gap-x":[w]}],"gap-y":[{"gap-y":[w]}],"justify-content":[{justify:["normal",...z()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...z(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...z(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[_]}],px:[{px:[_]}],py:[{py:[_]}],ps:[{ps:[_]}],pe:[{pe:[_]}],pt:[{pt:[_]}],pr:[{pr:[_]}],pb:[{pb:[_]}],pl:[{pl:[_]}],m:[{m:[b]}],mx:[{mx:[b]}],my:[{my:[b]}],ms:[{ms:[b]}],me:[{me:[b]}],mt:[{mt:[b]}],mr:[{mr:[b]}],mb:[{mb:[b]}],ml:[{ml:[b]}],"space-x":[{"space-x":[P]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[P]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ze,t]}],"min-w":[{"min-w":[ze,t,"min","max","fit"]}],"max-w":[{"max-w":[ze,t,"none","full","min","max","fit","prose",{screen:[os]},os]}],h:[{h:[ze,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ze,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ze,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ze,t,"auto","min","max","fit"]}],"font-size":[{text:["base",os,ss]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Sf]}],"font-family":[{font:[Gi]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ze]}],"line-clamp":[{"line-clamp":["none",Uo,Sf]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",jr,ze]}],"list-image":[{"list-image":["none",ze]}],"list-style-type":[{list:["none","disc","decimal",ze]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[k]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[k]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...V(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",jr,ss]}],"underline-offset":[{"underline-offset":["auto",jr,ze]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:I()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ze]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ze]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[k]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...B(),ij]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",oj]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},lj]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[E]}],"gradient-via-pos":[{via:[E]}],"gradient-to-pos":[{to:[E]}],"gradient-from":[{from:[x]}],"gradient-via":[{via:[x]}],"gradient-to":[{to:[x]}],rounded:[{rounded:[l]}],"rounded-s":[{"rounded-s":[l]}],"rounded-e":[{"rounded-e":[l]}],"rounded-t":[{"rounded-t":[l]}],"rounded-r":[{"rounded-r":[l]}],"rounded-b":[{"rounded-b":[l]}],"rounded-l":[{"rounded-l":[l]}],"rounded-ss":[{"rounded-ss":[l]}],"rounded-se":[{"rounded-se":[l]}],"rounded-ee":[{"rounded-ee":[l]}],"rounded-es":[{"rounded-es":[l]}],"rounded-tl":[{"rounded-tl":[l]}],"rounded-tr":[{"rounded-tr":[l]}],"rounded-br":[{"rounded-br":[l]}],"rounded-bl":[{"rounded-bl":[l]}],"border-w":[{border:[u]}],"border-w-x":[{"border-x":[u]}],"border-w-y":[{"border-y":[u]}],"border-w-s":[{"border-s":[u]}],"border-w-e":[{"border-e":[u]}],"border-w-t":[{"border-t":[u]}],"border-w-r":[{"border-r":[u]}],"border-w-b":[{"border-b":[u]}],"border-w-l":[{"border-l":[u]}],"border-opacity":[{"border-opacity":[k]}],"border-style":[{border:[...V(),"hidden"]}],"divide-x":[{"divide-x":[u]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[u]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[k]}],"divide-style":[{divide:V()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...V()]}],"outline-offset":[{"outline-offset":[jr,ze]}],"outline-w":[{outline:[jr,ss]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:U()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[k]}],"ring-offset-w":[{"ring-offset":[jr,ss]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",os,cj]}],"shadow-color":[{shadow:[Gi]}],opacity:[{opacity:[k]}],"mix-blend":[{"mix-blend":[...ee(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ee()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[f]}],"drop-shadow":[{"drop-shadow":["","none",os,ze]}],grayscale:[{grayscale:[h]}],"hue-rotate":[{"hue-rotate":[g]}],invert:[{invert:[v]}],saturate:[{saturate:[N]}],sepia:[{sepia:[R]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[f]}],"backdrop-grayscale":[{"backdrop-grayscale":[h]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[g]}],"backdrop-invert":[{"backdrop-invert":[v]}],"backdrop-opacity":[{"backdrop-opacity":[k]}],"backdrop-saturate":[{"backdrop-saturate":[N]}],"backdrop-sepia":[{"backdrop-sepia":[R]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ze]}],duration:[{duration:D()}],ease:[{ease:["linear","in","out","in-out",ze]}],delay:[{delay:D()}],animate:[{animate:["none","spin","ping","pulse","bounce",ze]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[qi,ze]}],"translate-x":[{"translate-x":[O]}],"translate-y":[{"translate-y":[O]}],"skew-x":[{"skew-x":[T]}],"skew-y":[{"skew-y":[T]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ze]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ze]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":I()}],"scroll-mx":[{"scroll-mx":I()}],"scroll-my":[{"scroll-my":I()}],"scroll-ms":[{"scroll-ms":I()}],"scroll-me":[{"scroll-me":I()}],"scroll-mt":[{"scroll-mt":I()}],"scroll-mr":[{"scroll-mr":I()}],"scroll-mb":[{"scroll-mb":I()}],"scroll-ml":[{"scroll-ml":I()}],"scroll-p":[{"scroll-p":I()}],"scroll-px":[{"scroll-px":I()}],"scroll-py":[{"scroll-py":I()}],"scroll-ps":[{"scroll-ps":I()}],"scroll-pe":[{"scroll-pe":I()}],"scroll-pt":[{"scroll-pt":I()}],"scroll-pr":[{"scroll-pr":I()}],"scroll-pb":[{"scroll-pb":I()}],"scroll-pl":[{"scroll-pl":I()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ze]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[jr,ss,Sf]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},mj=Yk(hj);function be(...e){return mj(bx(e))}const pj=ak,Dx=p.forwardRef(({className:e,...t},n)=>a.jsx(mx,{ref:n,className:be("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));Dx.displayName=mx.displayName;const gj=Xc("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground",message:"border-primary bg-primary text-primary-foreground shadow-lg ring-2 ring-primary/30",success:"border-green-500 bg-green-50 dark:bg-green-950 text-green-900 dark:text-green-100 shadow-lg ring-2 ring-green-500/30"}},defaultVariants:{variant:"default"}}),Ox=p.forwardRef(({className:e,variant:t,swipeDirection:n,...s},i)=>a.jsx(px,{ref:i,className:be(gj({variant:t}),e),...s}));Ox.displayName=px.displayName;const vj=p.forwardRef(({className:e,...t},n)=>a.jsx(yx,{ref:n,className:be("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",e),...t}));vj.displayName=yx.displayName;const Lx=p.forwardRef(({className:e,...t},n)=>a.jsx(wx,{ref:n,className:be("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:a.jsx(Rr,{className:"h-4 w-4"})}));Lx.displayName=wx.displayName;const Mx=p.forwardRef(({className:e,...t},n)=>a.jsx(gx,{ref:n,className:be("text-sm font-semibold group-[.custom-child-color]:text-white group-[.custom-parent-color]:text-white",e),...t}));Mx.displayName=gx.displayName;const $x=p.forwardRef(({className:e,...t},n)=>a.jsx(vx,{ref:n,className:be("text-sm opacity-90 group-[.message]:opacity-100 group-[.message]:text-primary-foreground group-[.custom-child-color]:opacity-100 group-[.custom-child-color]:text-white group-[.custom-parent-color]:opacity-100 group-[.custom-parent-color]:text-white",e),...t}));$x.displayName=vx.displayName;function yj(){const{toasts:e}=Ct();return a.jsxs(pj,{swipeDirection:"right",duration:5e3,children:[e.map(function({id:t,title:n,description:s,action:i,swipeDirection:l,...c}){return a.jsxs(Ox,{...c,children:[a.jsxs("div",{className:"grid gap-1",children:[n&&a.jsx(Mx,{children:n}),s&&a.jsx($x,{children:s})]}),i,a.jsx(Lx,{})]},t)}),a.jsx(Dx,{})]})}var oy=["light","dark"],wj="(prefers-color-scheme: dark)",xj=p.createContext(void 0),bj={setTheme:e=>{},themes:[]},Cj=()=>{var e;return(e=p.useContext(xj))!=null?e:bj};p.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:s,enableColorScheme:i,defaultTheme:l,value:c,attrs:u,nonce:f})=>{let h=l==="system",g=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${u.map(E=>`'${E}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,v=i?oy.includes(l)&&l?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${l}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",w=(E,C=!1,b=!0)=>{let k=c?c[E]:E,_=C?E+"|| ''":`'${k}'`,N="";return i&&b&&!C&&oy.includes(E)&&(N+=`d.style.colorScheme = '${E}';`),n==="class"?C||k?N+=`c.add(${_})`:N+="null":k&&(N+=`d[s](n,${_})`),N},x=e?`!function(){${g}${w(e)}}()`:s?`!function(){try{${g}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${h})){var t='${wj}',m=window.matchMedia(t);if(m.media!==t||m.matches){${w("dark")}}else{${w("light")}}}else if(e){${c?`var x=${JSON.stringify(c)};`:""}${w(c?"x[e]":"e",!0)}}${h?"":"else{"+w(l,!1,!1)+"}"}${v}}catch(e){}}()`:`!function(){try{${g}var e=localStorage.getItem('${t}');if(e){${c?`var x=${JSON.stringify(c)};`:""}${w(c?"x[e]":"e",!0)}}else{${w(l,!1,!1)};}${v}}catch(t){}}();`;return p.createElement("script",{nonce:f,dangerouslySetInnerHTML:{__html:x}})});var Sj=e=>{switch(e){case"success":return Nj;case"info":return jj;case"warning":return kj;case"error":return Tj;default:return null}},Ej=Array(12).fill(0),_j=({visible:e,className:t})=>pe.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},pe.createElement("div",{className:"sonner-spinner"},Ej.map((n,s)=>pe.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${s}`})))),Nj=pe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},pe.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),kj=pe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},pe.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),jj=pe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},pe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Tj=pe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},pe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Aj=pe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},pe.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),pe.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Rj=()=>{let[e,t]=pe.useState(document.hidden);return pe.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},oh=1,Pj=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:n,...s}=e,i=typeof e?.id=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:oh++,l=this.toasts.find(u=>u.id===i),c=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),l?this.toasts=this.toasts.map(u=>u.id===i?(this.publish({...u,...e,id:i,title:n}),{...u,...e,id:i,dismissible:c,title:n}):u):this.addToast({title:n,...s,dismissible:c,id:i}),i},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let s=e instanceof Promise?e:e(),i=n!==void 0,l,c=s.then(async f=>{if(l=["resolve",f],pe.isValidElement(f))i=!1,this.create({id:n,type:"default",message:f});else if(Dj(f)&&!f.ok){i=!1;let h=typeof t.error=="function"?await t.error(`HTTP error! status: ${f.status}`):t.error,g=typeof t.description=="function"?await t.description(`HTTP error! status: ${f.status}`):t.description;this.create({id:n,type:"error",message:h,description:g})}else if(t.success!==void 0){i=!1;let h=typeof t.success=="function"?await t.success(f):t.success,g=typeof t.description=="function"?await t.description(f):t.description;this.create({id:n,type:"success",message:h,description:g})}}).catch(async f=>{if(l=["reject",f],t.error!==void 0){i=!1;let h=typeof t.error=="function"?await t.error(f):t.error,g=typeof t.description=="function"?await t.description(f):t.description;this.create({id:n,type:"error",message:h,description:g})}}).finally(()=>{var f;i&&(this.dismiss(n),n=void 0),(f=t.finally)==null||f.call(t)}),u=()=>new Promise((f,h)=>c.then(()=>l[0]==="reject"?h(l[1]):f(l[1])).catch(h));return typeof n!="string"&&typeof n!="number"?{unwrap:u}:Object.assign(n,{unwrap:u})},this.custom=(e,t)=>{let n=t?.id||oh++;return this.create({jsx:e(n),id:n,...t}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},on=new Pj,Ij=(e,t)=>{let n=t?.id||oh++;return on.addToast({title:e,...t,id:n}),n},Dj=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",Oj=Ij,Lj=()=>on.toasts,Mj=()=>on.getActiveToasts();Object.assign(Oj,{success:on.success,info:on.info,warning:on.warning,error:on.error,custom:on.custom,message:on.message,promise:on.promise,dismiss:on.dismiss,loading:on.loading},{getHistory:Lj,getToasts:Mj});function $j(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",t==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}$j(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Ql(e){return e.label!==void 0}var Fj=3,Uj="32px",Bj="16px",iy=4e3,zj=356,Vj=14,Hj=20,Wj=200;function Vn(...e){return e.filter(Boolean).join(" ")}function qj(e){let[t,n]=e.split("-"),s=[];return t&&s.push(t),n&&s.push(n),s}var Gj=e=>{var t,n,s,i,l,c,u,f,h,g,v;let{invert:w,toast:x,unstyled:E,interacting:C,setHeights:b,visibleToasts:k,heights:_,index:N,toasts:j,expanded:R,removeToast:T,defaultRichColors:P,closeButton:O,style:G,cancelButtonStyle:L,actionButtonStyle:F,className:I="",descriptionClassName:U="",duration:M,position:B,gap:V,loadingIcon:ee,expandByDefault:z,classNames:$,icons:W,closeButtonAriaLabel:D="Close toast",pauseWhenPageIsHidden:Q}=e,[le,X]=pe.useState(null),[K,te]=pe.useState(null),[q,se]=pe.useState(!1),[fe,ge]=pe.useState(!1),[we,Re]=pe.useState(!1),[Be,We]=pe.useState(!1),[Ge,ie]=pe.useState(!1),[Pe,ae]=pe.useState(0),[ve,_e]=pe.useState(0),Ue=pe.useRef(x.duration||M||iy),ft=pe.useRef(null),Je=pe.useRef(null),wt=N===0,at=N+1<=k,ht=x.type,He=x.dismissible!==!1,$e=x.className||"",Mt=x.descriptionClassName||"",Tt=pe.useMemo(()=>_.findIndex(Fe=>Fe.toastId===x.id)||0,[_,x.id]),yr=pe.useMemo(()=>{var Fe;return(Fe=x.closeButton)!=null?Fe:O},[x.closeButton,O]),_s=pe.useMemo(()=>x.duration||M||iy,[x.duration,M]),Mr=pe.useRef(0),wr=pe.useRef(0),Fa=pe.useRef(0),nr=pe.useRef(null),[ci,di]=B.split("-"),ro=pe.useMemo(()=>_.reduce((Fe,Qe,et)=>et>=Tt?Fe:Fe+Qe.height,0),[_,Tt]),so=Rj(),$r=x.invert||w,rr=ht==="loading";wr.current=pe.useMemo(()=>Tt*V+ro,[Tt,ro]),pe.useEffect(()=>{Ue.current=_s},[_s]),pe.useEffect(()=>{se(!0)},[]),pe.useEffect(()=>{let Fe=Je.current;if(Fe){let Qe=Fe.getBoundingClientRect().height;return _e(Qe),b(et=>[{toastId:x.id,height:Qe,position:x.position},...et]),()=>b(et=>et.filter(Vt=>Vt.toastId!==x.id))}},[b,x.id]),pe.useLayoutEffect(()=>{if(!q)return;let Fe=Je.current,Qe=Fe.style.height;Fe.style.height="auto";let et=Fe.getBoundingClientRect().height;Fe.style.height=Qe,_e(et),b(Vt=>Vt.find(Qt=>Qt.toastId===x.id)?Vt.map(Qt=>Qt.toastId===x.id?{...Qt,height:et}:Qt):[{toastId:x.id,height:et,position:x.position},...Vt])},[q,x.title,x.description,b,x.id]);let Dn=pe.useCallback(()=>{ge(!0),ae(wr.current),b(Fe=>Fe.filter(Qe=>Qe.toastId!==x.id)),setTimeout(()=>{T(x)},Wj)},[x,T,b,wr]);pe.useEffect(()=>{if(x.promise&&ht==="loading"||x.duration===1/0||x.type==="loading")return;let Fe;return R||C||Q&&so?(()=>{if(Fa.current<Mr.current){let Qe=new Date().getTime()-Mr.current;Ue.current=Ue.current-Qe}Fa.current=new Date().getTime()})():Ue.current!==1/0&&(Mr.current=new Date().getTime(),Fe=setTimeout(()=>{var Qe;(Qe=x.onAutoClose)==null||Qe.call(x,x),Dn()},Ue.current)),()=>clearTimeout(Fe)},[R,C,x,ht,Q,so,Dn]),pe.useEffect(()=>{x.delete&&Dn()},[Dn,x.delete]);function Ua(){var Fe,Qe,et;return W!=null&&W.loading?pe.createElement("div",{className:Vn($?.loader,(Fe=x?.classNames)==null?void 0:Fe.loader,"sonner-loader"),"data-visible":ht==="loading"},W.loading):ee?pe.createElement("div",{className:Vn($?.loader,(Qe=x?.classNames)==null?void 0:Qe.loader,"sonner-loader"),"data-visible":ht==="loading"},ee):pe.createElement(_j,{className:Vn($?.loader,(et=x?.classNames)==null?void 0:et.loader),visible:ht==="loading"})}return pe.createElement("li",{tabIndex:0,ref:Je,className:Vn(I,$e,$?.toast,(t=x?.classNames)==null?void 0:t.toast,$?.default,$?.[ht],(n=x?.classNames)==null?void 0:n[ht]),"data-sonner-toast":"","data-rich-colors":(s=x.richColors)!=null?s:P,"data-styled":!(x.jsx||x.unstyled||E),"data-mounted":q,"data-promise":!!x.promise,"data-swiped":Ge,"data-removed":fe,"data-visible":at,"data-y-position":ci,"data-x-position":di,"data-index":N,"data-front":wt,"data-swiping":we,"data-dismissible":He,"data-type":ht,"data-invert":$r,"data-swipe-out":Be,"data-swipe-direction":K,"data-expanded":!!(R||z&&q),style:{"--index":N,"--toasts-before":N,"--z-index":j.length-N,"--offset":`${fe?Pe:wr.current}px`,"--initial-height":z?"auto":`${ve}px`,...G,...x.style},onDragEnd:()=>{Re(!1),X(null),nr.current=null},onPointerDown:Fe=>{rr||!He||(ft.current=new Date,ae(wr.current),Fe.target.setPointerCapture(Fe.pointerId),Fe.target.tagName!=="BUTTON"&&(Re(!0),nr.current={x:Fe.clientX,y:Fe.clientY}))},onPointerUp:()=>{var Fe,Qe,et,Vt;if(Be||!He)return;nr.current=null;let Qt=Number(((Fe=Je.current)==null?void 0:Fe.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Xt=Number(((Qe=Je.current)==null?void 0:Qe.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),On=new Date().getTime()-((et=ft.current)==null?void 0:et.getTime()),At=le==="x"?Qt:Xt,sr=Math.abs(At)/On;if(Math.abs(At)>=Hj||sr>.11){ae(wr.current),(Vt=x.onDismiss)==null||Vt.call(x,x),te(le==="x"?Qt>0?"right":"left":Xt>0?"down":"up"),Dn(),We(!0),ie(!1);return}Re(!1),X(null)},onPointerMove:Fe=>{var Qe,et,Vt,Qt;if(!nr.current||!He||((Qe=window.getSelection())==null?void 0:Qe.toString().length)>0)return;let Xt=Fe.clientY-nr.current.y,On=Fe.clientX-nr.current.x,At=(et=e.swipeDirections)!=null?et:qj(B);!le&&(Math.abs(On)>1||Math.abs(Xt)>1)&&X(Math.abs(On)>Math.abs(Xt)?"x":"y");let sr={x:0,y:0};le==="y"?(At.includes("top")||At.includes("bottom"))&&(At.includes("top")&&Xt<0||At.includes("bottom")&&Xt>0)&&(sr.y=Xt):le==="x"&&(At.includes("left")||At.includes("right"))&&(At.includes("left")&&On<0||At.includes("right")&&On>0)&&(sr.x=On),(Math.abs(sr.x)>0||Math.abs(sr.y)>0)&&ie(!0),(Vt=Je.current)==null||Vt.style.setProperty("--swipe-amount-x",`${sr.x}px`),(Qt=Je.current)==null||Qt.style.setProperty("--swipe-amount-y",`${sr.y}px`)}},yr&&!x.jsx?pe.createElement("button",{"aria-label":D,"data-disabled":rr,"data-close-button":!0,onClick:rr||!He?()=>{}:()=>{var Fe;Dn(),(Fe=x.onDismiss)==null||Fe.call(x,x)},className:Vn($?.closeButton,(i=x?.classNames)==null?void 0:i.closeButton)},(l=W?.close)!=null?l:Aj):null,x.jsx||p.isValidElement(x.title)?x.jsx?x.jsx:typeof x.title=="function"?x.title():x.title:pe.createElement(pe.Fragment,null,ht||x.icon||x.promise?pe.createElement("div",{"data-icon":"",className:Vn($?.icon,(c=x?.classNames)==null?void 0:c.icon)},x.promise||x.type==="loading"&&!x.icon?x.icon||Ua():null,x.type!=="loading"?x.icon||W?.[ht]||Sj(ht):null):null,pe.createElement("div",{"data-content":"",className:Vn($?.content,(u=x?.classNames)==null?void 0:u.content)},pe.createElement("div",{"data-title":"",className:Vn($?.title,(f=x?.classNames)==null?void 0:f.title)},typeof x.title=="function"?x.title():x.title),x.description?pe.createElement("div",{"data-description":"",className:Vn(U,Mt,$?.description,(h=x?.classNames)==null?void 0:h.description)},typeof x.description=="function"?x.description():x.description):null),p.isValidElement(x.cancel)?x.cancel:x.cancel&&Ql(x.cancel)?pe.createElement("button",{"data-button":!0,"data-cancel":!0,style:x.cancelButtonStyle||L,onClick:Fe=>{var Qe,et;Ql(x.cancel)&&He&&((et=(Qe=x.cancel).onClick)==null||et.call(Qe,Fe),Dn())},className:Vn($?.cancelButton,(g=x?.classNames)==null?void 0:g.cancelButton)},x.cancel.label):null,p.isValidElement(x.action)?x.action:x.action&&Ql(x.action)?pe.createElement("button",{"data-button":!0,"data-action":!0,style:x.actionButtonStyle||F,onClick:Fe=>{var Qe,et;Ql(x.action)&&((et=(Qe=x.action).onClick)==null||et.call(Qe,Fe),!Fe.defaultPrevented&&Dn())},className:Vn($?.actionButton,(v=x?.classNames)==null?void 0:v.actionButton)},x.action.label):null))};function ay(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Kj(e,t){let n={};return[e,t].forEach((s,i)=>{let l=i===1,c=l?"--mobile-offset":"--offset",u=l?Bj:Uj;function f(h){["top","right","bottom","left"].forEach(g=>{n[`${c}-${g}`]=typeof h=="number"?`${h}px`:h})}typeof s=="number"||typeof s=="string"?f(s):typeof s=="object"?["top","right","bottom","left"].forEach(h=>{s[h]===void 0?n[`${c}-${h}`]=u:n[`${c}-${h}`]=typeof s[h]=="number"?`${s[h]}px`:s[h]}):f(u)}),n}var Yj=p.forwardRef(function(e,t){let{invert:n,position:s="bottom-right",hotkey:i=["altKey","KeyT"],expand:l,closeButton:c,className:u,offset:f,mobileOffset:h,theme:g="light",richColors:v,duration:w,style:x,visibleToasts:E=Fj,toastOptions:C,dir:b=ay(),gap:k=Vj,loadingIcon:_,icons:N,containerAriaLabel:j="Notifications",pauseWhenPageIsHidden:R}=e,[T,P]=pe.useState([]),O=pe.useMemo(()=>Array.from(new Set([s].concat(T.filter(Q=>Q.position).map(Q=>Q.position)))),[T,s]),[G,L]=pe.useState([]),[F,I]=pe.useState(!1),[U,M]=pe.useState(!1),[B,V]=pe.useState(g!=="system"?g:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),ee=pe.useRef(null),z=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),$=pe.useRef(null),W=pe.useRef(!1),D=pe.useCallback(Q=>{P(le=>{var X;return(X=le.find(K=>K.id===Q.id))!=null&&X.delete||on.dismiss(Q.id),le.filter(({id:K})=>K!==Q.id)})},[]);return pe.useEffect(()=>on.subscribe(Q=>{if(Q.dismiss){P(le=>le.map(X=>X.id===Q.id?{...X,delete:!0}:X));return}setTimeout(()=>{Kw.flushSync(()=>{P(le=>{let X=le.findIndex(K=>K.id===Q.id);return X!==-1?[...le.slice(0,X),{...le[X],...Q},...le.slice(X+1)]:[Q,...le]})})})}),[]),pe.useEffect(()=>{if(g!=="system"){V(g);return}if(g==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?V("dark"):V("light")),typeof window>"u")return;let Q=window.matchMedia("(prefers-color-scheme: dark)");try{Q.addEventListener("change",({matches:le})=>{V(le?"dark":"light")})}catch{Q.addListener(({matches:X})=>{try{V(X?"dark":"light")}catch(K){console.error(K)}})}},[g]),pe.useEffect(()=>{T.length<=1&&I(!1)},[T]),pe.useEffect(()=>{let Q=le=>{var X,K;i.every(te=>le[te]||le.code===te)&&(I(!0),(X=ee.current)==null||X.focus()),le.code==="Escape"&&(document.activeElement===ee.current||(K=ee.current)!=null&&K.contains(document.activeElement))&&I(!1)};return document.addEventListener("keydown",Q),()=>document.removeEventListener("keydown",Q)},[i]),pe.useEffect(()=>{if(ee.current)return()=>{$.current&&($.current.focus({preventScroll:!0}),$.current=null,W.current=!1)}},[ee.current]),pe.createElement("section",{ref:t,"aria-label":`${j} ${z}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},O.map((Q,le)=>{var X;let[K,te]=Q.split("-");return T.length?pe.createElement("ol",{key:Q,dir:b==="auto"?ay():b,tabIndex:-1,ref:ee,className:u,"data-sonner-toaster":!0,"data-theme":B,"data-y-position":K,"data-lifted":F&&T.length>1&&!l,"data-x-position":te,style:{"--front-toast-height":`${((X=G[0])==null?void 0:X.height)||0}px`,"--width":`${zj}px`,"--gap":`${k}px`,...x,...Kj(f,h)},onBlur:q=>{W.current&&!q.currentTarget.contains(q.relatedTarget)&&(W.current=!1,$.current&&($.current.focus({preventScroll:!0}),$.current=null))},onFocus:q=>{q.target instanceof HTMLElement&&q.target.dataset.dismissible==="false"||W.current||(W.current=!0,$.current=q.relatedTarget)},onMouseEnter:()=>I(!0),onMouseMove:()=>I(!0),onMouseLeave:()=>{U||I(!1)},onDragEnd:()=>I(!1),onPointerDown:q=>{q.target instanceof HTMLElement&&q.target.dataset.dismissible==="false"||M(!0)},onPointerUp:()=>M(!1)},T.filter(q=>!q.position&&le===0||q.position===Q).map((q,se)=>{var fe,ge;return pe.createElement(Gj,{key:q.id,icons:N,index:se,toast:q,defaultRichColors:v,duration:(fe=C?.duration)!=null?fe:w,className:C?.className,descriptionClassName:C?.descriptionClassName,invert:n,visibleToasts:E,closeButton:(ge=C?.closeButton)!=null?ge:c,interacting:U,position:Q,style:C?.style,unstyled:C?.unstyled,classNames:C?.classNames,cancelButtonStyle:C?.cancelButtonStyle,actionButtonStyle:C?.actionButtonStyle,removeToast:D,toasts:T.filter(we=>we.position==q.position),heights:G.filter(we=>we.position==q.position),setHeights:L,expandByDefault:l,gap:k,loadingIcon:_,expanded:F,pauseWhenPageIsHidden:R,swipeDirections:e.swipeDirections})})):null}))});const Jj=({...e})=>{const{theme:t="system"}=Cj();return a.jsx(Yj,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var Qj=Gh[" useId ".trim().toString()]||(()=>{}),Xj=0;function ur(e){const[t,n]=p.useState(Qj());return Lt(()=>{n(s=>s??String(Xj++))},[e]),t?`radix-${t}`:""}const Zj=["top","right","bottom","left"],vs=Math.min,fn=Math.max,Tc=Math.round,Xl=Math.floor,fr=e=>({x:e,y:e}),eT={left:"right",right:"left",bottom:"top",top:"bottom"},tT={start:"end",end:"start"};function ih(e,t,n){return fn(e,vs(t,n))}function Pr(e,t){return typeof e=="function"?e(t):e}function Ir(e){return e.split("-")[0]}function ti(e){return e.split("-")[1]}function nm(e){return e==="x"?"y":"x"}function rm(e){return e==="y"?"height":"width"}const nT=new Set(["top","bottom"]);function dr(e){return nT.has(Ir(e))?"y":"x"}function sm(e){return nm(dr(e))}function rT(e,t,n){n===void 0&&(n=!1);const s=ti(e),i=sm(e),l=rm(i);let c=i==="x"?s===(n?"end":"start")?"right":"left":s==="start"?"bottom":"top";return t.reference[l]>t.floating[l]&&(c=Ac(c)),[c,Ac(c)]}function sT(e){const t=Ac(e);return[ah(e),t,ah(t)]}function ah(e){return e.replace(/start|end/g,t=>tT[t])}const ly=["left","right"],cy=["right","left"],oT=["top","bottom"],iT=["bottom","top"];function aT(e,t,n){switch(e){case"top":case"bottom":return n?t?cy:ly:t?ly:cy;case"left":case"right":return t?oT:iT;default:return[]}}function lT(e,t,n,s){const i=ti(e);let l=aT(Ir(e),n==="start",s);return i&&(l=l.map(c=>c+"-"+i),t&&(l=l.concat(l.map(ah)))),l}function Ac(e){return e.replace(/left|right|bottom|top/g,t=>eT[t])}function cT(e){return{top:0,right:0,bottom:0,left:0,...e}}function Fx(e){return typeof e!="number"?cT(e):{top:e,right:e,bottom:e,left:e}}function Rc(e){const{x:t,y:n,width:s,height:i}=e;return{width:s,height:i,top:n,left:t,right:t+s,bottom:n+i,x:t,y:n}}function dy(e,t,n){let{reference:s,floating:i}=e;const l=dr(t),c=sm(t),u=rm(c),f=Ir(t),h=l==="y",g=s.x+s.width/2-i.width/2,v=s.y+s.height/2-i.height/2,w=s[u]/2-i[u]/2;let x;switch(f){case"top":x={x:g,y:s.y-i.height};break;case"bottom":x={x:g,y:s.y+s.height};break;case"right":x={x:s.x+s.width,y:v};break;case"left":x={x:s.x-i.width,y:v};break;default:x={x:s.x,y:s.y}}switch(ti(t)){case"start":x[c]-=w*(n&&h?-1:1);break;case"end":x[c]+=w*(n&&h?-1:1);break}return x}const dT=async(e,t,n)=>{const{placement:s="bottom",strategy:i="absolute",middleware:l=[],platform:c}=n,u=l.filter(Boolean),f=await(c.isRTL==null?void 0:c.isRTL(t));let h=await c.getElementRects({reference:e,floating:t,strategy:i}),{x:g,y:v}=dy(h,s,f),w=s,x={},E=0;for(let C=0;C<u.length;C++){const{name:b,fn:k}=u[C],{x:_,y:N,data:j,reset:R}=await k({x:g,y:v,initialPlacement:s,placement:w,strategy:i,middlewareData:x,rects:h,platform:c,elements:{reference:e,floating:t}});g=_??g,v=N??v,x={...x,[b]:{...x[b],...j}},R&&E<=50&&(E++,typeof R=="object"&&(R.placement&&(w=R.placement),R.rects&&(h=R.rects===!0?await c.getElementRects({reference:e,floating:t,strategy:i}):R.rects),{x:g,y:v}=dy(h,w,f)),C=-1)}return{x:g,y:v,placement:w,strategy:i,middlewareData:x}};async function ca(e,t){var n;t===void 0&&(t={});const{x:s,y:i,platform:l,rects:c,elements:u,strategy:f}=e,{boundary:h="clippingAncestors",rootBoundary:g="viewport",elementContext:v="floating",altBoundary:w=!1,padding:x=0}=Pr(t,e),E=Fx(x),b=u[w?v==="floating"?"reference":"floating":v],k=Rc(await l.getClippingRect({element:(n=await(l.isElement==null?void 0:l.isElement(b)))==null||n?b:b.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(u.floating)),boundary:h,rootBoundary:g,strategy:f})),_=v==="floating"?{x:s,y:i,width:c.floating.width,height:c.floating.height}:c.reference,N=await(l.getOffsetParent==null?void 0:l.getOffsetParent(u.floating)),j=await(l.isElement==null?void 0:l.isElement(N))?await(l.getScale==null?void 0:l.getScale(N))||{x:1,y:1}:{x:1,y:1},R=Rc(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:_,offsetParent:N,strategy:f}):_);return{top:(k.top-R.top+E.top)/j.y,bottom:(R.bottom-k.bottom+E.bottom)/j.y,left:(k.left-R.left+E.left)/j.x,right:(R.right-k.right+E.right)/j.x}}const uT=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:s,placement:i,rects:l,platform:c,elements:u,middlewareData:f}=t,{element:h,padding:g=0}=Pr(e,t)||{};if(h==null)return{};const v=Fx(g),w={x:n,y:s},x=sm(i),E=rm(x),C=await c.getDimensions(h),b=x==="y",k=b?"top":"left",_=b?"bottom":"right",N=b?"clientHeight":"clientWidth",j=l.reference[E]+l.reference[x]-w[x]-l.floating[E],R=w[x]-l.reference[x],T=await(c.getOffsetParent==null?void 0:c.getOffsetParent(h));let P=T?T[N]:0;(!P||!await(c.isElement==null?void 0:c.isElement(T)))&&(P=u.floating[N]||l.floating[E]);const O=j/2-R/2,G=P/2-C[E]/2-1,L=vs(v[k],G),F=vs(v[_],G),I=L,U=P-C[E]-F,M=P/2-C[E]/2+O,B=ih(I,M,U),V=!f.arrow&&ti(i)!=null&&M!==B&&l.reference[E]/2-(M<I?L:F)-C[E]/2<0,ee=V?M<I?M-I:M-U:0;return{[x]:w[x]+ee,data:{[x]:B,centerOffset:M-B-ee,...V&&{alignmentOffset:ee}},reset:V}}}),fT=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,s;const{placement:i,middlewareData:l,rects:c,initialPlacement:u,platform:f,elements:h}=t,{mainAxis:g=!0,crossAxis:v=!0,fallbackPlacements:w,fallbackStrategy:x="bestFit",fallbackAxisSideDirection:E="none",flipAlignment:C=!0,...b}=Pr(e,t);if((n=l.arrow)!=null&&n.alignmentOffset)return{};const k=Ir(i),_=dr(u),N=Ir(u)===u,j=await(f.isRTL==null?void 0:f.isRTL(h.floating)),R=w||(N||!C?[Ac(u)]:sT(u)),T=E!=="none";!w&&T&&R.push(...lT(u,C,E,j));const P=[u,...R],O=await ca(t,b),G=[];let L=((s=l.flip)==null?void 0:s.overflows)||[];if(g&&G.push(O[k]),v){const M=rT(i,c,j);G.push(O[M[0]],O[M[1]])}if(L=[...L,{placement:i,overflows:G}],!G.every(M=>M<=0)){var F,I;const M=(((F=l.flip)==null?void 0:F.index)||0)+1,B=P[M];if(B&&(!(v==="alignment"?_!==dr(B):!1)||L.every(z=>z.overflows[0]>0&&dr(z.placement)===_)))return{data:{index:M,overflows:L},reset:{placement:B}};let V=(I=L.filter(ee=>ee.overflows[0]<=0).sort((ee,z)=>ee.overflows[1]-z.overflows[1])[0])==null?void 0:I.placement;if(!V)switch(x){case"bestFit":{var U;const ee=(U=L.filter(z=>{if(T){const $=dr(z.placement);return $===_||$==="y"}return!0}).map(z=>[z.placement,z.overflows.filter($=>$>0).reduce(($,W)=>$+W,0)]).sort((z,$)=>z[1]-$[1])[0])==null?void 0:U[0];ee&&(V=ee);break}case"initialPlacement":V=u;break}if(i!==V)return{reset:{placement:V}}}return{}}}};function uy(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function fy(e){return Zj.some(t=>e[t]>=0)}const hT=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:s="referenceHidden",...i}=Pr(e,t);switch(s){case"referenceHidden":{const l=await ca(t,{...i,elementContext:"reference"}),c=uy(l,n.reference);return{data:{referenceHiddenOffsets:c,referenceHidden:fy(c)}}}case"escaped":{const l=await ca(t,{...i,altBoundary:!0}),c=uy(l,n.floating);return{data:{escapedOffsets:c,escaped:fy(c)}}}default:return{}}}}},Ux=new Set(["left","top"]);async function mT(e,t){const{placement:n,platform:s,elements:i}=e,l=await(s.isRTL==null?void 0:s.isRTL(i.floating)),c=Ir(n),u=ti(n),f=dr(n)==="y",h=Ux.has(c)?-1:1,g=l&&f?-1:1,v=Pr(t,e);let{mainAxis:w,crossAxis:x,alignmentAxis:E}=typeof v=="number"?{mainAxis:v,crossAxis:0,alignmentAxis:null}:{mainAxis:v.mainAxis||0,crossAxis:v.crossAxis||0,alignmentAxis:v.alignmentAxis};return u&&typeof E=="number"&&(x=u==="end"?E*-1:E),f?{x:x*g,y:w*h}:{x:w*h,y:x*g}}const pT=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,s;const{x:i,y:l,placement:c,middlewareData:u}=t,f=await mT(t,e);return c===((n=u.offset)==null?void 0:n.placement)&&(s=u.arrow)!=null&&s.alignmentOffset?{}:{x:i+f.x,y:l+f.y,data:{...f,placement:c}}}}},gT=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:s,placement:i}=t,{mainAxis:l=!0,crossAxis:c=!1,limiter:u={fn:b=>{let{x:k,y:_}=b;return{x:k,y:_}}},...f}=Pr(e,t),h={x:n,y:s},g=await ca(t,f),v=dr(Ir(i)),w=nm(v);let x=h[w],E=h[v];if(l){const b=w==="y"?"top":"left",k=w==="y"?"bottom":"right",_=x+g[b],N=x-g[k];x=ih(_,x,N)}if(c){const b=v==="y"?"top":"left",k=v==="y"?"bottom":"right",_=E+g[b],N=E-g[k];E=ih(_,E,N)}const C=u.fn({...t,[w]:x,[v]:E});return{...C,data:{x:C.x-n,y:C.y-s,enabled:{[w]:l,[v]:c}}}}}},vT=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:s,placement:i,rects:l,middlewareData:c}=t,{offset:u=0,mainAxis:f=!0,crossAxis:h=!0}=Pr(e,t),g={x:n,y:s},v=dr(i),w=nm(v);let x=g[w],E=g[v];const C=Pr(u,t),b=typeof C=="number"?{mainAxis:C,crossAxis:0}:{mainAxis:0,crossAxis:0,...C};if(f){const N=w==="y"?"height":"width",j=l.reference[w]-l.floating[N]+b.mainAxis,R=l.reference[w]+l.reference[N]-b.mainAxis;x<j?x=j:x>R&&(x=R)}if(h){var k,_;const N=w==="y"?"width":"height",j=Ux.has(Ir(i)),R=l.reference[v]-l.floating[N]+(j&&((k=c.offset)==null?void 0:k[v])||0)+(j?0:b.crossAxis),T=l.reference[v]+l.reference[N]+(j?0:((_=c.offset)==null?void 0:_[v])||0)-(j?b.crossAxis:0);E<R?E=R:E>T&&(E=T)}return{[w]:x,[v]:E}}}},yT=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,s;const{placement:i,rects:l,platform:c,elements:u}=t,{apply:f=()=>{},...h}=Pr(e,t),g=await ca(t,h),v=Ir(i),w=ti(i),x=dr(i)==="y",{width:E,height:C}=l.floating;let b,k;v==="top"||v==="bottom"?(b=v,k=w===(await(c.isRTL==null?void 0:c.isRTL(u.floating))?"start":"end")?"left":"right"):(k=v,b=w==="end"?"top":"bottom");const _=C-g.top-g.bottom,N=E-g.left-g.right,j=vs(C-g[b],_),R=vs(E-g[k],N),T=!t.middlewareData.shift;let P=j,O=R;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(O=N),(s=t.middlewareData.shift)!=null&&s.enabled.y&&(P=_),T&&!w){const L=fn(g.left,0),F=fn(g.right,0),I=fn(g.top,0),U=fn(g.bottom,0);x?O=E-2*(L!==0||F!==0?L+F:fn(g.left,g.right)):P=C-2*(I!==0||U!==0?I+U:fn(g.top,g.bottom))}await f({...t,availableWidth:O,availableHeight:P});const G=await c.getDimensions(u.floating);return E!==G.width||C!==G.height?{reset:{rects:!0}}:{}}}};function ed(){return typeof window<"u"}function ni(e){return Bx(e)?(e.nodeName||"").toLowerCase():"#document"}function pn(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function vr(e){var t;return(t=(Bx(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Bx(e){return ed()?e instanceof Node||e instanceof pn(e).Node:!1}function Zn(e){return ed()?e instanceof Element||e instanceof pn(e).Element:!1}function pr(e){return ed()?e instanceof HTMLElement||e instanceof pn(e).HTMLElement:!1}function hy(e){return!ed()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof pn(e).ShadowRoot}const wT=new Set(["inline","contents"]);function ja(e){const{overflow:t,overflowX:n,overflowY:s,display:i}=er(e);return/auto|scroll|overlay|hidden|clip/.test(t+s+n)&&!wT.has(i)}const xT=new Set(["table","td","th"]);function bT(e){return xT.has(ni(e))}const CT=[":popover-open",":modal"];function td(e){return CT.some(t=>{try{return e.matches(t)}catch{return!1}})}const ST=["transform","translate","scale","rotate","perspective"],ET=["transform","translate","scale","rotate","perspective","filter"],_T=["paint","layout","strict","content"];function om(e){const t=im(),n=Zn(e)?er(e):e;return ST.some(s=>n[s]?n[s]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||ET.some(s=>(n.willChange||"").includes(s))||_T.some(s=>(n.contain||"").includes(s))}function NT(e){let t=ys(e);for(;pr(t)&&!qo(t);){if(om(t))return t;if(td(t))return null;t=ys(t)}return null}function im(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const kT=new Set(["html","body","#document"]);function qo(e){return kT.has(ni(e))}function er(e){return pn(e).getComputedStyle(e)}function nd(e){return Zn(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function ys(e){if(ni(e)==="html")return e;const t=e.assignedSlot||e.parentNode||hy(e)&&e.host||vr(e);return hy(t)?t.host:t}function zx(e){const t=ys(e);return qo(t)?e.ownerDocument?e.ownerDocument.body:e.body:pr(t)&&ja(t)?t:zx(t)}function da(e,t,n){var s;t===void 0&&(t=[]),n===void 0&&(n=!0);const i=zx(e),l=i===((s=e.ownerDocument)==null?void 0:s.body),c=pn(i);if(l){const u=lh(c);return t.concat(c,c.visualViewport||[],ja(i)?i:[],u&&n?da(u):[])}return t.concat(i,da(i,[],n))}function lh(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Vx(e){const t=er(e);let n=parseFloat(t.width)||0,s=parseFloat(t.height)||0;const i=pr(e),l=i?e.offsetWidth:n,c=i?e.offsetHeight:s,u=Tc(n)!==l||Tc(s)!==c;return u&&(n=l,s=c),{width:n,height:s,$:u}}function am(e){return Zn(e)?e:e.contextElement}function Bo(e){const t=am(e);if(!pr(t))return fr(1);const n=t.getBoundingClientRect(),{width:s,height:i,$:l}=Vx(t);let c=(l?Tc(n.width):n.width)/s,u=(l?Tc(n.height):n.height)/i;return(!c||!Number.isFinite(c))&&(c=1),(!u||!Number.isFinite(u))&&(u=1),{x:c,y:u}}const jT=fr(0);function Hx(e){const t=pn(e);return!im()||!t.visualViewport?jT:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function TT(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==pn(e)?!1:t}function Js(e,t,n,s){t===void 0&&(t=!1),n===void 0&&(n=!1);const i=e.getBoundingClientRect(),l=am(e);let c=fr(1);t&&(s?Zn(s)&&(c=Bo(s)):c=Bo(e));const u=TT(l,n,s)?Hx(l):fr(0);let f=(i.left+u.x)/c.x,h=(i.top+u.y)/c.y,g=i.width/c.x,v=i.height/c.y;if(l){const w=pn(l),x=s&&Zn(s)?pn(s):s;let E=w,C=lh(E);for(;C&&s&&x!==E;){const b=Bo(C),k=C.getBoundingClientRect(),_=er(C),N=k.left+(C.clientLeft+parseFloat(_.paddingLeft))*b.x,j=k.top+(C.clientTop+parseFloat(_.paddingTop))*b.y;f*=b.x,h*=b.y,g*=b.x,v*=b.y,f+=N,h+=j,E=pn(C),C=lh(E)}}return Rc({width:g,height:v,x:f,y:h})}function lm(e,t){const n=nd(e).scrollLeft;return t?t.left+n:Js(vr(e)).left+n}function Wx(e,t,n){n===void 0&&(n=!1);const s=e.getBoundingClientRect(),i=s.left+t.scrollLeft-(n?0:lm(e,s)),l=s.top+t.scrollTop;return{x:i,y:l}}function AT(e){let{elements:t,rect:n,offsetParent:s,strategy:i}=e;const l=i==="fixed",c=vr(s),u=t?td(t.floating):!1;if(s===c||u&&l)return n;let f={scrollLeft:0,scrollTop:0},h=fr(1);const g=fr(0),v=pr(s);if((v||!v&&!l)&&((ni(s)!=="body"||ja(c))&&(f=nd(s)),pr(s))){const x=Js(s);h=Bo(s),g.x=x.x+s.clientLeft,g.y=x.y+s.clientTop}const w=c&&!v&&!l?Wx(c,f,!0):fr(0);return{width:n.width*h.x,height:n.height*h.y,x:n.x*h.x-f.scrollLeft*h.x+g.x+w.x,y:n.y*h.y-f.scrollTop*h.y+g.y+w.y}}function RT(e){return Array.from(e.getClientRects())}function PT(e){const t=vr(e),n=nd(e),s=e.ownerDocument.body,i=fn(t.scrollWidth,t.clientWidth,s.scrollWidth,s.clientWidth),l=fn(t.scrollHeight,t.clientHeight,s.scrollHeight,s.clientHeight);let c=-n.scrollLeft+lm(e);const u=-n.scrollTop;return er(s).direction==="rtl"&&(c+=fn(t.clientWidth,s.clientWidth)-i),{width:i,height:l,x:c,y:u}}function IT(e,t){const n=pn(e),s=vr(e),i=n.visualViewport;let l=s.clientWidth,c=s.clientHeight,u=0,f=0;if(i){l=i.width,c=i.height;const h=im();(!h||h&&t==="fixed")&&(u=i.offsetLeft,f=i.offsetTop)}return{width:l,height:c,x:u,y:f}}const DT=new Set(["absolute","fixed"]);function OT(e,t){const n=Js(e,!0,t==="fixed"),s=n.top+e.clientTop,i=n.left+e.clientLeft,l=pr(e)?Bo(e):fr(1),c=e.clientWidth*l.x,u=e.clientHeight*l.y,f=i*l.x,h=s*l.y;return{width:c,height:u,x:f,y:h}}function my(e,t,n){let s;if(t==="viewport")s=IT(e,n);else if(t==="document")s=PT(vr(e));else if(Zn(t))s=OT(t,n);else{const i=Hx(e);s={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return Rc(s)}function qx(e,t){const n=ys(e);return n===t||!Zn(n)||qo(n)?!1:er(n).position==="fixed"||qx(n,t)}function LT(e,t){const n=t.get(e);if(n)return n;let s=da(e,[],!1).filter(u=>Zn(u)&&ni(u)!=="body"),i=null;const l=er(e).position==="fixed";let c=l?ys(e):e;for(;Zn(c)&&!qo(c);){const u=er(c),f=om(c);!f&&u.position==="fixed"&&(i=null),(l?!f&&!i:!f&&u.position==="static"&&!!i&&DT.has(i.position)||ja(c)&&!f&&qx(e,c))?s=s.filter(g=>g!==c):i=u,c=ys(c)}return t.set(e,s),s}function MT(e){let{element:t,boundary:n,rootBoundary:s,strategy:i}=e;const c=[...n==="clippingAncestors"?td(t)?[]:LT(t,this._c):[].concat(n),s],u=c[0],f=c.reduce((h,g)=>{const v=my(t,g,i);return h.top=fn(v.top,h.top),h.right=vs(v.right,h.right),h.bottom=vs(v.bottom,h.bottom),h.left=fn(v.left,h.left),h},my(t,u,i));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function $T(e){const{width:t,height:n}=Vx(e);return{width:t,height:n}}function FT(e,t,n){const s=pr(t),i=vr(t),l=n==="fixed",c=Js(e,!0,l,t);let u={scrollLeft:0,scrollTop:0};const f=fr(0);function h(){f.x=lm(i)}if(s||!s&&!l)if((ni(t)!=="body"||ja(i))&&(u=nd(t)),s){const x=Js(t,!0,l,t);f.x=x.x+t.clientLeft,f.y=x.y+t.clientTop}else i&&h();l&&!s&&i&&h();const g=i&&!s&&!l?Wx(i,u):fr(0),v=c.left+u.scrollLeft-f.x-g.x,w=c.top+u.scrollTop-f.y-g.y;return{x:v,y:w,width:c.width,height:c.height}}function Ef(e){return er(e).position==="static"}function py(e,t){if(!pr(e)||er(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return vr(e)===n&&(n=n.ownerDocument.body),n}function Gx(e,t){const n=pn(e);if(td(e))return n;if(!pr(e)){let i=ys(e);for(;i&&!qo(i);){if(Zn(i)&&!Ef(i))return i;i=ys(i)}return n}let s=py(e,t);for(;s&&bT(s)&&Ef(s);)s=py(s,t);return s&&qo(s)&&Ef(s)&&!om(s)?n:s||NT(e)||n}const UT=async function(e){const t=this.getOffsetParent||Gx,n=this.getDimensions,s=await n(e.floating);return{reference:FT(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function BT(e){return er(e).direction==="rtl"}const zT={convertOffsetParentRelativeRectToViewportRelativeRect:AT,getDocumentElement:vr,getClippingRect:MT,getOffsetParent:Gx,getElementRects:UT,getClientRects:RT,getDimensions:$T,getScale:Bo,isElement:Zn,isRTL:BT};function Kx(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function VT(e,t){let n=null,s;const i=vr(e);function l(){var u;clearTimeout(s),(u=n)==null||u.disconnect(),n=null}function c(u,f){u===void 0&&(u=!1),f===void 0&&(f=1),l();const h=e.getBoundingClientRect(),{left:g,top:v,width:w,height:x}=h;if(u||t(),!w||!x)return;const E=Xl(v),C=Xl(i.clientWidth-(g+w)),b=Xl(i.clientHeight-(v+x)),k=Xl(g),N={rootMargin:-E+"px "+-C+"px "+-b+"px "+-k+"px",threshold:fn(0,vs(1,f))||1};let j=!0;function R(T){const P=T[0].intersectionRatio;if(P!==f){if(!j)return c();P?c(!1,P):s=setTimeout(()=>{c(!1,1e-7)},1e3)}P===1&&!Kx(h,e.getBoundingClientRect())&&c(),j=!1}try{n=new IntersectionObserver(R,{...N,root:i.ownerDocument})}catch{n=new IntersectionObserver(R,N)}n.observe(e)}return c(!0),l}function HT(e,t,n,s){s===void 0&&(s={});const{ancestorScroll:i=!0,ancestorResize:l=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:f=!1}=s,h=am(e),g=i||l?[...h?da(h):[],...da(t)]:[];g.forEach(k=>{i&&k.addEventListener("scroll",n,{passive:!0}),l&&k.addEventListener("resize",n)});const v=h&&u?VT(h,n):null;let w=-1,x=null;c&&(x=new ResizeObserver(k=>{let[_]=k;_&&_.target===h&&x&&(x.unobserve(t),cancelAnimationFrame(w),w=requestAnimationFrame(()=>{var N;(N=x)==null||N.observe(t)})),n()}),h&&!f&&x.observe(h),x.observe(t));let E,C=f?Js(e):null;f&&b();function b(){const k=Js(e);C&&!Kx(C,k)&&n(),C=k,E=requestAnimationFrame(b)}return n(),()=>{var k;g.forEach(_=>{i&&_.removeEventListener("scroll",n),l&&_.removeEventListener("resize",n)}),v?.(),(k=x)==null||k.disconnect(),x=null,f&&cancelAnimationFrame(E)}}const WT=pT,qT=gT,GT=fT,KT=yT,YT=hT,gy=uT,JT=vT,QT=(e,t,n)=>{const s=new Map,i={platform:zT,...n},l={...i.platform,_c:s};return dT(e,t,{...i,platform:l})};var XT=typeof document<"u",ZT=function(){},bc=XT?p.useLayoutEffect:ZT;function Pc(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,s,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(s=n;s--!==0;)if(!Pc(e[s],t[s]))return!1;return!0}if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(s=n;s--!==0;)if(!{}.hasOwnProperty.call(t,i[s]))return!1;for(s=n;s--!==0;){const l=i[s];if(!(l==="_owner"&&e.$$typeof)&&!Pc(e[l],t[l]))return!1}return!0}return e!==e&&t!==t}function Yx(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function vy(e,t){const n=Yx(e);return Math.round(t*n)/n}function _f(e){const t=p.useRef(e);return bc(()=>{t.current=e}),t}function eA(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:s=[],platform:i,elements:{reference:l,floating:c}={},transform:u=!0,whileElementsMounted:f,open:h}=e,[g,v]=p.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[w,x]=p.useState(s);Pc(w,s)||x(s);const[E,C]=p.useState(null),[b,k]=p.useState(null),_=p.useCallback(z=>{z!==T.current&&(T.current=z,C(z))},[]),N=p.useCallback(z=>{z!==P.current&&(P.current=z,k(z))},[]),j=l||E,R=c||b,T=p.useRef(null),P=p.useRef(null),O=p.useRef(g),G=f!=null,L=_f(f),F=_f(i),I=_f(h),U=p.useCallback(()=>{if(!T.current||!P.current)return;const z={placement:t,strategy:n,middleware:w};F.current&&(z.platform=F.current),QT(T.current,P.current,z).then($=>{const W={...$,isPositioned:I.current!==!1};M.current&&!Pc(O.current,W)&&(O.current=W,Xo.flushSync(()=>{v(W)}))})},[w,t,n,F,I]);bc(()=>{h===!1&&O.current.isPositioned&&(O.current.isPositioned=!1,v(z=>({...z,isPositioned:!1})))},[h]);const M=p.useRef(!1);bc(()=>(M.current=!0,()=>{M.current=!1}),[]),bc(()=>{if(j&&(T.current=j),R&&(P.current=R),j&&R){if(L.current)return L.current(j,R,U);U()}},[j,R,U,L,G]);const B=p.useMemo(()=>({reference:T,floating:P,setReference:_,setFloating:N}),[_,N]),V=p.useMemo(()=>({reference:j,floating:R}),[j,R]),ee=p.useMemo(()=>{const z={position:n,left:0,top:0};if(!V.floating)return z;const $=vy(V.floating,g.x),W=vy(V.floating,g.y);return u?{...z,transform:"translate("+$+"px, "+W+"px)",...Yx(V.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:$,top:W}},[n,u,V.floating,g.x,g.y]);return p.useMemo(()=>({...g,update:U,refs:B,elements:V,floatingStyles:ee}),[g,U,B,V,ee])}const tA=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:s,padding:i}=typeof e=="function"?e(n):e;return s&&t(s)?s.current!=null?gy({element:s.current,padding:i}).fn(n):{}:s?gy({element:s,padding:i}).fn(n):{}}}},nA=(e,t)=>({...WT(e),options:[e,t]}),rA=(e,t)=>({...qT(e),options:[e,t]}),sA=(e,t)=>({...JT(e),options:[e,t]}),oA=(e,t)=>({...GT(e),options:[e,t]}),iA=(e,t)=>({...KT(e),options:[e,t]}),aA=(e,t)=>({...YT(e),options:[e,t]}),lA=(e,t)=>({...tA(e),options:[e,t]});var cA="Arrow",Jx=p.forwardRef((e,t)=>{const{children:n,width:s=10,height:i=5,...l}=e;return a.jsx(Oe.svg,{...l,ref:t,width:s,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});Jx.displayName=cA;var dA=Jx;function Qx(e){const[t,n]=p.useState(void 0);return Lt(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const s=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const l=i[0];let c,u;if("borderBoxSize"in l){const f=l.borderBoxSize,h=Array.isArray(f)?f[0]:f;c=h.inlineSize,u=h.blockSize}else c=e.offsetWidth,u=e.offsetHeight;n({width:c,height:u})});return s.observe(e,{box:"border-box"}),()=>s.unobserve(e)}else n(void 0)},[e]),t}var cm="Popper",[Xx,ri]=Pn(cm),[uA,Zx]=Xx(cm),e0=e=>{const{__scopePopper:t,children:n}=e,[s,i]=p.useState(null);return a.jsx(uA,{scope:t,anchor:s,onAnchorChange:i,children:n})};e0.displayName=cm;var t0="PopperAnchor",n0=p.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:s,...i}=e,l=Zx(t0,n),c=p.useRef(null),u=qe(t,c);return p.useEffect(()=>{l.onAnchorChange(s?.current||c.current)}),s?null:a.jsx(Oe.div,{...i,ref:u})});n0.displayName=t0;var dm="PopperContent",[fA,hA]=Xx(dm),r0=p.forwardRef((e,t)=>{const{__scopePopper:n,side:s="bottom",sideOffset:i=0,align:l="center",alignOffset:c=0,arrowPadding:u=0,avoidCollisions:f=!0,collisionBoundary:h=[],collisionPadding:g=0,sticky:v="partial",hideWhenDetached:w=!1,updatePositionStrategy:x="optimized",onPlaced:E,...C}=e,b=Zx(dm,n),[k,_]=p.useState(null),N=qe(t,q=>_(q)),[j,R]=p.useState(null),T=Qx(j),P=T?.width??0,O=T?.height??0,G=s+(l!=="center"?"-"+l:""),L=typeof g=="number"?g:{top:0,right:0,bottom:0,left:0,...g},F=Array.isArray(h)?h:[h],I=F.length>0,U={padding:L,boundary:F.filter(pA),altBoundary:I},{refs:M,floatingStyles:B,placement:V,isPositioned:ee,middlewareData:z}=eA({strategy:"fixed",placement:G,whileElementsMounted:(...q)=>HT(...q,{animationFrame:x==="always"}),elements:{reference:b.anchor},middleware:[nA({mainAxis:i+O,alignmentAxis:c}),f&&rA({mainAxis:!0,crossAxis:!1,limiter:v==="partial"?sA():void 0,...U}),f&&oA({...U}),iA({...U,apply:({elements:q,rects:se,availableWidth:fe,availableHeight:ge})=>{const{width:we,height:Re}=se.reference,Be=q.floating.style;Be.setProperty("--radix-popper-available-width",`${fe}px`),Be.setProperty("--radix-popper-available-height",`${ge}px`),Be.setProperty("--radix-popper-anchor-width",`${we}px`),Be.setProperty("--radix-popper-anchor-height",`${Re}px`)}}),j&&lA({element:j,padding:u}),gA({arrowWidth:P,arrowHeight:O}),w&&aA({strategy:"referenceHidden",...U})]}),[$,W]=i0(V),D=an(E);Lt(()=>{ee&&D?.()},[ee,D]);const Q=z.arrow?.x,le=z.arrow?.y,X=z.arrow?.centerOffset!==0,[K,te]=p.useState();return Lt(()=>{k&&te(window.getComputedStyle(k).zIndex)},[k]),a.jsx("div",{ref:M.setFloating,"data-radix-popper-content-wrapper":"",style:{...B,transform:ee?B.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:K,"--radix-popper-transform-origin":[z.transformOrigin?.x,z.transformOrigin?.y].join(" "),...z.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:a.jsx(fA,{scope:n,placedSide:$,onArrowChange:R,arrowX:Q,arrowY:le,shouldHideArrow:X,children:a.jsx(Oe.div,{"data-side":$,"data-align":W,...C,ref:N,style:{...C.style,animation:ee?void 0:"none"}})})})});r0.displayName=dm;var s0="PopperArrow",mA={top:"bottom",right:"left",bottom:"top",left:"right"},o0=p.forwardRef(function(t,n){const{__scopePopper:s,...i}=t,l=hA(s0,s),c=mA[l.placedSide];return a.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[c]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:a.jsx(dA,{...i,ref:n,style:{...i.style,display:"block"}})})});o0.displayName=s0;function pA(e){return e!==null}var gA=e=>({name:"transformOrigin",options:e,fn(t){const{placement:n,rects:s,middlewareData:i}=t,c=i.arrow?.centerOffset!==0,u=c?0:e.arrowWidth,f=c?0:e.arrowHeight,[h,g]=i0(n),v={start:"0%",center:"50%",end:"100%"}[g],w=(i.arrow?.x??0)+u/2,x=(i.arrow?.y??0)+f/2;let E="",C="";return h==="bottom"?(E=c?v:`${w}px`,C=`${-f}px`):h==="top"?(E=c?v:`${w}px`,C=`${s.floating.height+f}px`):h==="right"?(E=`${-f}px`,C=c?v:`${x}px`):h==="left"&&(E=`${s.floating.width+f}px`,C=c?v:`${x}px`),{data:{x:E,y:C}}}});function i0(e){const[t,n="center"]=e.split("-");return[t,n]}var a0=e0,um=n0,fm=r0,hm=o0,[rd]=Pn("Tooltip",[ri]),mm=ri(),l0="TooltipProvider",vA=700,yy="tooltip.open",[yA,c0]=rd(l0),d0=e=>{const{__scopeTooltip:t,delayDuration:n=vA,skipDelayDuration:s=300,disableHoverableContent:i=!1,children:l}=e,c=p.useRef(!0),u=p.useRef(!1),f=p.useRef(0);return p.useEffect(()=>{const h=f.current;return()=>window.clearTimeout(h)},[]),a.jsx(yA,{scope:t,isOpenDelayedRef:c,delayDuration:n,onOpen:p.useCallback(()=>{window.clearTimeout(f.current),c.current=!1},[]),onClose:p.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>c.current=!0,s)},[s]),isPointerInTransitRef:u,onPointerInTransitChange:p.useCallback(h=>{u.current=h},[]),disableHoverableContent:i,children:l})};d0.displayName=l0;var u0="Tooltip",[wF,sd]=rd(u0),ch="TooltipTrigger",wA=p.forwardRef((e,t)=>{const{__scopeTooltip:n,...s}=e,i=sd(ch,n),l=c0(ch,n),c=mm(n),u=p.useRef(null),f=qe(t,u,i.onTriggerChange),h=p.useRef(!1),g=p.useRef(!1),v=p.useCallback(()=>h.current=!1,[]);return p.useEffect(()=>()=>document.removeEventListener("pointerup",v),[v]),a.jsx(um,{asChild:!0,...c,children:a.jsx(Oe.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...s,ref:f,onPointerMove:ye(e.onPointerMove,w=>{w.pointerType!=="touch"&&!g.current&&!l.isPointerInTransitRef.current&&(i.onTriggerEnter(),g.current=!0)}),onPointerLeave:ye(e.onPointerLeave,()=>{i.onTriggerLeave(),g.current=!1}),onPointerDown:ye(e.onPointerDown,()=>{i.open&&i.onClose(),h.current=!0,document.addEventListener("pointerup",v,{once:!0})}),onFocus:ye(e.onFocus,()=>{h.current||i.onOpen()}),onBlur:ye(e.onBlur,i.onClose),onClick:ye(e.onClick,i.onClose)})})});wA.displayName=ch;var xA="TooltipPortal",[xF,bA]=rd(xA,{forceMount:void 0}),Go="TooltipContent",f0=p.forwardRef((e,t)=>{const n=bA(Go,e.__scopeTooltip),{forceMount:s=n.forceMount,side:i="top",...l}=e,c=sd(Go,e.__scopeTooltip);return a.jsx(In,{present:s||c.open,children:c.disableHoverableContent?a.jsx(h0,{side:i,...l,ref:t}):a.jsx(CA,{side:i,...l,ref:t})})}),CA=p.forwardRef((e,t)=>{const n=sd(Go,e.__scopeTooltip),s=c0(Go,e.__scopeTooltip),i=p.useRef(null),l=qe(t,i),[c,u]=p.useState(null),{trigger:f,onClose:h}=n,g=i.current,{onPointerInTransitChange:v}=s,w=p.useCallback(()=>{u(null),v(!1)},[v]),x=p.useCallback((E,C)=>{const b=E.currentTarget,k={x:E.clientX,y:E.clientY},_=kA(k,b.getBoundingClientRect()),N=jA(k,_),j=TA(C.getBoundingClientRect()),R=RA([...N,...j]);u(R),v(!0)},[v]);return p.useEffect(()=>()=>w(),[w]),p.useEffect(()=>{if(f&&g){const E=b=>x(b,g),C=b=>x(b,f);return f.addEventListener("pointerleave",E),g.addEventListener("pointerleave",C),()=>{f.removeEventListener("pointerleave",E),g.removeEventListener("pointerleave",C)}}},[f,g,x,w]),p.useEffect(()=>{if(c){const E=C=>{const b=C.target,k={x:C.clientX,y:C.clientY},_=f?.contains(b)||g?.contains(b),N=!AA(k,c);_?w():N&&(w(),h())};return document.addEventListener("pointermove",E),()=>document.removeEventListener("pointermove",E)}},[f,g,c,h,w]),a.jsx(h0,{...e,ref:l})}),[SA,EA]=rd(u0,{isInside:!1}),_A=Jw("TooltipContent"),h0=p.forwardRef((e,t)=>{const{__scopeTooltip:n,children:s,"aria-label":i,onEscapeKeyDown:l,onPointerDownOutside:c,...u}=e,f=sd(Go,n),h=mm(n),{onClose:g}=f;return p.useEffect(()=>(document.addEventListener(yy,g),()=>document.removeEventListener(yy,g)),[g]),p.useEffect(()=>{if(f.trigger){const v=w=>{w.target?.contains(f.trigger)&&g()};return window.addEventListener("scroll",v,{capture:!0}),()=>window.removeEventListener("scroll",v,{capture:!0})}},[f.trigger,g]),a.jsx(Zo,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:v=>v.preventDefault(),onDismiss:g,children:a.jsxs(fm,{"data-state":f.stateAttribute,...h,...u,ref:t,style:{...u.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[a.jsx(_A,{children:s}),a.jsx(SA,{scope:n,isInside:!0,children:a.jsx(VN,{id:f.contentId,role:"tooltip",children:i||s})})]})})});f0.displayName=Go;var m0="TooltipArrow",NA=p.forwardRef((e,t)=>{const{__scopeTooltip:n,...s}=e,i=mm(n);return EA(m0,n).isInside?null:a.jsx(hm,{...i,...s,ref:t})});NA.displayName=m0;function kA(e,t){const n=Math.abs(t.top-e.y),s=Math.abs(t.bottom-e.y),i=Math.abs(t.right-e.x),l=Math.abs(t.left-e.x);switch(Math.min(n,s,i,l)){case l:return"left";case i:return"right";case n:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function jA(e,t,n=5){const s=[];switch(t){case"top":s.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":s.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":s.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":s.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return s}function TA(e){const{top:t,right:n,bottom:s,left:i}=e;return[{x:i,y:t},{x:n,y:t},{x:n,y:s},{x:i,y:s}]}function AA(e,t){const{x:n,y:s}=e;let i=!1;for(let l=0,c=t.length-1;l<t.length;c=l++){const u=t[l],f=t[c],h=u.x,g=u.y,v=f.x,w=f.y;g>s!=w>s&&n<(v-h)*(s-g)/(w-g)+h&&(i=!i)}return i}function RA(e){const t=e.slice();return t.sort((n,s)=>n.x<s.x?-1:n.x>s.x?1:n.y<s.y?-1:n.y>s.y?1:0),PA(t)}function PA(e){if(e.length<=1)return e.slice();const t=[];for(let s=0;s<e.length;s++){const i=e[s];for(;t.length>=2;){const l=t[t.length-1],c=t[t.length-2];if((l.x-c.x)*(i.y-c.y)>=(l.y-c.y)*(i.x-c.x))t.pop();else break}t.push(i)}t.pop();const n=[];for(let s=e.length-1;s>=0;s--){const i=e[s];for(;n.length>=2;){const l=n[n.length-1],c=n[n.length-2];if((l.x-c.x)*(i.y-c.y)>=(l.y-c.y)*(i.x-c.x))n.pop();else break}n.push(i)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var IA=d0,p0=f0;const DA=IA,OA=p.forwardRef(({className:e,sideOffset:t=4,...n},s)=>a.jsx(p0,{ref:s,sideOffset:t,className:be("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));OA.displayName=p0.displayName;var od=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},id=typeof window>"u"||"Deno"in globalThis;function Kn(){}function LA(e,t){return typeof e=="function"?e(t):e}function MA(e){return typeof e=="number"&&e>=0&&e!==1/0}function $A(e,t){return Math.max(e+(t||0)-Date.now(),0)}function dh(e,t){return typeof e=="function"?e(t):e}function FA(e,t){return typeof e=="function"?e(t):e}function wy(e,t){const{type:n="all",exact:s,fetchStatus:i,predicate:l,queryKey:c,stale:u}=e;if(c){if(s){if(t.queryHash!==pm(c,t.options))return!1}else if(!fa(t.queryKey,c))return!1}if(n!=="all"){const f=t.isActive();if(n==="active"&&!f||n==="inactive"&&f)return!1}return!(typeof u=="boolean"&&t.isStale()!==u||i&&i!==t.state.fetchStatus||l&&!l(t))}function xy(e,t){const{exact:n,status:s,predicate:i,mutationKey:l}=e;if(l){if(!t.options.mutationKey)return!1;if(n){if(ua(t.options.mutationKey)!==ua(l))return!1}else if(!fa(t.options.mutationKey,l))return!1}return!(s&&t.state.status!==s||i&&!i(t))}function pm(e,t){return(t?.queryKeyHashFn||ua)(e)}function ua(e){return JSON.stringify(e,(t,n)=>uh(n)?Object.keys(n).sort().reduce((s,i)=>(s[i]=n[i],s),{}):n)}function fa(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>fa(e[n],t[n])):!1}function g0(e,t){if(e===t)return e;const n=by(e)&&by(t);if(n||uh(e)&&uh(t)){const s=n?e:Object.keys(e),i=s.length,l=n?t:Object.keys(t),c=l.length,u=n?[]:{},f=new Set(s);let h=0;for(let g=0;g<c;g++){const v=n?g:l[g];(!n&&f.has(v)||n)&&e[v]===void 0&&t[v]===void 0?(u[v]=void 0,h++):(u[v]=g0(e[v],t[v]),u[v]===e[v]&&e[v]!==void 0&&h++)}return i===c&&h===i?e:u}return t}function by(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function uh(e){if(!Cy(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!Cy(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Cy(e){return Object.prototype.toString.call(e)==="[object Object]"}function UA(e){return new Promise(t=>{setTimeout(t,e)})}function BA(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?g0(e,t):t}function zA(e,t,n=0){const s=[...e,t];return n&&s.length>n?s.slice(1):s}function VA(e,t,n=0){const s=[t,...e];return n&&s.length>n?s.slice(0,-1):s}var gm=Symbol();function v0(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:!e.queryFn||e.queryFn===gm?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var HA=class extends od{#e;#t;#n;constructor(){super(),this.#n=e=>{if(!id&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#n=e,this.#t?.(),this.#t=e(t=>{typeof t=="boolean"?this.setFocused(t):this.onFocus()})}setFocused(e){this.#e!==e&&(this.#e=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},y0=new HA,WA=class extends od{#e=!0;#t;#n;constructor(){super(),this.#n=e=>{if(!id&&window.addEventListener){const t=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#n=e,this.#t?.(),this.#t=e(this.setOnline.bind(this))}setOnline(e){this.#e!==e&&(this.#e=e,this.listeners.forEach(n=>{n(e)}))}isOnline(){return this.#e}},Ic=new WA;function qA(){let e,t;const n=new Promise((i,l)=>{e=i,t=l});n.status="pending",n.catch(()=>{});function s(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{s({status:"fulfilled",value:i}),e(i)},n.reject=i=>{s({status:"rejected",reason:i}),t(i)},n}function GA(e){return Math.min(1e3*2**e,3e4)}function w0(e){return(e??"online")==="online"?Ic.isOnline():!0}var x0=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function Nf(e){return e instanceof x0}function b0(e){let t=!1,n=0,s=!1,i;const l=qA(),c=C=>{s||(w(new x0(C)),e.abort?.())},u=()=>{t=!0},f=()=>{t=!1},h=()=>y0.isFocused()&&(e.networkMode==="always"||Ic.isOnline())&&e.canRun(),g=()=>w0(e.networkMode)&&e.canRun(),v=C=>{s||(s=!0,e.onSuccess?.(C),i?.(),l.resolve(C))},w=C=>{s||(s=!0,e.onError?.(C),i?.(),l.reject(C))},x=()=>new Promise(C=>{i=b=>{(s||h())&&C(b)},e.onPause?.()}).then(()=>{i=void 0,s||e.onContinue?.()}),E=()=>{if(s)return;let C;const b=n===0?e.initialPromise:void 0;try{C=b??e.fn()}catch(k){C=Promise.reject(k)}Promise.resolve(C).then(v).catch(k=>{if(s)return;const _=e.retry??(id?0:3),N=e.retryDelay??GA,j=typeof N=="function"?N(n,k):N,R=_===!0||typeof _=="number"&&n<_||typeof _=="function"&&_(n,k);if(t||!R){w(k);return}n++,e.onFail?.(n,k),UA(j).then(()=>h()?void 0:x()).then(()=>{t?w(k):E()})})};return{promise:l,cancel:c,continue:()=>(i?.(),l),cancelRetry:u,continueRetry:f,canStart:g,start:()=>(g()?E():x().then(E),l)}}var KA=e=>setTimeout(e,0);function YA(){let e=[],t=0,n=u=>{u()},s=u=>{u()},i=KA;const l=u=>{t?e.push(u):i(()=>{n(u)})},c=()=>{const u=e;e=[],u.length&&i(()=>{s(()=>{u.forEach(f=>{n(f)})})})};return{batch:u=>{let f;t++;try{f=u()}finally{t--,t||c()}return f},batchCalls:u=>(...f)=>{l(()=>{u(...f)})},schedule:l,setNotifyFunction:u=>{n=u},setBatchNotifyFunction:u=>{s=u},setScheduler:u=>{i=u}}}var Kt=YA(),C0=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),MA(this.gcTime)&&(this.#e=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(id?1/0:300*1e3))}clearGcTimeout(){this.#e&&(clearTimeout(this.#e),this.#e=void 0)}},JA=class extends C0{#e;#t;#n;#s;#r;#i;#a;constructor(e){super(),this.#a=!1,this.#i=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#s=e.client,this.#n=this.#s.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=XA(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(e){this.options={...this.#i,...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(e,t){const n=BA(this.state.data,e,this.options);return this.#o({data:n,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),n}setState(e,t){this.#o({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#r?.promise;return this.#r?.cancel(e),t?t.then(Kn).catch(Kn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>FA(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===gm||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>dh(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!$A(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.#r&&(this.#a?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#o({type:"invalidate"})}fetch(e,t){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(h=>h.options.queryFn);f&&this.setOptions(f.options)}const n=new AbortController,s=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(this.#a=!0,n.signal)})},i=()=>{const f=v0(this.options,t),g=(()=>{const v={client:this.#s,queryKey:this.queryKey,meta:this.meta};return s(v),v})();return this.#a=!1,this.options.persister?this.options.persister(f,g,this):f(g)},c=(()=>{const f={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#s,state:this.state,fetchFn:i};return s(f),f})();this.options.behavior?.onFetch(c,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==c.fetchOptions?.meta)&&this.#o({type:"fetch",meta:c.fetchOptions?.meta});const u=f=>{Nf(f)&&f.silent||this.#o({type:"error",error:f}),Nf(f)||(this.#n.config.onError?.(f,this),this.#n.config.onSettled?.(this.state.data,f,this)),this.scheduleGc()};return this.#r=b0({initialPromise:t?.initialPromise,fn:c.fetchFn,abort:n.abort.bind(n),onSuccess:f=>{if(f===void 0){u(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(h){u(h);return}this.#n.config.onSuccess?.(f,this),this.#n.config.onSettled?.(f,this.state.error,this),this.scheduleGc()},onError:u,onFail:(f,h)=>{this.#o({type:"failed",failureCount:f,error:h})},onPause:()=>{this.#o({type:"pause"})},onContinue:()=>{this.#o({type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0}),this.#r.start()}#o(e){const t=n=>{switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...QA(n.data,this.options),fetchMeta:e.meta??null};case"success":return this.#t=void 0,{...n,data:e.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=e.error;return Nf(s)&&s.revert&&this.#t?{...this.#t,fetchStatus:"idle"}:{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}};this.state=t(this.state),Kt.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:e})})}};function QA(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:w0(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function XA(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,s=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var ZA=class extends od{constructor(e={}){super(),this.config=e,this.#e=new Map}#e;build(e,t,n){const s=t.queryKey,i=t.queryHash??pm(s,t);let l=this.get(i);return l||(l=new JA({client:e,queryKey:s,queryHash:i,options:e.defaultQueryOptions(t),state:n,defaultOptions:e.getQueryDefaults(s)}),this.add(l)),l}add(e){this.#e.has(e.queryHash)||(this.#e.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#e.get(e.queryHash);t&&(e.destroy(),t===e&&this.#e.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Kt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#e.get(e)}getAll(){return[...this.#e.values()]}find(e){const t={exact:!0,...e};return this.getAll().find(n=>wy(t,n))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(n=>wy(e,n)):t}notify(e){Kt.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){Kt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Kt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},eR=class extends C0{#e;#t;#n;constructor(e){super(),this.mutationId=e.mutationId,this.#t=e.mutationCache,this.#e=[],this.state=e.state||tR(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#e.includes(e)||(this.#e.push(e),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#e=this.#e.filter(t=>t!==e),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#t.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#s({type:"continue"})};this.#n=b0({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(i,l)=>{this.#s({type:"failed",failureCount:i,error:l})},onPause:()=>{this.#s({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});const n=this.state.status==="pending",s=!this.#n.canStart();try{if(n)t();else{this.#s({type:"pending",variables:e,isPaused:s}),await this.#t.config.onMutate?.(e,this);const l=await this.options.onMutate?.(e);l!==this.state.context&&this.#s({type:"pending",context:l,variables:e,isPaused:s})}const i=await this.#n.start();return await this.#t.config.onSuccess?.(i,e,this.state.context,this),await this.options.onSuccess?.(i,e,this.state.context),await this.#t.config.onSettled?.(i,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(i,null,e,this.state.context),this.#s({type:"success",data:i}),i}catch(i){try{throw await this.#t.config.onError?.(i,e,this.state.context,this),await this.options.onError?.(i,e,this.state.context),await this.#t.config.onSettled?.(void 0,i,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,i,e,this.state.context),i}finally{this.#s({type:"error",error:i})}}finally{this.#t.runNext(this)}}#s(e){const t=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),Kt.batch(()=>{this.#e.forEach(n=>{n.onMutationUpdate(e)}),this.#t.notify({mutation:this,type:"updated",action:e})})}};function tR(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var nR=class extends od{constructor(e={}){super(),this.config=e,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(e,t,n){const s=new eR({mutationCache:this,mutationId:++this.#n,options:e.defaultMutationOptions(t),state:n});return this.add(s),s}add(e){this.#e.add(e);const t=Zl(e);if(typeof t=="string"){const n=this.#t.get(t);n?n.push(e):this.#t.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#e.delete(e)){const t=Zl(e);if(typeof t=="string"){const n=this.#t.get(t);if(n)if(n.length>1){const s=n.indexOf(e);s!==-1&&n.splice(s,1)}else n[0]===e&&this.#t.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=Zl(e);if(typeof t=="string"){const s=this.#t.get(t)?.find(i=>i.state.status==="pending");return!s||s===e}else return!0}runNext(e){const t=Zl(e);return typeof t=="string"?this.#t.get(t)?.find(s=>s!==e&&s.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Kt.batch(()=>{this.#e.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(e){const t={exact:!0,...e};return this.getAll().find(n=>xy(t,n))}findAll(e={}){return this.getAll().filter(t=>xy(e,t))}notify(e){Kt.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return Kt.batch(()=>Promise.all(e.map(t=>t.continue().catch(Kn))))}};function Zl(e){return e.options.scope?.id}function Sy(e){return{onFetch:(t,n)=>{const s=t.options,i=t.fetchOptions?.meta?.fetchMore?.direction,l=t.state.data?.pages||[],c=t.state.data?.pageParams||[];let u={pages:[],pageParams:[]},f=0;const h=async()=>{let g=!1;const v=E=>{Object.defineProperty(E,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},w=v0(t.options,t.fetchOptions),x=async(E,C,b)=>{if(g)return Promise.reject();if(C==null&&E.pages.length)return Promise.resolve(E);const _=(()=>{const T={client:t.client,queryKey:t.queryKey,pageParam:C,direction:b?"backward":"forward",meta:t.options.meta};return v(T),T})(),N=await w(_),{maxPages:j}=t.options,R=b?VA:zA;return{pages:R(E.pages,N,j),pageParams:R(E.pageParams,C,j)}};if(i&&l.length){const E=i==="backward",C=E?rR:Ey,b={pages:l,pageParams:c},k=C(s,b);u=await x(b,k,E)}else{const E=e??l.length;do{const C=f===0?c[0]??s.initialPageParam:Ey(s,u);if(f>0&&C==null)break;u=await x(u,C),f++}while(f<E)}return u};t.options.persister?t.fetchFn=()=>t.options.persister?.(h,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n):t.fetchFn=h}}}function Ey(e,{pages:t,pageParams:n}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,n[s],n):void 0}function rR(e,{pages:t,pageParams:n}){return t.length>0?e.getPreviousPageParam?.(t[0],t,n[0],n):void 0}var sR=class{#e;#t;#n;#s;#r;#i;#a;#o;constructor(e={}){this.#e=e.queryCache||new ZA,this.#t=e.mutationCache||new nR,this.#n=e.defaultOptions||{},this.#s=new Map,this.#r=new Map,this.#i=0}mount(){this.#i++,this.#i===1&&(this.#a=y0.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#o=Ic.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#i--,this.#i===0&&(this.#a?.(),this.#a=void 0,this.#o?.(),this.#o=void 0)}isFetching(e){return this.#e.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#t.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#e.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=this.#e.build(this,t),s=n.state.data;return s===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(dh(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return this.#e.findAll(e).map(({queryKey:t,state:n})=>{const s=n.data;return[t,s]})}setQueryData(e,t,n){const s=this.defaultQueryOptions({queryKey:e}),l=this.#e.get(s.queryHash)?.state.data,c=LA(t,l);if(c!==void 0)return this.#e.build(this,s).setData(c,{...n,manual:!0})}setQueriesData(e,t,n){return Kt.batch(()=>this.#e.findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,n)]))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#e.get(t.queryHash)?.state}removeQueries(e){const t=this.#e;Kt.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=this.#e;return Kt.batch(()=>(n.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},s=Kt.batch(()=>this.#e.findAll(e).map(i=>i.cancel(n)));return Promise.all(s).then(Kn).catch(Kn)}invalidateQueries(e,t={}){return Kt.batch(()=>(this.#e.findAll(e).forEach(n=>{n.invalidate()}),e?.refetchType==="none"?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},s=Kt.batch(()=>this.#e.findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let l=i.fetch(void 0,n);return n.throwOnError||(l=l.catch(Kn)),i.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(s).then(Kn)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=this.#e.build(this,t);return n.isStaleByTime(dh(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Kn).catch(Kn)}fetchInfiniteQuery(e){return e.behavior=Sy(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Kn).catch(Kn)}ensureInfiniteQueryData(e){return e.behavior=Sy(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Ic.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(e){this.#n=e}setQueryDefaults(e,t){this.#s.set(ua(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#s.values()],n={};return t.forEach(s=>{fa(e,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(e,t){this.#r.set(ua(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#r.values()],n={};return t.forEach(s=>{fa(e,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#n.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=pm(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===gm&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#n.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},oR=p.createContext(void 0),iR=({client:e,children:t})=>(p.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(oR.Provider,{value:e,children:t}));function ha(){return ha=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ha.apply(this,arguments)}var us;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(us||(us={}));const _y="popstate";function aR(e){e===void 0&&(e={});function t(s,i){let{pathname:l,search:c,hash:u}=s.location;return fh("",{pathname:l,search:c,hash:u},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){return typeof i=="string"?i:Dc(i)}return cR(t,n,null,e)}function pt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function S0(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function lR(){return Math.random().toString(36).substr(2,8)}function Ny(e,t){return{usr:e.state,key:e.key,idx:t}}function fh(e,t,n,s){return n===void 0&&(n=null),ha({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?si(t):t,{state:n,key:t&&t.key||s||lR()})}function Dc(e){let{pathname:t="/",search:n="",hash:s=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function si(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function cR(e,t,n,s){s===void 0&&(s={});let{window:i=document.defaultView,v5Compat:l=!1}=s,c=i.history,u=us.Pop,f=null,h=g();h==null&&(h=0,c.replaceState(ha({},c.state,{idx:h}),""));function g(){return(c.state||{idx:null}).idx}function v(){u=us.Pop;let b=g(),k=b==null?null:b-h;h=b,f&&f({action:u,location:C.location,delta:k})}function w(b,k){u=us.Push;let _=fh(C.location,b,k);h=g()+1;let N=Ny(_,h),j=C.createHref(_);try{c.pushState(N,"",j)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;i.location.assign(j)}l&&f&&f({action:u,location:C.location,delta:1})}function x(b,k){u=us.Replace;let _=fh(C.location,b,k);h=g();let N=Ny(_,h),j=C.createHref(_);c.replaceState(N,"",j),l&&f&&f({action:u,location:C.location,delta:0})}function E(b){let k=i.location.origin!=="null"?i.location.origin:i.location.href,_=typeof b=="string"?b:Dc(b);return _=_.replace(/ $/,"%20"),pt(k,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,k)}let C={get action(){return u},get location(){return e(i,c)},listen(b){if(f)throw new Error("A history only accepts one active listener");return i.addEventListener(_y,v),f=b,()=>{i.removeEventListener(_y,v),f=null}},createHref(b){return t(i,b)},createURL:E,encodeLocation(b){let k=E(b);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:w,replace:x,go(b){return c.go(b)}};return C}var ky;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(ky||(ky={}));function dR(e,t,n){return n===void 0&&(n="/"),uR(e,t,n)}function uR(e,t,n,s){let i=typeof t=="string"?si(t):t,l=Ko(i.pathname||"/",n);if(l==null)return null;let c=E0(e);fR(c);let u=null;for(let f=0;u==null&&f<c.length;++f){let h=SR(l);u=bR(c[f],h)}return u}function E0(e,t,n,s){t===void 0&&(t=[]),n===void 0&&(n=[]),s===void 0&&(s="");let i=(l,c,u)=>{let f={relativePath:u===void 0?l.path||"":u,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};f.relativePath.startsWith("/")&&(pt(f.relativePath.startsWith(s),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(s.length));let h=hs([s,f.relativePath]),g=n.concat(f);l.children&&l.children.length>0&&(pt(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),E0(l.children,t,g,h)),!(l.path==null&&!l.index)&&t.push({path:h,score:wR(h,l.index),routesMeta:g})};return e.forEach((l,c)=>{var u;if(l.path===""||!((u=l.path)!=null&&u.includes("?")))i(l,c);else for(let f of _0(l.path))i(l,c,f)}),t}function _0(e){let t=e.split("/");if(t.length===0)return[];let[n,...s]=t,i=n.endsWith("?"),l=n.replace(/\?$/,"");if(s.length===0)return i?[l,""]:[l];let c=_0(s.join("/")),u=[];return u.push(...c.map(f=>f===""?l:[l,f].join("/"))),i&&u.push(...c),u.map(f=>e.startsWith("/")&&f===""?"/":f)}function fR(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:xR(t.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const hR=/^:[\w-]+$/,mR=3,pR=2,gR=1,vR=10,yR=-2,jy=e=>e==="*";function wR(e,t){let n=e.split("/"),s=n.length;return n.some(jy)&&(s+=yR),t&&(s+=pR),n.filter(i=>!jy(i)).reduce((i,l)=>i+(hR.test(l)?mR:l===""?gR:vR),s)}function xR(e,t){return e.length===t.length&&e.slice(0,-1).every((s,i)=>s===t[i])?e[e.length-1]-t[t.length-1]:0}function bR(e,t,n){let{routesMeta:s}=e,i={},l="/",c=[];for(let u=0;u<s.length;++u){let f=s[u],h=u===s.length-1,g=l==="/"?t:t.slice(l.length)||"/",v=hh({path:f.relativePath,caseSensitive:f.caseSensitive,end:h},g),w=f.route;if(!v)return null;Object.assign(i,v.params),c.push({params:i,pathname:hs([l,v.pathname]),pathnameBase:kR(hs([l,v.pathnameBase])),route:w}),v.pathnameBase!=="/"&&(l=hs([l,v.pathnameBase]))}return c}function hh(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,s]=CR(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let l=i[0],c=l.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:s.reduce((h,g,v)=>{let{paramName:w,isOptional:x}=g;if(w==="*"){let C=u[v]||"";c=l.slice(0,l.length-C.length).replace(/(.)\/+$/,"$1")}const E=u[v];return x&&!E?h[w]=void 0:h[w]=(E||"").replace(/%2F/g,"/"),h},{}),pathname:l,pathnameBase:c,pattern:e}}function CR(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),S0(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,f)=>(s.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),s]}function SR(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return S0(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Ko(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,s=e.charAt(n);return s&&s!=="/"?null:e.slice(n)||"/"}function ER(e,t){t===void 0&&(t="/");let{pathname:n,search:s="",hash:i=""}=typeof e=="string"?si(e):e;return{pathname:n?n.startsWith("/")?n:_R(n,t):t,search:jR(s),hash:TR(i)}}function _R(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function kf(e,t,n,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function NR(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function N0(e,t){let n=NR(e);return t?n.map((s,i)=>i===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function k0(e,t,n,s){s===void 0&&(s=!1);let i;typeof e=="string"?i=si(e):(i=ha({},e),pt(!i.pathname||!i.pathname.includes("?"),kf("?","pathname","search",i)),pt(!i.pathname||!i.pathname.includes("#"),kf("#","pathname","hash",i)),pt(!i.search||!i.search.includes("#"),kf("#","search","hash",i)));let l=e===""||i.pathname==="",c=l?"/":i.pathname,u;if(c==null)u=n;else{let v=t.length-1;if(!s&&c.startsWith("..")){let w=c.split("/");for(;w[0]==="..";)w.shift(),v-=1;i.pathname=w.join("/")}u=v>=0?t[v]:"/"}let f=ER(i,u),h=c&&c!=="/"&&c.endsWith("/"),g=(l||c===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(h||g)&&(f.pathname+="/"),f}const hs=e=>e.join("/").replace(/\/\/+/g,"/"),kR=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),jR=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,TR=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function AR(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const j0=["post","put","patch","delete"];new Set(j0);const RR=["get",...j0];new Set(RR);function ma(){return ma=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ma.apply(this,arguments)}const ad=p.createContext(null),T0=p.createContext(null),ws=p.createContext(null),ld=p.createContext(null),xs=p.createContext({outlet:null,matches:[],isDataRoute:!1}),A0=p.createContext(null);function PR(e,t){let{relative:n}=t===void 0?{}:t;Ta()||pt(!1);let{basename:s,navigator:i}=p.useContext(ws),{hash:l,pathname:c,search:u}=dd(e,{relative:n}),f=c;return s!=="/"&&(f=c==="/"?s:hs([s,c])),i.createHref({pathname:f,search:u,hash:l})}function Ta(){return p.useContext(ld)!=null}function gn(){return Ta()||pt(!1),p.useContext(ld).location}function R0(e){p.useContext(ws).static||p.useLayoutEffect(e)}function tt(){let{isDataRoute:e}=p.useContext(xs);return e?WR():IR()}function IR(){Ta()||pt(!1);let e=p.useContext(ad),{basename:t,future:n,navigator:s}=p.useContext(ws),{matches:i}=p.useContext(xs),{pathname:l}=gn(),c=JSON.stringify(N0(i,n.v7_relativeSplatPath)),u=p.useRef(!1);return R0(()=>{u.current=!0}),p.useCallback(function(h,g){if(g===void 0&&(g={}),!u.current)return;if(typeof h=="number"){s.go(h);return}let v=k0(h,JSON.parse(c),l,g.relative==="path");e==null&&t!=="/"&&(v.pathname=v.pathname==="/"?t:hs([t,v.pathname])),(g.replace?s.replace:s.push)(v,g.state,g)},[t,s,c,l,e])}function cd(){let{matches:e}=p.useContext(xs),t=e[e.length-1];return t?t.params:{}}function dd(e,t){let{relative:n}=t===void 0?{}:t,{future:s}=p.useContext(ws),{matches:i}=p.useContext(xs),{pathname:l}=gn(),c=JSON.stringify(N0(i,s.v7_relativeSplatPath));return p.useMemo(()=>k0(e,JSON.parse(c),l,n==="path"),[e,c,l,n])}function DR(e,t){return OR(e,t)}function OR(e,t,n,s){Ta()||pt(!1);let{navigator:i}=p.useContext(ws),{matches:l}=p.useContext(xs),c=l[l.length-1],u=c?c.params:{};c&&c.pathname;let f=c?c.pathnameBase:"/";c&&c.route;let h=gn(),g;if(t){var v;let b=typeof t=="string"?si(t):t;f==="/"||(v=b.pathname)!=null&&v.startsWith(f)||pt(!1),g=b}else g=h;let w=g.pathname||"/",x=w;if(f!=="/"){let b=f.replace(/^\//,"").split("/");x="/"+w.replace(/^\//,"").split("/").slice(b.length).join("/")}let E=dR(e,{pathname:x}),C=UR(E&&E.map(b=>Object.assign({},b,{params:Object.assign({},u,b.params),pathname:hs([f,i.encodeLocation?i.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?f:hs([f,i.encodeLocation?i.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),l,n,s);return t&&C?p.createElement(ld.Provider,{value:{location:ma({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:us.Pop}},C):C}function LR(){let e=HR(),t=AR(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},t),n?p.createElement("pre",{style:i},n):null,null)}const MR=p.createElement(LR,null);class $R extends p.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?p.createElement(xs.Provider,{value:this.props.routeContext},p.createElement(A0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function FR(e){let{routeContext:t,match:n,children:s}=e,i=p.useContext(ad);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),p.createElement(xs.Provider,{value:t},s)}function UR(e,t,n,s){var i;if(t===void 0&&(t=[]),n===void 0&&(n=null),s===void 0&&(s=null),e==null){var l;if(!n)return null;if(n.errors)e=n.matches;else if((l=s)!=null&&l.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let c=e,u=(i=n)==null?void 0:i.errors;if(u!=null){let g=c.findIndex(v=>v.route.id&&u?.[v.route.id]!==void 0);g>=0||pt(!1),c=c.slice(0,Math.min(c.length,g+1))}let f=!1,h=-1;if(n&&s&&s.v7_partialHydration)for(let g=0;g<c.length;g++){let v=c[g];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(h=g),v.route.id){let{loaderData:w,errors:x}=n,E=v.route.loader&&w[v.route.id]===void 0&&(!x||x[v.route.id]===void 0);if(v.route.lazy||E){f=!0,h>=0?c=c.slice(0,h+1):c=[c[0]];break}}}return c.reduceRight((g,v,w)=>{let x,E=!1,C=null,b=null;n&&(x=u&&v.route.id?u[v.route.id]:void 0,C=v.route.errorElement||MR,f&&(h<0&&w===0?(qR("route-fallback"),E=!0,b=null):h===w&&(E=!0,b=v.route.hydrateFallbackElement||null)));let k=t.concat(c.slice(0,w+1)),_=()=>{let N;return x?N=C:E?N=b:v.route.Component?N=p.createElement(v.route.Component,null):v.route.element?N=v.route.element:N=g,p.createElement(FR,{match:v,routeContext:{outlet:g,matches:k,isDataRoute:n!=null},children:N})};return n&&(v.route.ErrorBoundary||v.route.errorElement||w===0)?p.createElement($R,{location:n.location,revalidation:n.revalidation,component:C,error:x,children:_(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):_()},null)}var P0=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(P0||{}),I0=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(I0||{});function BR(e){let t=p.useContext(ad);return t||pt(!1),t}function zR(e){let t=p.useContext(T0);return t||pt(!1),t}function VR(e){let t=p.useContext(xs);return t||pt(!1),t}function D0(e){let t=VR(),n=t.matches[t.matches.length-1];return n.route.id||pt(!1),n.route.id}function HR(){var e;let t=p.useContext(A0),n=zR(),s=D0();return t!==void 0?t:(e=n.errors)==null?void 0:e[s]}function WR(){let{router:e}=BR(P0.UseNavigateStable),t=D0(I0.UseNavigateStable),n=p.useRef(!1);return R0(()=>{n.current=!0}),p.useCallback(function(i,l){l===void 0&&(l={}),n.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,ma({fromRouteId:t},l)))},[e,t])}const Ty={};function qR(e,t,n){Ty[e]||(Ty[e]=!0)}function GR(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath}function yt(e){pt(!1)}function KR(e){let{basename:t="/",children:n=null,location:s,navigationType:i=us.Pop,navigator:l,static:c=!1,future:u}=e;Ta()&&pt(!1);let f=t.replace(/^\/*/,"/"),h=p.useMemo(()=>({basename:f,navigator:l,static:c,future:ma({v7_relativeSplatPath:!1},u)}),[f,u,l,c]);typeof s=="string"&&(s=si(s));let{pathname:g="/",search:v="",hash:w="",state:x=null,key:E="default"}=s,C=p.useMemo(()=>{let b=Ko(g,f);return b==null?null:{location:{pathname:b,search:v,hash:w,state:x,key:E},navigationType:i}},[f,g,v,w,x,E,i]);return C==null?null:p.createElement(ws.Provider,{value:h},p.createElement(ld.Provider,{children:n,value:C}))}function YR(e){let{children:t,location:n}=e;return DR(mh(t),n)}new Promise(()=>{});function mh(e,t){t===void 0&&(t=[]);let n=[];return p.Children.forEach(e,(s,i)=>{if(!p.isValidElement(s))return;let l=[...t,i];if(s.type===p.Fragment){n.push.apply(n,mh(s.props.children,l));return}s.type!==yt&&pt(!1),!s.props.index||!s.props.children||pt(!1);let c={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(c.children=mh(s.props.children,l)),n.push(c)}),n}function Oc(){return Oc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Oc.apply(this,arguments)}function O0(e,t){if(e==null)return{};var n={},s=Object.keys(e),i,l;for(l=0;l<s.length;l++)i=s[l],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function JR(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function QR(e,t){return e.button===0&&(!t||t==="_self")&&!JR(e)}function ph(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let s=e[n];return t.concat(Array.isArray(s)?s.map(i=>[n,i]):[[n,s]])},[]))}function XR(e,t){let n=ph(e);return t&&t.forEach((s,i)=>{n.has(i)||t.getAll(i).forEach(l=>{n.append(i,l)})}),n}const ZR=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],eP=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],tP="6";try{window.__reactRouterVersion=tP}catch{}const nP=p.createContext({isTransitioning:!1}),rP="startTransition",Ay=Gh[rP];function sP(e){let{basename:t,children:n,future:s,window:i}=e,l=p.useRef();l.current==null&&(l.current=aR({window:i,v5Compat:!0}));let c=l.current,[u,f]=p.useState({action:c.action,location:c.location}),{v7_startTransition:h}=s||{},g=p.useCallback(v=>{h&&Ay?Ay(()=>f(v)):f(v)},[f,h]);return p.useLayoutEffect(()=>c.listen(g),[c,g]),p.useEffect(()=>GR(s),[s]),p.createElement(KR,{basename:t,children:n,location:u.location,navigationType:u.action,navigator:c,future:s})}const oP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",iP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,aP=p.forwardRef(function(t,n){let{onClick:s,relative:i,reloadDocument:l,replace:c,state:u,target:f,to:h,preventScrollReset:g,viewTransition:v}=t,w=O0(t,ZR),{basename:x}=p.useContext(ws),E,C=!1;if(typeof h=="string"&&iP.test(h)&&(E=h,oP))try{let N=new URL(window.location.href),j=h.startsWith("//")?new URL(N.protocol+h):new URL(h),R=Ko(j.pathname,x);j.origin===N.origin&&R!=null?h=R+j.search+j.hash:C=!0}catch{}let b=PR(h,{relative:i}),k=dP(h,{replace:c,state:u,target:f,preventScrollReset:g,relative:i,viewTransition:v});function _(N){s&&s(N),N.defaultPrevented||k(N)}return p.createElement("a",Oc({},w,{href:E||b,onClick:C||l?s:_,ref:n,target:f}))}),lP=p.forwardRef(function(t,n){let{"aria-current":s="page",caseSensitive:i=!1,className:l="",end:c=!1,style:u,to:f,viewTransition:h,children:g}=t,v=O0(t,eP),w=dd(f,{relative:v.relative}),x=gn(),E=p.useContext(T0),{navigator:C,basename:b}=p.useContext(ws),k=E!=null&&uP(w)&&h===!0,_=C.encodeLocation?C.encodeLocation(w).pathname:w.pathname,N=x.pathname,j=E&&E.navigation&&E.navigation.location?E.navigation.location.pathname:null;i||(N=N.toLowerCase(),j=j?j.toLowerCase():null,_=_.toLowerCase()),j&&b&&(j=Ko(j,b)||j);const R=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let T=N===_||!c&&N.startsWith(_)&&N.charAt(R)==="/",P=j!=null&&(j===_||!c&&j.startsWith(_)&&j.charAt(_.length)==="/"),O={isActive:T,isPending:P,isTransitioning:k},G=T?s:void 0,L;typeof l=="function"?L=l(O):L=[l,T?"active":null,P?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let F=typeof u=="function"?u(O):u;return p.createElement(aP,Oc({},v,{"aria-current":G,className:L,ref:n,style:F,to:f,viewTransition:h}),typeof g=="function"?g(O):g)});var gh;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(gh||(gh={}));var Ry;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Ry||(Ry={}));function cP(e){let t=p.useContext(ad);return t||pt(!1),t}function dP(e,t){let{target:n,replace:s,state:i,preventScrollReset:l,relative:c,viewTransition:u}=t===void 0?{}:t,f=tt(),h=gn(),g=dd(e,{relative:c});return p.useCallback(v=>{if(QR(v,n)){v.preventDefault();let w=s!==void 0?s:Dc(h)===Dc(g);f(e,{replace:w,state:i,preventScrollReset:l,relative:c,viewTransition:u})}},[h,f,g,s,i,n,e,l,c,u])}function L0(e){let t=p.useRef(ph(e)),n=p.useRef(!1),s=gn(),i=p.useMemo(()=>XR(s.search,n.current?null:t.current),[s.search]),l=tt(),c=p.useCallback((u,f)=>{const h=ph(typeof u=="function"?u(i):u);n.current=!0,l("?"+h,f)},[l,i]);return[i,c]}function uP(e,t){t===void 0&&(t={});let n=p.useContext(nP);n==null&&pt(!1);let{basename:s}=cP(gh.useViewTransitionState),i=dd(e,{relative:t.relative});if(!n.isTransitioning)return!1;let l=Ko(n.currentLocation.pathname,s)||n.currentLocation.pathname,c=Ko(n.nextLocation.pathname,s)||n.nextLocation.pathname;return hh(i.pathname,c)!=null||hh(i.pathname,l)!=null}const fP=({children:e,className:t,withTopInset:n=!0,withBottomInset:s=!0})=>a.jsx("div",{className:be("safe-area-layout min-h-[100dvh] w-full overflow-x-hidden",{"safe-area-top":n,"safe-area-bottom":s},t),children:e});var vh=function(e,t){return vh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=s[i])},vh(e,t)};function M0(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");vh(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var En=function(){return En=Object.assign||function(t){for(var n,s=1,i=arguments.length;s<i;s++){n=arguments[s];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},En.apply(this,arguments)};function bs(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]]);return n}function $0(e,t,n,s){var i=arguments.length,l=i<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,n):s,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(e,t,n,s);else for(var u=e.length-1;u>=0;u--)(c=e[u])&&(l=(i<3?c(l):i>3?c(t,n,l):c(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l}function F0(e,t){return function(n,s){t(n,s,e)}}function U0(e,t,n,s,i,l){function c(k){if(k!==void 0&&typeof k!="function")throw new TypeError("Function expected");return k}for(var u=s.kind,f=u==="getter"?"get":u==="setter"?"set":"value",h=!t&&e?s.static?e:e.prototype:null,g=t||(h?Object.getOwnPropertyDescriptor(h,s.name):{}),v,w=!1,x=n.length-1;x>=0;x--){var E={};for(var C in s)E[C]=C==="access"?{}:s[C];for(var C in s.access)E.access[C]=s.access[C];E.addInitializer=function(k){if(w)throw new TypeError("Cannot add initializers after decoration has completed");l.push(c(k||null))};var b=(0,n[x])(u==="accessor"?{get:g.get,set:g.set}:g[f],E);if(u==="accessor"){if(b===void 0)continue;if(b===null||typeof b!="object")throw new TypeError("Object expected");(v=c(b.get))&&(g.get=v),(v=c(b.set))&&(g.set=v),(v=c(b.init))&&i.unshift(v)}else(v=c(b))&&(u==="field"?i.unshift(v):g[f]=v)}h&&Object.defineProperty(h,s.name,g),w=!0}function B0(e,t,n){for(var s=arguments.length>2,i=0;i<t.length;i++)n=s?t[i].call(e,n):t[i].call(e);return s?n:void 0}function z0(e){return typeof e=="symbol"?e:"".concat(e)}function V0(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function H0(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function je(e,t,n,s){function i(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function u(g){try{h(s.next(g))}catch(v){c(v)}}function f(g){try{h(s.throw(g))}catch(v){c(v)}}function h(g){g.done?l(g.value):i(g.value).then(u,f)}h((s=s.apply(e,t||[])).next())})}function W0(e,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},s,i,l,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=u(0),c.throw=u(1),c.return=u(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(h){return function(g){return f([h,g])}}function f(h){if(s)throw new TypeError("Generator is already executing.");for(;c&&(c=0,h[0]&&(n=0)),n;)try{if(s=1,i&&(l=h[0]&2?i.return:h[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,h[1])).done)return l;switch(i=0,l&&(h=[h[0]&2,l.value]),h[0]){case 0:case 1:l=h;break;case 4:return n.label++,{value:h[1],done:!1};case 5:n.label++,i=h[1],h=[0];continue;case 7:h=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(h[0]===6||h[0]===2)){n=0;continue}if(h[0]===3&&(!l||h[1]>l[0]&&h[1]<l[3])){n.label=h[1];break}if(h[0]===6&&n.label<l[1]){n.label=l[1],l=h;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(h);break}l[2]&&n.ops.pop(),n.trys.pop();continue}h=t.call(e,n)}catch(g){h=[6,g],i=0}finally{s=l=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}var ud=Object.create?(function(e,t,n,s){s===void 0&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}):(function(e,t,n,s){s===void 0&&(s=n),e[s]=t[n]});function q0(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&ud(t,e,n)}function Lc(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],s=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function vm(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var s=n.call(e),i,l=[],c;try{for(;(t===void 0||t-- >0)&&!(i=s.next()).done;)l.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(c)throw c.error}}return l}function G0(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(vm(arguments[t]));return e}function K0(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var s=Array(e),i=0,t=0;t<n;t++)for(var l=arguments[t],c=0,u=l.length;c<u;c++,i++)s[i]=l[c];return s}function ym(e,t,n){if(n||arguments.length===2)for(var s=0,i=t.length,l;s<i;s++)(l||!(s in t))&&(l||(l=Array.prototype.slice.call(t,0,s)),l[s]=t[s]);return e.concat(l||Array.prototype.slice.call(t))}function Yo(e){return this instanceof Yo?(this.v=e,this):new Yo(e)}function Y0(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=n.apply(e,t||[]),i,l=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",c),i[Symbol.asyncIterator]=function(){return this},i;function c(x){return function(E){return Promise.resolve(E).then(x,v)}}function u(x,E){s[x]&&(i[x]=function(C){return new Promise(function(b,k){l.push([x,C,b,k])>1||f(x,C)})},E&&(i[x]=E(i[x])))}function f(x,E){try{h(s[x](E))}catch(C){w(l[0][3],C)}}function h(x){x.value instanceof Yo?Promise.resolve(x.value.v).then(g,v):w(l[0][2],x)}function g(x){f("next",x)}function v(x){f("throw",x)}function w(x,E){x(E),l.shift(),l.length&&f(l[0][0],l[0][1])}}function J0(e){var t,n;return t={},s("next"),s("throw",function(i){throw i}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(i,l){t[i]=e[i]?function(c){return(n=!n)?{value:Yo(e[i](c)),done:!1}:l?l(c):c}:l}}function Q0(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Lc=="function"?Lc(e):e[Symbol.iterator](),n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n);function s(l){n[l]=e[l]&&function(c){return new Promise(function(u,f){c=e[l](c),i(u,f,c.done,c.value)})}}function i(l,c,u,f){Promise.resolve(f).then(function(h){l({value:h,done:u})},c)}}function X0(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var hP=Object.create?(function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}):function(e,t){e.default=t},yh=function(e){return yh=Object.getOwnPropertyNames||function(t){var n=[];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[n.length]=s);return n},yh(e)};function Z0(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n=yh(e),s=0;s<n.length;s++)n[s]!=="default"&&ud(t,e,n[s]);return hP(t,e),t}function eb(e){return e&&e.__esModule?e:{default:e}}function tb(e,t,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(e):s?s.value:t.get(e)}function nb(e,t,n,s,i){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n}function rb(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function sb(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var s,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=t[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=t[Symbol.dispose],n&&(i=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");i&&(s=function(){try{i.call(this)}catch(l){return Promise.reject(l)}}),e.stack.push({value:t,dispose:s,async:n})}else n&&e.stack.push({async:!0});return t}var mP=typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var s=new Error(n);return s.name="SuppressedError",s.error=e,s.suppressed=t,s};function ob(e){function t(l){e.error=e.hasError?new mP(l,e.error,"An error was suppressed during disposal."):l,e.hasError=!0}var n,s=0;function i(){for(;n=e.stack.pop();)try{if(!n.async&&s===1)return s=0,e.stack.push(n),Promise.resolve().then(i);if(n.dispose){var l=n.dispose.call(n.value);if(n.async)return s|=2,Promise.resolve(l).then(i,function(c){return t(c),i()})}else s|=1}catch(c){t(c)}if(s===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return i()}function ib(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,s,i,l,c){return s?t?".jsx":".js":i&&(!l||!c)?n:i+l+"."+c.toLowerCase()+"js"}):e}const pP={__extends:M0,__assign:En,__rest:bs,__decorate:$0,__param:F0,__esDecorate:U0,__runInitializers:B0,__propKey:z0,__setFunctionName:V0,__metadata:H0,__awaiter:je,__generator:W0,__createBinding:ud,__exportStar:q0,__values:Lc,__read:vm,__spread:G0,__spreadArrays:K0,__spreadArray:ym,__await:Yo,__asyncGenerator:Y0,__asyncDelegator:J0,__asyncValues:Q0,__makeTemplateObject:X0,__importStar:Z0,__importDefault:eb,__classPrivateFieldGet:tb,__classPrivateFieldSet:nb,__classPrivateFieldIn:rb,__addDisposableResource:sb,__disposeResources:ob,__rewriteRelativeImportExtension:ib},gP=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:sb,get __assign(){return En},__asyncDelegator:J0,__asyncGenerator:Y0,__asyncValues:Q0,__await:Yo,__awaiter:je,__classPrivateFieldGet:tb,__classPrivateFieldIn:rb,__classPrivateFieldSet:nb,__createBinding:ud,__decorate:$0,__disposeResources:ob,__esDecorate:U0,__exportStar:q0,__extends:M0,__generator:W0,__importDefault:eb,__importStar:Z0,__makeTemplateObject:X0,__metadata:H0,__param:F0,__propKey:z0,__read:vm,__rest:bs,__rewriteRelativeImportExtension:ib,__runInitializers:B0,__setFunctionName:V0,__spread:G0,__spreadArray:ym,__spreadArrays:K0,__values:Lc,default:pP},Symbol.toStringTag,{value:"Module"})),vP=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class wm extends Error{constructor(t,n="FunctionsError",s){super(t),this.name=n,this.context=s}}class yP extends wm{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Py extends wm{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Iy extends wm{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var wh;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(wh||(wh={}));class wP{constructor(t,{headers:n={},customFetch:s,region:i=wh.Any}={}){this.url=t,this.headers=n,this.region=i,this.fetch=vP(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return je(this,arguments,void 0,function*(n,s={}){var i;let l,c;try{const{headers:u,method:f,body:h,signal:g,timeout:v}=s;let w={},{region:x}=s;x||(x=this.region);const E=new URL(`${this.url}/${n}`);x&&x!=="any"&&(w["x-region"]=x,E.searchParams.set("forceFunctionRegion",x));let C;h&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(w["Content-Type"]="application/octet-stream",C=h):typeof h=="string"?(w["Content-Type"]="text/plain",C=h):typeof FormData<"u"&&h instanceof FormData?C=h:(w["Content-Type"]="application/json",C=JSON.stringify(h)):C=h;let b=g;v&&(c=new AbortController,l=setTimeout(()=>c.abort(),v),g?(b=c.signal,g.addEventListener("abort",()=>c.abort())):b=c.signal);const k=yield this.fetch(E.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},w),this.headers),u),body:C,signal:b}).catch(R=>{throw new yP(R)}),_=k.headers.get("x-relay-error");if(_&&_==="true")throw new Py(k);if(!k.ok)throw new Iy(k);let N=((i=k.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),j;return N==="application/json"?j=yield k.json():N==="application/octet-stream"||N==="application/pdf"?j=yield k.blob():N==="text/event-stream"?j=k:N==="multipart/form-data"?j=yield k.formData():j=yield k.text(),{data:j,error:null,response:k}}catch(u){return{data:null,error:u,response:u instanceof Iy||u instanceof Py?u.context:void 0}}finally{l&&clearTimeout(l)}})}}var zt={};const oi=sN(gP);var ec={},tc={},nc={},rc={},sc={},oc={},Dy;function ab(){if(Dy)return oc;Dy=1,Object.defineProperty(oc,"__esModule",{value:!0});class e extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return oc.default=e,oc}var Oy;function lb(){if(Oy)return sc;Oy=1,Object.defineProperty(sc,"__esModule",{value:!0});const t=oi.__importDefault(ab());class n{constructor(i){var l,c;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(l=i.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=i.signal,this.isMaybeSingle=(c=i.isMaybeSingle)!==null&&c!==void 0?c:!1,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,l){return this.headers=new Headers(this.headers),this.headers.set(i,l),this}then(i,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const c=this.fetch;let u=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var h,g,v,w;let x=null,E=null,C=null,b=f.status,k=f.statusText;if(f.ok){if(this.method!=="HEAD"){const R=await f.text();R===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((h=this.headers.get("Accept"))===null||h===void 0)&&h.includes("application/vnd.pgrst.plan+text"))?E=R:E=JSON.parse(R))}const N=(g=this.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),j=(v=f.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");N&&j&&j.length>1&&(C=parseInt(j[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(x={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,C=null,b=406,k="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const N=await f.text();try{x=JSON.parse(N),Array.isArray(x)&&f.status===404&&(E=[],x=null,b=200,k="OK")}catch{f.status===404&&N===""?(b=204,k="No Content"):x={message:N}}if(x&&this.isMaybeSingle&&(!((w=x?.details)===null||w===void 0)&&w.includes("0 rows"))&&(x=null,b=200,k="OK"),x&&this.shouldThrowOnError)throw new t.default(x)}return{error:x,data:E,count:C,status:b,statusText:k}});return this.shouldThrowOnError||(u=u.catch(f=>{var h,g,v;return{error:{message:`${(h=f?.name)!==null&&h!==void 0?h:"FetchError"}: ${f?.message}`,details:`${(g=f?.stack)!==null&&g!==void 0?g:""}`,hint:"",code:`${(v=f?.code)!==null&&v!==void 0?v:""}`},data:null,count:null,status:0,statusText:""}})),u.then(i,l)}returns(){return this}overrideTypes(){return this}}return sc.default=n,sc}var Ly;function cb(){if(Ly)return rc;Ly=1,Object.defineProperty(rc,"__esModule",{value:!0});const t=oi.__importDefault(lb());class n extends t.default{select(i){let l=!1;const c=(i??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:l=!0,nullsFirst:c,foreignTable:u,referencedTable:f=u}={}){const h=f?`${f}.order`:"order",g=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${g?`${g},`:""}${i}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:l,referencedTable:c=l}={}){const u=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(u,`${i}`),this}range(i,l,{foreignTable:c,referencedTable:u=c}={}){const f=typeof u>"u"?"offset":`${u}.offset`,h=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(f,`${i}`),this.url.searchParams.set(h,`${l-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:l=!1,settings:c=!1,buffers:u=!1,wal:f=!1,format:h="text"}={}){var g;const v=[i?"analyze":null,l?"verbose":null,c?"settings":null,u?"buffers":null,f?"wal":null].filter(Boolean).join("|"),w=(g=this.headers.get("Accept"))!==null&&g!==void 0?g:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${h}; for="${w}"; options=${v};`),h==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return rc.default=n,rc}var My;function xm(){if(My)return nc;My=1,Object.defineProperty(nc,"__esModule",{value:!0});const t=oi.__importDefault(cb()),n=new RegExp("[,()]");class s extends t.default{eq(l,c){return this.url.searchParams.append(l,`eq.${c}`),this}neq(l,c){return this.url.searchParams.append(l,`neq.${c}`),this}gt(l,c){return this.url.searchParams.append(l,`gt.${c}`),this}gte(l,c){return this.url.searchParams.append(l,`gte.${c}`),this}lt(l,c){return this.url.searchParams.append(l,`lt.${c}`),this}lte(l,c){return this.url.searchParams.append(l,`lte.${c}`),this}like(l,c){return this.url.searchParams.append(l,`like.${c}`),this}likeAllOf(l,c){return this.url.searchParams.append(l,`like(all).{${c.join(",")}}`),this}likeAnyOf(l,c){return this.url.searchParams.append(l,`like(any).{${c.join(",")}}`),this}ilike(l,c){return this.url.searchParams.append(l,`ilike.${c}`),this}ilikeAllOf(l,c){return this.url.searchParams.append(l,`ilike(all).{${c.join(",")}}`),this}ilikeAnyOf(l,c){return this.url.searchParams.append(l,`ilike(any).{${c.join(",")}}`),this}is(l,c){return this.url.searchParams.append(l,`is.${c}`),this}in(l,c){const u=Array.from(new Set(c)).map(f=>typeof f=="string"&&n.test(f)?`"${f}"`:`${f}`).join(",");return this.url.searchParams.append(l,`in.(${u})`),this}contains(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cs.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cs.{${c.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(c)}`),this}containedBy(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cd.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cd.{${c.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(c)}`),this}rangeGt(l,c){return this.url.searchParams.append(l,`sr.${c}`),this}rangeGte(l,c){return this.url.searchParams.append(l,`nxl.${c}`),this}rangeLt(l,c){return this.url.searchParams.append(l,`sl.${c}`),this}rangeLte(l,c){return this.url.searchParams.append(l,`nxr.${c}`),this}rangeAdjacent(l,c){return this.url.searchParams.append(l,`adj.${c}`),this}overlaps(l,c){return typeof c=="string"?this.url.searchParams.append(l,`ov.${c}`):this.url.searchParams.append(l,`ov.{${c.join(",")}}`),this}textSearch(l,c,{config:u,type:f}={}){let h="";f==="plain"?h="pl":f==="phrase"?h="ph":f==="websearch"&&(h="w");const g=u===void 0?"":`(${u})`;return this.url.searchParams.append(l,`${h}fts${g}.${c}`),this}match(l){return Object.entries(l).forEach(([c,u])=>{this.url.searchParams.append(c,`eq.${u}`)}),this}not(l,c,u){return this.url.searchParams.append(l,`not.${c}.${u}`),this}or(l,{foreignTable:c,referencedTable:u=c}={}){const f=u?`${u}.or`:"or";return this.url.searchParams.append(f,`(${l})`),this}filter(l,c,u){return this.url.searchParams.append(l,`${c}.${u}`),this}}return nc.default=s,nc}var $y;function db(){if($y)return tc;$y=1,Object.defineProperty(tc,"__esModule",{value:!0});const t=oi.__importDefault(xm());class n{constructor(i,{headers:l={},schema:c,fetch:u}){this.url=i,this.headers=new Headers(l),this.schema=c,this.fetch=u}select(i,l){const{head:c=!1,count:u}=l??{},f=c?"HEAD":"GET";let h=!1;const g=(i??"*").split("").map(v=>/\s/.test(v)&&!h?"":(v==='"'&&(h=!h),v)).join("");return this.url.searchParams.set("select",g),u&&this.headers.append("Prefer",`count=${u}`),new t.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:l,defaultToNull:c=!0}={}){var u;const f="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const h=i.reduce((g,v)=>g.concat(Object.keys(v)),[]);if(h.length>0){const g=[...new Set(h)].map(v=>`"${v}"`);this.url.searchParams.set("columns",g.join(","))}}return new t.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}upsert(i,{onConflict:l,ignoreDuplicates:c=!1,count:u,defaultToNull:f=!0}={}){var h;const g="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),u&&this.headers.append("Prefer",`count=${u}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const v=i.reduce((w,x)=>w.concat(Object.keys(x)),[]);if(v.length>0){const w=[...new Set(v)].map(x=>`"${x}"`);this.url.searchParams.set("columns",w.join(","))}}return new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}update(i,{count:l}={}){var c;const u="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:i}={}){var l;const c="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return tc.default=n,tc}var Fy;function xP(){if(Fy)return ec;Fy=1,Object.defineProperty(ec,"__esModule",{value:!0});const e=oi,t=e.__importDefault(db()),n=e.__importDefault(xm());class s{constructor(l,{headers:c={},schema:u,fetch:f}={}){this.url=l,this.headers=new Headers(c),this.schemaName=u,this.fetch=f}from(l){const c=new URL(`${this.url}/${l}`);return new t.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new s(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:u=!1,get:f=!1,count:h}={}){var g;let v;const w=new URL(`${this.url}/rpc/${l}`);let x;u||f?(v=u?"HEAD":"GET",Object.entries(c).filter(([C,b])=>b!==void 0).map(([C,b])=>[C,Array.isArray(b)?`{${b.join(",")}}`:`${b}`]).forEach(([C,b])=>{w.searchParams.append(C,b)})):(v="POST",x=c);const E=new Headers(this.headers);return h&&E.set("Prefer",`count=${h}`),new n.default({method:v,url:w,headers:E,schema:this.schemaName,body:x,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}}return ec.default=s,ec}var Uy;function bP(){if(Uy)return zt;Uy=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.PostgrestError=zt.PostgrestBuilder=zt.PostgrestTransformBuilder=zt.PostgrestFilterBuilder=zt.PostgrestQueryBuilder=zt.PostgrestClient=void 0;const e=oi,t=e.__importDefault(xP());zt.PostgrestClient=t.default;const n=e.__importDefault(db());zt.PostgrestQueryBuilder=n.default;const s=e.__importDefault(xm());zt.PostgrestFilterBuilder=s.default;const i=e.__importDefault(cb());zt.PostgrestTransformBuilder=i.default;const l=e.__importDefault(lb());zt.PostgrestBuilder=l.default;const c=e.__importDefault(ab());return zt.PostgrestError=c.default,zt.default={PostgrestClient:t.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:l.default,PostgrestError:c.default},zt}var ub=bP();const fb=Wh(ub),CP=qw({__proto__:null,default:fb},[ub]),{PostgrestClient:SP,PostgrestQueryBuilder:bF,PostgrestFilterBuilder:CF,PostgrestTransformBuilder:SF,PostgrestBuilder:EF,PostgrestError:_F}=fb||CP;class EP{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const s=n.node,i=parseInt(s.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let n=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(n+=`

Suggested solution: ${t.workaround}`),new Error(n)}static createWebSocket(t,n){const s=this.getWebSocketConstructor();return new s(t,n)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const _P="2.81.1",NP=`realtime-js/${_P}`,hb="1.0.0",kP="2.0.0",By=hb,xh=1e4,jP=1e3,TP=100;var Vs;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Vs||(Vs={}));var _t;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(_t||(_t={}));var Sn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Sn||(Sn={}));var bh;(function(e){e.websocket="websocket"})(bh||(bh={}));var Hs;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Hs||(Hs={}));class AP{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(t,n){if(this._isArrayBuffer(t.payload))return n(this._binaryEncodePush(t));if(t.event===this.BROADCAST&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(t));let s=[t.join_ref,t.ref,t.topic,t.event,t.payload];return n(JSON.stringify(s))}_binaryEncodePush(t){const{join_ref:n,ref:s,event:i,topic:l,payload:c}=t,u=this.META_LENGTH+n.length+s.length+l.length+i.length,f=new ArrayBuffer(this.HEADER_LENGTH+u);let h=new DataView(f),g=0;h.setUint8(g++,this.KINDS.push),h.setUint8(g++,n.length),h.setUint8(g++,s.length),h.setUint8(g++,l.length),h.setUint8(g++,i.length),Array.from(n,w=>h.setUint8(g++,w.charCodeAt(0))),Array.from(s,w=>h.setUint8(g++,w.charCodeAt(0))),Array.from(l,w=>h.setUint8(g++,w.charCodeAt(0))),Array.from(i,w=>h.setUint8(g++,w.charCodeAt(0)));var v=new Uint8Array(f.byteLength+c.byteLength);return v.set(new Uint8Array(f),0),v.set(new Uint8Array(c),f.byteLength),v.buffer}_binaryEncodeUserBroadcastPush(t){var n;return this._isArrayBuffer((n=t.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var n,s;const{join_ref:i,ref:l,topic:c}=t,u=t.payload.event,f=(s=(n=t.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:new ArrayBuffer(0),h=this.USER_BROADCAST_PUSH_META_LENGTH+i.length+l.length+c.length+u.length,g=new ArrayBuffer(this.HEADER_LENGTH+h);let v=new DataView(g),w=0;v.setUint8(w++,this.KINDS.userBroadcastPush),v.setUint8(w++,i.length),v.setUint8(w++,l.length),v.setUint8(w++,c.length),v.setUint8(w++,u.length),v.setUint8(w++,this.BINARY_ENCODING),Array.from(i,E=>v.setUint8(w++,E.charCodeAt(0))),Array.from(l,E=>v.setUint8(w++,E.charCodeAt(0))),Array.from(c,E=>v.setUint8(w++,E.charCodeAt(0))),Array.from(u,E=>v.setUint8(w++,E.charCodeAt(0)));var x=new Uint8Array(g.byteLength+f.byteLength);return x.set(new Uint8Array(g),0),x.set(new Uint8Array(f),g.byteLength),x.buffer}_encodeJsonUserBroadcastPush(t){var n,s;const{join_ref:i,ref:l,topic:c}=t,u=t.payload.event,f=(s=(n=t.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:{},g=new TextEncoder().encode(JSON.stringify(f)).buffer,v=this.USER_BROADCAST_PUSH_META_LENGTH+i.length+l.length+c.length+u.length,w=new ArrayBuffer(this.HEADER_LENGTH+v);let x=new DataView(w),E=0;x.setUint8(E++,this.KINDS.userBroadcastPush),x.setUint8(E++,i.length),x.setUint8(E++,l.length),x.setUint8(E++,c.length),x.setUint8(E++,u.length),x.setUint8(E++,this.JSON_ENCODING),Array.from(i,b=>x.setUint8(E++,b.charCodeAt(0))),Array.from(l,b=>x.setUint8(E++,b.charCodeAt(0))),Array.from(c,b=>x.setUint8(E++,b.charCodeAt(0))),Array.from(u,b=>x.setUint8(E++,b.charCodeAt(0)));var C=new Uint8Array(w.byteLength+g.byteLength);return C.set(new Uint8Array(w),0),C.set(new Uint8Array(g),w.byteLength),C.buffer}decode(t,n){if(this._isArrayBuffer(t)){let s=this._binaryDecode(t);return n(s)}if(typeof t=="string"){const s=JSON.parse(t),[i,l,c,u,f]=s;return n({join_ref:i,ref:l,topic:c,event:u,payload:f})}return n({})}_binaryDecode(t){const n=new DataView(t),s=n.getUint8(0),i=new TextDecoder;switch(s){case this.KINDS.push:return this._decodePush(t,n,i);case this.KINDS.reply:return this._decodeReply(t,n,i);case this.KINDS.broadcast:return this._decodeBroadcast(t,n,i);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,n,i)}}_decodePush(t,n,s){const i=n.getUint8(1),l=n.getUint8(2),c=n.getUint8(3);let u=this.HEADER_LENGTH+this.META_LENGTH-1;const f=s.decode(t.slice(u,u+i));u=u+i;const h=s.decode(t.slice(u,u+l));u=u+l;const g=s.decode(t.slice(u,u+c));u=u+c;const v=JSON.parse(s.decode(t.slice(u,t.byteLength)));return{join_ref:f,ref:null,topic:h,event:g,payload:v}}_decodeReply(t,n,s){const i=n.getUint8(1),l=n.getUint8(2),c=n.getUint8(3),u=n.getUint8(4);let f=this.HEADER_LENGTH+this.META_LENGTH;const h=s.decode(t.slice(f,f+i));f=f+i;const g=s.decode(t.slice(f,f+l));f=f+l;const v=s.decode(t.slice(f,f+c));f=f+c;const w=s.decode(t.slice(f,f+u));f=f+u;const x=JSON.parse(s.decode(t.slice(f,t.byteLength))),E={status:w,response:x};return{join_ref:h,ref:g,topic:v,event:Sn.reply,payload:E}}_decodeBroadcast(t,n,s){const i=n.getUint8(1),l=n.getUint8(2);let c=this.HEADER_LENGTH+2;const u=s.decode(t.slice(c,c+i));c=c+i;const f=s.decode(t.slice(c,c+l));c=c+l;const h=JSON.parse(s.decode(t.slice(c,t.byteLength)));return{join_ref:null,ref:null,topic:u,event:f,payload:h}}_decodeUserBroadcast(t,n,s){const i=n.getUint8(1),l=n.getUint8(2),c=n.getUint8(3),u=n.getUint8(4);let f=this.HEADER_LENGTH+4;const h=s.decode(t.slice(f,f+i));f=f+i;const g=s.decode(t.slice(f,f+l));f=f+l;const v=s.decode(t.slice(f,f+c));f=f+c;const w=t.slice(f,t.byteLength),x=u===this.JSON_ENCODING?JSON.parse(s.decode(w)):w,E={type:this.BROADCAST,event:g,payload:x};return c>0&&(E.meta=JSON.parse(v)),{join_ref:null,ref:null,topic:h,event:this.BROADCAST,payload:E}}_isArrayBuffer(t){var n;return t instanceof ArrayBuffer||((n=t?.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}}class mb{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var rt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(rt||(rt={}));const zy=(e,t,n={})=>{var s;const i=(s=n.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((l,c)=>(l[c]=RP(c,e,t,i),l),{}):{}},RP=(e,t,n,s)=>{const i=t.find(u=>u.name===e),l=i?.type,c=n[e];return l&&!s.includes(l)?pb(l,c):Ch(c)},pb=(e,t)=>{if(e.charAt(0)==="_"){const n=e.slice(1,e.length);return OP(t,n)}switch(e){case rt.bool:return PP(t);case rt.float4:case rt.float8:case rt.int2:case rt.int4:case rt.int8:case rt.numeric:case rt.oid:return IP(t);case rt.json:case rt.jsonb:return DP(t);case rt.timestamp:return LP(t);case rt.abstime:case rt.date:case rt.daterange:case rt.int4range:case rt.int8range:case rt.money:case rt.reltime:case rt.text:case rt.time:case rt.timestamptz:case rt.timetz:case rt.tsrange:case rt.tstzrange:return Ch(t);default:return Ch(t)}},Ch=e=>e,PP=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},IP=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},DP=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},OP=(e,t)=>{if(typeof e!="string")return e;const n=e.length-1,s=e[n];if(e[0]==="{"&&s==="}"){let l;const c=e.slice(1,n);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(u=>pb(t,u))}return e},LP=e=>typeof e=="string"?e.replace(" ","T"):e,gb=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class jf{constructor(t,n,s={},i=xh){this.channel=t,this.event=n,this.payload=s,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var s;return this._hasReceived(t)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Vy;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Vy||(Vy={}));class sa{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=n?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},i=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=sa.syncState(this.state,i,l,c),this.pendingDiffs.forEach(f=>{this.state=sa.syncDiff(this.state,f,l,c)}),this.pendingDiffs=[],u()}),this.channel._on(s.diff,{},i=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=sa.syncDiff(this.state,i,l,c),u())}),this.onJoin((i,l,c)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:l,newPresences:c})}),this.onLeave((i,l,c)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,s,i){const l=this.cloneDeep(t),c=this.transformState(n),u={},f={};return this.map(l,(h,g)=>{c[h]||(f[h]=g)}),this.map(c,(h,g)=>{const v=l[h];if(v){const w=g.map(b=>b.presence_ref),x=v.map(b=>b.presence_ref),E=g.filter(b=>x.indexOf(b.presence_ref)<0),C=v.filter(b=>w.indexOf(b.presence_ref)<0);E.length>0&&(u[h]=E),C.length>0&&(f[h]=C)}else u[h]=g}),this.syncDiff(l,{joins:u,leaves:f},s,i)}static syncDiff(t,n,s,i){const{joins:l,leaves:c}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),i||(i=()=>{}),this.map(l,(u,f)=>{var h;const g=(h=t[u])!==null&&h!==void 0?h:[];if(t[u]=this.cloneDeep(f),g.length>0){const v=t[u].map(x=>x.presence_ref),w=g.filter(x=>v.indexOf(x.presence_ref)<0);t[u].unshift(...w)}s(u,g,f)}),this.map(c,(u,f)=>{let h=t[u];if(!h)return;const g=f.map(v=>v.presence_ref);h=h.filter(v=>g.indexOf(v.presence_ref)<0),t[u]=h,i(u,h,f),h.length===0&&delete t[u]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(s=>n(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,s)=>{const i=t[s];return"metas"in i?n[s]=i.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):n[s]=i,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Hy;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Hy||(Hy={}));var oa;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(oa||(oa={}));var Ar;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Ar||(Ar={}));class bm{constructor(t,n={config:{}},s){var i,l;if(this.topic=t,this.params=n,this.socket=s,this.bindings={},this.state=_t.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new jf(this,Sn.join,this.params,this.timeout),this.rejoinTimer=new mb(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=_t.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=_t.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=_t.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=_t.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=_t.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Sn.reply,{},(c,u)=>{this._trigger(this._replyEventName(u),c)}),this.presence=new sa(this),this.broadcastEndpointURL=gb(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,n=this.timeout){var s,i,l;if(this.socket.isConnected()||this.socket.connect(),this.state==_t.closed){const{config:{broadcast:c,presence:u,private:f}}=this.params,h=(i=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(x=>x.filter))!==null&&i!==void 0?i:[],g=!!this.bindings[oa.PRESENCE]&&this.bindings[oa.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,v={},w={broadcast:c,presence:Object.assign(Object.assign({},u),{enabled:g}),postgres_changes:h,private:f};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this._onError(x=>t?.(Ar.CHANNEL_ERROR,x)),this._onClose(()=>t?.(Ar.CLOSED)),this.updateJoinPayload(Object.assign({config:w},v)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:x})=>{var E;if(this.socket.setAuth(),x===void 0){t?.(Ar.SUBSCRIBED);return}else{const C=this.bindings.postgres_changes,b=(E=C?.length)!==null&&E!==void 0?E:0,k=[];for(let _=0;_<b;_++){const N=C[_],{filter:{event:j,schema:R,table:T,filter:P}}=N,O=x&&x[_];if(O&&O.event===j&&O.schema===R&&O.table===T&&O.filter===P)k.push(Object.assign(Object.assign({},N),{id:O.id}));else{this.unsubscribe(),this.state=_t.errored,t?.(Ar.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=k,t&&t(Ar.SUBSCRIBED);return}}).receive("error",x=>{this.state=_t.errored,t?.(Ar.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{t?.(Ar.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,s){return this.state===_t.joined&&t===oa.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,n,s)}async httpSend(t,n,s={}){var i;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const c={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:n,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(i=s.timeout)!==null&&i!==void 0?i:this.timeout);if(u.status===202)return{success:!0};let f=u.statusText;try{const h=await u.json();f=h.error||h.message||f}catch{}return Promise.reject(new Error(f))}async send(t,n={}){var s,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=t,f={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((i=h.body)===null||i===void 0?void 0:i.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,u,f;const h=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((f=(u=(c=this.params)===null||c===void 0?void 0:c.config)===null||u===void 0?void 0:u.broadcast)===null||f===void 0)&&f.ack)&&l("ok"),h.receive("ok",()=>l("ok")),h.receive("error",()=>l("error")),h.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=_t.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Sn.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(i=>{s=new jf(this,Sn.leave,{},t),s.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=_t.closed,this.bindings={}}async _fetchWithTimeout(t,n,s){const i=new AbortController,l=setTimeout(()=>i.abort(),s),c=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(l),c}_push(t,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new jf(this,t,n,s);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>TP){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(t,n,s){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,s){var i,l;const c=t.toLocaleLowerCase(),{close:u,error:f,leave:h,join:g}=Sn;if(s&&[u,f,h,g].indexOf(c)>=0&&s!==this._joinRef())return;let w=this._onMessage(c,n,s);if(n&&!w)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(x=>{var E,C,b;return((E=x.filter)===null||E===void 0?void 0:E.event)==="*"||((b=(C=x.filter)===null||C===void 0?void 0:C.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===c}).map(x=>x.callback(w,s)):(l=this.bindings[c])===null||l===void 0||l.filter(x=>{var E,C,b,k,_,N;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in x){const j=x.id,R=(E=x.filter)===null||E===void 0?void 0:E.event;return j&&((C=n.ids)===null||C===void 0?void 0:C.includes(j))&&(R==="*"||R?.toLocaleLowerCase()===((b=n.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const j=(_=(k=x?.filter)===null||k===void 0?void 0:k.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return j==="*"||j===((N=n?.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===c}).map(x=>{if(typeof w=="object"&&"ids"in w){const E=w.data,{schema:C,table:b,commit_timestamp:k,type:_,errors:N}=E;w=Object.assign(Object.assign({},{schema:C,table:b,commit_timestamp:k,eventType:_,new:{},old:{},errors:N}),this._getPayloadRecords(E))}x.callback(w,s)})}_isClosed(){return this.state===_t.closed}_isJoined(){return this.state===_t.joined}_isJoining(){return this.state===_t.joining}_isLeaving(){return this.state===_t.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,s){const i=t.toLocaleLowerCase(),l={type:i,filter:n,callback:s};return this.bindings[i]?this.bindings[i].push(l):this.bindings[i]=[l],this}_off(t,n){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(i=>{var l;return!(((l=i.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===s&&bm.isEqual(i.filter,n))})),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const s in t)if(t[s]!==n[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Sn.close,{},t)}_onError(t){this._on(Sn.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=_t.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=zy(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=zy(t.columns,t.old_record)),n}}const Tf=()=>{},ic={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},MP=[1e3,2e3,5e3,1e4],$P=1e4,FP=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class UP{constructor(t,n){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=xh,this.transport=null,this.heartbeatIntervalMs=ic.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Tf,this.ref=0,this.reconnectTimer=null,this.vsn=By,this.logger=Tf,this.conn=null,this.sendBuffer=[],this.serializer=new AP,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...l)=>i(...l):(...l)=>fetch(...l),!(!((s=n?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${t}/${bh.websocket}`,this.httpEndpoint=gb(t),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=EP.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const n=t.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,s){this.logger(t,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Vs.connecting:return Hs.Connecting;case Vs.open:return Hs.Open;case Vs.closing:return Hs.Closing;default:return Hs.Closed}}isConnected(){return this.connectionState()===Hs.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,n={config:{}}){const s=`realtime:${t}`,i=this.getChannels().find(l=>l.topic===s);if(i)return i;{const l=new bm(`realtime:${t}`,n,this);return this.channels.push(l),l}}push(t){const{topic:n,event:s,payload:i,ref:l}=t,c=()=>{this.encode(t,u=>{var f;(f=this.conn)===null||f===void 0||f.send(u)})};this.log("push",`${n} ${s} (${l})`,i),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(jP,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},ic.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(h){this.log("error","error in heartbeat callback",h)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:i,payload:l,ref:c}=n,u=c?`(${c})`:"",f=l.status||"";this.log("receive",`${f} ${s} ${i} ${u}`.trim(),l),this.channels.filter(h=>h._isMember(s)).forEach(h=>h._trigger(i,l,c)),this._triggerStateCallbacks("message",n)})}_clearTimer(t){var n;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Vs.open||this.conn.readyState===Vs.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var n;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Sn.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const s=t.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${t}${s}${i}`}_workerObjectUrl(t){let n;if(t)n=t;else{const s=new Blob([FP],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}_setConnectionState(t,n=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(t=null){let n;t?n=t:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(s=>{const i={access_token:n,version:NP};n&&s.updateJoinPayload(i),s.joinedOnce&&s._isJoined()&&s._push(Sn.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${t}`,n)})}_triggerStateCallbacks(t,n){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(n)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new mb(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ic.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var n,s,i,l,c,u,f,h,g,v,w,x;switch(this.transport=(n=t?.transport)!==null&&n!==void 0?n:null,this.timeout=(s=t?.timeout)!==null&&s!==void 0?s:xh,this.heartbeatIntervalMs=(i=t?.heartbeatIntervalMs)!==null&&i!==void 0?i:ic.HEARTBEAT_INTERVAL,this.worker=(l=t?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=t?.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:Tf,this.vsn=(f=t?.vsn)!==null&&f!==void 0?f:By,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=t?.reconnectAfterMs)!==null&&h!==void 0?h:(E=>MP[E-1]||$P),this.vsn){case hb:this.encode=(g=t?.encode)!==null&&g!==void 0?g:((E,C)=>C(JSON.stringify(E))),this.decode=(v=t?.decode)!==null&&v!==void 0?v:((E,C)=>C(JSON.parse(E)));break;case kP:this.encode=(w=t?.encode)!==null&&w!==void 0?w:this.serializer.encode.bind(this.serializer),this.decode=(x=t?.decode)!==null&&x!==void 0?x:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class Cm extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ut(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class BP extends Cm{constructor(t,n,s){super(t),this.name="StorageApiError",this.status=n,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Sh extends Cm{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}const Sm=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),zP=()=>Response,Eh=e=>{if(Array.isArray(e))return e.map(n=>Eh(n));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([n,s])=>{const i=n.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[i]=Eh(s)}),t},VP=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Af=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},HP=(e,t,n)=>je(void 0,void 0,void 0,function*(){const s=yield zP();e instanceof s&&!n?.noResolveJson?e.json().then(i=>{const l=e.status||500,c=i?.statusCode||l+"";t(new BP(Af(i),l,c))}).catch(i=>{t(new Sh(Af(i),i))}):t(new Sh(Af(e),e))}),WP=(e,t,n,s)=>{const i={method:e,headers:t?.headers||{}};return e==="GET"||!s?i:(VP(s)?(i.headers=Object.assign({"Content-Type":"application/json"},t?.headers),i.body=JSON.stringify(s)):i.body=s,t?.duplex&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),n))};function Aa(e,t,n,s,i,l){return je(this,void 0,void 0,function*(){return new Promise((c,u)=>{e(n,WP(t,s,i,l)).then(f=>{if(!f.ok)throw f;return s?.noResolveJson?f:f.json()}).then(f=>c(f)).catch(f=>HP(f,u,s))})})}function pa(e,t,n,s){return je(this,void 0,void 0,function*(){return Aa(e,"GET",t,n,s)})}function Yn(e,t,n,s,i){return je(this,void 0,void 0,function*(){return Aa(e,"POST",t,s,i,n)})}function _h(e,t,n,s,i){return je(this,void 0,void 0,function*(){return Aa(e,"PUT",t,s,i,n)})}function qP(e,t,n,s){return je(this,void 0,void 0,function*(){return Aa(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),s)})}function Em(e,t,n,s,i){return je(this,void 0,void 0,function*(){return Aa(e,"DELETE",t,s,i,n)})}class GP{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n}then(t,n){return this.execute().then(t,n)}execute(){return je(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ut(t))return{data:null,error:t};throw t}})}}var vb;class KP{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n,this[vb]="BlobDownloadBuilder",this.promise=null}asStream(){return new GP(this.downloadFn,this.shouldThrowOnError)}then(t,n){return this.getPromise().then(t,n)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return je(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ut(t))return{data:null,error:t};throw t}})}}vb=Symbol.toStringTag;const YP={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Wy={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class JP{constructor(t,n={},s,i){this.shouldThrowOnError=!1,this.url=t,this.headers=n,this.bucketId=s,this.fetch=Sm(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,n,s,i){return je(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},Wy),i);let u=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(c.upsert)});const f=c.metadata;typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),f&&l.append("metadata",this.encodeMetadata(f)),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.has("cacheControl")||l.append("cacheControl",c.cacheControl),f&&!l.has("metadata")&&l.append("metadata",this.encodeMetadata(f))):(l=s,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType,f&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(f))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!c.duplex&&(c.duplex="half")),i?.headers&&(u=Object.assign(Object.assign({},u),i.headers));const h=this._removeEmptyFolders(n),g=this._getFinalPath(h),v=yield(t=="PUT"?_h:Yn)(this.fetch,`${this.url}/object/${g}`,l,Object.assign({headers:u},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:h,id:v.Id,fullPath:v.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ut(l))return{data:null,error:l};throw l}})}upload(t,n,s){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,s)})}uploadToSignedUrl(t,n,s,i){return je(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),u=new URL(this.url+`/object/upload/sign/${c}`);u.searchParams.set("token",n);try{let f;const h=Object.assign({upsert:Wy.upsert},i),g=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob<"u"&&s instanceof Blob?(f=new FormData,f.append("cacheControl",h.cacheControl),f.append("",s)):typeof FormData<"u"&&s instanceof FormData?(f=s,f.append("cacheControl",h.cacheControl)):(f=s,g["cache-control"]=`max-age=${h.cacheControl}`,g["content-type"]=h.contentType);const v=yield _h(this.fetch,u.toString(),f,{headers:g});return{data:{path:l,fullPath:v.Key},error:null}}catch(f){if(this.shouldThrowOnError)throw f;if(ut(f))return{data:null,error:f};throw f}})}createSignedUploadUrl(t,n){return je(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t);const i=Object.assign({},this.headers);n?.upsert&&(i["x-upsert"]="true");const l=yield Yn(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:i}),c=new URL(this.url+l.url),u=c.searchParams.get("token");if(!u)throw new Cm("No token returned by API");return{data:{signedUrl:c.toString(),path:t,token:u},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ut(s))return{data:null,error:s};throw s}})}update(t,n,s){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,s)})}move(t,n,s){return je(this,void 0,void 0,function*(){try{return{data:yield Yn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ut(i))return{data:null,error:i};throw i}})}copy(t,n,s){return je(this,void 0,void 0,function*(){try{return{data:{path:(yield Yn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ut(i))return{data:null,error:i};throw i}})}createSignedUrl(t,n,s){return je(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),l=yield Yn(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const c=s?.download?`&download=${s.download===!0?"":s.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ut(i))return{data:null,error:i};throw i}})}createSignedUrls(t,n,s){return je(this,void 0,void 0,function*(){try{const i=yield Yn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),l=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:i.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ut(i))return{data:null,error:i};throw i}})}download(t,n){const i=typeof n?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(n?.transform||{}),c=l?`?${l}`:"",u=this._getFinalPath(t),f=()=>pa(this.fetch,`${this.url}/${i}/${u}${c}`,{headers:this.headers,noResolveJson:!0});return new KP(f,this.shouldThrowOnError)}info(t){return je(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const s=yield pa(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Eh(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ut(s))return{data:null,error:s};throw s}})}exists(t){return je(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield qP(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ut(s)&&s instanceof Sh){const i=s.originalError;if([400,404].includes(i?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(t,n){const s=this._getFinalPath(t),i=[],l=n?.download?`download=${n.download===!0?"":n.download}`:"";l!==""&&i.push(l);const u=typeof n?.transform<"u"?"render/image":"object",f=this.transformOptsToQueryString(n?.transform||{});f!==""&&i.push(f);let h=i.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${s}${h}`)}}}remove(t){return je(this,void 0,void 0,function*(){try{return{data:yield Em(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}list(t,n,s){return je(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},YP),n),{prefix:t||""});return{data:yield Yn(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},s),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ut(i))return{data:null,error:i};throw i}})}listV2(t,n){return je(this,void 0,void 0,function*(){try{const s=Object.assign({},t);return{data:yield Yn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ut(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const yb="2.81.1",wb={"X-Client-Info":`storage-js/${yb}`};class QP{constructor(t,n={},s,i){this.shouldThrowOnError=!1;const l=new URL(t);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},wb),n),this.fetch=Sm(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return je(this,void 0,void 0,function*(){try{const n=this.listBucketOptionsToQueryString(t);return{data:yield pa(this.fetch,`${this.url}/bucket${n}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}getBucket(t){return je(this,void 0,void 0,function*(){try{return{data:yield pa(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}createBucket(t){return je(this,arguments,void 0,function*(n,s={public:!1}){try{return{data:yield Yn(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ut(i))return{data:null,error:i};throw i}})}updateBucket(t,n){return je(this,void 0,void 0,function*(){try{return{data:yield _h(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ut(s))return{data:null,error:s};throw s}})}emptyBucket(t){return je(this,void 0,void 0,function*(){try{return{data:yield Yn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}deleteBucket(t){return je(this,void 0,void 0,function*(){try{return{data:yield Em(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}listBucketOptionsToQueryString(t){const n={};return t&&("limit"in t&&(n.limit=String(t.limit)),"offset"in t&&(n.offset=String(t.offset)),t.search&&(n.search=t.search),t.sortColumn&&(n.sortColumn=t.sortColumn),t.sortOrder&&(n.sortOrder=t.sortOrder)),Object.keys(n).length>0?"?"+new URLSearchParams(n).toString():""}}class XP{constructor(t,n={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},wb),n),this.fetch=Sm(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return je(this,void 0,void 0,function*(){try{return{data:yield Yn(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}listBuckets(t){return je(this,void 0,void 0,function*(){try{const n=new URLSearchParams;t?.limit!==void 0&&n.set("limit",t.limit.toString()),t?.offset!==void 0&&n.set("offset",t.offset.toString()),t?.sortColumn&&n.set("sortColumn",t.sortColumn),t?.sortOrder&&n.set("sortOrder",t.sortOrder),t?.search&&n.set("search",t.search);const s=n.toString(),i=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield pa(this.fetch,i,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}deleteBucket(t){return je(this,void 0,void 0,function*(){try{return{data:yield Em(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}}const _m={"X-Client-Info":`storage-js/${yb}`,"Content-Type":"application/json"};class xb extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function hn(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class Rf extends xb{constructor(t,n,s){super(t),this.name="StorageVectorsApiError",this.status=n,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class ZP extends xb{constructor(t,n){super(t),this.name="StorageVectorsUnknownError",this.originalError=n}}var qy;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(qy||(qy={}));const Nm=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),eI=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Gy=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),tI=(e,t,n)=>je(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!n?.noResolveJson){const i=e.status||500,l=e;if(typeof l.json=="function")l.json().then(c=>{const u=c?.statusCode||c?.code||i+"";t(new Rf(Gy(c),i,u))}).catch(()=>{const c=i+"",u=l.statusText||`HTTP ${i} error`;t(new Rf(u,i,c))});else{const c=i+"",u=l.statusText||`HTTP ${i} error`;t(new Rf(u,i,c))}}else t(new ZP(Gy(e),e))}),nI=(e,t,n,s)=>{const i={method:e,headers:t?.headers||{}};return s?(eI(s)?(i.headers=Object.assign({"Content-Type":"application/json"},t?.headers),i.body=JSON.stringify(s)):i.body=s,Object.assign(Object.assign({},i),n)):i};function rI(e,t,n,s,i,l){return je(this,void 0,void 0,function*(){return new Promise((c,u)=>{e(n,nI(t,s,i,l)).then(f=>{if(!f.ok)throw f;if(s?.noResolveJson)return f;const h=f.headers.get("content-type");return!h||!h.includes("application/json")?{}:f.json()}).then(f=>c(f)).catch(f=>tI(f,u,s))})})}function mn(e,t,n,s,i){return je(this,void 0,void 0,function*(){return rI(e,"POST",t,s,i,n)})}class sI{constructor(t,n={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},_m),n),this.fetch=Nm(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return je(this,void 0,void 0,function*(){try{return{data:(yield mn(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(hn(n))return{data:null,error:n};throw n}})}getIndex(t,n){return je(this,void 0,void 0,function*(){try{return{data:yield mn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(hn(s))return{data:null,error:s};throw s}})}listIndexes(t){return je(this,void 0,void 0,function*(){try{return{data:yield mn(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(hn(n))return{data:null,error:n};throw n}})}deleteIndex(t,n){return je(this,void 0,void 0,function*(){try{return{data:(yield mn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(hn(s))return{data:null,error:s};throw s}})}}class oI{constructor(t,n={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},_m),n),this.fetch=Nm(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return je(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield mn(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(hn(n))return{data:null,error:n};throw n}})}getVectors(t){return je(this,void 0,void 0,function*(){try{return{data:yield mn(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(hn(n))return{data:null,error:n};throw n}})}listVectors(t){return je(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield mn(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(hn(n))return{data:null,error:n};throw n}})}queryVectors(t){return je(this,void 0,void 0,function*(){try{return{data:yield mn(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(hn(n))return{data:null,error:n};throw n}})}deleteVectors(t){return je(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield mn(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(hn(n))return{data:null,error:n};throw n}})}}class iI{constructor(t,n={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},_m),n),this.fetch=Nm(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return je(this,void 0,void 0,function*(){try{return{data:(yield mn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(hn(n))return{data:null,error:n};throw n}})}getBucket(t){return je(this,void 0,void 0,function*(){try{return{data:yield mn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(hn(n))return{data:null,error:n};throw n}})}listBuckets(){return je(this,arguments,void 0,function*(t={}){try{return{data:yield mn(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(hn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return je(this,void 0,void 0,function*(){try{return{data:(yield mn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(hn(n))return{data:null,error:n};throw n}})}}class aI extends iI{constructor(t,n={}){super(t,n.headers||{},n.fetch)}from(t){return new lI(this.url,this.headers,t,this.fetch)}}class lI extends sI{constructor(t,n,s,i){super(t,n,i),this.vectorBucketName=s}createIndex(t){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return je(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return je(this,arguments,void 0,function*(n={}){return t.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return je(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return je(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new cI(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class cI extends oI{constructor(t,n,s,i,l){super(t,n,l),this.vectorBucketName=s,this.indexName=i}putVectors(t){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return je(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return je(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return je(this,arguments,void 0,function*(n={}){return t.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return je(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return je(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class dI extends QP{constructor(t,n={},s,i){super(t,n,s,i)}from(t){return new JP(this.url,this.headers,t,this.fetch)}get vectors(){return new aI(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new XP(this.url+"/iceberg",this.headers,this.fetch)}}const uI="2.81.1";let Ji="";typeof Deno<"u"?Ji="deno":typeof document<"u"?Ji="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ji="react-native":Ji="node";const fI={"X-Client-Info":`supabase-js-${Ji}/${uI}`},hI={headers:fI},mI={schema:"public"},pI={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},gI={},vI=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),yI=()=>Headers,wI=(e,t,n)=>{const s=vI(n),i=yI();return async(l,c)=>{var u;const f=(u=await t())!==null&&u!==void 0?u:e;let h=new i(c?.headers);return h.has("apikey")||h.set("apikey",e),h.has("Authorization")||h.set("Authorization",`Bearer ${f}`),s(l,Object.assign(Object.assign({},c),{headers:h}))}};function xI(e){return e.endsWith("/")?e:e+"/"}function bI(e,t){var n,s;const{db:i,auth:l,realtime:c,global:u}=e,{db:f,auth:h,realtime:g,global:v}=t,w={db:Object.assign(Object.assign({},f),i),auth:Object.assign(Object.assign({},h),l),realtime:Object.assign(Object.assign({},g),c),storage:{},global:Object.assign(Object.assign(Object.assign({},v),u),{headers:Object.assign(Object.assign({},(n=v?.headers)!==null&&n!==void 0?n:{}),(s=u?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return e.accessToken?w.accessToken=e.accessToken:delete w.accessToken,w}function CI(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(xI(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const bb="2.81.1",Mo=30*1e3,Nh=3,Pf=Nh*Mo,SI="http://localhost:9999",EI="supabase.auth.token",_I={"X-Client-Info":`gotrue-js/${bb}`},kh="X-Supabase-Api-Version",Cb={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},NI=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,kI=600*1e3;class ga extends Error{constructor(t,n,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function Ae(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class jI extends ga{constructor(t,n,s){super(t,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function TI(e){return Ae(e)&&e.name==="AuthApiError"}class Ws extends ga{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class Cs extends ga{constructor(t,n,s,i){super(t,s,i),this.name=n,this.status=s}}class Wn extends Cs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function AI(e){return Ae(e)&&e.name==="AuthSessionMissingError"}class jo extends Cs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ac extends Cs{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class lc extends Cs{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function RI(e){return Ae(e)&&e.name==="AuthImplicitGrantRedirectError"}class Ky extends Cs{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class jh extends Cs{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function If(e){return Ae(e)&&e.name==="AuthRetryableFetchError"}class Yy extends Cs{constructor(t,n,s){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class Th extends Cs{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Mc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Jy=` 	
\r=`.split(""),PI=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Jy.length;t+=1)e[Jy[t].charCodeAt(0)]=-2;for(let t=0;t<Mc.length;t+=1)e[Mc[t].charCodeAt(0)]=t;return e})();function Qy(e,t,n){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;n(Mc[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;n(Mc[s]),t.queuedBits-=6}}function Sb(e,t,n){const s=PI[e];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Xy(e){const t=[],n=c=>{t.push(String.fromCodePoint(c))},s={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},l=c=>{OI(c,s,n)};for(let c=0;c<e.length;c+=1)Sb(e.charCodeAt(c),i,l);return t.join("")}function II(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function DI(e,t){for(let n=0;n<e.length;n+=1){let s=e.charCodeAt(n);if(s>55295&&s<=56319){const i=(s-55296)*1024&65535;s=(e.charCodeAt(n+1)-56320&65535|i)+65536,n+=1}II(s,t)}}function OI(e,t,n){if(t.utf8seq===0){if(e<=127){n(e);return}for(let s=1;s<6;s+=1)if((e>>7-s&1)===0){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function zo(e){const t=[],n={queue:0,queuedBits:0},s=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)Sb(e.charCodeAt(i),n,s);return new Uint8Array(t)}function LI(e){const t=[];return DI(e,n=>t.push(n)),new Uint8Array(t)}function qs(e){const t=[],n={queue:0,queuedBits:0},s=i=>{t.push(i)};return e.forEach(i=>Qy(i,n,s)),Qy(null,n,s),t.join("")}function MI(e){return Math.round(Date.now()/1e3)+e}function $I(){return Symbol("auth-callback")}const It=()=>typeof window<"u"&&typeof document<"u",Fs={tested:!1,writable:!1},Eb=()=>{if(!It())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Fs.tested)return Fs.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Fs.tested=!0,Fs.writable=!0}catch{Fs.tested=!0,Fs.writable=!1}return Fs.writable};function FI(e){const t={},n=new URL(e);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,l)=>{t[l]=i})}catch{}return n.searchParams.forEach((s,i)=>{t[i]=s}),t}const _b=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),UI=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",$o=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},Us=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},is=async(e,t)=>{await e.removeItem(t)};class fd{constructor(){this.promise=new fd.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}fd.promiseConstructor=Promise;function Df(e){const t=e.split(".");if(t.length!==3)throw new Th("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!NI.test(t[s]))throw new Th("JWT not in base64url format");return{header:JSON.parse(Xy(t[0])),payload:JSON.parse(Xy(t[1])),signature:zo(t[2]),raw:{header:t[0],payload:t[1]}}}async function BI(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function zI(e,t){return new Promise((s,i)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await e(l);if(!t(l,null,c)){s(c);return}}catch(c){if(!t(l,c)){i(c);return}}})()})}function VI(e){return("0"+e.toString(16)).substr(-2)}function HI(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let i="";for(let l=0;l<56;l++)i+=n.charAt(Math.floor(Math.random()*s));return i}return crypto.getRandomValues(t),Array.from(t,VI).join("")}async function WI(e){const n=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(s);return Array.from(i).map(l=>String.fromCharCode(l)).join("")}async function qI(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const n=await WI(e);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function To(e,t,n=!1){const s=HI();let i=s;n&&(i+="/PASSWORD_RECOVERY"),await $o(e,`${t}-code-verifier`,i);const l=await qI(s);return[l,s===l?"plain":"s256"]}const GI=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function KI(e){const t=e.headers.get(kh);if(!t||!t.match(GI))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function YI(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function JI(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const QI=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ao(e){if(!QI.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Of(){const e={};return new Proxy(e,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function XI(e,t){return new Proxy(e,{get:(n,s,i)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const l=s.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,s,i)}return!t.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(n,s,i)}})}function Zy(e){return JSON.parse(JSON.stringify(e))}const Bs=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ZI=[502,503,504];async function ew(e){var t;if(!UI(e))throw new jh(Bs(e),0);if(ZI.includes(e.status))throw new jh(Bs(e),e.status);let n;try{n=await e.json()}catch(l){throw new Ws(Bs(l),l)}let s;const i=KI(e);if(i&&i.getTime()>=Cb["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new Yy(Bs(n),e.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new Wn}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new Yy(Bs(n),e.status,n.weak_password.reasons);throw new jI(Bs(n),e.status||500,s)}const e2=(e,t,n,s)=>{const i={method:e,headers:t?.headers||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),i.body=JSON.stringify(s),Object.assign(Object.assign({},i),n))};async function Le(e,t,n,s){var i;const l=Object.assign({},s?.headers);l[kh]||(l[kh]=Cb["2024-01-01"].name),s?.jwt&&(l.Authorization=`Bearer ${s.jwt}`);const c=(i=s?.query)!==null&&i!==void 0?i:{};s?.redirectTo&&(c.redirect_to=s.redirectTo);const u=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",f=await t2(e,t,n+u,{headers:l,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(f):{data:Object.assign({},f),error:null}}async function t2(e,t,n,s,i,l){const c=e2(t,s,i,l);let u;try{u=await e(n,Object.assign({},c))}catch(f){throw console.error(f),new jh(Bs(f),0)}if(u.ok||await ew(u),s?.noResolveJson)return u;try{return await u.json()}catch(f){await ew(f)}}function qn(e){var t;let n=null;s2(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=MI(e.expires_in)));const s=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:n,user:s},error:null}}function tw(e){const t=qn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ls(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function n2(e){return{data:e,error:null}}function r2(e){const{action_link:t,email_otp:n,hashed_token:s,redirect_to:i,verification_type:l}=e,c=bs(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:n,hashed_token:s,redirect_to:i,verification_type:l},f=Object.assign({},c);return{data:{properties:u,user:f},error:null}}function nw(e){return e}function s2(e){return e.access_token&&e.refresh_token&&e.expires_in}const Lf=["global","local","others"];class o2{constructor({url:t="",headers:n={},fetch:s}){this.url=t,this.headers=n,this.fetch=_b(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,n=Lf[0]){if(Lf.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Lf.join(", ")}`);try{return await Le(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Ae(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,n={}){try{return await Le(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:ls})}catch(s){if(Ae(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:n}=t,s=bs(t,["options"]),i=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(i.new_email=s?.newEmail,delete i.newEmail),await Le(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:r2,redirectTo:n?.redirectTo})}catch(n){if(Ae(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await Le(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ls})}catch(n){if(Ae(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,s,i,l,c,u,f;try{const h={nextPage:null,lastPage:0,total:0},g=await Le(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=t?.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(l=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&l!==void 0?l:""},xform:nw});if(g.error)throw g.error;const v=await g.json(),w=(c=g.headers.get("x-total-count"))!==null&&c!==void 0?c:0,x=(f=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&f!==void 0?f:[];return x.length>0&&(x.forEach(E=>{const C=parseInt(E.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(E.split(";")[1].split("=")[1]);h[`${b}Page`]=C}),h.total=parseInt(w)),{data:Object.assign(Object.assign({},v),h),error:null}}catch(h){if(Ae(h))return{data:{users:[]},error:h};throw h}}async getUserById(t){Ao(t);try{return await Le(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ls})}catch(n){if(Ae(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){Ao(t);try{return await Le(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:ls})}catch(s){if(Ae(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,n=!1){Ao(t);try{return await Le(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:ls})}catch(s){if(Ae(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){Ao(t.userId);try{const{data:n,error:s}=await Le(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:s}}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _deleteFactor(t){Ao(t.userId),Ao(t.id);try{return{data:await Le(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _listOAuthClients(t){var n,s,i,l,c,u,f;try{const h={nextPage:null,lastPage:0,total:0},g=await Le(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=t?.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(l=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&l!==void 0?l:""},xform:nw});if(g.error)throw g.error;const v=await g.json(),w=(c=g.headers.get("x-total-count"))!==null&&c!==void 0?c:0,x=(f=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&f!==void 0?f:[];return x.length>0&&(x.forEach(E=>{const C=parseInt(E.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(E.split(";")[1].split("=")[1]);h[`${b}Page`]=C}),h.total=parseInt(w)),{data:Object.assign(Object.assign({},v),h),error:null}}catch(h){if(Ae(h))return{data:{clients:[]},error:h};throw h}}async _createOAuthClient(t){try{return await Le(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _getOAuthClient(t){try{return await Le(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _updateOAuthClient(t,n){try{return await Le(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:n,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ae(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await Le(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(t){try{return await Le(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ae(n))return{data:null,error:n};throw n}}}function rw(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}const Ro={debug:!!(globalThis&&Eb()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Nb extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class i2 extends Nb{}async function a2(e,t,n){Ro.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),Ro.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async i=>{if(i){Ro.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await n()}finally{Ro.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw Ro.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new i2(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ro.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function l2(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function kb(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function c2(e){return parseInt(e,16)}function d2(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function u2(e){var t;const{chainId:n,domain:s,expirationTime:i,issuedAt:l=new Date,nonce:c,notBefore:u,requestId:f,resources:h,scheme:g,uri:v,version:w}=e;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!v)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(w!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${w}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const x=kb(e.address),E=g?`${g}://${s}`:s,C=e.statement?`${e.statement}
`:"",b=`${E} wants you to sign in with your Ethereum account:
${x}

${C}`;let k=`URI: ${v}
Version: ${w}
Chain ID: ${n}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(i&&(k+=`
Expiration Time: ${i.toISOString()}`),u&&(k+=`
Not Before: ${u.toISOString()}`),f&&(k+=`
Request ID: ${f}`),h){let _=`
Resources:`;for(const N of h){if(!N||typeof N!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${N}`);_+=`
- ${N}`}k+=_}return`${b}
${k}`}class bt extends Error{constructor({message:t,code:n,cause:s,name:i}){var l;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(l=i??(s instanceof Error?s.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=n}}class $c extends bt{constructor(t,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:t}),this.name="WebAuthnUnknownError",this.originalError=n}}function f2({error:e,options:t}){var n,s,i;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new bt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((n=l.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new bt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((s=l.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new bt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=l.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new bt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new bt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new bt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return l.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new bt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new bt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const c=window.location.hostname;if(jb(c)){if(l.rp.id!==c)return new bt({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new bt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new bt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new bt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new bt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function h2({error:e,options:t}){const{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new bt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new bt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(jb(s)){if(n.rpId!==s)return new bt({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new bt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new bt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new bt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class m2{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const p2=new m2;function g2(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:n,excludeCredentials:s}=e,i=bs(e,["challenge","user","excludeCredentials"]),l=zo(t).buffer,c=Object.assign(Object.assign({},n),{id:zo(n.id).buffer}),u=Object.assign(Object.assign({},i),{challenge:l,user:c});if(s&&s.length>0){u.excludeCredentials=new Array(s.length);for(let f=0;f<s.length;f++){const h=s[f];u.excludeCredentials[f]=Object.assign(Object.assign({},h),{id:zo(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return u}function v2(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:n}=e,s=bs(e,["challenge","allowCredentials"]),i=zo(t).buffer,l=Object.assign(Object.assign({},s),{challenge:i});if(n&&n.length>0){l.allowCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const u=n[c];l.allowCredentials[c]=Object.assign(Object.assign({},u),{id:zo(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function y2(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const n=e;return{id:e.id,rawId:e.id,response:{attestationObject:qs(new Uint8Array(e.response.attestationObject)),clientDataJSON:qs(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function w2(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const n=e,s=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:qs(new Uint8Array(i.authenticatorData)),clientDataJSON:qs(new Uint8Array(i.clientDataJSON)),signature:qs(new Uint8Array(i.signature)),userHandle:i.userHandle?qs(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function jb(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function sw(){var e,t;return!!(It()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function x2(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new $c("Browser returned unexpected credential type",t)}:{data:null,error:new $c("Empty credential response",t)}}catch(t){return{data:null,error:f2({error:t,options:e})}}}async function b2(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new $c("Browser returned unexpected credential type",t)}:{data:null,error:new $c("Empty credential response",t)}}catch(t){return{data:null,error:h2({error:t,options:e})}}}const C2={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},S2={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Fc(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),n=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),s={};for(const i of e)if(i)for(const l in i){const c=i[l];if(c!==void 0)if(Array.isArray(c))s[l]=c;else if(n(c))s[l]=c;else if(t(c)){const u=s[l];t(u)?s[l]=Fc(u,c):s[l]=Fc(c)}else s[l]=c}return s}function E2(e,t){return Fc(C2,e,t||{})}function _2(e,t){return Fc(S2,e,t||{})}class N2{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:n,friendlyName:s,signal:i},l){try{const{data:c,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:n});if(!c)return{data:null,error:u};const f=i??p2.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:h}=c.webauthn.credential_options.publicKey;h.name||(h.name=`${h.id}:${s}`),h.displayName||(h.displayName=h.name)}switch(c.webauthn.type){case"create":{const h=E2(c.webauthn.credential_options.publicKey,l?.create),{data:g,error:v}=await x2({publicKey:h,signal:f});return g?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:g}},error:null}:{data:null,error:v}}case"request":{const h=_2(c.webauthn.credential_options.publicKey,l?.request),{data:g,error:v}=await b2(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:h,signal:f}));return g?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:g}},error:null}:{data:null,error:v}}}}catch(c){return Ae(c)?{data:null,error:c}:{data:null,error:new Ws("Unexpected error in challenge",c)}}}async _verify({challengeId:t,factorId:n,webauthn:s}){return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},l){if(!n)return{data:null,error:new ga("rpId is required for WebAuthn authentication")};try{if(!sw())return{data:null,error:new Ws("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this.challenge({factorId:t,webauthn:{rpId:n,rpOrigins:s},signal:i},{request:l});if(!c)return{data:null,error:u};const{webauthn:f}=c;return this._verify({factorId:t,challengeId:c.challengeId,webauthn:{type:f.type,rpId:n,rpOrigins:s,credential_response:f.credential_response}})}catch(c){return Ae(c)?{data:null,error:c}:{data:null,error:new Ws("Unexpected error in authenticate",c)}}}async _register({friendlyName:t,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},l){if(!n)return{data:null,error:new ga("rpId is required for WebAuthn registration")};try{if(!sw())return{data:null,error:new Ws("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this._enroll({friendlyName:t});if(!c)return await this.client.mfa.listFactors().then(g=>{var v;return(v=g.data)===null||v===void 0?void 0:v.all.find(w=>w.factor_type==="webauthn"&&w.friendly_name===t&&w.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g?.id}):void 0),{data:null,error:u};const{data:f,error:h}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:n,rpOrigins:s},signal:i},{create:l});return f?this._verify({factorId:c.id,challengeId:f.challengeId,webauthn:{rpId:n,rpOrigins:s,type:f.webauthn.type,credential_response:f.webauthn.credential_response}}):{data:null,error:h}}catch(c){return Ae(c)?{data:null,error:c}:{data:null,error:new Ws("Unexpected error in register",c)}}}}l2();const k2={url:SI,storageKey:EI,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:_I,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function ow(e,t,n){return await n()}const Po={};class va{get jwks(){var t,n;return(n=(t=Po[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){Po[this.storageKey]=Object.assign(Object.assign({},Po[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=Po[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Po[this.storageKey]=Object.assign(Object.assign({},Po[this.storageKey]),{cachedAt:t})}constructor(t){var n,s,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},k2),t);if(this.storageKey=l.storageKey,this.instanceID=(n=va.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,va.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&It()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new o2({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=_b(l.fetch),this.lock=l.lock||ow,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,l.lock?this.lock=l.lock:It()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=a2:this.lock=ow,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new N2(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:Eb()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=rw(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=rw(this.memoryStorage)),It()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${bb}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let n={},s="none";if(It()&&(n=FI(window.location.href),this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce")),It()&&this.detectSessionInUrl&&s!=="none"){const{data:i,error:l}=await this._getSessionFromURL(n,s);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),RI(l)){const f=(t=l.details)===null||t===void 0?void 0:t.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:u}=i;return this._debug("#_initialize()","detected session in URL",c,"redirect type",u),await this._saveSession(c),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Ae(n)?this._returnResult({error:n}):this._returnResult({error:new Ws("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,s,i;try{const l=await Le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=t?.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(i=t?.options)===null||i===void 0?void 0:i.captchaToken}},xform:qn}),{data:c,error:u}=l;if(u||!c)return this._returnResult({data:{user:null,session:null},error:u});const f=c.session,h=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:h,session:f},error:null})}catch(l){if(Ae(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(t){var n,s,i;try{let l;if("email"in t){const{email:g,password:v,options:w}=t;let x=null,E=null;this.flowType==="pkce"&&([x,E]=await To(this.storage,this.storageKey)),l=await Le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:w?.emailRedirectTo,body:{email:g,password:v,data:(n=w?.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:w?.captchaToken},code_challenge:x,code_challenge_method:E},xform:qn})}else if("phone"in t){const{phone:g,password:v,options:w}=t;l=await Le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:v,data:(s=w?.data)!==null&&s!==void 0?s:{},channel:(i=w?.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:w?.captchaToken}},xform:qn})}else throw new ac("You must provide either an email or phone number and a password");const{data:c,error:u}=l;if(u||!c)return this._returnResult({data:{user:null,session:null},error:u});const f=c.session,h=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:h,session:f},error:null})}catch(l){if(Ae(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(t){try{let n;if("email"in t){const{email:l,password:c,options:u}=t;n=await Le(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:tw})}else if("phone"in t){const{phone:l,password:c,options:u}=t;n=await Le(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:tw})}else throw new ac("You must provide either an email or phone number and a password");const{data:s,error:i}=n;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!s||!s.session||!s.user){const l=new jo;return this._returnResult({data:{user:null,session:null},error:l})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:i})}catch(n){if(Ae(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(t){var n,s,i,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;switch(n){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(t){var n,s,i,l,c,u,f,h,g,v,w;let x,E;if("message"in t)x=t.message,E=t.signature;else{const{chain:C,wallet:b,statement:k,options:_}=t;let N;if(It())if(typeof b=="object")N=b;else{const G=window;if("ethereum"in G&&typeof G.ethereum=="object"&&"request"in G.ethereum&&typeof G.ethereum.request=="function")N=G.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!_?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=b}const j=new URL((n=_?.url)!==null&&n!==void 0?n:window.location.href),R=await N.request({method:"eth_requestAccounts"}).then(G=>G).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!R||R.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const T=kb(R[0]);let P=(s=_?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!P){const G=await N.request({method:"eth_chainId"});P=c2(G)}const O={domain:j.host,address:T,statement:k,uri:j.href,version:"1",chainId:P,nonce:(i=_?.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(c=(l=_?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(u=_?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(f=_?.signInWithEthereum)===null||f===void 0?void 0:f.notBefore,requestId:(h=_?.signInWithEthereum)===null||h===void 0?void 0:h.requestId,resources:(g=_?.signInWithEthereum)===null||g===void 0?void 0:g.resources};x=u2(O),E=await N.request({method:"personal_sign",params:[d2(x),T]})}try{const{data:C,error:b}=await Le(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:x,signature:E},!((v=t.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(w=t.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:qn});if(b)throw b;if(!C||!C.session||!C.user){const k=new jo;return this._returnResult({data:{user:null,session:null},error:k})}return C.session&&(await this._saveSession(C.session),await this._notifyAllSubscribers("SIGNED_IN",C.session)),this._returnResult({data:Object.assign({},C),error:b})}catch(C){if(Ae(C))return this._returnResult({data:{user:null,session:null},error:C});throw C}}async signInWithSolana(t){var n,s,i,l,c,u,f,h,g,v,w,x;let E,C;if("message"in t)E=t.message,C=t.signature;else{const{chain:b,wallet:k,statement:_,options:N}=t;let j;if(It())if(typeof k=="object")j=k;else{const T=window;if("solana"in T&&typeof T.solana=="object"&&("signIn"in T.solana&&typeof T.solana.signIn=="function"||"signMessage"in T.solana&&typeof T.solana.signMessage=="function"))j=T.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!N?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=k}const R=new URL((n=N?.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in j&&j.signIn){const T=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N?.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),_?{statement:_}:null));let P;if(Array.isArray(T)&&T[0]&&typeof T[0]=="object")P=T[0];else if(T&&typeof T=="object"&&"signedMessage"in T&&"signature"in T)P=T;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in P&&"signature"in P&&(typeof P.signedMessage=="string"||P.signedMessage instanceof Uint8Array)&&P.signature instanceof Uint8Array)E=typeof P.signedMessage=="string"?P.signedMessage:new TextDecoder().decode(P.signedMessage),C=P.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");E=[`${R.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(i=(s=N?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((l=N?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((c=N?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((u=N?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((f=N?.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((h=N?.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((v=(g=N?.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||v===void 0)&&v.length?["Resources",...N.signInWithSolana.resources.map(P=>`- ${P}`)]:[]].join(`
`);const T=await j.signMessage(new TextEncoder().encode(E),"utf8");if(!T||!(T instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");C=T}}try{const{data:b,error:k}=await Le(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:E,signature:qs(C)},!((w=t.options)===null||w===void 0)&&w.captchaToken?{gotrue_meta_security:{captcha_token:(x=t.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:qn});if(k)throw k;if(!b||!b.session||!b.user){const _=new jo;return this._returnResult({data:{user:null,session:null},error:_})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:k})}catch(b){if(Ae(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async _exchangeCodeForSession(t){const n=await Us(this.storage,`${this.storageKey}-code-verifier`),[s,i]=(n??"").split("/");try{const{data:l,error:c}=await Le(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:qn});if(await is(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!l||!l.session||!l.user){const u=new jo;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:i??null}),error:c})}catch(l){if(Ae(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(t){try{const{options:n,provider:s,token:i,access_token:l,nonce:c}=t,u=await Le(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:i,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:n?.captchaToken}},xform:qn}),{data:f,error:h}=u;if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!f||!f.session||!f.user){const g=new jo;return this._returnResult({data:{user:null,session:null},error:g})}return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),this._returnResult({data:f,error:h})}catch(n){if(Ae(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(t){var n,s,i,l,c;try{if("email"in t){const{email:u,options:f}=t;let h=null,g=null;this.flowType==="pkce"&&([h,g]=await To(this.storage,this.storageKey));const{error:v}=await Le(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(n=f?.data)!==null&&n!==void 0?n:{},create_user:(s=f?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:h,code_challenge_method:g},redirectTo:f?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:v})}if("phone"in t){const{phone:u,options:f}=t,{data:h,error:g}=await Le(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(i=f?.data)!==null&&i!==void 0?i:{},create_user:(l=f?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},channel:(c=f?.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:h?.message_id},error:g})}throw new ac("You must provide either an email or phone number.")}catch(u){if(Ae(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(t){var n,s;try{let i,l;"options"in t&&(i=(n=t.options)===null||n===void 0?void 0:n.redirectTo,l=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:c,error:u}=await Le(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:i,xform:qn});if(u)throw u;if(!c)throw new Error("An error occurred on token verification.");const f=c.session,h=c.user;return f?.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),this._returnResult({data:{user:h,session:f},error:null})}catch(i){if(Ae(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var n,s,i,l,c;try{let u=null,f=null;this.flowType==="pkce"&&([u,f]=await To(this.storage,this.storageKey));const h=await Le(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((i=t?.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:f}),headers:this.headers,xform:n2});return!((l=h.data)===null||l===void 0)&&l.url&&It()&&!(!((c=t.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(h.data.url),this._returnResult(h)}catch(u){if(Ae(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:s}=t;if(s)throw s;if(!n)throw new Wn;const{error:i}=await Le(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(Ae(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:s,type:i,options:l}=t,{error:c}=await Le(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:i,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in t){const{phone:s,type:i,options:l}=t,{data:c,error:u}=await Le(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:i,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:u})}throw new ac("You must provide either an email or phone number and a type")}catch(n){if(Ae(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await Us(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<Pf:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const c=await Us(this.userStorage,this.storageKey+"-user");c?.user?t.user=c.user:t.user=Of()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};t.user=XI(t.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Le(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ls}):await this._useSession(async n=>{var s,i,l;const{data:c,error:u}=n;if(u)throw u;return!(!((s=c.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Wn}:await Le(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(i=c.session)===null||i===void 0?void 0:i.access_token)!==null&&l!==void 0?l:void 0,xform:ls})})}catch(n){if(Ae(n))return AI(n)&&(await this._removeSession(),await is(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async s=>{const{data:i,error:l}=s;if(l)throw l;if(!i.session)throw new Wn;const c=i.session;let u=null,f=null;this.flowType==="pkce"&&t.email!=null&&([u,f]=await To(this.storage,this.storageKey));const{data:h,error:g}=await Le(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:f}),jwt:c.access_token,xform:ls});if(g)throw g;return c.user=h.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(s){if(Ae(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Wn;const n=Date.now()/1e3;let s=n,i=!0,l=null;const{payload:c}=Df(t.access_token);if(c.exp&&(s=c.exp,i=s<=n),i){const{data:u,error:f}=await this._callRefreshToken(t.refresh_token);if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!u)return{data:{user:null,session:null},error:null};l=u}else{const{data:u,error:f}=await this._getUser(t.access_token);if(f)throw f;l={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(n){if(Ae(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var s;if(!t){const{data:c,error:u}=n;if(u)throw u;t=(s=c.session)!==null&&s!==void 0?s:void 0}if(!t?.refresh_token)throw new Wn;const{data:i,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(Ae(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(t,n){try{if(!It())throw new lc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new lc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Ky("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new lc("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Ky("No code detected.");const{data:_,error:N}=await this._exchangeCodeForSession(t.code);if(N)throw N;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:i,access_token:l,refresh_token:c,expires_in:u,expires_at:f,token_type:h}=t;if(!l||!u||!c||!h)throw new lc("No session defined in URL");const g=Math.round(Date.now()/1e3),v=parseInt(u);let w=g+v;f&&(w=parseInt(f));const x=w-g;x*1e3<=Mo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${v}s`);const E=w-v;g-E>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",E,w,g):g-E<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",E,w,g);const{data:C,error:b}=await this._getUser(l);if(b)throw b;const k={provider_token:s,provider_refresh_token:i,access_token:l,expires_in:v,expires_at:w,refresh_token:c,token_type:h,user:C.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:k,redirectType:t.type},error:null})}catch(s){if(Ae(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await Us(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:i,error:l}=n;if(l)return this._returnResult({error:l});const c=(s=i.session)===null||s===void 0?void 0:s.access_token;if(c){const{error:u}=await this.admin.signOut(c,t);if(u&&!(TI(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return t!=="others"&&(await this._removeSession(),await is(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const n=$I(),s={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async n=>{var s,i;try{const{data:{session:l},error:c}=n;if(c)throw c;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,n={}){let s=null,i=null;this.flowType==="pkce"&&([s,i]=await To(this.storage,this.storageKey,!0));try{return await Le(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(l){if(Ae(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var t;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var n;try{const{data:s,error:i}=await this._useSession(async l=>{var c,u,f,h,g;const{data:v,error:w}=l;if(w)throw w;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(c=t.options)===null||c===void 0?void 0:c.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(f=t.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await Le(this.fetch,"GET",x,{headers:this.headers,jwt:(g=(h=v.session)===null||h===void 0?void 0:h.access_token)!==null&&g!==void 0?g:void 0})});if(i)throw i;return It()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:t.provider,url:s?.url},error:null})}catch(s){if(Ae(s))return this._returnResult({data:{provider:t.provider,url:null},error:s});throw s}}async linkIdentityIdToken(t){return await this._useSession(async n=>{var s;try{const{error:i,data:{session:l}}=n;if(i)throw i;const{options:c,provider:u,token:f,access_token:h,nonce:g}=t,v=await Le(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=l?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:u,id_token:f,access_token:h,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:qn}),{data:w,error:x}=v;return x?this._returnResult({data:{user:null,session:null},error:x}):!w||!w.session||!w.user?this._returnResult({data:{user:null,session:null},error:new jo}):(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("USER_UPDATED",w.session)),this._returnResult({data:w,error:x}))}catch(i){if(Ae(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async n=>{var s,i;const{data:l,error:c}=n;if(c)throw c;return await Le(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await zI(async i=>(i>0&&await BI(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await Le(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:qn})),(i,l)=>{const c=200*Math.pow(2,i);return l&&If(l)&&Date.now()+c-s<Mo})}catch(s){if(this._debug(n,"error",s),Ae(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",s),It()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,n;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const i=await Us(this.storage,this.storageKey);if(i&&this.userStorage){let c=await Us(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:i.user},await $o(this.userStorage,this.storageKey+"-user",c)),i.user=(t=c?.user)!==null&&t!==void 0?t:Of()}else if(i&&!i.user&&!i.user){const c=await Us(this.storage,this.storageKey+"-user");c&&c?.user?(i.user=c.user,await is(this.storage,this.storageKey+"-user"),await $o(this.storage,this.storageKey,i)):i.user=Of()}if(this._debug(s,"session from storage",i),!this._isValidSession(i)){this._debug(s,"session is not valid"),i!==null&&await this._removeSession();return}const l=((n=i.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Pf;if(this._debug(s,`session has${l?"":" not"} expired with margin of ${Pf}s`),l){if(this.autoRefreshToken&&i.refresh_token){const{error:c}=await this._callRefreshToken(i.refresh_token);c&&(console.error(c),If(c)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:u}=await this._getUser(i.access_token);!u&&c?.user?(i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(s,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(s,"error",i),console.error(i);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var n,s;if(!t)throw new Wn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new fd;const{data:l,error:c}=await this._refreshAccessToken(t);if(c)throw c;if(!l.session)throw new Wn;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const u={data:l.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(l){if(this._debug(i,"error",l),Ae(l)){const c={data:null,error:l};return If(l)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(c),c}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(l),l}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,n,s=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:n});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,n)}catch(f){l.push(f)}});if(await Promise.all(c),l.length>0){for(let u=0;u<l.length;u+=1)console.error(l[u]);throw l[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),s=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&n.user&&await $o(this.userStorage,this.storageKey+"-user",{user:n.user});const i=Object.assign({},n);delete i.user;const l=Zy(i);await $o(this.storage,this.storageKey,l)}else{const i=Zy(n);await $o(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await is(this.storage,this.storageKey),await is(this.storage,this.storageKey+"-code-verifier"),await is(this.storage,this.storageKey+"-user"),this.userStorage&&await is(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&It()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Mo);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((s.expires_at*1e3-t)/Mo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Mo}ms, refresh threshold is ${Nh} ticks`),i<=Nh&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Nb)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!It()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,s){const i=[`provider=${encodeURIComponent(n)}`];if(s?.redirectTo&&i.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&i.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[l,c]=await To(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});i.push(u.toString())}if(s?.queryParams){const l=new URLSearchParams(s.queryParams);i.push(l.toString())}return s?.skipBrowserRedirect&&i.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var s;const{data:i,error:l}=n;return l?this._returnResult({data:null,error:l}):await Le(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(t){try{return await this._useSession(async n=>{var s,i;const{data:l,error:c}=n;if(c)return this._returnResult({data:null,error:c});const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:f,error:h}=await Le(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(s=l?.session)===null||s===void 0?void 0:s.access_token});return h?this._returnResult({data:null,error:h}):(t.factorType==="totp"&&f.type==="totp"&&(!((i=f?.totp)===null||i===void 0)&&i.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),this._returnResult({data:f,error:null}))})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:i,error:l}=n;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?y2(t.webauthn.credential_response):w2(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:f}=await Le(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:c,headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token});return f?this._returnResult({data:null,error:f}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:f}))})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:i,error:l}=n;if(l)return this._returnResult({data:null,error:l});const c=await Le(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token});if(c.error)return c;const{data:u}=c;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:g2(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:v2(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(t){const{data:n,error:s}=await this._challenge({factorId:t.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){var t;const{data:{user:n},error:s}=await this.getUser();if(s)return{data:null,error:s};const i={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=n?.factors)!==null&&t!==void 0?t:[])i.all.push(l),l.status==="verified"&&i[l.factor_type].push(l);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var t,n;const{data:{session:s},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Df(s.access_token);let c=null;l.aal&&(c=l.aal);let u=c;((n=(t=s.user.factors)===null||t===void 0?void 0:t.filter(g=>g.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(u="aal2");const h=l.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async n=>{const{data:{session:s},error:i}=n;return i?this._returnResult({data:null,error:i}):s?await Le(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:s.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Wn})})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(t,n){try{return await this._useSession(async s=>{const{data:{session:i},error:l}=s;if(l)return this._returnResult({data:null,error:l});if(!i)return this._returnResult({data:null,error:new Wn});const c=await Le(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&It()&&!n?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(s){if(Ae(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(t,n){try{return await this._useSession(async s=>{const{data:{session:i},error:l}=s;if(l)return this._returnResult({data:null,error:l});if(!i)return this._returnResult({data:null,error:new Wn});const c=await Le(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&It()&&!n?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(s){if(Ae(s))return this._returnResult({data:null,error:s});throw s}}async fetchJwk(t,n={keys:[]}){let s=n.keys.find(u=>u.kid===t);if(s)return s;const i=Date.now();if(s=this.jwks.keys.find(u=>u.kid===t),s&&this.jwks_cached_at+kI>i)return s;const{data:l,error:c}=await Le(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=i,s=l.keys.find(u=>u.kid===t),!s)?null:s}async getClaims(t,n={}){try{let s=t;if(!s){const{data:x,error:E}=await this.getSession();if(E||!x.session)return this._returnResult({data:null,error:E});s=x.session.access_token}const{header:i,payload:l,signature:c,raw:{header:u,payload:f}}=Df(s);n?.allowExpired||YI(l.exp);const h=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,n?.keys?{keys:n.keys}:n?.jwks);if(!h){const{error:x}=await this.getUser(s);if(x)throw x;return{data:{claims:l,header:i,signature:c},error:null}}const g=JI(i.alg),v=await crypto.subtle.importKey("jwk",h,g,!0,["verify"]);if(!await crypto.subtle.verify(g,v,c,LI(`${u}.${f}`)))throw new Th("Invalid JWT signature");return{data:{claims:l,header:i,signature:c},error:null}}catch(s){if(Ae(s))return this._returnResult({data:null,error:s});throw s}}}va.nextInstanceID={};const j2=va;class T2 extends j2{constructor(t){super(t)}}class A2{constructor(t,n,s){var i,l,c;this.supabaseUrl=t,this.supabaseKey=n;const u=CI(t);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const f=`sb-${u.hostname.split(".")[0]}-auth-token`,h={db:mI,realtime:gI,auth:Object.assign(Object.assign({},pI),{storageKey:f}),global:hI},g=bI(s??{},h);this.storageKey=(i=g.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(l=g.global.headers)!==null&&l!==void 0?l:{},g.accessToken?(this.accessToken=g.accessToken,this.auth=new Proxy({},{get:(v,w)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(w)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=g.auth)!==null&&c!==void 0?c:{},this.headers,g.global.fetch),this.fetch=wI(n,this._getAccessToken.bind(this),g.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},g.realtime)),this.accessToken&&this.accessToken().then(v=>this.realtime.setAuth(v)).catch(v=>console.warn("Failed to set initial Realtime auth token:",v)),this.rest=new SP(new URL("rest/v1",u).href,{headers:this.headers,schema:g.db.schema,fetch:this.fetch}),this.storage=new dI(this.storageUrl.href,this.headers,this.fetch,s?.storage),g.accessToken||this._listenForAuthEvents()}get functions(){return new wP(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,n,s)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,n;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(n=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:s,storage:i,userStorage:l,storageKey:c,flowType:u,lock:f,debug:h,throwOnError:g},v,w){const x={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new T2({url:this.authUrl.href,headers:Object.assign(Object.assign({},x),v),storageKey:c,autoRefreshToken:t,persistSession:n,detectSessionInUrl:s,storage:i,userStorage:l,flowType:u,lock:f,debug:h,throwOnError:g,fetch:w,hasCustomAuthorizationHeader:Object.keys(this.headers).some(E=>E.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new UP(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,s)=>{this._handleTokenChanged(n,"CLIENT",s?.access_token)})}_handleTokenChanged(t,n,s){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const R2=(e,t,n)=>new A2(e,t,n);function P2(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}P2()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Tb="https://itmhojbjfacocrpmslmt.supabase.co",Ab="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml0bWhvamJqZmFjb2NycG1zbG10Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4ODExMDIsImV4cCI6MjA3NDQ1NzEwMn0.i8cdSYaeY7u4YaDqGI_92KmMwEpyEYt3ZZ9GuKxXVPk";console.log(" [SUPABASE CLIENT] Environment check:",{hasUrl:!0,hasKey:!0,urlLength:Tb?.length||0,keyLength:Ab?.length||0,mode:"production",dev:!1,prod:!0});const Y=R2(Tb,Ab,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0},realtime:{params:{eventsPerSecond:10}},global:{headers:{"x-client-info":"kidscallhome-web"}}}),km=Xc("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-base font-semibold ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ce=p.forwardRef(({className:e,variant:t,size:n,asChild:s=!1,...i},l)=>{const c=s?xN:"button";return a.jsx(c,{className:be(km({variant:t,size:n,className:e})),ref:l,...i})});ce.displayName="Button";const Te=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:be("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Te.displayName="Card";const I2=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:be("flex flex-col space-y-1.5 p-6",e),...t}));I2.displayName="CardHeader";const D2=p.forwardRef(({className:e,...t},n)=>a.jsx("h3",{ref:n,className:be("text-2xl font-semibold leading-none tracking-tight",e),...t}));D2.displayName="CardTitle";const O2=p.forwardRef(({className:e,...t},n)=>a.jsx("p",{ref:n,className:be("text-sm text-muted-foreground",e),...t}));O2.displayName="CardDescription";const L2=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:be("p-6 pt-0",e),...t}));L2.displayName="CardContent";const M2=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:be("flex items-center p-6 pt-0",e),...t}));M2.displayName="CardFooter";class $2 extends p.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t,errorInfo:null}}componentDidCatch(t,n){console.error(" [ERROR BOUNDARY] Caught error:",t,n),this.setState({error:t,errorInfo:n})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload()};render(){if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const t=this.state.error?.message?.includes("VITE_SUPABASE")||this.state.error?.message?.includes("environment variable");return a.jsx("div",{className:"min-h-[100dvh] flex items-center justify-center bg-gradient-to-br from-primary/5 via-background to-secondary/5 p-4",children:a.jsxs(Te,{className:"max-w-2xl w-full p-8 space-y-6",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(aa,{className:"h-12 w-12 text-destructive"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Something went wrong"}),a.jsx("p",{className:"text-muted-foreground mt-1",children:t?"Missing required configuration":"An unexpected error occurred"})]})]}),t?a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"The app is missing required environment variables. Please check:"}),a.jsxs("ul",{className:"list-disc list-inside space-y-2 text-sm text-muted-foreground ml-4",children:[a.jsx("li",{children:"VITE_SUPABASE_URL"}),a.jsx("li",{children:"VITE_SUPABASE_PUBLISHABLE_KEY"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Set these in your Vercel project settings (Settings  Environment Variables) or in a .env file for local development."})]}):a.jsx("div",{className:"space-y-4",children:this.state.error&&a.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4",children:[a.jsx("p",{className:"font-mono text-sm text-destructive break-all",children:this.state.error.toString()}),this.state.errorInfo&&a.jsxs("details",{className:"mt-4",children:[a.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground",children:"Stack trace"}),a.jsx("pre",{className:"mt-2 text-xs text-muted-foreground overflow-auto max-h-48",children:this.state.errorInfo.componentStack})]})]})}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx(ce,{onClick:this.handleReset,className:"flex-1",children:"Reload Page"}),a.jsx(ce,{variant:"outline",onClick:()=>window.location.href="/",className:"flex-1",children:"Go Home"})]})]})})}return this.props.children}}const F2=()=>{const e=tt();return a.jsx("div",{className:"min-h-[100dvh] bg-gradient-to-b from-primary/10 to-background",children:a.jsxs("div",{className:"container mx-auto px-4 py-16",children:[a.jsxs("div",{className:"text-center space-y-6 mb-16",children:[a.jsx("div",{className:"aspect-square w-20 mx-auto",children:a.jsx("img",{src:"/icon-192x192.png",alt:"Kids Call Home",className:"w-full h-full object-contain",width:"192",height:"192"})}),a.jsx("h1",{className:"text-5xl md:text-6xl font-bold text-primary",children:"Kids Call Home"}),a.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:"Stay connected with your family through simple video calls and messaging"})]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-8 max-w-4xl mx-auto",children:[a.jsxs(Te,{className:"p-8 cursor-pointer hover:shadow-xl transition-all border-4 border-primary/20 hover:border-primary/40",onClick:()=>e("/parent/auth"),children:[a.jsx(la,{className:"h-16 w-16 text-primary mb-4"}),a.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Parents"}),a.jsx("p",{className:"text-muted-foreground mb-6",children:"Create an account and add your children. Manage their access and stay connected."}),a.jsx(ce,{className:"w-full",size:"lg",children:"Parent Sign In"})]}),a.jsxs(Te,{className:"p-8 cursor-pointer hover:shadow-xl transition-all border-4 border-secondary/20 hover:border-secondary/40",onClick:()=>e("/child/login"),children:[a.jsx(Na,{className:"h-16 w-16 text-secondary mb-4"}),a.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Kids"}),a.jsx("p",{className:"text-muted-foreground mb-6",children:"Enter your special code to call and message your parents!"}),a.jsx(ce,{className:"w-full",size:"lg",variant:"secondary",children:"Kid Login"})]})]}),a.jsxs("div",{className:"mt-16 grid md:grid-cols-3 gap-8 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"text-center space-y-3",children:[a.jsx("div",{className:"text-4xl",children:""}),a.jsx("h3",{className:"font-bold text-xl",children:"Video Calls"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Face-to-face conversations anytime"})]}),a.jsxs("div",{className:"text-center space-y-3",children:[a.jsx("div",{className:"text-4xl",children:""}),a.jsx("h3",{className:"font-bold text-xl",children:"Messaging"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Send messages instantly"})]}),a.jsxs("div",{className:"text-center space-y-3",children:[a.jsx("div",{className:"text-4xl",children:""}),a.jsx("h3",{className:"font-bold text-xl",children:"Safe & Secure"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Private family connections only"})]})]}),a.jsx("div",{className:"mt-16 pt-8 border-t text-center",children:a.jsx(ce,{variant:"ghost",onClick:()=>e("/info"),className:"text-muted-foreground hover:text-foreground",children:"App Information & Legal"})})]})})},U2=()=>{const e=gn(),t=tt();return p.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),a.jsx("div",{className:"flex min-h-[100dvh] items-center justify-center bg-gradient-to-br from-primary/5 via-background to-secondary/5 p-4",children:a.jsxs("div",{className:"text-center space-y-8 max-w-md w-full",children:[a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"text-9xl font-bold text-primary/20 select-none",children:[a.jsx("span",{className:"inline-block animate-bounce",style:{animationDelay:"0s",animationDuration:"2s"},children:"4"}),a.jsx("span",{className:"inline-block animate-bounce",style:{animationDelay:"0.2s",animationDuration:"2s"},children:"0"}),a.jsx("span",{className:"inline-block animate-bounce",style:{animationDelay:"0.4s",animationDuration:"2s"},children:"4"})]}),a.jsx(Gs,{className:"absolute top-0 left-1/4 w-6 h-6 text-kid-purple animate-pulse",style:{animationDelay:"0.5s"}}),a.jsx(Gs,{className:"absolute top-4 right-1/4 w-5 h-5 text-kid-pink animate-pulse",style:{animationDelay:"1s"}}),a.jsx(Gs,{className:"absolute bottom-0 left-1/3 w-4 h-4 text-kid-green animate-pulse",style:{animationDelay:"1.5s"}})]}),a.jsxs("div",{className:"space-y-4 animate-fade-in",children:[a.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-foreground",children:"Oops! This page went on an adventure! "}),a.jsx("p",{className:"text-xl text-muted-foreground",children:"We couldn't find the page you're looking for. Maybe it's playing hide and seek?"})]}),a.jsx("div",{className:"flex justify-center",children:a.jsxs("div",{className:"relative",children:[a.jsx(Ak,{className:"w-24 h-24 text-primary/30 animate-spin-slow"}),a.jsx("div",{className:"absolute inset-0 border-4 border-primary/20 rounded-full animate-ping"})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center pt-4",children:[a.jsxs(ce,{onClick:()=>t("/"),size:"lg",className:"w-full sm:w-auto animate-fade-in-up",style:{animationDelay:"0.3s"},children:[a.jsx(Ys,{className:"mr-2 h-5 w-5"}),"Go Home"]}),a.jsx(ce,{onClick:()=>t(-1),variant:"outline",size:"lg",className:"w-full sm:w-auto animate-fade-in-up",style:{animationDelay:"0.5s"},children:"Go Back"})]}),a.jsxs("div",{className:"flex justify-center gap-4 text-2xl pt-4",children:[a.jsx("span",{className:"animate-bounce",style:{animationDelay:"0s"},children:""}),a.jsx("span",{className:"animate-bounce",style:{animationDelay:"0.2s"},children:""}),a.jsx("span",{className:"animate-bounce",style:{animationDelay:"0.4s"},children:""})]})]})})},B2=()=>{const e=tt(),t=()=>{window.location.reload()};return a.jsx("div",{className:"flex min-h-[100dvh] items-center justify-center bg-gradient-to-br from-destructive/5 via-background to-secondary/5 p-4",children:a.jsxs("div",{className:"text-center space-y-8 max-w-md w-full",children:[a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"text-9xl font-bold text-destructive/20 select-none",children:[a.jsx("span",{className:"inline-block animate-bounce",style:{animationDelay:"0s",animationDuration:"2s"},children:"5"}),a.jsx("span",{className:"inline-block animate-bounce",style:{animationDelay:"0.2s",animationDuration:"2s"},children:"0"}),a.jsx("span",{className:"inline-block animate-bounce",style:{animationDelay:"0.4s",animationDuration:"2s"},children:"0"})]}),a.jsx(kx,{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-16 h-16 text-destructive/40 animate-pulse"})]}),a.jsxs("div",{className:"space-y-4 animate-fade-in",children:[a.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-foreground",children:"Oops! Something went wrong! "}),a.jsx("p",{className:"text-xl text-muted-foreground",children:"Our servers are taking a little break. Don't worry, we're working on fixing it!"})]}),a.jsx("div",{className:"flex justify-center",children:a.jsx(ds,{className:"w-24 h-24 text-destructive/30 animate-spin-slow"})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center pt-4",children:[a.jsxs(ce,{onClick:t,size:"lg",className:"w-full sm:w-auto animate-fade-in-up",style:{animationDelay:"0.3s"},children:[a.jsx(ds,{className:"mr-2 h-5 w-5"}),"Try Again"]}),a.jsxs(ce,{onClick:()=>e("/"),variant:"outline",size:"lg",className:"w-full sm:w-auto animate-fade-in-up",style:{animationDelay:"0.5s"},children:[a.jsx(Ys,{className:"mr-2 h-5 w-5"}),"Go Home"]})]}),a.jsxs("div",{className:"flex justify-center gap-4 text-2xl pt-4",children:[a.jsx("span",{className:"animate-bounce",style:{animationDelay:"0s"},children:""}),a.jsx("span",{className:"animate-bounce",style:{animationDelay:"0.2s"},children:""}),a.jsx("span",{className:"animate-bounce",style:{animationDelay:"0.4s"},children:""})]})]})})},z2=()=>{const e=tt(),t=()=>{window.location.reload()};return a.jsx("div",{className:"flex min-h-[100dvh] items-center justify-center bg-gradient-to-br from-secondary/5 via-background to-primary/5 p-4",children:a.jsxs("div",{className:"text-center space-y-8 max-w-md w-full",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"text-9xl font-bold text-secondary/20 select-none flex items-center justify-center",children:a.jsx(ny,{className:"w-32 h-32 text-secondary/30"})}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsxs("div",{className:"relative w-40 h-40",children:[a.jsx("div",{className:"absolute inset-0 border-4 border-secondary/20 rounded-full animate-ping"}),a.jsx("div",{className:"absolute inset-0 border-4 border-secondary/20 rounded-full animate-ping",style:{animationDelay:"0.5s"}}),a.jsx("div",{className:"absolute inset-0 border-4 border-secondary/20 rounded-full animate-ping",style:{animationDelay:"1s"}})]})})]}),a.jsxs("div",{className:"space-y-4 animate-fade-in",children:[a.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-foreground",children:"Oops! No internet connection! "}),a.jsx("p",{className:"text-xl text-muted-foreground",children:"It looks like you're not connected to the internet. Check your connection and try again!"})]}),a.jsx("div",{className:"flex justify-center",children:a.jsxs("div",{className:"relative",children:[a.jsx(Lk,{className:"w-24 h-24 text-secondary/30 animate-pulse"}),a.jsx(ny,{className:"absolute inset-0 w-24 h-24 text-destructive/30 animate-pulse",style:{animationDelay:"0.5s"}})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center pt-4",children:[a.jsxs(ce,{onClick:t,size:"lg",className:"w-full sm:w-auto animate-fade-in-up",style:{animationDelay:"0.3s"},children:[a.jsx(ds,{className:"mr-2 h-5 w-5"}),"Try Again"]}),a.jsxs(ce,{onClick:()=>e("/"),variant:"outline",size:"lg",className:"w-full sm:w-auto animate-fade-in-up",style:{animationDelay:"0.5s"},children:[a.jsx(Ys,{className:"mr-2 h-5 w-5"}),"Go Home"]})]}),a.jsxs("div",{className:"flex justify-center gap-4 text-2xl pt-4",children:[a.jsx("span",{className:"animate-bounce",style:{animationDelay:"0s"},children:""}),a.jsx("span",{className:"animate-bounce",style:{animationDelay:"0.2s"},children:""}),a.jsx("span",{className:"animate-bounce",style:{animationDelay:"0.4s"},children:""})]})]})})},V2="modulepreload",H2=function(e){return"/"+e},iw={},gr=function(t,n,s){let i=Promise.resolve();if(n&&n.length>0){let f=function(h){return Promise.all(h.map(g=>Promise.resolve(g).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=c?.nonce||c?.getAttribute("nonce");i=f(n.map(h=>{if(h=H2(h),h in iw)return;iw[h]=!0;const g=h.endsWith(".css"),v=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${v}`))return;const w=document.createElement("link");if(w.rel=g?"stylesheet":V2,g||(w.as="script"),w.crossOrigin="",w.href=h,u&&w.setAttribute("nonce",u),document.head.appendChild(w),g)return new Promise((x,E)=>{w.addEventListener("load",x),w.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${h}`)))})}))}function l(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return i.then(c=>{for(const u of c||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})};function Rb(e){const t=p.useRef({value:e,previous:e});return p.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var hd="Checkbox",[W2]=Pn(hd),[q2,jm]=W2(hd);function G2(e){const{__scopeCheckbox:t,checked:n,children:s,defaultChecked:i,disabled:l,form:c,name:u,onCheckedChange:f,required:h,value:g="on",internal_do_not_use_render:v}=e,[w,x]=gs({prop:n,defaultProp:i??!1,onChange:f,caller:hd}),[E,C]=p.useState(null),[b,k]=p.useState(null),_=p.useRef(!1),N=E?!!c||!!E.closest("form"):!0,j={checked:w,disabled:l,setChecked:x,control:E,setControl:C,name:u,form:c,value:g,hasConsumerStoppedPropagationRef:_,required:h,defaultChecked:ms(i)?!1:i,isFormControl:N,bubbleInput:b,setBubbleInput:k};return a.jsx(q2,{scope:t,...j,children:K2(v)?v(j):s})}var Pb="CheckboxTrigger",Ib=p.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:n,...s},i)=>{const{control:l,value:c,disabled:u,checked:f,required:h,setControl:g,setChecked:v,hasConsumerStoppedPropagationRef:w,isFormControl:x,bubbleInput:E}=jm(Pb,e),C=qe(i,g),b=p.useRef(f);return p.useEffect(()=>{const k=l?.form;if(k){const _=()=>v(b.current);return k.addEventListener("reset",_),()=>k.removeEventListener("reset",_)}},[l,v]),a.jsx(Oe.button,{type:"button",role:"checkbox","aria-checked":ms(f)?"mixed":f,"aria-required":h,"data-state":$b(f),"data-disabled":u?"":void 0,disabled:u,value:c,...s,ref:C,onKeyDown:ye(t,k=>{k.key==="Enter"&&k.preventDefault()}),onClick:ye(n,k=>{v(_=>ms(_)?!0:!_),E&&x&&(w.current=k.isPropagationStopped(),w.current||k.stopPropagation())})})});Ib.displayName=Pb;var Tm=p.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:s,checked:i,defaultChecked:l,required:c,disabled:u,value:f,onCheckedChange:h,form:g,...v}=e;return a.jsx(G2,{__scopeCheckbox:n,checked:i,defaultChecked:l,disabled:u,required:c,onCheckedChange:h,name:s,form:g,value:f,internal_do_not_use_render:({isFormControl:w})=>a.jsxs(a.Fragment,{children:[a.jsx(Ib,{...v,ref:t,__scopeCheckbox:n}),w&&a.jsx(Mb,{__scopeCheckbox:n})]})})});Tm.displayName=hd;var Db="CheckboxIndicator",Ob=p.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:s,...i}=e,l=jm(Db,n);return a.jsx(In,{present:s||ms(l.checked)||l.checked===!0,children:a.jsx(Oe.span,{"data-state":$b(l.checked),"data-disabled":l.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...e.style}})})});Ob.displayName=Db;var Lb="CheckboxBubbleInput",Mb=p.forwardRef(({__scopeCheckbox:e,...t},n)=>{const{control:s,hasConsumerStoppedPropagationRef:i,checked:l,defaultChecked:c,required:u,disabled:f,name:h,value:g,form:v,bubbleInput:w,setBubbleInput:x}=jm(Lb,e),E=qe(n,x),C=Rb(l),b=Qx(s);p.useEffect(()=>{const _=w;if(!_)return;const N=window.HTMLInputElement.prototype,R=Object.getOwnPropertyDescriptor(N,"checked").set,T=!i.current;if(C!==l&&R){const P=new Event("click",{bubbles:T});_.indeterminate=ms(l),R.call(_,ms(l)?!1:l),_.dispatchEvent(P)}},[w,C,l,i]);const k=p.useRef(ms(l)?!1:l);return a.jsx(Oe.input,{type:"checkbox","aria-hidden":!0,defaultChecked:c??k.current,required:u,disabled:f,name:h,value:g,form:v,...t,tabIndex:-1,ref:E,style:{...t.style,...b,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Mb.displayName=Lb;function K2(e){return typeof e=="function"}function ms(e){return e==="indeterminate"}function $b(e){return ms(e)?"indeterminate":e?"checked":"unchecked"}const Fb=p.forwardRef(({className:e,...t},n)=>a.jsx(Tm,{ref:n,className:be("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:a.jsx(Ob,{className:be("flex items-center justify-center text-current"),children:a.jsx(Jn,{className:"h-4 w-4"})})}));Fb.displayName=Tm.displayName;const hr=p.forwardRef(({className:e,type:t,...n},s)=>a.jsx("input",{type:t,className:be("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-base file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...n}));hr.displayName="Input";var Y2="Label",Ub=p.forwardRef((e,t)=>a.jsx(Oe.label,{...e,ref:t,onMouseDown:n=>{n.target.closest("button, input, select, textarea")||(e.onMouseDown?.(n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));Ub.displayName=Y2;var Bb=Ub;const J2=Xc("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Am=p.forwardRef(({className:e,...t},n)=>a.jsx(Bb,{ref:n,className:be(J2(),e),...t}));Am.displayName=Bb.displayName;const Q2=["password","Password","PASSWORD","passwd","pwd","secret","Secret","SECRET","token","Token","TOKEN","apiKey","api_key","apikey","accessToken","access_token","refreshToken","refresh_token","authToken","auth_token","sessionToken","session_token","privateKey","private_key","privatekey","secretKey","secret_key","secretkey","authorization","Authorization","AUTHORIZATION","cookie","Cookie","COOKIE","session","Session","SESSION","credential","credentials","Credential","Credentials","CREDENTIALS"],zb=[/password/i,/passwd/i,/secret/i,/token/i,/key/i,/credential/i,/auth/i,/session/i,/cookie/i];function ps(e,t={}){const{maskValue:n=!0,removeField:s=!1}=t;if(!e||typeof e!="object")return e;if(Array.isArray(e))return e.map(l=>ps(l,t));if(e instanceof Date)return e;if(e instanceof Error)return{name:e.name,message:e.message,stack:"[REDACTED]"};const i={};for(const[l,c]of Object.entries(e))if(Q2.includes(l)||zb.some(f=>f.test(l))){if(s)continue;n&&(i[l]="[REDACTED]")}else c&&typeof c=="object"?i[l]=ps(c,t):i[l]=c;return i}function Mf(e){return!e||typeof e!="string"?e:zb.some(n=>n.test(e))&&e.length>20?"[REDACTED]":e}const Qn={log:(...e)=>{{const t=e.map(n=>typeof n=="object"&&n!==null?ps(n,{maskValue:!0,removeField:!1}):typeof n=="string"?Mf(n):n);console.log(...t)}},error:(...e)=>{const t=e.map(n=>n instanceof Error?{name:n.name,message:n.message,stack:"[REDACTED]"}:typeof n=="object"&&n!==null?ps(n,{maskValue:!0,removeField:!1}):typeof n=="string"?Mf(n):n);console.error(...t)},warn:(...e)=>{const t=e.map(n=>typeof n=="object"&&n!==null?ps(n,{maskValue:!0,removeField:!1}):typeof n=="string"?Mf(n):n);console.warn(...t)},debug:(...e)=>{}};function Qi(e){return e instanceof Error?{name:e.name,message:e.message,stack:void 0,...e.code&&{code:e.code},...e.details&&{details:ps(e.details)}}:typeof e=="object"&&e!==null?{message:"Unknown error",...ps(e)}:{message:String(e)}}const Vb="kch_rate_limits",Hb="kch_failed_logins",md={login:{maxAttempts:5,windowMs:60*1e3,lockoutDurationMs:900*1e3},childLogin:{maxAttempts:10,windowMs:60*1e3,lockoutDurationMs:300*1e3},apiCall:{maxAttempts:100,windowMs:60*1e3}};function Rm(){try{const e=localStorage.getItem(Vb);return e?JSON.parse(e):{}}catch{return{}}}function Pm(e){try{localStorage.setItem(Vb,JSON.stringify(e))}catch{}}function Im(){try{const e=localStorage.getItem(Hb);return e?JSON.parse(e):{}}catch{return{}}}function Wb(e){try{localStorage.setItem(Hb,JSON.stringify(e))}catch{}}function X2(e,t="apiCall"){const n=md[t],s=Rm(),i=Date.now(),l=s[e];if(l?.lockedUntil&&l.lockedUntil>i)return{allowed:!1,lockedUntil:l.lockedUntil};if(!l||l.resetAt<i)return{allowed:!0};if(l.count>=n.maxAttempts){if(t==="login"&&n.lockoutDurationMs){const c=i+n.lockoutDurationMs;return s[e]={count:l.count,resetAt:l.resetAt,lockedUntil:c},Pm(s),{allowed:!1,lockedUntil:c}}return{allowed:!1,resetAt:l.resetAt}}return{allowed:!0}}function Z2(e,t="apiCall"){const n=md[t],s=Rm(),i=Date.now(),l=s[e];!l||l.resetAt<i?s[e]={count:1,resetAt:i+n.windowMs}:s[e]={...l,count:l.count+1},Pm(s)}function eD(e){const t=Im(),n=Date.now(),s=md.login,i=t[e];let l=1,c;return!i||n-i.lastAttempt>s.windowMs?l=1:l=i.attempts+1,l>=s.maxAttempts&&s.lockoutDurationMs&&(c=n+s.lockoutDurationMs),t[e]={email:e,attempts:l,lastAttempt:n,lockedUntil:c},Wb(t),{attempts:l,locked:!!c,lockedUntil:c}}function tD(e){const t=Im();delete t[e],Wb(t);const n=Rm();delete n[`login:${e}`],Pm(n)}function aw(e){const n=Im()[e],s=Date.now(),i=md.login;if(!n)return{locked:!1};if(n.lockedUntil&&n.lockedUntil>s)return{locked:!0,lockedUntil:n.lockedUntil,attemptsRemaining:0};if(s-n.lastAttempt>i.windowMs)return{locked:!1};const l=i.maxAttempts-n.attempts;return{locked:!1,attemptsRemaining:Math.max(0,l)}}function nD(e,t){return`${t}:${e}`}function lw(){const e=[];let t=0;const n=navigator.userAgent.toLowerCase();["headless","phantom","selenium","webdriver","puppeteer","playwright","scrapy","bot","crawler","spider"].some(l=>n.includes(l))&&(e.push("Bot user agent detected"),t+=50),!window.chrome&&!window.safari&&!window.firefox&&(e.push("Missing browser vendor object"),t+=20),navigator.webdriver&&(e.push("WebDriver property detected"),t+=40),navigator.plugins.length===0&&(e.push("No browser plugins detected"),t+=15),navigator.languages.length===0&&(e.push("No browser languages detected"),t+=10),navigator.permissions||(e.push("Permissions API missing"),t+=10),(window.screen.width===0||window.screen.height===0)&&(e.push("Invalid screen dimensions"),t+=20);try{const l=document.createElement("canvas");l.getContext("webgl")||l.getContext("experimental-webgl")||(e.push("WebGL not supported"),t+=10)}catch{e.push("WebGL check failed"),t+=5}return(window.__nightmare||window.__phantomas)&&(e.push("Automation framework detected"),t+=30),{isBot:t>=30,confidence:Math.min(100,t),reasons:e}}class rD{mouseMovements=[];clicks=[];keystrokes=[];scrolls=[];pageViews=[];startTime=Date.now();constructor(){this.setupTracking()}setupTracking(){document.addEventListener("mousemove",()=>{this.mouseMovements.push(Date.now()),this.mouseMovements.length>100&&this.mouseMovements.shift()}),document.addEventListener("click",()=>{this.clicks.push(Date.now()),this.clicks.length>50&&this.clicks.shift()}),document.addEventListener("keydown",()=>{this.keystrokes.push(Date.now()),this.keystrokes.length>100&&this.keystrokes.shift()});let t;window.addEventListener("scroll",()=>{clearTimeout(t),t=setTimeout(()=>{this.scrolls.push(Date.now()),this.scrolls.length>50&&this.scrolls.shift()},100)})}analyzeBehavior(){const t=[];let n=0;const l=(Date.now()-this.startTime)/6e4;if(this.mouseMovements.length===0&&l>.5&&(t.push("No mouse movement detected"),n+=30),this.pageViews.length>10&&l<1&&(t.push("Rapid page switching"),n+=25),this.mouseMovements.length+this.clicks.length+this.keystrokes.length===0&&l>1&&(t.push("No user interactions"),n+=40),this.clicks.length>5){const u=[];for(let g=1;g<this.clicks.length;g++)u.push(this.clicks[g]-this.clicks[g-1]);const f=u.reduce((g,v)=>g+v,0)/u.length;u.reduce((g,v)=>g+Math.pow(v-f,2),0)/u.length<100&&(t.push("Mechanical timing pattern"),n+=20)}return{isSuspicious:n>=30,score:Math.min(100,n),reasons:t}}recordPageView(){this.pageViews.push(Date.now()),this.pageViews.length>20&&this.pageViews.shift()}getInteractionScore(){const t=this.mouseMovements.length+this.clicks.length+this.keystrokes.length+this.scrolls.length,n=(Date.now()-this.startTime)/6e4;return Math.min(100,t/Math.max(1,n)*10)}}let Cc=null;function sD(){return Cc||(Cc=new rD),Cc}function oD(){return Cc}function $f(e){return typeof e!="string"?String(e):e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim()}function iD(e){return!e||typeof e!="string"?!1:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim())}function aD(e){const t=[];return!e||typeof e!="string"?{valid:!1,errors:["Password is required"]}:(e.length<6&&t.push("Password must be at least 6 characters"),e.length>128&&t.push("Password must be less than 128 characters"),["password","123456","12345678","qwerty","abc123"].includes(e.toLowerCase())&&t.push("Password is too common"),{valid:t.length===0,errors:t})}function lD(e){return!e||typeof e!="string"?!1:/^[A-Z0-9]{3,6}-[a-z]+-\d{1,2}$/i.test(e.trim())}function cD(e){const t={},n={};if(e.email!==void 0){const s=$f(e.email);n.email=s,iD(s)||(t.email=["Invalid email format"])}if(e.password!==void 0){const s=e.password;n.password=s;const i=aD(s);i.valid||(t.password=i.errors)}if(e.name!==void 0){const s=$f(e.name);n.name=s,s.length<1&&(t.name=["Name is required"]),s.length>100&&(t.name=["Name must be less than 100 characters"])}if(e.code!==void 0){const s=$f(e.code);n.code=s,lD(s)||(t.code=["Invalid login code format"])}return{valid:Object.keys(t).length===0,errors:t,sanitized:n}}async function dD(e){const n=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-1",n);return Array.from(new Uint8Array(s)).map(l=>l.toString(16).padStart(2,"0")).join("").toUpperCase()}async function uD(e){try{const t=await dD(e),n=t.substring(0,5),s=t.substring(5),i=await fetch(`https://api.pwnedpasswords.com/range/${n}`,{method:"GET",headers:{"User-Agent":"KidsCallHome-PasswordChecker/1.0"}});if(!i.ok)return console.warn("HaveIBeenPwned API unavailable, skipping breach check"),!1;const c=(await i.text()).split(/\r?\n/);for(const u of c){const f=u.trim();if(!f)continue;const[h]=f.split(":");if(h&&h.toUpperCase()===s)return!0}return!1}catch(t){return console.warn("Error checking password breach status:",t),!1}}async function cw(e,t=!0){const n=[];if(!e||typeof e!="string")return{valid:!1,errors:["Password is required"]};if(e.length<6&&n.push("Password must be at least 6 characters"),e.length>128&&n.push("Password must be less than 128 characters"),["password","123456","12345678","qwerty","abc123"].includes(e.toLowerCase())&&n.push("Password is too common"),n.length>0)return{valid:!1,errors:n};if(t)try{if(await uD(e))return n.push("This password has been found in data breaches. Please choose a different password."),{valid:!1,errors:n,isPwned:!0}}catch(i){console.warn("Breach check failed, allowing password:",i)}return{valid:n.length===0,errors:n,isPwned:!1}}function Hn(e,t={}){const n={type:e,userId:t.userId,email:t.email,ip:void 0,userAgent:navigator.userAgent,timestamp:Date.now(),metadata:t.metadata,severity:t.severity||mD(e)};try{const s=hD();s.push(n),s.length>100&&s.shift(),localStorage.setItem("kch_audit_logs",JSON.stringify(s))}catch{}fD().catch(()=>{})}async function fD(e){}function hD(){try{const e=localStorage.getItem("kch_audit_logs");return e?JSON.parse(e):[]}catch{return[]}}function mD(e){switch(e){case"login_attempt":case"logout":case"signup":return"low";case"login_failed":case"rate_limit_exceeded":case"data_access":return"medium";case"login_locked":case"account_locked":case"bot_detected":case"permission_denied":return"high";case"suspicious_activity":return"critical";default:return"medium"}}const qb="kch_csrf_token",pD=3600*1e3;function gD(){const e=new Uint8Array(32);crypto.getRandomValues(e);const t=Array.from(e,s=>s.toString(16).padStart(2,"0")).join(""),n={token:t,expiresAt:Date.now()+pD};try{sessionStorage.setItem(qb,JSON.stringify(n))}catch{window.__csrfToken=n}return t}function vD(){try{const e=sessionStorage.getItem(qb);if(e){const t=JSON.parse(e);if(t.expiresAt>Date.now())return t.token}}catch{const e=window.__csrfToken;if(e&&e.expiresAt>Date.now())return e.token}return gD()}const dw=(e,t,n=365)=>{const s=new Date;s.setTime(s.getTime()+n*24*60*60*1e3),document.cookie=`${e}=${t};expires=${s.toUTCString()};path=/`},yD=e=>{const t=e+"=",n=document.cookie.split(";");for(let s=0;s<n.length;s++){let i=n[s];for(;i.charAt(0)===" ";)i=i.substring(1,i.length);if(i.indexOf(t)===0)return i.substring(t.length,i.length)}return null},wD=()=>{const[e,t]=p.useState(!0),[n,s]=p.useState(""),[i,l]=p.useState(""),[c,u]=p.useState(""),[f,h]=p.useState(!0),[g,v]=p.useState(!1),[w,x]=p.useState(null),[E,C]=p.useState(null),[b,k]=p.useState(!1),[_,N]=p.useState(null),[j,R]=p.useState(!1),[T,P]=p.useState(null),O=tt(),{toast:G}=Ct(),L=p.useRef(null),F="";p.useEffect(()=>{sD();const U=lw();U.isBot&&(Qn.warn("Bot detected:",U),Hn("bot_detected",{metadata:{reasons:U.reasons,confidence:U.confidence},severity:"high"}));const M=localStorage.getItem("staySignedIn");M!==null&&h(M==="true");const B=yD("parentName");B&&x(B)},[]),p.useEffect(()=>{if(e&&n){const U=aw(n);N(U),U.attemptsRemaining!==void 0&&U.attemptsRemaining<=3&&k(!0)}else N(null),k(!1)},[n,e]),p.useEffect(()=>{if(e||!i||i.length<6){P(null);return}const U=setTimeout(async()=>{R(!0),P("checking");try{const M=await cw(i);R(!1),M.isPwned?P("breached"):M.valid?P("safe"):P(null)}catch{R(!1),P(null)}},800);return()=>clearTimeout(U)},[i,e]);const I=async U=>{U.preventDefault(),v(!0),C(null);try{const M=cD({email:e?n:void 0,password:i,name:e?void 0:c});if(!M.valid){const W=Object.values(M.errors)[0]?.[0];G({title:"Validation Error",description:W||"Please check your input",variant:"destructive"});return}const B=M.sanitized.email||n,V=M.sanitized.password||i;if(!e){if(T==="breached"){G({title:"Password Security Issue",description:"This password has been found in data breaches and is unsafe to use. Please choose a unique password with a mix of letters, numbers, and symbols.",variant:"destructive",duration:8e3});return}if(T!=="safe"){R(!0),P("checking");try{const W=await cw(V);if(R(!1),W.valid)P("safe");else{if(W.isPwned)P("breached"),G({title:"Password Security Issue",description:"This password has been found in data breaches and is unsafe to use. Please choose a unique password with a mix of letters, numbers, and symbols.",variant:"destructive",duration:8e3});else{const D=W.errors[0];G({title:"Password Validation Error",description:D||"Please choose a stronger password",variant:"destructive"})}return}}catch(W){R(!1),P(null),Qn.warn("Breach check failed:",Qi(W))}}}const ee=nD(B,"login"),z=X2(ee,"login");if(!z.allowed)if(z.lockedUntil){const W=Math.ceil((z.lockedUntil-Date.now())/6e4);G({title:"Account Temporarily Locked",description:`Too many login attempts. Please try again in ${W} minute(s).`,variant:"destructive"}),Hn("login_locked",{email:B,severity:"high"});return}else{G({title:"Too Many Attempts",description:"Please wait before trying again.",variant:"destructive"}),Hn("rate_limit_exceeded",{email:B,severity:"medium"});return}if(e){const W=aw(B);if(W.locked&&W.lockedUntil){const D=Math.ceil((W.lockedUntil-Date.now())/6e4);G({title:"Account Locked",description:`Account is locked due to multiple failed attempts. Try again in ${D} minute(s).`,variant:"destructive"}),N(W),Hn("account_locked",{email:B,severity:"high"});return}}const $=lw();if($.isBot&&$.confidence>50){const D=oD()?.analyzeBehavior();if(D?.isSuspicious){G({title:"Security Check Failed",description:"Unable to verify you're human. Please try again.",variant:"destructive"}),Hn("bot_detected",{email:B,metadata:{botReasons:$.reasons,behaviorReasons:D.reasons},severity:"high"});return}}if(Z2(ee,"login"),localStorage.setItem("staySignedIn",f.toString()),f?sessionStorage.removeItem("clearSessionOnClose"):sessionStorage.setItem("clearSessionOnClose","true"),e){Hn("login_attempt",{email:B,severity:"low"});const{data:{user:W},error:D}=await Y.auth.signInWithPassword({email:B,password:V});if(D){const Q=eD(B);if(Qn.error("Auth error:",Qi(D)),Hn("login_failed",{email:B,metadata:{attempts:Q.attempts},severity:"medium"}),Q.locked&&Q.lockedUntil){const le=Math.ceil((Q.lockedUntil-Date.now())/6e4);G({title:"Account Locked",description:`Too many failed attempts. Account locked for ${le} minute(s).`,variant:"destructive"}),N({locked:!0,lockedUntil:Q.lockedUntil}),Hn("account_locked",{email:B,severity:"high"})}else{const le=5-Q.attempts;G({title:"Login Failed",description:le>0?`Invalid credentials. ${le} attempt(s) remaining.`:"Invalid credentials.",variant:"destructive"}),Q.attempts>=2&&k(!0)}throw D}if(tD(B),Hn("login_success",{userId:W?.id,email:B,severity:"low"}),W){const{data:Q}=await Y.from("parents").select("name").eq("id",W.id).maybeSingle();Q?.name&&dw("parentName",Q.name,365);try{const{generateDeviceIdentifierAsync:le,detectDeviceType:X,getDeviceName:K,getClientIP:te,getDeviceMacAddress:q,getCountryFromIP:se}=await gr(async()=>{const{generateDeviceIdentifierAsync:ie,detectDeviceType:Pe,getDeviceName:ae,getClientIP:ve,getDeviceMacAddress:_e,getCountryFromIP:Ue}=await Promise.resolve().then(()=>Oh);return{generateDeviceIdentifierAsync:ie,detectDeviceType:Pe,getDeviceName:ae,getClientIP:ve,getDeviceMacAddress:_e,getCountryFromIP:Ue}},void 0),fe=await le(),ge=X(),we=K(),Re=navigator.userAgent,Be=await te(),We=await q(),Ge=await se(Be);await Y.rpc("update_device_login",{p_parent_id:W.id,p_device_identifier:fe,p_device_name:we,p_device_type:ge,p_user_agent:Re,p_ip_address:Be||null,p_mac_address:We||null,p_country_code:Ge||null,p_child_id:null})}catch(le){console.warn("Device tracking failed:",le)}}G({title:"Welcome back!"}),O("/parent/children")}else{Hn("signup",{email:B,severity:"low"});const{error:W}=await Y.auth.signUp({email:B,password:V,options:{data:{name:M.sanitized.name||c},emailRedirectTo:`${window.location.origin}/parent/children`}});if(W)throw Qn.error("Signup error:",Qi(W)),Hn("signup",{email:B,metadata:{error:W.message},severity:"medium"}),W;(M.sanitized.name||c)&&dw("parentName",M.sanitized.name||c,365),G({title:"Account created! Welcome!"}),O("/parent/children")}}catch(M){const B=Qi(M);Qn.error("Auth operation failed:",B),M instanceof Error&&M.message.includes("locked")||G({title:"Error",description:M instanceof Error?M.message:"An unexpected error occurred",variant:"destructive"})}finally{v(!1),R(!1),l(""),P(null),C(null)}};return a.jsx("div",{className:"min-h-[100dvh] flex items-center justify-center bg-background p-4",children:a.jsxs(Te,{className:"w-full max-w-md p-8 space-y-6",children:[a.jsxs("div",{className:"text-center space-y-2",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("img",{src:"/icon-192x192.png",alt:"Kids Call Home",className:"h-12 w-12"})}),a.jsx("h1",{className:"text-3xl font-bold",children:"Kids Call Home"}),a.jsx("p",{className:"text-muted-foreground",children:e?w?`Welcome back, ${w}!`:"Welcome back, parent!":"Create your parent account"})]}),a.jsxs("form",{onSubmit:I,className:"space-y-4",children:[!e&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Your Name"}),a.jsx(hr,{type:"text",placeholder:"Mom / Dad / Guardian",value:c,onChange:U=>u(U.target.value),required:!e})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Email"}),a.jsx(hr,{type:"email",placeholder:"parent@email.com",value:n,onChange:U=>s(U.target.value),required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(hr,{ref:L,type:"password",placeholder:"",value:i,onChange:U=>{l(U.target.value),e||P(null)},required:!0,minLength:6,autoComplete:e?"current-password":"new-password",className:!e&&T==="breached"?"pr-10 border-destructive focus-visible:ring-destructive":!e&&T==="safe"?"pr-10 border-green-500 focus-visible:ring-green-500":"",onBlur:()=>{}}),!e&&a.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:[j&&a.jsx(cs,{className:"h-4 w-4 animate-spin text-muted-foreground"}),!j&&T==="breached"&&a.jsx(aa,{className:"h-4 w-4 text-destructive"}),!j&&T==="safe"&&i.length>=6&&a.jsx(Yv,{className:"h-4 w-4 text-green-500"})]})]}),!e&&j&&a.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[a.jsx(cs,{className:"h-3 w-3 animate-spin"}),"Checking password security..."]}),!e&&T==="breached"&&a.jsxs("p",{className:"text-xs text-destructive flex items-start gap-1",children:[a.jsx(aa,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),"This password has been compromised in data breaches. Choose a unique password that you haven't used elsewhere."]}),!e&&T==="safe"&&i.length>=6&&a.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 flex items-center gap-1",children:[a.jsx(Yv,{className:"h-3 w-3"}),"Password looks secure!"]})]}),e&&a.jsxs(a.Fragment,{children:[_?.locked&&_.lockedUntil&&a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-destructive/10 border border-destructive/20 rounded-md",children:[a.jsx(kx,{className:"h-5 w-5 text-destructive mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-destructive",children:"Account Locked"}),a.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Too many failed login attempts. Please try again in"," ",Math.ceil((_.lockedUntil-Date.now())/6e4)," minute(s)."]})]})]}),_&&!_.locked&&_.attemptsRemaining!==void 0&&_.attemptsRemaining<5&&a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-md",children:[a.jsx(Zc,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-yellow-700",children:"Security Notice"}),a.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[_.attemptsRemaining," attempt(s) remaining before account lockout."]})]})]}),b&&F,a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Fb,{id:"staySignedIn",checked:f,onCheckedChange:U=>h(U===!0)}),a.jsx(Am,{htmlFor:"staySignedIn",className:"text-sm font-normal cursor-pointer",children:"Stay signed in"})]})]}),a.jsx("input",{type:"hidden",name:"csrf_token",value:vD()}),a.jsx(ce,{type:"submit",className:"w-full",disabled:g||e&&_?.locked,children:g?"Processing...":e?a.jsxs(a.Fragment,{children:[a.jsx(xk,{className:"mr-2 h-4 w-4"}),"Sign In"]}):a.jsxs(a.Fragment,{children:[a.jsx(Dk,{className:"mr-2 h-4 w-4"}),"Create Account"]})})]}),a.jsx("div",{className:"text-center",children:a.jsx("button",{type:"button",onClick:()=>t(!e),className:"text-sm text-primary hover:underline",children:e?"Need an account? Sign up":"Already have an account? Sign in"})})]})})};var Ff="focusScope.autoFocusOnMount",Uf="focusScope.autoFocusOnUnmount",uw={bubbles:!1,cancelable:!0},xD="FocusScope",pd=p.forwardRef((e,t)=>{const{loop:n=!1,trapped:s=!1,onMountAutoFocus:i,onUnmountAutoFocus:l,...c}=e,[u,f]=p.useState(null),h=an(i),g=an(l),v=p.useRef(null),w=qe(t,C=>f(C)),x=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(s){let C=function(N){if(x.paused||!u)return;const j=N.target;u.contains(j)?v.current=j:as(v.current,{select:!0})},b=function(N){if(x.paused||!u)return;const j=N.relatedTarget;j!==null&&(u.contains(j)||as(v.current,{select:!0}))},k=function(N){if(document.activeElement===document.body)for(const R of N)R.removedNodes.length>0&&as(u)};document.addEventListener("focusin",C),document.addEventListener("focusout",b);const _=new MutationObserver(k);return u&&_.observe(u,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",C),document.removeEventListener("focusout",b),_.disconnect()}}},[s,u,x.paused]),p.useEffect(()=>{if(u){hw.add(x);const C=document.activeElement;if(!u.contains(C)){const k=new CustomEvent(Ff,uw);u.addEventListener(Ff,h),u.dispatchEvent(k),k.defaultPrevented||(bD(ND(Gb(u)),{select:!0}),document.activeElement===C&&as(u))}return()=>{u.removeEventListener(Ff,h),setTimeout(()=>{const k=new CustomEvent(Uf,uw);u.addEventListener(Uf,g),u.dispatchEvent(k),k.defaultPrevented||as(C??document.body,{select:!0}),u.removeEventListener(Uf,g),hw.remove(x)},0)}}},[u,h,g,x]);const E=p.useCallback(C=>{if(!n&&!s||x.paused)return;const b=C.key==="Tab"&&!C.altKey&&!C.ctrlKey&&!C.metaKey,k=document.activeElement;if(b&&k){const _=C.currentTarget,[N,j]=CD(_);N&&j?!C.shiftKey&&k===j?(C.preventDefault(),n&&as(N,{select:!0})):C.shiftKey&&k===N&&(C.preventDefault(),n&&as(j,{select:!0})):k===_&&C.preventDefault()}},[n,s,x.paused]);return a.jsx(Oe.div,{tabIndex:-1,...c,ref:w,onKeyDown:E})});pd.displayName=xD;function bD(e,{select:t=!1}={}){const n=document.activeElement;for(const s of e)if(as(s,{select:t}),document.activeElement!==n)return}function CD(e){const t=Gb(e),n=fw(t,e),s=fw(t.reverse(),e);return[n,s]}function Gb(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const i=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||i?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function fw(e,t){for(const n of e)if(!SD(n,{upTo:t}))return n}function SD(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function ED(e){return e instanceof HTMLInputElement&&"select"in e}function as(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&ED(e)&&t&&e.select()}}var hw=_D();function _D(){let e=[];return{add(t){const n=e[0];t!==n&&n?.pause(),e=mw(e,t),e.unshift(t)},remove(t){e=mw(e,t),e[0]?.resume()}}}function mw(e,t){const n=[...e],s=n.indexOf(t);return s!==-1&&n.splice(s,1),n}function ND(e){return e.filter(t=>t.tagName!=="A")}var Bf=0;function Dm(){p.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??pw()),document.body.insertAdjacentElement("beforeend",e[1]??pw()),Bf++,()=>{Bf===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Bf--}},[])}function pw(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Sc="right-scroll-bar-position",Ec="width-before-scroll-bar",kD="with-scroll-bars-hidden",jD="--removed-body-scroll-bar-size";function zf(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function TD(e,t){var n=p.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(s){var i=n.value;i!==s&&(n.value=s,n.callback(s,i))}}}})[0];return n.callback=t,n.facade}var AD=typeof window<"u"?p.useLayoutEffect:p.useEffect,gw=new WeakMap;function RD(e,t){var n=TD(null,function(s){return e.forEach(function(i){return zf(i,s)})});return AD(function(){var s=gw.get(n);if(s){var i=new Set(s),l=new Set(e),c=n.current;i.forEach(function(u){l.has(u)||zf(u,null)}),l.forEach(function(u){i.has(u)||zf(u,c)})}gw.set(n,e)},[e]),n}function PD(e){return e}function ID(e,t){t===void 0&&(t=PD);var n=[],s=!1,i={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(l){var c=t(l,s);return n.push(c),function(){n=n.filter(function(u){return u!==c})}},assignSyncMedium:function(l){for(s=!0;n.length;){var c=n;n=[],c.forEach(l)}n={push:function(u){return l(u)},filter:function(){return n}}},assignMedium:function(l){s=!0;var c=[];if(n.length){var u=n;n=[],u.forEach(l),c=n}var f=function(){var g=c;c=[],g.forEach(l)},h=function(){return Promise.resolve().then(f)};h(),n={push:function(g){c.push(g),h()},filter:function(g){return c=c.filter(g),n}}}};return i}function DD(e){e===void 0&&(e={});var t=ID(null);return t.options=En({async:!0,ssr:!1},e),t}var Kb=function(e){var t=e.sideCar,n=bs(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=t.read();if(!s)throw new Error("Sidecar medium not found");return p.createElement(s,En({},n))};Kb.isSideCarExport=!0;function OD(e,t){return e.useMedium(t),Kb}var Yb=DD(),Vf=function(){},gd=p.forwardRef(function(e,t){var n=p.useRef(null),s=p.useState({onScrollCapture:Vf,onWheelCapture:Vf,onTouchMoveCapture:Vf}),i=s[0],l=s[1],c=e.forwardProps,u=e.children,f=e.className,h=e.removeScrollBar,g=e.enabled,v=e.shards,w=e.sideCar,x=e.noRelative,E=e.noIsolation,C=e.inert,b=e.allowPinchZoom,k=e.as,_=k===void 0?"div":k,N=e.gapMode,j=bs(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),R=w,T=RD([n,t]),P=En(En({},j),i);return p.createElement(p.Fragment,null,g&&p.createElement(R,{sideCar:Yb,removeScrollBar:h,shards:v,noRelative:x,noIsolation:E,inert:C,setCallbacks:l,allowPinchZoom:!!b,lockRef:n,gapMode:N}),c?p.cloneElement(p.Children.only(u),En(En({},P),{ref:T})):p.createElement(_,En({},P,{className:f,ref:T}),u))});gd.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};gd.classNames={fullWidth:Ec,zeroRight:Sc};var LD=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function MD(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=LD();return t&&e.setAttribute("nonce",t),e}function $D(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function FD(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var UD=function(){var e=0,t=null;return{add:function(n){e==0&&(t=MD())&&($D(t,n),FD(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},BD=function(){var e=UD();return function(t,n){p.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Jb=function(){var e=BD(),t=function(n){var s=n.styles,i=n.dynamic;return e(s,i),null};return t},zD={left:0,top:0,right:0,gap:0},Hf=function(e){return parseInt(e||"",10)||0},VD=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],s=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[Hf(n),Hf(s),Hf(i)]},HD=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return zD;var t=VD(e),n=document.documentElement.clientWidth,s=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,s-n+t[2]-t[0])}},WD=Jb(),Vo="data-scroll-locked",qD=function(e,t,n,s){var i=e.left,l=e.top,c=e.right,u=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(kD,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(u,"px ").concat(s,`;
  }
  body[`).concat(Vo,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(s,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(l,`px;
    padding-right: `).concat(c,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(u,"px ").concat(s,`;
    `),n==="padding"&&"padding-right: ".concat(u,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Sc,` {
    right: `).concat(u,"px ").concat(s,`;
  }
  
  .`).concat(Ec,` {
    margin-right: `).concat(u,"px ").concat(s,`;
  }
  
  .`).concat(Sc," .").concat(Sc,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(Ec," .").concat(Ec,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(Vo,`] {
    `).concat(jD,": ").concat(u,`px;
  }
`)},vw=function(){var e=parseInt(document.body.getAttribute(Vo)||"0",10);return isFinite(e)?e:0},GD=function(){p.useEffect(function(){return document.body.setAttribute(Vo,(vw()+1).toString()),function(){var e=vw()-1;e<=0?document.body.removeAttribute(Vo):document.body.setAttribute(Vo,e.toString())}},[])},KD=function(e){var t=e.noRelative,n=e.noImportant,s=e.gapMode,i=s===void 0?"margin":s;GD();var l=p.useMemo(function(){return HD(i)},[i]);return p.createElement(WD,{styles:qD(l,!t,i,n?"":"!important")})},Ah=!1;if(typeof window<"u")try{var cc=Object.defineProperty({},"passive",{get:function(){return Ah=!0,!0}});window.addEventListener("test",cc,cc),window.removeEventListener("test",cc,cc)}catch{Ah=!1}var Io=Ah?{passive:!1}:!1,YD=function(e){return e.tagName==="TEXTAREA"},Qb=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!YD(e)&&n[t]==="visible")},JD=function(e){return Qb(e,"overflowY")},QD=function(e){return Qb(e,"overflowX")},yw=function(e,t){var n=t.ownerDocument,s=t;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var i=Xb(e,s);if(i){var l=Zb(e,s),c=l[1],u=l[2];if(c>u)return!0}s=s.parentNode}while(s&&s!==n.body);return!1},XD=function(e){var t=e.scrollTop,n=e.scrollHeight,s=e.clientHeight;return[t,n,s]},ZD=function(e){var t=e.scrollLeft,n=e.scrollWidth,s=e.clientWidth;return[t,n,s]},Xb=function(e,t){return e==="v"?JD(t):QD(t)},Zb=function(e,t){return e==="v"?XD(t):ZD(t)},eO=function(e,t){return e==="h"&&t==="rtl"?-1:1},tO=function(e,t,n,s,i){var l=eO(e,window.getComputedStyle(t).direction),c=l*s,u=n.target,f=t.contains(u),h=!1,g=c>0,v=0,w=0;do{if(!u)break;var x=Zb(e,u),E=x[0],C=x[1],b=x[2],k=C-b-l*E;(E||k)&&Xb(e,u)&&(v+=k,w+=E);var _=u.parentNode;u=_&&_.nodeType===Node.DOCUMENT_FRAGMENT_NODE?_.host:_}while(!f&&u!==document.body||f&&(t.contains(u)||t===u));return(g&&Math.abs(v)<1||!g&&Math.abs(w)<1)&&(h=!0),h},dc=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},ww=function(e){return[e.deltaX,e.deltaY]},xw=function(e){return e&&"current"in e?e.current:e},nO=function(e,t){return e[0]===t[0]&&e[1]===t[1]},rO=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},sO=0,Do=[];function oO(e){var t=p.useRef([]),n=p.useRef([0,0]),s=p.useRef(),i=p.useState(sO++)[0],l=p.useState(Jb)[0],c=p.useRef(e);p.useEffect(function(){c.current=e},[e]),p.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var C=ym([e.lockRef.current],(e.shards||[]).map(xw),!0).filter(Boolean);return C.forEach(function(b){return b.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),C.forEach(function(b){return b.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var u=p.useCallback(function(C,b){if("touches"in C&&C.touches.length===2||C.type==="wheel"&&C.ctrlKey)return!c.current.allowPinchZoom;var k=dc(C),_=n.current,N="deltaX"in C?C.deltaX:_[0]-k[0],j="deltaY"in C?C.deltaY:_[1]-k[1],R,T=C.target,P=Math.abs(N)>Math.abs(j)?"h":"v";if("touches"in C&&P==="h"&&T.type==="range")return!1;var O=yw(P,T);if(!O)return!0;if(O?R=P:(R=P==="v"?"h":"v",O=yw(P,T)),!O)return!1;if(!s.current&&"changedTouches"in C&&(N||j)&&(s.current=R),!R)return!0;var G=s.current||R;return tO(G,b,C,G==="h"?N:j)},[]),f=p.useCallback(function(C){var b=C;if(!(!Do.length||Do[Do.length-1]!==l)){var k="deltaY"in b?ww(b):dc(b),_=t.current.filter(function(R){return R.name===b.type&&(R.target===b.target||b.target===R.shadowParent)&&nO(R.delta,k)})[0];if(_&&_.should){b.cancelable&&b.preventDefault();return}if(!_){var N=(c.current.shards||[]).map(xw).filter(Boolean).filter(function(R){return R.contains(b.target)}),j=N.length>0?u(b,N[0]):!c.current.noIsolation;j&&b.cancelable&&b.preventDefault()}}},[]),h=p.useCallback(function(C,b,k,_){var N={name:C,delta:b,target:k,should:_,shadowParent:iO(k)};t.current.push(N),setTimeout(function(){t.current=t.current.filter(function(j){return j!==N})},1)},[]),g=p.useCallback(function(C){n.current=dc(C),s.current=void 0},[]),v=p.useCallback(function(C){h(C.type,ww(C),C.target,u(C,e.lockRef.current))},[]),w=p.useCallback(function(C){h(C.type,dc(C),C.target,u(C,e.lockRef.current))},[]);p.useEffect(function(){return Do.push(l),e.setCallbacks({onScrollCapture:v,onWheelCapture:v,onTouchMoveCapture:w}),document.addEventListener("wheel",f,Io),document.addEventListener("touchmove",f,Io),document.addEventListener("touchstart",g,Io),function(){Do=Do.filter(function(C){return C!==l}),document.removeEventListener("wheel",f,Io),document.removeEventListener("touchmove",f,Io),document.removeEventListener("touchstart",g,Io)}},[]);var x=e.removeScrollBar,E=e.inert;return p.createElement(p.Fragment,null,E?p.createElement(l,{styles:rO(i)}):null,x?p.createElement(KD,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function iO(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const aO=OD(Yb,oO);var vd=p.forwardRef(function(e,t){return p.createElement(gd,En({},e,{ref:t,sideCar:aO}))});vd.classNames=gd.classNames;var lO=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Oo=new WeakMap,uc=new WeakMap,fc={},Wf=0,eC=function(e){return e&&(e.host||eC(e.parentNode))},cO=function(e,t){return t.map(function(n){if(e.contains(n))return n;var s=eC(n);return s&&e.contains(s)?s:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},dO=function(e,t,n,s){var i=cO(t,Array.isArray(e)?e:[e]);fc[n]||(fc[n]=new WeakMap);var l=fc[n],c=[],u=new Set,f=new Set(i),h=function(v){!v||u.has(v)||(u.add(v),h(v.parentNode))};i.forEach(h);var g=function(v){!v||f.has(v)||Array.prototype.forEach.call(v.children,function(w){if(u.has(w))g(w);else try{var x=w.getAttribute(s),E=x!==null&&x!=="false",C=(Oo.get(w)||0)+1,b=(l.get(w)||0)+1;Oo.set(w,C),l.set(w,b),c.push(w),C===1&&E&&uc.set(w,!0),b===1&&w.setAttribute(n,"true"),E||w.setAttribute(s,"true")}catch(k){console.error("aria-hidden: cannot operate on ",w,k)}})};return g(t),u.clear(),Wf++,function(){c.forEach(function(v){var w=Oo.get(v)-1,x=l.get(v)-1;Oo.set(v,w),l.set(v,x),w||(uc.has(v)||v.removeAttribute(s),uc.delete(v)),x||v.removeAttribute(n)}),Wf--,Wf||(Oo=new WeakMap,Oo=new WeakMap,uc=new WeakMap,fc={})}},Om=function(e,t,n){n===void 0&&(n="data-aria-hidden");var s=Array.from(Array.isArray(e)?e:[e]),i=lO(e);return i?(s.push.apply(s,Array.from(i.querySelectorAll("[aria-live]"))),dO(s,i,n,"aria-hidden")):function(){return null}},yd="Dialog",[tC,nC]=Pn(yd),[uO,tr]=tC(yd),rC=e=>{const{__scopeDialog:t,children:n,open:s,defaultOpen:i,onOpenChange:l,modal:c=!0}=e,u=p.useRef(null),f=p.useRef(null),[h,g]=gs({prop:s,defaultProp:i??!1,onChange:l,caller:yd});return a.jsx(uO,{scope:t,triggerRef:u,contentRef:f,contentId:ur(),titleId:ur(),descriptionId:ur(),open:h,onOpenChange:g,onOpenToggle:p.useCallback(()=>g(v=>!v),[g]),modal:c,children:n})};rC.displayName=yd;var sC="DialogTrigger",oC=p.forwardRef((e,t)=>{const{__scopeDialog:n,...s}=e,i=tr(sC,n),l=qe(t,i.triggerRef);return a.jsx(Oe.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":$m(i.open),...s,ref:l,onClick:ye(e.onClick,i.onOpenToggle)})});oC.displayName=sC;var Lm="DialogPortal",[fO,iC]=tC(Lm,{forceMount:void 0}),aC=e=>{const{__scopeDialog:t,forceMount:n,children:s,container:i}=e,l=tr(Lm,t);return a.jsx(fO,{scope:t,forceMount:n,children:p.Children.map(s,c=>a.jsx(In,{present:n||l.open,children:a.jsx(Ea,{asChild:!0,container:i,children:c})}))})};aC.displayName=Lm;var Uc="DialogOverlay",lC=p.forwardRef((e,t)=>{const n=iC(Uc,e.__scopeDialog),{forceMount:s=n.forceMount,...i}=e,l=tr(Uc,e.__scopeDialog);return l.modal?a.jsx(In,{present:s||l.open,children:a.jsx(mO,{...i,ref:t})}):null});lC.displayName=Uc;var hO=Ks("DialogOverlay.RemoveScroll"),mO=p.forwardRef((e,t)=>{const{__scopeDialog:n,...s}=e,i=tr(Uc,n);return a.jsx(vd,{as:hO,allowPinchZoom:!0,shards:[i.contentRef],children:a.jsx(Oe.div,{"data-state":$m(i.open),...s,ref:t,style:{pointerEvents:"auto",...s.style}})})}),Qs="DialogContent",cC=p.forwardRef((e,t)=>{const n=iC(Qs,e.__scopeDialog),{forceMount:s=n.forceMount,...i}=e,l=tr(Qs,e.__scopeDialog);return a.jsx(In,{present:s||l.open,children:l.modal?a.jsx(pO,{...i,ref:t}):a.jsx(gO,{...i,ref:t})})});cC.displayName=Qs;var pO=p.forwardRef((e,t)=>{const n=tr(Qs,e.__scopeDialog),s=p.useRef(null),i=qe(t,n.contentRef,s);return p.useEffect(()=>{const l=s.current;if(l)return Om(l)},[]),a.jsx(dC,{...e,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ye(e.onCloseAutoFocus,l=>{l.preventDefault(),n.triggerRef.current?.focus()}),onPointerDownOutside:ye(e.onPointerDownOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0;(c.button===2||u)&&l.preventDefault()}),onFocusOutside:ye(e.onFocusOutside,l=>l.preventDefault())})}),gO=p.forwardRef((e,t)=>{const n=tr(Qs,e.__scopeDialog),s=p.useRef(!1),i=p.useRef(!1);return a.jsx(dC,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{e.onCloseAutoFocus?.(l),l.defaultPrevented||(s.current||n.triggerRef.current?.focus(),l.preventDefault()),s.current=!1,i.current=!1},onInteractOutside:l=>{e.onInteractOutside?.(l),l.defaultPrevented||(s.current=!0,l.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const c=l.target;n.triggerRef.current?.contains(c)&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&i.current&&l.preventDefault()}})}),dC=p.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:l,...c}=e,u=tr(Qs,n),f=p.useRef(null),h=qe(t,f);return Dm(),a.jsxs(a.Fragment,{children:[a.jsx(pd,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:i,onUnmountAutoFocus:l,children:a.jsx(Zo,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":$m(u.open),...c,ref:h,onDismiss:()=>u.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(yO,{titleId:u.titleId}),a.jsx(xO,{contentRef:f,descriptionId:u.descriptionId})]})]})}),Mm="DialogTitle",uC=p.forwardRef((e,t)=>{const{__scopeDialog:n,...s}=e,i=tr(Mm,n);return a.jsx(Oe.h2,{id:i.titleId,...s,ref:t})});uC.displayName=Mm;var fC="DialogDescription",hC=p.forwardRef((e,t)=>{const{__scopeDialog:n,...s}=e,i=tr(fC,n);return a.jsx(Oe.p,{id:i.descriptionId,...s,ref:t})});hC.displayName=fC;var mC="DialogClose",pC=p.forwardRef((e,t)=>{const{__scopeDialog:n,...s}=e,i=tr(mC,n);return a.jsx(Oe.button,{type:"button",...s,ref:t,onClick:ye(e.onClick,()=>i.onOpenChange(!1))})});pC.displayName=mC;function $m(e){return e?"open":"closed"}var gC="DialogTitleWarning",[vO,vC]=yN(gC,{contentName:Qs,titleName:Mm,docsSlug:"dialog"}),yO=({titleId:e})=>{const t=vC(gC),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return p.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},wO="DialogDescriptionWarning",xO=({contentRef:e,descriptionId:t})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${vC(wO).contentName}}.`;return p.useEffect(()=>{const i=e.current?.getAttribute("aria-describedby");t&&i&&(document.getElementById(t)||console.warn(s))},[s,e,t]),null},Fm=rC,yC=oC,Um=aC,Ra=lC,Pa=cC,Ia=uC,Da=hC,wd=pC;const Bc=Fm,bO=Um,wC=p.forwardRef(({className:e,...t},n)=>a.jsx(Ra,{ref:n,className:be("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));wC.displayName=Ra.displayName;const ya=p.forwardRef(({className:e,children:t,...n},s)=>a.jsxs(bO,{children:[a.jsx(wC,{}),a.jsxs(Pa,{ref:s,className:be("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,a.jsxs(wd,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[a.jsx(Rr,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ya.displayName=Pa.displayName;const wa=({className:e,...t})=>a.jsx("div",{className:be("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});wa.displayName="DialogHeader";const Rh=({className:e,...t})=>a.jsx("div",{className:be("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Rh.displayName="DialogFooter";const xa=p.forwardRef(({className:e,...t},n)=>a.jsx(Ia,{ref:n,className:be("text-lg font-semibold leading-none tracking-tight",e),...t}));xa.displayName=Ia.displayName;const zc=p.forwardRef(({className:e,...t},n)=>a.jsx(Da,{ref:n,className:be("text-sm text-muted-foreground",e),...t}));zc.displayName=Da.displayName;const qf=["#3B82F6","#F97316","#10B981","#A855F7","#EC4899"],bw=[{name:"red",color:"#EF4444"},{name:"blue",color:"#3B82F6"},{name:"green",color:"#10B981"},{name:"yellow",color:"#FBBF24"},{name:"orange",color:"#F97316"},{name:"purple",color:"#A855F7"},{name:"pink",color:"#EC4899"},{name:"brown",color:"#92400E"},{name:"black",color:"#1F2937"},{name:"white",color:"#F3F4F6"}],CO=[{name:"cat",emoji:""},{name:"dog",emoji:""},{name:"bird",emoji:""},{name:"fish",emoji:""},{name:"bear",emoji:""},{name:"lion",emoji:""},{name:"tiger",emoji:""},{name:"elephant",emoji:""},{name:"monkey",emoji:""},{name:"rabbit",emoji:""},{name:"horse",emoji:""},{name:"duck",emoji:""},{name:"cow",emoji:""},{name:"pig",emoji:""},{name:"sheep",emoji:""}],SO=({open:e,onOpenChange:t,onChildAdded:n})=>{const[s,i]=p.useState(""),[l,c]=p.useState(qf[0]),[u,f]=p.useState("color"),[h,g]=p.useState(""),[v,w]=p.useState(""),[x,E]=p.useState(""),[C,b]=p.useState(""),[k,_]=p.useState(!1),[N,j]=p.useState(!1),{toast:R}=Ct();p.useEffect(()=>{e&&(T(),P())},[e]);const T=async()=>{try{const{data:{user:U}}=await Y.auth.getUser();if(!U)return;const{data:M,error:B}=await Y.from("parents").select("family_code").eq("id",U.id).single();if(B){if(B.code==="42703"||B.message?.includes("does not exist")){R({title:"Database Migration Required",description:"The family_code column doesn't exist yet. Please run the migration in Supabase: supabase/migrations/20250121000000_add_family_code.sql",variant:"destructive",duration:1e4}),console.error(" [FAMILY CODE] Migration not run. Error:",B);return}throw B}M?.family_code?b(M.family_code):(console.warn(" [FAMILY CODE] Parent exists but family_code is null"),R({title:"Family Code Missing",description:"Your account doesn't have a family code yet. Please contact support or refresh the page after running the migration.",variant:"destructive"}))}catch(U){console.error("Failed to fetch family code:",U),R({title:"Error Loading Family Code",description:U.message||"Please refresh and try again. If the problem persists, ensure the database migration has been run.",variant:"destructive",duration:8e3})}},P=async()=>{j(!0);try{const{data:U,error:M}=await Y.rpc("generate_kid_friendly_login_code");if(M)throw M;E(U);const[B,V]=U.split("-");g(B),w(V);const ee=bw.some(z=>z.name===B);f(ee?"color":"animal")}catch{R({title:"Error",description:"Failed to generate code. Please try again.",variant:"destructive"})}finally{j(!1)}},O=(U,M)=>{g(U),f(M),L(U,v)},G=U=>{const M=parseInt(U);(U===""||M>=1&&M<=99)&&(w(U),h&&L(h,U))},L=(U,M)=>{U&&M&&C?E(`${C}-${U}-${M}`):U&&M&&E(`${U}-${M}`)},F=async U=>{try{const{data:M,error:B}=await Y.from("children").select("id").eq("login_code",U).maybeSingle();if(B)throw B;return!M}catch{return!1}};p.useEffect(()=>{C&&h&&v?E(`${C}-${h}-${v}`):h&&v&&E(`${h}-${v}`)},[C,h,v]);const I=async U=>{if(U.preventDefault(),!s.trim()){R({title:"Error",description:"Please enter a name",variant:"destructive"});return}if(!C){R({title:"Family Code Required",description:"Family code not loaded. This may mean the database migration hasn't been run. Please check the console for details.",variant:"destructive",duration:8e3});return}if(!x||!h||!v){R({title:"Error",description:"Please select a color/animal and number",variant:"destructive"});return}_(!0);try{const{data:{user:M}}=await Y.auth.getUser();if(!M)throw new Error("Not authenticated");const{data:B,error:V}=await Y.rpc("can_add_child",{p_parent_id:M.id});if(V)console.error("Error checking subscription limit:",V);else if(B===!1){R({title:"Subscription Limit Reached",description:"You've reached your subscription limit. Please upgrade your plan to add more children.",variant:"destructive",duration:8e3}),_(!1);return}if(!await F(x)){R({title:"Code already taken",description:"Please generate a new code or choose different options",variant:"destructive"}),_(!1);return}const{error:z}=await Y.from("children").insert({parent_id:M.id,name:s.trim(),login_code:x,avatar_color:l});if(z)throw z;R({title:"Child added successfully!",description:`Full login code: ${x}`}),i(""),c(qf[0]),g(""),w(""),E(""),t(!1),n()}catch(M){R({title:"Error",description:M.message,variant:"destructive"})}finally{_(!1)}};return a.jsx(Bc,{open:e,onOpenChange:t,children:a.jsxs(ya,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsx(wa,{children:a.jsx(xa,{children:"Add a Child"})}),a.jsxs("form",{onSubmit:I,className:"space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Child's Name"}),a.jsx(hr,{type:"text",placeholder:"Enter name",value:s,onChange:U=>i(U.target.value),required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Pick an Avatar Color"}),a.jsx("div",{className:"flex gap-2 flex-wrap",children:qf.map(U=>a.jsx("button",{type:"button",onClick:()=>c(U),className:"w-12 h-12 rounded-full border-4 transition-all",style:{backgroundColor:U,borderColor:l===U?U:"transparent",opacity:l===U?1:.6}},U))})]}),a.jsxs("div",{className:"space-y-4 border-t pt-4",children:[a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[a.jsx("p",{className:"text-xs font-medium text-blue-900 dark:text-blue-100 mb-1",children:"Your Family Code"}),a.jsx("p",{className:"text-xl font-mono font-bold text-blue-700 dark:text-blue-300 text-center",children:C||"Loading..."}),a.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-2 text-center",children:"Share this code with your child for login"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("label",{className:"text-sm font-medium",children:"Child's Login Code"}),a.jsxs(ce,{type:"button",variant:"outline",size:"sm",onClick:P,disabled:N||!C,children:[a.jsx(ds,{className:`h-4 w-4 mr-2 ${N?"animate-spin":""}`}),"Generate New"]})]}),a.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[a.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Full Login Code"}),a.jsx("p",{className:"text-2xl font-mono font-bold text-center break-all",children:x||(C?"Select color/animal and number":"Loading...")})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(ce,{type:"button",variant:u==="color"?"default":"outline",onClick:()=>f("color"),className:"flex-1",children:"Colors"}),a.jsx(ce,{type:"button",variant:u==="animal"?"default":"outline",onClick:()=>f("animal"),className:"flex-1",children:"Animals"})]}),u==="color"?a.jsx("div",{className:"grid grid-cols-5 gap-2",children:bw.map(U=>a.jsx("button",{type:"button",onClick:()=>O(U.name,"color"),className:`h-16 rounded-lg border-2 transition-all flex items-center justify-center ${h===U.name?"border-primary scale-105":"border-transparent opacity-60 hover:opacity-100"}`,style:{backgroundColor:U.color},children:a.jsx("span",{className:"text-white font-bold text-sm capitalize",children:U.name})},U.name))}):a.jsx("div",{className:"grid grid-cols-5 gap-2",children:CO.map(U=>a.jsxs("button",{type:"button",onClick:()=>O(U.name,"animal"),className:`h-16 rounded-lg border-2 transition-all flex flex-col items-center justify-center ${h===U.name?"border-primary scale-105 bg-primary/10":"border-transparent opacity-60 hover:opacity-100 hover:bg-muted"}`,children:[a.jsx("span",{className:"text-2xl",children:U.emoji}),a.jsx("span",{className:"text-xs font-medium capitalize mt-1",children:U.name})]},U.name))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Number (1-99)"}),a.jsx(hr,{type:"number",min:"1",max:"99",placeholder:"Enter number",value:v,onChange:U=>G(U.target.value),className:"text-center text-2xl font-bold"})]}),x&&C&&a.jsxs("div",{className:"bg-green-50 dark:bg-green-950 p-3 rounded-lg flex items-center gap-2",children:[a.jsx(Jn,{className:"h-5 w-5 text-green-600"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm text-green-800 dark:text-green-200 font-medium",children:"Code ready!"}),a.jsxs("p",{className:"text-xs text-green-700 dark:text-green-300 mt-1",children:["Your child will use: ",a.jsx("span",{className:"font-mono font-bold",children:x})]})]})]})]}),a.jsx(ce,{type:"submit",className:"w-full",disabled:k||!x||!C,children:k?"Creating...":"Add Child"})]})]})})},zs=p.forwardRef(({className:e,activeClassName:t,pendingClassName:n,to:s,...i},l)=>a.jsx(lP,{ref:l,to:s,className:({isActive:c,isPending:u})=>be(e,c&&t,u&&n),...i}));zs.displayName="NavLink";const Cw=e=>{let t;const n=new Set,s=(h,g)=>{const v=typeof h=="function"?h(t):h;if(!Object.is(v,t)){const w=t;t=g??(typeof v!="object"||v===null)?v:Object.assign({},t,v),n.forEach(x=>x(t,w))}},i=()=>t,u={setState:s,getState:i,getInitialState:()=>f,subscribe:h=>(n.add(h),()=>n.delete(h))},f=t=e(s,i,u);return u},EO=(e=>e?Cw(e):Cw),_O=e=>e;function NO(e,t=_O){const n=pe.useSyncExternalStore(e.subscribe,pe.useCallback(()=>t(e.getState()),[e,t]),pe.useCallback(()=>t(e.getInitialState()),[e,t]));return pe.useDebugValue(n),n}const Sw=e=>{const t=EO(e),n=s=>NO(t,s);return Object.assign(n,t),n},kO=(e=>e?Sw(e):Sw),Vc="kidscallhome_badge_state",xC=1;function Oa(){try{const e=localStorage.getItem(Vc);if(!e)return{unreadMessagesByChild:{},missedCallsByChild:{},lastClearedTimestamps:{messages:{},calls:{}}};const t=JSON.parse(e);return t.version!==xC?(console.log(" [BADGE STORAGE] Version mismatch, clearing old data"),localStorage.removeItem(Vc),{unreadMessagesByChild:{},missedCallsByChild:{},lastClearedTimestamps:{messages:{},calls:{}}}):{unreadMessagesByChild:t.unreadMessagesByChild||{},missedCallsByChild:t.missedCallsByChild||{},lastClearedTimestamps:t.lastClearedTimestamps||{messages:{},calls:{}}}}catch(e){return console.error(" [BADGE STORAGE] Error loading badge state:",e),{unreadMessagesByChild:{},missedCallsByChild:{},lastClearedTimestamps:{messages:{},calls:{}}}}}function Tr(e,t,n){try{const s=Oa(),i=n||s.lastClearedTimestamps,l={version:xC,unreadMessagesByChild:e,missedCallsByChild:t,lastUpdated:new Date().toISOString(),lastClearedTimestamps:i};localStorage.setItem(Vc,JSON.stringify(l))}catch(s){console.error(" [BADGE STORAGE] Error saving badge state:",s)}}function Ew(e,t){try{const n=Oa(),s=new Date().toISOString(),i={...n.lastClearedTimestamps};(t==="messages"||t==="both")&&(i.messages[e]=s),(t==="calls"||t==="both")&&(i.calls[e]=s),Tr(n.unreadMessagesByChild,n.missedCallsByChild,i),console.log(` [BADGE STORAGE] Marked ${t} badges as cleared for child ${e} at ${s}`)}catch(n){console.error(" [BADGE STORAGE] Error marking badges as cleared:",n)}}function Fo(e,t){try{return Oa().lastClearedTimestamps[t][e]||null}catch(n){return console.error(" [BADGE STORAGE] Error getting last cleared timestamp:",n),null}}function jO(){try{localStorage.removeItem(Vc)}catch(e){console.error(" [BADGE STORAGE] Error clearing badge state:",e)}}const _w=Oa(),Ze=kO((e,t)=>({unreadMessagesByChild:_w.unreadMessagesByChild,missedCallsByChild:_w.missedCallsByChild,setInitialUnread:n=>{e({unreadMessagesByChild:n}),Tr(t().unreadMessagesByChild,t().missedCallsByChild)},setInitialMissed:n=>{e({missedCallsByChild:n}),Tr(t().unreadMessagesByChild,t().missedCallsByChild)},incrementUnread:n=>e(s=>{const i={unreadMessagesByChild:{...s.unreadMessagesByChild,[n]:(s.unreadMessagesByChild[n]??0)+1}};return Tr(i.unreadMessagesByChild,s.missedCallsByChild),i}),decrementUnread:(n,s=1)=>e(i=>{const l={unreadMessagesByChild:{...i.unreadMessagesByChild,[n]:Math.max(0,(i.unreadMessagesByChild[n]??0)-s)}};return Tr(l.unreadMessagesByChild,i.missedCallsByChild),l}),clearUnreadForChild:n=>e(s=>{const i={unreadMessagesByChild:{...s.unreadMessagesByChild,[n]:0}};return Tr(i.unreadMessagesByChild,s.missedCallsByChild),Ew(n,"messages"),i}),incrementMissed:n=>e(s=>{const i={missedCallsByChild:{...s.missedCallsByChild,[n]:(s.missedCallsByChild[n]??0)+1}};return Tr(s.unreadMessagesByChild,i.missedCallsByChild),i}),decrementMissed:(n,s=1)=>e(i=>{const l={missedCallsByChild:{...i.missedCallsByChild,[n]:Math.max(0,(i.missedCallsByChild[n]??0)-s)}};return Tr(i.unreadMessagesByChild,l.missedCallsByChild),l}),clearMissedForChild:n=>e(s=>{const i={missedCallsByChild:{...s.missedCallsByChild,[n]:0}};return Tr(s.unreadMessagesByChild,i.missedCallsByChild),Ew(n,"calls"),i}),reset:()=>{e({unreadMessagesByChild:{},missedCallsByChild:{}}),jO()}}));function bC(){const e=Ze(t=>t.unreadMessagesByChild);return Object.values(e).reduce((t,n)=>t+n,0)}function CC(){const e=Ze(t=>t.missedCallsByChild);return Object.values(e).reduce((t,n)=>t+n,0)}function Bm(e){return Ze(t=>e?t.unreadMessagesByChild[e]??0:0)}function SC(e){return Ze(t=>e?t.missedCallsByChild[e]??0:0)}var TO=p.createContext(void 0);function xd(e){const t=p.useContext(TO);return e||t||"ltr"}var Gf="rovingFocusGroup.onEntryFocus",AO={bubbles:!1,cancelable:!0},La="RovingFocusGroup",[Ph,EC,RO]=Yc(La),[PO,bd]=Pn(La,[RO]),[IO,DO]=PO(La),_C=p.forwardRef((e,t)=>a.jsx(Ph.Provider,{scope:e.__scopeRovingFocusGroup,children:a.jsx(Ph.Slot,{scope:e.__scopeRovingFocusGroup,children:a.jsx(OO,{...e,ref:t})})}));_C.displayName=La;var OO=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:s,loop:i=!1,dir:l,currentTabStopId:c,defaultCurrentTabStopId:u,onCurrentTabStopIdChange:f,onEntryFocus:h,preventScrollOnEntryFocus:g=!1,...v}=e,w=p.useRef(null),x=qe(t,w),E=xd(l),[C,b]=gs({prop:c,defaultProp:u??null,onChange:f,caller:La}),[k,_]=p.useState(!1),N=an(h),j=EC(n),R=p.useRef(!1),[T,P]=p.useState(0);return p.useEffect(()=>{const O=w.current;if(O)return O.addEventListener(Gf,N),()=>O.removeEventListener(Gf,N)},[N]),a.jsx(IO,{scope:n,orientation:s,dir:E,loop:i,currentTabStopId:C,onItemFocus:p.useCallback(O=>b(O),[b]),onItemShiftTab:p.useCallback(()=>_(!0),[]),onFocusableItemAdd:p.useCallback(()=>P(O=>O+1),[]),onFocusableItemRemove:p.useCallback(()=>P(O=>O-1),[]),children:a.jsx(Oe.div,{tabIndex:k||T===0?-1:0,"data-orientation":s,...v,ref:x,style:{outline:"none",...e.style},onMouseDown:ye(e.onMouseDown,()=>{R.current=!0}),onFocus:ye(e.onFocus,O=>{const G=!R.current;if(O.target===O.currentTarget&&G&&!k){const L=new CustomEvent(Gf,AO);if(O.currentTarget.dispatchEvent(L),!L.defaultPrevented){const F=j().filter(V=>V.focusable),I=F.find(V=>V.active),U=F.find(V=>V.id===C),B=[I,U,...F].filter(Boolean).map(V=>V.ref.current);jC(B,g)}}R.current=!1}),onBlur:ye(e.onBlur,()=>_(!1))})})}),NC="RovingFocusGroupItem",kC=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:s=!0,active:i=!1,tabStopId:l,children:c,...u}=e,f=ur(),h=l||f,g=DO(NC,n),v=g.currentTabStopId===h,w=EC(n),{onFocusableItemAdd:x,onFocusableItemRemove:E,currentTabStopId:C}=g;return p.useEffect(()=>{if(s)return x(),()=>E()},[s,x,E]),a.jsx(Ph.ItemSlot,{scope:n,id:h,focusable:s,active:i,children:a.jsx(Oe.span,{tabIndex:v?0:-1,"data-orientation":g.orientation,...u,ref:t,onMouseDown:ye(e.onMouseDown,b=>{s?g.onItemFocus(h):b.preventDefault()}),onFocus:ye(e.onFocus,()=>g.onItemFocus(h)),onKeyDown:ye(e.onKeyDown,b=>{if(b.key==="Tab"&&b.shiftKey){g.onItemShiftTab();return}if(b.target!==b.currentTarget)return;const k=$O(b,g.orientation,g.dir);if(k!==void 0){if(b.metaKey||b.ctrlKey||b.altKey||b.shiftKey)return;b.preventDefault();let N=w().filter(j=>j.focusable).map(j=>j.ref.current);if(k==="last")N.reverse();else if(k==="prev"||k==="next"){k==="prev"&&N.reverse();const j=N.indexOf(b.currentTarget);N=g.loop?FO(N,j+1):N.slice(j+1)}setTimeout(()=>jC(N))}}),children:typeof c=="function"?c({isCurrentTabStop:v,hasTabStop:C!=null}):c})})});kC.displayName=NC;var LO={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function MO(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function $O(e,t,n){const s=MO(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return LO[s]}function jC(e,t=!1){const n=document.activeElement;for(const s of e)if(s===n||(s.focus({preventScroll:t}),document.activeElement!==n))return}function FO(e,t){return e.map((n,s)=>e[(t+s)%e.length])}var TC=_C,AC=kC,Ih=["Enter"," "],UO=["ArrowDown","PageUp","Home"],RC=["ArrowUp","PageDown","End"],BO=[...UO,...RC],zO={ltr:[...Ih,"ArrowRight"],rtl:[...Ih,"ArrowLeft"]},VO={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Ma="Menu",[ba,HO,WO]=Yc(Ma),[to,PC]=Pn(Ma,[WO,ri,bd]),Cd=ri(),IC=bd(),[qO,no]=to(Ma),[GO,$a]=to(Ma),DC=e=>{const{__scopeMenu:t,open:n=!1,children:s,dir:i,onOpenChange:l,modal:c=!0}=e,u=Cd(t),[f,h]=p.useState(null),g=p.useRef(!1),v=an(l),w=xd(i);return p.useEffect(()=>{const x=()=>{g.current=!0,document.addEventListener("pointerdown",E,{capture:!0,once:!0}),document.addEventListener("pointermove",E,{capture:!0,once:!0})},E=()=>g.current=!1;return document.addEventListener("keydown",x,{capture:!0}),()=>{document.removeEventListener("keydown",x,{capture:!0}),document.removeEventListener("pointerdown",E,{capture:!0}),document.removeEventListener("pointermove",E,{capture:!0})}},[]),a.jsx(a0,{...u,children:a.jsx(qO,{scope:t,open:n,onOpenChange:v,content:f,onContentChange:h,children:a.jsx(GO,{scope:t,onClose:p.useCallback(()=>v(!1),[v]),isUsingKeyboardRef:g,dir:w,modal:c,children:s})})})};DC.displayName=Ma;var KO="MenuAnchor",zm=p.forwardRef((e,t)=>{const{__scopeMenu:n,...s}=e,i=Cd(n);return a.jsx(um,{...i,...s,ref:t})});zm.displayName=KO;var Vm="MenuPortal",[YO,OC]=to(Vm,{forceMount:void 0}),LC=e=>{const{__scopeMenu:t,forceMount:n,children:s,container:i}=e,l=no(Vm,t);return a.jsx(YO,{scope:t,forceMount:n,children:a.jsx(In,{present:n||l.open,children:a.jsx(Ea,{asChild:!0,container:i,children:s})})})};LC.displayName=Vm;var Rn="MenuContent",[JO,Hm]=to(Rn),MC=p.forwardRef((e,t)=>{const n=OC(Rn,e.__scopeMenu),{forceMount:s=n.forceMount,...i}=e,l=no(Rn,e.__scopeMenu),c=$a(Rn,e.__scopeMenu);return a.jsx(ba.Provider,{scope:e.__scopeMenu,children:a.jsx(In,{present:s||l.open,children:a.jsx(ba.Slot,{scope:e.__scopeMenu,children:c.modal?a.jsx(QO,{...i,ref:t}):a.jsx(XO,{...i,ref:t})})})})}),QO=p.forwardRef((e,t)=>{const n=no(Rn,e.__scopeMenu),s=p.useRef(null),i=qe(t,s);return p.useEffect(()=>{const l=s.current;if(l)return Om(l)},[]),a.jsx(Wm,{...e,ref:i,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ye(e.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),XO=p.forwardRef((e,t)=>{const n=no(Rn,e.__scopeMenu);return a.jsx(Wm,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),ZO=Ks("MenuContent.ScrollLock"),Wm=p.forwardRef((e,t)=>{const{__scopeMenu:n,loop:s=!1,trapFocus:i,onOpenAutoFocus:l,onCloseAutoFocus:c,disableOutsidePointerEvents:u,onEntryFocus:f,onEscapeKeyDown:h,onPointerDownOutside:g,onFocusOutside:v,onInteractOutside:w,onDismiss:x,disableOutsideScroll:E,...C}=e,b=no(Rn,n),k=$a(Rn,n),_=Cd(n),N=IC(n),j=HO(n),[R,T]=p.useState(null),P=p.useRef(null),O=qe(t,P,b.onContentChange),G=p.useRef(0),L=p.useRef(""),F=p.useRef(0),I=p.useRef(null),U=p.useRef("right"),M=p.useRef(0),B=E?vd:p.Fragment,V=E?{as:ZO,allowPinchZoom:!0}:void 0,ee=$=>{const W=L.current+$,D=j().filter(q=>!q.disabled),Q=document.activeElement,le=D.find(q=>q.ref.current===Q)?.textValue,X=D.map(q=>q.textValue),K=uL(X,W,le),te=D.find(q=>q.textValue===K)?.ref.current;(function q(se){L.current=se,window.clearTimeout(G.current),se!==""&&(G.current=window.setTimeout(()=>q(""),1e3))})(W),te&&setTimeout(()=>te.focus())};p.useEffect(()=>()=>window.clearTimeout(G.current),[]),Dm();const z=p.useCallback($=>U.current===I.current?.side&&hL($,I.current?.area),[]);return a.jsx(JO,{scope:n,searchRef:L,onItemEnter:p.useCallback($=>{z($)&&$.preventDefault()},[z]),onItemLeave:p.useCallback($=>{z($)||(P.current?.focus(),T(null))},[z]),onTriggerLeave:p.useCallback($=>{z($)&&$.preventDefault()},[z]),pointerGraceTimerRef:F,onPointerGraceIntentChange:p.useCallback($=>{I.current=$},[]),children:a.jsx(B,{...V,children:a.jsx(pd,{asChild:!0,trapped:i,onMountAutoFocus:ye(l,$=>{$.preventDefault(),P.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:a.jsx(Zo,{asChild:!0,disableOutsidePointerEvents:u,onEscapeKeyDown:h,onPointerDownOutside:g,onFocusOutside:v,onInteractOutside:w,onDismiss:x,children:a.jsx(TC,{asChild:!0,...N,dir:k.dir,orientation:"vertical",loop:s,currentTabStopId:R,onCurrentTabStopIdChange:T,onEntryFocus:ye(f,$=>{k.isUsingKeyboardRef.current||$.preventDefault()}),preventScrollOnEntryFocus:!0,children:a.jsx(fm,{role:"menu","aria-orientation":"vertical","data-state":ZC(b.open),"data-radix-menu-content":"",dir:k.dir,..._,...C,ref:O,style:{outline:"none",...C.style},onKeyDown:ye(C.onKeyDown,$=>{const D=$.target.closest("[data-radix-menu-content]")===$.currentTarget,Q=$.ctrlKey||$.altKey||$.metaKey,le=$.key.length===1;D&&($.key==="Tab"&&$.preventDefault(),!Q&&le&&ee($.key));const X=P.current;if($.target!==X||!BO.includes($.key))return;$.preventDefault();const te=j().filter(q=>!q.disabled).map(q=>q.ref.current);RC.includes($.key)&&te.reverse(),cL(te)}),onBlur:ye(e.onBlur,$=>{$.currentTarget.contains($.target)||(window.clearTimeout(G.current),L.current="")}),onPointerMove:ye(e.onPointerMove,Ca($=>{const W=$.target,D=M.current!==$.clientX;if($.currentTarget.contains(W)&&D){const Q=$.clientX>M.current?"right":"left";U.current=Q,M.current=$.clientX}}))})})})})})})});MC.displayName=Rn;var eL="MenuGroup",qm=p.forwardRef((e,t)=>{const{__scopeMenu:n,...s}=e;return a.jsx(Oe.div,{role:"group",...s,ref:t})});qm.displayName=eL;var tL="MenuLabel",$C=p.forwardRef((e,t)=>{const{__scopeMenu:n,...s}=e;return a.jsx(Oe.div,{...s,ref:t})});$C.displayName=tL;var Hc="MenuItem",Nw="menu.itemSelect",Sd=p.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:s,...i}=e,l=p.useRef(null),c=$a(Hc,e.__scopeMenu),u=Hm(Hc,e.__scopeMenu),f=qe(t,l),h=p.useRef(!1),g=()=>{const v=l.current;if(!n&&v){const w=new CustomEvent(Nw,{bubbles:!0,cancelable:!0});v.addEventListener(Nw,x=>s?.(x),{once:!0}),Kh(v,w),w.defaultPrevented?h.current=!1:c.onClose()}};return a.jsx(FC,{...i,ref:f,disabled:n,onClick:ye(e.onClick,g),onPointerDown:v=>{e.onPointerDown?.(v),h.current=!0},onPointerUp:ye(e.onPointerUp,v=>{h.current||v.currentTarget?.click()}),onKeyDown:ye(e.onKeyDown,v=>{const w=u.searchRef.current!=="";n||w&&v.key===" "||Ih.includes(v.key)&&(v.currentTarget.click(),v.preventDefault())})})});Sd.displayName=Hc;var FC=p.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:s=!1,textValue:i,...l}=e,c=Hm(Hc,n),u=IC(n),f=p.useRef(null),h=qe(t,f),[g,v]=p.useState(!1),[w,x]=p.useState("");return p.useEffect(()=>{const E=f.current;E&&x((E.textContent??"").trim())},[l.children]),a.jsx(ba.ItemSlot,{scope:n,disabled:s,textValue:i??w,children:a.jsx(AC,{asChild:!0,...u,focusable:!s,children:a.jsx(Oe.div,{role:"menuitem","data-highlighted":g?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...l,ref:h,onPointerMove:ye(e.onPointerMove,Ca(E=>{s?c.onItemLeave(E):(c.onItemEnter(E),E.defaultPrevented||E.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ye(e.onPointerLeave,Ca(E=>c.onItemLeave(E))),onFocus:ye(e.onFocus,()=>v(!0)),onBlur:ye(e.onBlur,()=>v(!1))})})})}),nL="MenuCheckboxItem",UC=p.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:s,...i}=e;return a.jsx(WC,{scope:e.__scopeMenu,checked:n,children:a.jsx(Sd,{role:"menuitemcheckbox","aria-checked":Wc(n)?"mixed":n,...i,ref:t,"data-state":Km(n),onSelect:ye(i.onSelect,()=>s?.(Wc(n)?!0:!n),{checkForDefaultPrevented:!1})})})});UC.displayName=nL;var BC="MenuRadioGroup",[rL,sL]=to(BC,{value:void 0,onValueChange:()=>{}}),zC=p.forwardRef((e,t)=>{const{value:n,onValueChange:s,...i}=e,l=an(s);return a.jsx(rL,{scope:e.__scopeMenu,value:n,onValueChange:l,children:a.jsx(qm,{...i,ref:t})})});zC.displayName=BC;var VC="MenuRadioItem",HC=p.forwardRef((e,t)=>{const{value:n,...s}=e,i=sL(VC,e.__scopeMenu),l=n===i.value;return a.jsx(WC,{scope:e.__scopeMenu,checked:l,children:a.jsx(Sd,{role:"menuitemradio","aria-checked":l,...s,ref:t,"data-state":Km(l),onSelect:ye(s.onSelect,()=>i.onValueChange?.(n),{checkForDefaultPrevented:!1})})})});HC.displayName=VC;var Gm="MenuItemIndicator",[WC,oL]=to(Gm,{checked:!1}),qC=p.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:s,...i}=e,l=oL(Gm,n);return a.jsx(In,{present:s||Wc(l.checked)||l.checked===!0,children:a.jsx(Oe.span,{...i,ref:t,"data-state":Km(l.checked)})})});qC.displayName=Gm;var iL="MenuSeparator",GC=p.forwardRef((e,t)=>{const{__scopeMenu:n,...s}=e;return a.jsx(Oe.div,{role:"separator","aria-orientation":"horizontal",...s,ref:t})});GC.displayName=iL;var aL="MenuArrow",KC=p.forwardRef((e,t)=>{const{__scopeMenu:n,...s}=e,i=Cd(n);return a.jsx(hm,{...i,...s,ref:t})});KC.displayName=aL;var lL="MenuSub",[NF,YC]=to(lL),Xi="MenuSubTrigger",JC=p.forwardRef((e,t)=>{const n=no(Xi,e.__scopeMenu),s=$a(Xi,e.__scopeMenu),i=YC(Xi,e.__scopeMenu),l=Hm(Xi,e.__scopeMenu),c=p.useRef(null),{pointerGraceTimerRef:u,onPointerGraceIntentChange:f}=l,h={__scopeMenu:e.__scopeMenu},g=p.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return p.useEffect(()=>g,[g]),p.useEffect(()=>{const v=u.current;return()=>{window.clearTimeout(v),f(null)}},[u,f]),a.jsx(zm,{asChild:!0,...h,children:a.jsx(FC,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":i.contentId,"data-state":ZC(n.open),...e,ref:Kc(t,i.onTriggerChange),onClick:v=>{e.onClick?.(v),!(e.disabled||v.defaultPrevented)&&(v.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ye(e.onPointerMove,Ca(v=>{l.onItemEnter(v),!v.defaultPrevented&&!e.disabled&&!n.open&&!c.current&&(l.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{n.onOpenChange(!0),g()},100))})),onPointerLeave:ye(e.onPointerLeave,Ca(v=>{g();const w=n.content?.getBoundingClientRect();if(w){const x=n.content?.dataset.side,E=x==="right",C=E?-5:5,b=w[E?"left":"right"],k=w[E?"right":"left"];l.onPointerGraceIntentChange({area:[{x:v.clientX+C,y:v.clientY},{x:b,y:w.top},{x:k,y:w.top},{x:k,y:w.bottom},{x:b,y:w.bottom}],side:x}),window.clearTimeout(u.current),u.current=window.setTimeout(()=>l.onPointerGraceIntentChange(null),300)}else{if(l.onTriggerLeave(v),v.defaultPrevented)return;l.onPointerGraceIntentChange(null)}})),onKeyDown:ye(e.onKeyDown,v=>{const w=l.searchRef.current!=="";e.disabled||w&&v.key===" "||zO[s.dir].includes(v.key)&&(n.onOpenChange(!0),n.content?.focus(),v.preventDefault())})})})});JC.displayName=Xi;var QC="MenuSubContent",XC=p.forwardRef((e,t)=>{const n=OC(Rn,e.__scopeMenu),{forceMount:s=n.forceMount,...i}=e,l=no(Rn,e.__scopeMenu),c=$a(Rn,e.__scopeMenu),u=YC(QC,e.__scopeMenu),f=p.useRef(null),h=qe(t,f);return a.jsx(ba.Provider,{scope:e.__scopeMenu,children:a.jsx(In,{present:s||l.open,children:a.jsx(ba.Slot,{scope:e.__scopeMenu,children:a.jsx(Wm,{id:u.contentId,"aria-labelledby":u.triggerId,...i,ref:h,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:g=>{c.isUsingKeyboardRef.current&&f.current?.focus(),g.preventDefault()},onCloseAutoFocus:g=>g.preventDefault(),onFocusOutside:ye(e.onFocusOutside,g=>{g.target!==u.trigger&&l.onOpenChange(!1)}),onEscapeKeyDown:ye(e.onEscapeKeyDown,g=>{c.onClose(),g.preventDefault()}),onKeyDown:ye(e.onKeyDown,g=>{const v=g.currentTarget.contains(g.target),w=VO[c.dir].includes(g.key);v&&w&&(l.onOpenChange(!1),u.trigger?.focus(),g.preventDefault())})})})})})});XC.displayName=QC;function ZC(e){return e?"open":"closed"}function Wc(e){return e==="indeterminate"}function Km(e){return Wc(e)?"indeterminate":e?"checked":"unchecked"}function cL(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function dL(e,t){return e.map((n,s)=>e[(t+s)%e.length])}function uL(e,t,n){const i=t.length>1&&Array.from(t).every(h=>h===t[0])?t[0]:t,l=n?e.indexOf(n):-1;let c=dL(e,Math.max(l,0));i.length===1&&(c=c.filter(h=>h!==n));const f=c.find(h=>h.toLowerCase().startsWith(i.toLowerCase()));return f!==n?f:void 0}function fL(e,t){const{x:n,y:s}=e;let i=!1;for(let l=0,c=t.length-1;l<t.length;c=l++){const u=t[l],f=t[c],h=u.x,g=u.y,v=f.x,w=f.y;g>s!=w>s&&n<(v-h)*(s-g)/(w-g)+h&&(i=!i)}return i}function hL(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return fL(n,t)}function Ca(e){return t=>t.pointerType==="mouse"?e(t):void 0}var mL=DC,pL=zm,gL=LC,vL=MC,yL=qm,wL=$C,xL=Sd,bL=UC,CL=zC,SL=HC,EL=qC,_L=GC,NL=KC,kL=JC,jL=XC,Ed="DropdownMenu",[TL]=Pn(Ed,[PC]),Jt=PC(),[AL,eS]=TL(Ed),tS=e=>{const{__scopeDropdownMenu:t,children:n,dir:s,open:i,defaultOpen:l,onOpenChange:c,modal:u=!0}=e,f=Jt(t),h=p.useRef(null),[g,v]=gs({prop:i,defaultProp:l??!1,onChange:c,caller:Ed});return a.jsx(AL,{scope:t,triggerId:ur(),triggerRef:h,contentId:ur(),open:g,onOpenChange:v,onOpenToggle:p.useCallback(()=>v(w=>!w),[v]),modal:u,children:a.jsx(mL,{...f,open:g,onOpenChange:v,dir:s,modal:u,children:n})})};tS.displayName=Ed;var nS="DropdownMenuTrigger",rS=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:s=!1,...i}=e,l=eS(nS,n),c=Jt(n);return a.jsx(pL,{asChild:!0,...c,children:a.jsx(Oe.button,{type:"button",id:l.triggerId,"aria-haspopup":"menu","aria-expanded":l.open,"aria-controls":l.open?l.contentId:void 0,"data-state":l.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...i,ref:Kc(t,l.triggerRef),onPointerDown:ye(e.onPointerDown,u=>{!s&&u.button===0&&u.ctrlKey===!1&&(l.onOpenToggle(),l.open||u.preventDefault())}),onKeyDown:ye(e.onKeyDown,u=>{s||(["Enter"," "].includes(u.key)&&l.onOpenToggle(),u.key==="ArrowDown"&&l.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(u.key)&&u.preventDefault())})})})});rS.displayName=nS;var RL="DropdownMenuPortal",sS=e=>{const{__scopeDropdownMenu:t,...n}=e,s=Jt(t);return a.jsx(gL,{...s,...n})};sS.displayName=RL;var oS="DropdownMenuContent",iS=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=eS(oS,n),l=Jt(n),c=p.useRef(!1);return a.jsx(vL,{id:i.contentId,"aria-labelledby":i.triggerId,...l,...s,ref:t,onCloseAutoFocus:ye(e.onCloseAutoFocus,u=>{c.current||i.triggerRef.current?.focus(),c.current=!1,u.preventDefault()}),onInteractOutside:ye(e.onInteractOutside,u=>{const f=u.detail.originalEvent,h=f.button===0&&f.ctrlKey===!0,g=f.button===2||h;(!i.modal||g)&&(c.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});iS.displayName=oS;var PL="DropdownMenuGroup",IL=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=Jt(n);return a.jsx(yL,{...i,...s,ref:t})});IL.displayName=PL;var DL="DropdownMenuLabel",aS=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=Jt(n);return a.jsx(wL,{...i,...s,ref:t})});aS.displayName=DL;var OL="DropdownMenuItem",lS=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=Jt(n);return a.jsx(xL,{...i,...s,ref:t})});lS.displayName=OL;var LL="DropdownMenuCheckboxItem",cS=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=Jt(n);return a.jsx(bL,{...i,...s,ref:t})});cS.displayName=LL;var ML="DropdownMenuRadioGroup",$L=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=Jt(n);return a.jsx(CL,{...i,...s,ref:t})});$L.displayName=ML;var FL="DropdownMenuRadioItem",dS=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=Jt(n);return a.jsx(SL,{...i,...s,ref:t})});dS.displayName=FL;var UL="DropdownMenuItemIndicator",uS=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=Jt(n);return a.jsx(EL,{...i,...s,ref:t})});uS.displayName=UL;var BL="DropdownMenuSeparator",fS=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=Jt(n);return a.jsx(_L,{...i,...s,ref:t})});fS.displayName=BL;var zL="DropdownMenuArrow",VL=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=Jt(n);return a.jsx(NL,{...i,...s,ref:t})});VL.displayName=zL;var HL="DropdownMenuSubTrigger",hS=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=Jt(n);return a.jsx(kL,{...i,...s,ref:t})});hS.displayName=HL;var WL="DropdownMenuSubContent",mS=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=Jt(n);return a.jsx(jL,{...i,...s,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});mS.displayName=WL;var qL=tS,GL=rS,KL=sS,pS=iS,gS=aS,vS=lS,yS=cS,wS=dS,xS=uS,bS=fS,CS=hS,SS=mS;const kw=qL,jw=GL,YL=p.forwardRef(({className:e,inset:t,children:n,...s},i)=>a.jsxs(CS,{ref:i,className:be("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",t&&"pl-8",e),...s,children:[n,a.jsx(Xh,{className:"ml-auto h-4 w-4"})]}));YL.displayName=CS.displayName;const JL=p.forwardRef(({className:e,...t},n)=>a.jsx(SS,{ref:n,className:be("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));JL.displayName=SS.displayName;const Dh=p.forwardRef(({className:e,sideOffset:t=4,...n},s)=>a.jsx(KL,{children:a.jsx(pS,{ref:s,sideOffset:t,className:be("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Dh.displayName=pS.displayName;const Zi=p.forwardRef(({className:e,inset:t,...n},s)=>a.jsx(vS,{ref:s,className:be("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t&&"pl-8",e),...n}));Zi.displayName=vS.displayName;const QL=p.forwardRef(({className:e,children:t,checked:n,...s},i)=>a.jsxs(yS,{ref:i,className:be("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),checked:n,...s,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(xS,{children:a.jsx(Jn,{className:"h-4 w-4"})})}),t]}));QL.displayName=yS.displayName;const XL=p.forwardRef(({className:e,children:t,...n},s)=>a.jsxs(wS,{ref:s,className:be("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(xS,{children:a.jsx(gk,{className:"h-2 w-2 fill-current"})})}),t]}));XL.displayName=wS.displayName;const ZL=p.forwardRef(({className:e,inset:t,...n},s)=>a.jsx(gS,{ref:s,className:be("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));ZL.displayName=gS.displayName;const eM=p.forwardRef(({className:e,...t},n)=>a.jsx(bS,{ref:n,className:be("-mx-1 my-1 h-px bg-muted",e),...t}));eM.displayName=bS.displayName;var ES="AlertDialog",[tM]=Pn(ES,[nC]),Dr=nC(),_S=e=>{const{__scopeAlertDialog:t,...n}=e,s=Dr(t);return a.jsx(Fm,{...s,...n,modal:!0})};_S.displayName=ES;var nM="AlertDialogTrigger",rM=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...s}=e,i=Dr(n);return a.jsx(yC,{...i,...s,ref:t})});rM.displayName=nM;var sM="AlertDialogPortal",NS=e=>{const{__scopeAlertDialog:t,...n}=e,s=Dr(t);return a.jsx(Um,{...s,...n})};NS.displayName=sM;var oM="AlertDialogOverlay",kS=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...s}=e,i=Dr(n);return a.jsx(Ra,{...i,...s,ref:t})});kS.displayName=oM;var Ho="AlertDialogContent",[iM,aM]=tM(Ho),lM=Jw("AlertDialogContent"),jS=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:s,...i}=e,l=Dr(n),c=p.useRef(null),u=qe(t,c),f=p.useRef(null);return a.jsx(vO,{contentName:Ho,titleName:TS,docsSlug:"alert-dialog",children:a.jsx(iM,{scope:n,cancelRef:f,children:a.jsxs(Pa,{role:"alertdialog",...l,...i,ref:u,onOpenAutoFocus:ye(i.onOpenAutoFocus,h=>{h.preventDefault(),f.current?.focus({preventScroll:!0})}),onPointerDownOutside:h=>h.preventDefault(),onInteractOutside:h=>h.preventDefault(),children:[a.jsx(lM,{children:s}),a.jsx(dM,{contentRef:c})]})})})});jS.displayName=Ho;var TS="AlertDialogTitle",AS=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...s}=e,i=Dr(n);return a.jsx(Ia,{...i,...s,ref:t})});AS.displayName=TS;var RS="AlertDialogDescription",PS=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...s}=e,i=Dr(n);return a.jsx(Da,{...i,...s,ref:t})});PS.displayName=RS;var cM="AlertDialogAction",IS=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...s}=e,i=Dr(n);return a.jsx(wd,{...i,...s,ref:t})});IS.displayName=cM;var DS="AlertDialogCancel",OS=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...s}=e,{cancelRef:i}=aM(DS,n),l=Dr(n),c=qe(t,i);return a.jsx(wd,{...l,...s,ref:c})});OS.displayName=DS;var dM=({contentRef:e})=>{const t=`\`${Ho}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Ho}\` by passing a \`${RS}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Ho}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},uM=_S,fM=NS,LS=kS,MS=jS,$S=IS,FS=OS,US=AS,BS=PS;const Xn=uM,hM=fM,zS=p.forwardRef(({className:e,...t},n)=>a.jsx(LS,{className:be("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));zS.displayName=LS.displayName;const _n=p.forwardRef(({className:e,...t},n)=>a.jsxs(hM,{children:[a.jsx(zS,{}),a.jsx(MS,{ref:n,className:be("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));_n.displayName=MS.displayName;const Nn=({className:e,...t})=>a.jsx("div",{className:be("flex flex-col space-y-2 text-center sm:text-left",e),...t});Nn.displayName="AlertDialogHeader";const kn=({className:e,...t})=>a.jsx("div",{className:be("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});kn.displayName="AlertDialogFooter";const jn=p.forwardRef(({className:e,...t},n)=>a.jsx(US,{ref:n,className:be("text-lg font-semibold",e),...t}));jn.displayName=US.displayName;const Tn=p.forwardRef(({className:e,...t},n)=>a.jsx(BS,{ref:n,className:be("text-sm text-muted-foreground",e),...t}));Tn.displayName=BS.displayName;const mr=p.forwardRef(({className:e,...t},n)=>a.jsx($S,{ref:n,className:be(km(),e),...t}));mr.displayName=$S.displayName;const An=p.forwardRef(({className:e,...t},n)=>a.jsx(FS,{ref:n,className:be(km({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));An.displayName=FS.displayName;const Ot=()=>{const e=gn(),t=tt(),{toast:n}=Ct(),s=()=>{const C=e.pathname;if(C.includes("/child/"))return"child";if(C.includes("/parent/"))return null;if(document.cookie.includes("sb-")||localStorage.getItem("sb-"))return"parent";const k=localStorage.getItem("childSession");if(k)try{return JSON.parse(k),"child"}catch{}return null},[i,l]=p.useState(s),[c,u]=p.useState(!1),[f,h]=p.useState(!1),g=bC(),v=CC();p.useEffect(()=>{(async()=>{const b=e.pathname;if(b.includes("/child/")){const k=localStorage.getItem("childSession");if(k)try{JSON.parse(k),l("child");return}catch{}}if(b.includes("/parent/"))try{const{data:{session:k}}=await Y.auth.getSession();if(k){l("parent");return}}catch(k){console.error("Error checking parent session:",k)}try{const{data:{session:k}}=await Y.auth.getSession();if(k)l("parent");else{const _=localStorage.getItem("childSession");if(_)try{JSON.parse(_),l("child")}catch{l(null)}else l(null)}}catch(k){console.error("Error checking parent session:",k),l(null)}})()},[e.pathname]);const w=async()=>{if(i==="child"){const C=localStorage.getItem("childSession");if(C)try{const b=JSON.parse(C)}catch{}localStorage.removeItem("childSession"),Ze.getState().reset(),n({title:"Logged out"}),t("/child/login")}else if(i==="parent"){const{data:{user:C}}=await Y.auth.getUser();await Y.auth.signOut(),Ze.getState().reset(),n({title:"Logged out"}),t("/parent/auth")}};if(c||!i||e.pathname.includes("/auth")||e.pathname.includes("/login")||e.pathname.includes("/call/")||e.pathname.includes("/chat/"))return null;const x=({isActive:C})=>be("flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors relative",C?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"),E=({count:C})=>C===0?null:a.jsx("span",{className:"absolute -top-1 -right-1 bg-destructive text-destructive-foreground text-xs font-bold rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1 border-2 border-background",children:C>99?"99+":C});return i==="parent"?a.jsxs(a.Fragment,{children:[a.jsx("nav",{className:"fixed top-0 left-0 right-0 z-50 border-b bg-background w-full overflow-x-hidden",style:{paddingTop:"calc(var(--safe-area-inset-top) * 0.15)"},children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full",children:a.jsxs("div",{className:"flex items-center justify-between h-16 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-4 min-w-0 flex-shrink","data-tour":"parent-menu",children:[a.jsxs(zs,{to:"/parent",className:x,children:[a.jsx(Ys,{className:"h-4 w-4"}),a.jsx("span",{children:"Home"})]}),a.jsxs(zs,{to:"/parent/dashboard",className:x,children:[a.jsxs("div",{className:"relative flex items-center justify-center",children:[a.jsx(Zv,{className:"h-4 w-4"}),a.jsx(E,{count:v})]}),a.jsx("span",{children:"Dashboard"})]}),a.jsxs(zs,{to:"/parent/children",className:x,children:[a.jsxs("div",{className:"relative flex items-center justify-center",children:[a.jsx(la,{className:"h-4 w-4"}),a.jsx(E,{count:g})]}),a.jsx("span",{children:"Children"})]}),a.jsxs(kw,{children:[a.jsx(jw,{asChild:!0,children:a.jsxs("button",{className:be("flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors",e.pathname==="/parent/devices"||e.pathname==="/parent/settings"||e.pathname==="/info"?"bg-accent text-accent-foreground":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"),children:[a.jsx(Qv,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"More"})]})}),a.jsxs(Dh,{align:"end",className:"w-48",children:[a.jsxs(Zi,{onClick:()=>t("/parent/devices"),children:[a.jsx(xc,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Devices"})]}),a.jsxs(Zi,{onClick:()=>t("/parent/settings"),children:[a.jsx(jx,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Settings"})]}),a.jsxs(Zi,{onClick:()=>t("/info"),children:[a.jsx(jc,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"App Information"})]})]})]})]}),a.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>h(!0),className:"flex-shrink-0",children:[a.jsx(ey,{className:"h-4 w-4 md:mr-2"}),a.jsx("span",{className:"hidden md:inline",children:"Logout"})]})]})})}),a.jsx(Xn,{open:f,onOpenChange:h,children:a.jsxs(_n,{children:[a.jsxs(Nn,{children:[a.jsx(jn,{children:"Confirm Logout"}),a.jsx(Tn,{children:"Are you sure you want to log out? You'll need to sign in again to access your account."})]}),a.jsxs(kn,{children:[a.jsx(An,{children:"Cancel"}),a.jsx(mr,{onClick:w,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Logout"})]})]})})]}):i==="child"?a.jsxs(a.Fragment,{children:[a.jsx("nav",{className:"fixed top-0 left-0 right-0 z-50 border-b bg-background w-full overflow-x-hidden",style:{paddingTop:"calc(var(--safe-area-inset-top) * 0.15)"},children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full",children:a.jsxs("div",{className:"flex items-center justify-between h-16 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-4 min-w-0 flex-shrink","data-tour":"child-help",children:[a.jsxs(zs,{to:"/child",className:x,children:[a.jsx(Ys,{className:"h-4 w-4"}),a.jsx("span",{children:"Home"})]}),a.jsxs(zs,{to:"/child/dashboard",className:x,children:[a.jsxs("div",{className:"relative flex items-center justify-center",children:[a.jsx(Zv,{className:"h-4 w-4"}),a.jsx(E,{count:v})]}),a.jsx("span",{children:"Dashboard"})]}),a.jsxs(zs,{to:"/child/parents",className:x,children:[a.jsxs("div",{className:"relative flex items-center justify-center",children:[a.jsx(la,{className:"h-4 w-4"}),a.jsx(E,{count:g})]}),a.jsx("span",{children:"Parents"})]}),a.jsxs(kw,{children:[a.jsx(jw,{asChild:!0,children:a.jsxs("button",{className:be("flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors",e.pathname==="/info"?"bg-accent text-accent-foreground":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"),children:[a.jsx(Qv,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"More"})]})}),a.jsx(Dh,{align:"end",className:"w-48",children:a.jsxs(Zi,{onClick:()=>t("/info"),children:[a.jsx(jc,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"App Information"})]})})]})]}),a.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>h(!0),className:"flex-shrink-0",children:[a.jsx(ey,{className:"h-4 w-4 md:mr-2"}),a.jsx("span",{className:"hidden md:inline",children:"Logout"})]})]})})}),a.jsx(Xn,{open:f,onOpenChange:h,children:a.jsxs(_n,{children:[a.jsxs(Nn,{children:[a.jsx(jn,{children:"Confirm Logout"}),a.jsx(Tn,{children:"Are you sure you want to log out? You'll need to sign in again to access your account."})]}),a.jsxs(kn,{children:[a.jsx(An,{children:"Cancel"}),a.jsx(mr,{onClick:w,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Logout"})]})]})})]}):null},mM=()=>{const[e,t]=p.useState(!document.hidden),[n,s]=p.useState(!document.hidden);return p.useEffect(()=>{const i=()=>{const u=!document.hidden;t(u),u&&s(!0)};t(!document.hidden),s(!document.hidden),document.addEventListener("visibilitychange",i);const l=()=>{t(!0),s(!0)},c=()=>{t(!1)};return window.addEventListener("focus",l),window.addEventListener("blur",c),()=>{document.removeEventListener("visibilitychange",i),window.removeEventListener("focus",l),window.removeEventListener("blur",c)}},[]),{isVisible:e,hasBeenVisible:n,isHidden:!e}},pM=()=>{const e=p.useRef(null),t=p.useRef(null);p.useEffect(()=>{"serviceWorker"in navigator&&(navigator.serviceWorker.register("/sw.js").then(c=>{console.log(" [PUSH] Service Worker registered:",c),e.current=c,c.addEventListener("updatefound",()=>{console.log(" [PUSH] Service Worker update found");const u=c.installing;u&&u.addEventListener("statechange",()=>{u.state==="installed"&&navigator.serviceWorker.controller&&console.log(" [PUSH] New service worker installed, reload to activate")})})}).catch(c=>{console.error(" [PUSH] Service Worker registration failed:",c)}),navigator.serviceWorker.addEventListener("message",c=>{if(console.log(" [PUSH] Message from service worker:",c.data),c.data&&c.data.type==="NOTIFICATION_CLICKED"){const{callId:u,url:f}=c.data;t.current&&t.current({callId:u,url:f})}}))},[]);const n=p.useCallback(async()=>{if(!("Notification"in window))return console.warn(" [PUSH] This browser does not support notifications"),"denied";if(Notification.permission==="granted")return"granted";if(Notification.permission==="denied")return console.warn(" [PUSH] Notification permission denied"),"denied";const c=await Notification.requestPermission();return console.log(" [PUSH] Notification permission:",c),c},[]),s=p.useCallback(async c=>{if(!("Notification"in window)){console.warn(" [PUSH] Notifications not supported");return}if(await n()!=="granted"){console.warn(" [PUSH] Notification permission not granted");return}if(e.current)try{await e.current.showNotification(c.title,{body:c.body,icon:c.icon||"/icon-192x192.png",badge:c.badge||"/icon-96x96.png",tag:c.tag||"notification",requireInteraction:c.requireInteraction??!0,vibrate:c.vibrate||[200,100,200],data:c.data||{},actions:c.actions||[]}),console.log(" [PUSH] Notification sent via service worker")}catch(f){console.error(" [PUSH] Failed to send notification:",f)}else try{new Notification(c.title,{body:c.body,icon:c.icon||"/icon-192x192.png",tag:c.tag||"notification",requireInteraction:c.requireInteraction??!0,data:c.data||{}}),console.log(" [PUSH] Notification sent via Notification API")}catch(f){console.error(" [PUSH] Failed to send notification:",f)}},[n]),i=p.useCallback(async c=>{e.current&&(await e.current.getNotifications({tag:c})).forEach(f=>f.close())},[]),l=p.useCallback(c=>{t.current=c},[]);return{requestPermission:n,sendNotification:s,closeNotification:i,onNotificationClick:l,hasPermission:"Notification"in window&&Notification.permission==="granted",permission:"Notification"in window?Notification.permission:"default"}},Ym=(e={})=>{const{enabled:t=!0,volume:n=.7}=e,s=p.useRef(null),i=p.useRef(null),l=p.useRef(null),c=p.useRef({}),u=p.useRef([]);p.useEffect(()=>{if(!t)return;try{const _=window.AudioContext||window.webkitAudioContext;s.current=new _,console.log(" [AUDIO] AudioContext created, state:",s.current.state)}catch(_){console.error(" [AUDIO] Failed to create AudioContext:",_)}const b=async()=>{if(s.current&&s.current.state==="suspended")try{await s.current.resume(),console.log(" [AUDIO] AudioContext resumed via user interaction")}catch(_){console.error(" [AUDIO] Failed to resume AudioContext:",_)}};return["click","touchstart","keydown","mousedown"].forEach(_=>{document.addEventListener(_,b,{passive:!0}),u.current.push({event:_,handler:b})}),b(),()=>{if(c.current.ringtone&&(c.current.ringtone=!1),i.current&&(clearInterval(i.current),i.current=null),l.current&&(clearInterval(l.current),l.current=null),"vibrate"in navigator)try{navigator.vibrate(0)}catch{}u.current.forEach(({event:_,handler:N})=>{document.removeEventListener(_,N)}),u.current=[],s.current&&(s.current.close().catch(console.error),s.current=null)}},[t]);const f=p.useCallback(async()=>{if(!s.current)try{const b=window.AudioContext||window.webkitAudioContext;s.current=new b,console.log(" [AUDIO] AudioContext created, initial state:",s.current.state)}catch(b){return console.error(" [AUDIO] Failed to create AudioContext:",b),null}if(s.current.state==="suspended")try{console.log(" [AUDIO] AudioContext is suspended, attempting to resume..."),await s.current.resume(),console.log(" [AUDIO] AudioContext resumed successfully, state:",s.current.state)}catch(b){console.error(" [AUDIO] Failed to resume AudioContext:",b);try{await new Promise(k=>setTimeout(k,100)),s.current.state==="suspended"&&(await s.current.resume(),console.log(" [AUDIO] AudioContext resumed on retry, state:",s.current.state))}catch(k){return console.error(" [AUDIO] Failed to resume AudioContext on retry:",k),console.warn(" [AUDIO] AudioContext requires user interaction. Ringtone may not play until user interacts with page."),null}}return s.current},[]),h=p.useCallback(()=>{if(!(!t||!("vibrate"in navigator)))try{const b=()=>{if(c.current.ringtone&&"vibrate"in navigator)try{navigator.vibrate([200,100,200])}catch{}};b(),l.current=setInterval(()=>{c.current.ringtone&&b()},2e3),console.log(" [AUDIO] Vibration started")}catch{console.debug(" [AUDIO] Vibration not available yet (requires user interaction)")}},[t]),g=p.useCallback(async()=>{if(!t){console.log(" [AUDIO] Audio notifications disabled");return}if(c.current.ringtone){console.log(" [AUDIO] Ringtone already playing");return}const b=await f();if(!b){console.error(" [AUDIO] Cannot play ringtone - AudioContext not available");return}try{c.current.ringtone=!0,console.log(" [AUDIO] Ringtone started, AudioContext state:",b.state);const k=()=>{if(!(!c.current.ringtone||!s.current))try{const _=s.current.createOscillator(),N=s.current.createGain();_.connect(N),N.connect(s.current.destination),_.frequency.value=800,_.type="sine";const j=s.current.currentTime;N.gain.setValueAtTime(0,j),N.gain.linearRampToValueAtTime(n*.4,j+.05),N.gain.linearRampToValueAtTime(n*.4,j+.2),N.gain.linearRampToValueAtTime(0,j+.25),_.start(j),_.stop(j+.25)}catch(_){console.error(" [AUDIO] Error playing tone:",_)}};k(),h(),i.current=setInterval(()=>{c.current.ringtone&&(k(),setTimeout(()=>{c.current.ringtone&&k()},250))},2e3)}catch(k){console.error(" [AUDIO] Error playing ringtone:",k),c.current.ringtone=!1}},[t,n,f,h]),v=p.useCallback(()=>{if(l.current&&(clearInterval(l.current),l.current=null),"vibrate"in navigator)try{navigator.vibrate(0)}catch{}console.log(" [AUDIO] Vibration stopped")},[]),w=p.useCallback(()=>{c.current.ringtone&&(c.current.ringtone=!1,i.current&&(clearInterval(i.current),i.current=null),v(),console.log(" [AUDIO] Ringtone stopped"))},[v]),x=p.useCallback(async()=>{if(!t)return;const b=await f();if(b)try{const k=b.createOscillator(),_=b.createGain();k.connect(_),_.connect(b.destination),k.frequency.value=400,k.type="sine";const N=b.currentTime;_.gain.setValueAtTime(0,N),_.gain.linearRampToValueAtTime(n*.3,N+.05),_.gain.linearRampToValueAtTime(0,N+.2),k.start(N),k.stop(N+.2),console.log(" [AUDIO] Call ended sound played")}catch(k){console.error(" [AUDIO] Error playing call ended sound:",k)}},[t,n,f]),E=p.useCallback(async()=>{if(!t)return;const b=await f();if(b)try{[600,800].forEach((k,_)=>{const N=b.createOscillator(),j=b.createGain();N.connect(j),j.connect(b.destination),N.frequency.value=k,N.type="sine";const R=b.currentTime+_*.1;j.gain.setValueAtTime(0,R),j.gain.linearRampToValueAtTime(n*.4,R+.05),j.gain.linearRampToValueAtTime(0,R+.15),N.start(R),N.stop(R+.15)}),console.log(" [AUDIO] Call answered sound played")}catch(k){console.error(" [AUDIO] Error playing call answered sound:",k)}},[t,n,f]),C=p.useCallback(b=>{b==="ringtone"&&w()},[w]);return{playRingtone:g,stopRingtone:w,startVibration:h,stopVibration:v,playCallEnded:x,playCallAnswered:E,stopSound:C,isPlaying:c.current}},Jm=(e={})=>{const{enabled:t=!0,volume:n=.7}=e,s=tt(),{isVisible:i,hasBeenVisible:l}=mM(),{sendNotification:c,closeNotification:u,onNotificationClick:f,hasPermission:h}=pM(),{playRingtone:g,stopRingtone:v}=Ym({enabled:t,volume:n}),w=p.useRef(null),x=p.useRef(!1);p.useEffect(()=>{f(b=>{console.log(" [CALL NOTIFICATIONS] Notification clicked, starting ringtone",b),u("incoming-call"),b.url&&s(b.url),b.callId===w.current&&g().catch(k=>{console.error(" [CALL NOTIFICATIONS] Failed to play ringtone after notification click:",k)})})},[f,u,s,g]);const E=p.useCallback(async b=>{t&&(w.current=b.callId,x.current=!1,console.log(" [CALL NOTIFICATIONS] Handling incoming call:",{callId:b.callId,isVisible:i,hasBeenVisible:l}),i&&l?(console.log(" [CALL NOTIFICATIONS] Tab is active, playing ringtone immediately"),g().catch(k=>{console.error(" [CALL NOTIFICATIONS] Failed to play ringtone:",k)})):(console.log(" [CALL NOTIFICATIONS] Tab is not active, showing push notification"),await c({title:"Incoming Call",body:b.callerName?`${b.callerName} is calling...`:"You have an incoming call",icon:"/icon-192x192.png",badge:"/icon-96x96.png",tag:"incoming-call",requireInteraction:!0,vibrate:[200,100,200,100,200],data:{callId:b.callId,callerName:b.callerName,callerId:b.callerId,url:b.url}}),x.current=!0))},[t,i,l,h,c,g]);p.useEffect(()=>{i&&w.current&&l&&x.current&&(console.log(" [CALL NOTIFICATIONS] Tab became visible, starting ringtone"),g().catch(b=>{console.error(" [CALL NOTIFICATIONS] Failed to play ringtone when tab became visible:",b)}))},[i,l,g]);const C=p.useCallback(async b=>{w.current===b&&(console.log(" [CALL NOTIFICATIONS] Stopping incoming call notifications:",b),v(),await u("incoming-call"),w.current=null,x.current=!1)},[v,u]);return p.useEffect(()=>()=>{w.current&&C(w.current)},[C]),{handleIncomingCall:E,stopIncomingCall:C,hasActiveCall:w.current!==null,activeCallId:w.current}};async function Xs({callId:e,by:t,reason:n="hangup"}){console.log(" [CALL LIFECYCLE] End requested",{callId:e,by:t,reason:n,timestamp:new Date().toISOString()});let s=null;try{const{data:h,error:g}=await Y.from("calls").select("id, status, ended_at").eq("id",e).maybeSingle();g?console.warn(" [CALL LIFECYCLE] Error checking call status (will continue):",g):s=h}catch(h){console.warn(" [CALL LIFECYCLE] Exception checking call status (will continue):",h)}if(s&&(s.status==="ended"||s.ended_at))return console.log(" [CALL LIFECYCLE] Call already ended (idempotent)",{callId:e,status:s.status,ended_at:s.ended_at}),s;let i=null,l=null;const c={status:"ended",ended_at:new Date().toISOString(),ended_by:t,end_reason:n},{data:u,error:f}=await Y.from("calls").update(c).eq("id",e).select("id, status, ended_at, ended_by, end_reason").single();if(i=u,l=f,l&&(l.code==="PGRST204"||l.code==="406"||l.message?.includes("end_reason")||l.message?.includes("ended_by")||l.message?.includes("ended_at")||l.message?.includes("Not Acceptable"))){console.warn(" [CALL LIFECYCLE] Update failed (possibly schema issue), trying fallback",{callId:e,errorCode:l.code,errorMessage:l.message});let h=null;try{const{error:g}=await Y.rpc("ensure_call_ending_columns");h=g}catch{h={message:"RPC function not available"}}if(!h){console.log(" [CALL LIFECYCLE] Columns created, retrying update",{callId:e});const{data:g,error:v}=await Y.from("calls").update({status:"ended",ended_at:new Date().toISOString(),ended_by:t,end_reason:n}).eq("id",e).select("id, status, ended_at, ended_by, end_reason").single();v?l=v:(i=g,l=null,console.log(" [CALL LIFECYCLE] Call ended successfully after creating columns",{callId:e}))}if(l){console.warn(" [CALL LIFECYCLE] Column creation failed or retry failed, falling back to basic update",{callId:e});const{data:g,error:v}=await Y.from("calls").update({status:"ended"}).eq("id",e).select("id, status").single();if(!v)i=g,l=null,console.log(" [CALL LIFECYCLE] Call ended with simple update (columns not available)",{callId:e});else{const{data:w}=await Y.from("calls").select("id, status").eq("id",e).maybeSingle();if(w?.status==="ended")i=w,l=null,console.log(" [CALL LIFECYCLE] Call already ended (idempotent)",{callId:e});else return console.warn(" [CALL LIFECYCLE] Fallback update failed, but continuing",{callId:e,error:v,currentStatus:w?.status}),null}}}if(!l&&i)try{const h=Y.rpc("increment_call_version",{call_id:e});h&&typeof h.catch=="function"&&await h.catch(()=>{})}catch{console.log(" [CALL LIFECYCLE] Version increment RPC not available (optional)",{callId:e})}if(l){if(l.code==="PGRST116"||l.message?.includes("No rows")){console.log(" [CALL LIFECYCLE] No rows updated - call may already be ended (idempotent)",{callId:e});const{data:h}=await Y.from("calls").select("id, status, ended_at").eq("id",e).maybeSingle();return h}if(l.code==="406"||l.message?.includes("Not Acceptable")){console.warn(" [CALL LIFECYCLE] 406 error detected, trying simple status update",{callId:e});const{data:h,error:g}=await Y.from("calls").update({status:"ended"}).eq("id",e).select("id, status").single();if(!g&&h)return console.log(" [CALL LIFECYCLE] Call ended with simple status update",{callId:e}),h}return console.error(" [CALL LIFECYCLE] Error ending call:",l),null}return i&&console.log(" [CALL LIFECYCLE] Call ended successfully",{callId:i.id,status:i.status,ended_at:i.ended_at,ended_by:i.ended_by,end_reason:i.end_reason}),i}function Yt(e){return e.status==="ended"||!!e.ended_at}const Kf=[{id:"parent-child-name-status",selector:'[data-tour="parent-child-name-status"]',title:"Child Status",description:"Your child's name and online status. Green dot means they're online and available to call.",placement:"bottom"},{id:"parent-login-code",selector:'[data-tour="parent-login-code"]',title:"Login Code",description:"This is your child's unique login code. Share this code with them so they can log in to their account.",placement:"bottom"},{id:"parent-copy-code",selector:'[data-tour="parent-copy-code"]',title:"Copy Code",description:"Tap this button to copy the login code to your clipboard. Easy way to share it via text or email.",placement:"bottom"},{id:"parent-copy-link",selector:'[data-tour="parent-copy-link"]',title:"Copy Link",description:"Copy a magic link that includes the login code. Your child can tap the link to log in automatically.",placement:"bottom"},{id:"parent-print-code",selector:'[data-tour="parent-print-code"]',title:"Print Code",description:"Print the login code on a card or paper. Great for giving to your child to keep handy.",placement:"bottom"},{id:"parent-view-qr",selector:'[data-tour="parent-view-qr"]',title:"View QR Code",description:"See a QR code version of the login code. Your child can scan it with their device camera to log in.",placement:"bottom"},{id:"parent-call-button",selector:'[data-tour="parent-call-button"]',title:"Start a Video Call",description:"Tap this button to start a video call with your child. Make sure they're online (green dot) for best results.",placement:"bottom"},{id:"parent-messages",selector:'[data-tour="parent-messages"]',title:"Send Messages",description:"Send text messages to your child. Perfect for quick notes when they can't answer a call.",placement:"bottom"},{id:"parent-delete-child",selector:'[data-tour="parent-delete-child"]',title:"Delete Child",description:"Remove this child from your account. Use with caution - this action cannot be undone.",placement:"bottom"},{id:"parent-upgrade-plan",selector:'[data-tour="parent-upgrade-plan"]',title:"Upgrade Plan",description:"Tap here to upgrade your subscription and add more children to your account. View available plans and pricing.",placement:"bottom"},{id:"parent-upgrade-limit",selector:'[data-tour="parent-upgrade-limit"]',title:"Upgrade When Limit Reached",description:"When you reach your subscription limit, tap this button to upgrade and add more children to your account.",placement:"bottom"},{id:"parent-menu",selector:'[data-tour="parent-menu"]',title:"Navigation Menu",description:"Use the menu at the top to navigate between pages: Home, Dashboard, Children, Devices, Settings, and App Information.",placement:"bottom"}],Yf=[{id:"child-answer-button",selector:'[data-tour="child-answer-button"]',description:"Tap this to talk to mom or dad. ",placement:"bottom"},{id:"child-messages",selector:'[data-tour="child-messages"]',description:"Tap here to see messages. ",placement:"bottom"},{id:"child-help",selector:'[data-tour="child-help"]',description:"Use the navigation menu to switch between pages.",placement:"bottom"}],gM=[{id:"parent-home-view-children",selector:'[data-tour="parent-home-view-children"]',title:"View Children",description:"Tap here to see all your children and their profiles.",placement:"bottom"},{id:"parent-home-dashboard",selector:'[data-tour="parent-home-dashboard"]',title:"Go to Dashboard",description:"Access the full dashboard to manage children, login codes, and more.",placement:"bottom"}],vM=[{id:"parent-children-list-card",selector:'[data-tour="parent-children-list-card"]',title:"Child Profile",description:"Each card shows your child's name, online status, and login code.",placement:"bottom"},{id:"parent-children-list-call",selector:'[data-tour="parent-children-list-call"]',title:"Call Your Child",description:"Tap the Call button to start a video call with your child.",placement:"bottom"},{id:"parent-children-list-message",selector:'[data-tour="parent-children-list-message"]',title:"Send Message",description:"Tap the Message button to send a text message to your child.",placement:"bottom"}],yM=[{id:"parent-devices-list",selector:'[data-tour="parent-devices-list"]',title:"Device Management",description:"View and manage all devices that can access your account. You can remove devices for security.",placement:"bottom"}],wM=[{id:"parent-upgrade-plans",selector:'[data-tour="parent-upgrade-plans"]',title:"Subscription Plans",description:"Choose a plan that fits your needs. Monthly or annual billing available.",placement:"bottom"}],xM=[{id:"parent-settings-account",selector:'[data-tour="parent-settings-account"]',title:"Account Settings",description:"Manage your account information, subscription, and children limit here.",placement:"bottom"},{id:"parent-settings-upgrade",selector:'[data-tour="parent-settings-upgrade"]',title:"Upgrade Subscription",description:"Tap here to upgrade your plan and add more children to your account.",placement:"bottom"}],bM=[{id:"child-home-parents",selector:'[data-tour="child-home-parents"]',description:"Tap here to see your parents and start a call. ",placement:"bottom"}],CM=[{id:"child-parents-list-card",selector:'[data-tour="child-parents-list-card"]',description:"Tap a parent's card to call them. ",placement:"bottom"}];function SM(e,t){if(t)switch(t){case"parent_home":return gM;case"parent_dashboard":return Kf;case"parent_children_list":return vM;case"parent_devices":return yM;case"parent_upgrade":return wM;case"parent_settings":return xM;case"child_home":return bM;case"child_dashboard":return Yf;case"child_parents_list":return CM;default:return e==="parent"?Kf:Yf}return e==="parent"?Kf:Yf}function EM(){if(typeof window<"u"&&window.Capacitor||typeof window<"u"&&window.cordova||typeof window<"u"&&window.ReactNativeWebView)return!0;const e=navigator.userAgent.toLowerCase();return!!(e.includes("capacitor")||e.includes("cordova")||e.includes("ionic"))}async function VS(){try{if(typeof window<"u"&&window.Capacitor?.Plugins?.MacAddress)try{const e=await window.Capacitor.Plugins.MacAddress.getMacAddress();if(e?.macAddress)return e.macAddress}catch{}if(typeof window<"u"&&window.Capacitor?.Plugins?.Network)try{const e=window.Capacitor.Plugins.Network;if(e.getMacAddress){const t=await e.getMacAddress();if(t)return t}}catch{}if(typeof window<"u"&&window.Capacitor?.Plugins?.DeviceInfo)try{const e=await window.Capacitor.Plugins.DeviceInfo.getMacAddress();if(e?.macAddress)return e.macAddress}catch{}if(typeof window<"u"&&window.device){const e=window.device;if(e.macAddress)return e.macAddress}typeof window<"u"&&window.ReactNativeWebView}catch(e){console.warn("Failed to get MAC address:",e)}return null}async function _M(){try{if(typeof window<"u"&&window.Capacitor?.Plugins?.Device){const e=await window.Capacitor.Plugins.Device.getInfo();if(e?.id)return`native-${e.id}`}if(typeof window<"u"&&window.device){const e=window.device;if(e?.uuid)return`cordova-${e.uuid}`}typeof window<"u"&&window.ReactNativeWebView}catch(e){console.warn("Failed to get native device ID:",e)}return null}function ii(){return HS()}async function NM(){return EM()?await VS():null}async function kM(){const e=await VS();if(e)return`mac-${e.replace(/:/g,"").toLowerCase()}`;const t=await _M();return t||HS()}function HS(){const e=document.createElement("canvas");e.getContext("2d")?.fillText("DeviceID",2,2);const n=e.toDataURL(),s=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,screen.colorDepth||"unknown",new Date().getTimezoneOffset(),navigator.platform,navigator.vendor||"unknown",n.substring(0,50),navigator.hardwareConcurrency||"unknown",navigator.deviceMemory||"unknown",navigator.maxTouchPoints||"0",window.devicePixelRatio||"1",navigator.cookieEnabled?"1":"0",navigator.doNotTrack||"unknown"].join("|");let i=0;for(let l=0;l<s.length;l++){const c=s.charCodeAt(l);i=(i<<5)-i+c,i=i&i}return`web-${Math.abs(i).toString(36).substring(0,16)}`}function WS(){const e=navigator.userAgent.toLowerCase();return/tablet|ipad|playbook|silk/i.test(e)?"tablet":/mobile|iphone|ipod|android|blackberry|opera|mini|windows\sce|palm|smartphone|iemobile/i.test(e)?"mobile":/desktop|windows|macintosh|linux/i.test(e)?"desktop":"other"}function jM(){const e=navigator.userAgent,t=WS();if(e.includes("iPad")){const n=e.match(/iPad(\d+,\d+)/i);return n?`iPad ${n[1]}`:"iPad"}if(e.includes("iPhone")){const n=e.match(/iPhone(\d+,\d+)/i);return n?`iPhone ${n[1]}`:"iPhone"}if(e.includes("Android")){const n=e.match(/Android.*?; ([^)]+)\)/);if(n){const s=n[1].trim();return s.startsWith("SM-")?`Samsung ${s.substring(3)}`:s.startsWith("LM-")?`LG ${s.substring(3)}`:s}return"Android Device"}if(e.includes("Macintosh")){const n=e.match(/Mac OS X ([\d_]+)/i);return n?`Mac (macOS ${n[1].replace(/_/g,".")})`:"Mac"}return e.includes("Windows")?e.includes("Windows NT 10.0")?"Windows PC (Windows 10/11)":e.includes("Windows NT 6.3")?"Windows PC (Windows 8.1)":e.includes("Windows NT 6.2")?"Windows PC (Windows 8)":e.includes("Windows NT 6.1")?"Windows PC (Windows 7)":"Windows PC":e.includes("Linux")?"Linux PC":t.charAt(0).toUpperCase()+t.slice(1)}async function TM(){try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip||null}catch{return null}}async function AM(e){if(!e)return null;try{const{getCountryFromIP:t}=await gr(async()=>{const{getCountryFromIP:s}=await Promise.resolve().then(()=>w$);return{getCountryFromIP:s}},void 0);return(await t(e)).countryCode||null}catch(t){return console.warn("Failed to get country from IP:",t),null}}const Oh=Object.freeze(Object.defineProperty({__proto__:null,detectDeviceType:WS,generateDeviceIdentifier:ii,generateDeviceIdentifierAsync:kM,getClientIP:TM,getCountryFromIP:AM,getDeviceMacAddress:NM,getDeviceName:jM},Symbol.toStringTag,{value:"Module"})),qS="kch_tour_";function GS(e,t){return`${qS}${e}_${t}_done`}function KS(e,t){return`${qS}${e}_${t}_device`}function RM(e,t){const n=GS(e,t);return localStorage.getItem(n)==="true"}function Tw(e,t){const n=GS(e,t);localStorage.setItem(n,"true");const s=KS(e,t),i=ii();localStorage.setItem(s,i)}function PM(e,t){const n=KS(e,t),s=localStorage.getItem(n);if(!s)return!0;const i=ii();return s!==i}function YS({role:e,pageKey:t}){const n=SM(e,t),[s,i]=p.useState(0),[l,c]=p.useState(!1);p.useEffect(()=>{!RM(e,t)&&PM(e,t)&&(c(!0),i(0))},[e,t]),p.useEffect(()=>{const x=E=>{E.detail.role===e&&E.detail.pageKey===t&&(c(!0),i(0))};return window.addEventListener("onboarding:restart",x),()=>{window.removeEventListener("onboarding:restart",x)}},[e,t]);const u=p.useCallback(()=>{c(!0),i(0)},[]),f=p.useCallback(()=>{s<n.length-1?i(s+1):v()},[s,n.length]),h=p.useCallback(()=>{s>0&&i(s-1)},[s]),g=p.useCallback(()=>{Tw(e,t),c(!1),i(0)},[e,t]),v=p.useCallback(()=>{Tw(e,t),c(!1),i(0)},[e,t]);return{activeStep:l&&s<n.length?n[s]:null,stepIndex:s,totalSteps:n.length,isRunning:l,start:u,next:f,back:h,skip:g,finish:v}}const JS="kch_tour_";function IM(e,t){return`${JS}${e}_${t}_done`}function Or({role:e,pageKey:t}){const{isRunning:n}=YS({role:e,pageKey:t}),s=()=>{const i=IM(e,t);localStorage.removeItem(i);const l=`${JS}${e}_${t}_device`;localStorage.removeItem(l),window.dispatchEvent(new CustomEvent("onboarding:restart",{detail:{role:e,pageKey:t}}))};return n?null:a.jsx(ce,{onClick:s,className:"fixed right-4 sm:right-6 h-12 w-12 rounded-full shadow-lg z-50 safe-area-bottom",style:{bottom:"calc(1rem + var(--safe-area-inset-bottom))"},size:"icon",variant:"default","aria-label":"Show help tour",title:"Show me around",children:a.jsx(mk,{className:"h-5 w-5"})})}function Lr({role:e,pageKey:t}){const{activeStep:n,stepIndex:s,totalSteps:i,isRunning:l,next:c,back:u,skip:f,finish:h}=YS({role:e,pageKey:t}),[g,v]=p.useState(null),[w,x]=p.useState(null),E=p.useRef(null);p.useEffect(()=>{if(!n||!l){x(null),v(null);return}const N=document.querySelector(n.selector);if(!N){console.warn(`Onboarding: Element not found for selector "${n.selector}"`),setTimeout(()=>{c()},100);return}x(N);const j=()=>{const R=N.getBoundingClientRect(),T=n.placement||"bottom",P=24,O=window.innerWidth,L=O<640?Math.min(O-32,320):320,F=140,I=16,U=window.innerHeight;let M=0,B=0;const V=R.top-8,ee=R.bottom+8,z=R.left-8,$=R.right+8;switch(T){case"top":M=V-F-P,B=R.left+R.width/2-L/2;break;case"bottom":M=ee+P,B=R.left+R.width/2-L/2;break;case"left":M=R.top+R.height/2-F/2,B=z-L-P;break;case"right":M=R.top+R.height/2-F/2,B=$+P;break}const W=B+L,D=M+F,Q=B,le=M,X=Q<$&&W>z,K=le<ee&&D>V;X&&K&&(T==="top"||T==="bottom"?$+P+L<O-I?(B=$+P,M=Math.max(I,Math.min(R.top+R.height/2-F/2,U-F-I))):z-P-L>I?(B=z-P-L,M=Math.max(I,Math.min(R.top+R.height/2-F/2,U-F-I))):T==="top"?(M=V-F-P*2,B=Math.max(I,Math.min(B,O-L-I))):(M=ee+P*2,B=Math.max(I,Math.min(B,O-L-I))):(T==="left"||T==="right")&&(ee+P+F<U-I?(M=ee+P,B=Math.max(I,Math.min(R.left+R.width/2-L/2,O-L-I))):V-P-F>I?(M=V-P-F,B=Math.max(I,Math.min(R.left+R.width/2-L/2,O-L-I))):T==="left"?(B=z-L-P*2,M=Math.max(I,Math.min(M,U-F-I))):(B=$+P*2,M=Math.max(I,Math.min(M,U-F-I))))),B<I&&(B=I),B+L>O-I&&(B=O-L-I),M<I&&(M=I),M+F>U-I&&(M=U-F-I);const q=B+L,se=M+F;B<$&&q>z&&M<ee&&se>V&&(M=V-F-P*2,B=Math.max(I,Math.min(R.left+R.width/2-L/2,O-L-I)),M<I&&(M=ee+P*2)),v({top:M,left:B,placement:T})};return j(),window.addEventListener("resize",j),window.addEventListener("scroll",j,!0),()=>{window.removeEventListener("resize",j),window.removeEventListener("scroll",j,!0)}},[n,l,c]);const[C,b]=p.useState(null);if(p.useEffect(()=>{if(!w){b(null);return}const N=()=>{const j=w.getBoundingClientRect();b(j)};return N(),window.addEventListener("resize",N),window.addEventListener("scroll",N,!0),()=>{window.removeEventListener("resize",N),window.removeEventListener("scroll",N,!0)}},[w]),p.useEffect(()=>{if(!w)return;const N=w.style.zIndex,j=w.style.position,R=w.style.outline,T=w.style.boxShadow;return w.style.zIndex="10002",getComputedStyle(w).position==="static"&&(w.style.position="relative"),w.style.outline="3px solid hsl(var(--primary))",w.style.outlineOffset="4px",w.style.borderRadius="8px",w.style.boxShadow="0 0 0 4px rgba(0, 0, 0, 0.1), 0 4px 12px rgba(0, 0, 0, 0.15)",w.style.pointerEvents="auto",()=>{w.style.zIndex=N,w.style.position=j,w.style.outline=R,w.style.outlineOffset="",w.style.borderRadius="",w.style.boxShadow=T}},[w]),!l||!n||!g)return null;const k=s===i-1,_=s===0;return a.jsxs(a.Fragment,{children:[C?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed z-[10000] bg-black/50",style:{top:0,left:0,right:0,height:`${Math.max(0,C.top-8)}px`},onClick:f,"aria-hidden":"true"}),a.jsx("div",{className:"fixed z-[10000] bg-black/50",style:{top:`${C.bottom+8}px`,left:0,right:0,bottom:0},onClick:f,"aria-hidden":"true"}),a.jsx("div",{className:"fixed z-[10000] bg-black/50",style:{top:`${Math.max(0,C.top-8)}px`,left:0,width:`${Math.max(0,C.left-8)}px`,height:`${C.height+16}px`},onClick:f,"aria-hidden":"true"}),a.jsx("div",{className:"fixed z-[10000] bg-black/50",style:{top:`${Math.max(0,C.top-8)}px`,left:`${C.right+8}px`,right:0,height:`${C.height+16}px`},onClick:f,"aria-hidden":"true"})]}):a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[10000]",onClick:f,"aria-hidden":"true"}),a.jsxs("div",{ref:E,className:"fixed z-[10003] bg-background border-2 border-primary rounded-lg shadow-xl p-4 max-w-[calc(100vw-2rem)] sm:max-w-[320px] mx-4 sm:mx-0 pointer-events-auto",style:{top:`${g.top}px`,left:`${g.left}px`},onClick:N=>N.stopPropagation(),children:[a.jsx("button",{onClick:f,className:"absolute top-2 right-2 text-muted-foreground hover:text-foreground transition-colors","aria-label":"Skip tour",children:a.jsx(Rr,{className:"h-4 w-4"})}),a.jsxs("div",{className:be("pr-6 sm:pr-8",e==="child"&&"text-base sm:text-lg"),children:[n.title&&e==="parent"&&a.jsx("h3",{className:"font-bold text-base sm:text-lg mb-2",children:n.title}),a.jsx("p",{className:be("text-sm sm:text-base text-muted-foreground",e==="child"&&"text-base sm:text-lg"),children:n.description})]}),a.jsxs("div",{className:"flex items-center justify-between mt-4 gap-2 flex-wrap",children:[a.jsx("div",{className:"flex items-center gap-2",children:!_&&a.jsxs(ce,{variant:"outline",size:"sm",onClick:u,className:"text-xs sm:text-sm",children:[a.jsx(Nx,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Back"})]})}),a.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[a.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:[s+1," / ",i]}),a.jsxs(ce,{onClick:k?h:c,size:"sm",className:"text-xs sm:text-sm",children:[k?"Got it!":"Next",!k&&a.jsx(Xh,{className:"h-4 w-4 ml-1"})]})]})]})]})]})}const Aw={sm:"h-2 w-2",md:"h-3 w-3",lg:"h-4 w-4"};function Wo({isOnline:e,className:t,size:n="md",showPulse:s=!1}){return a.jsxs("div",{className:be("relative inline-flex items-center justify-center",t),children:[a.jsx("div",{className:be("rounded-full border-2 border-background",Aw[n],e?"bg-green-500 dark:bg-green-400":"bg-gray-400 dark:bg-gray-500"),"aria-label":e?"Online":"Offline",title:e?"Online":"Offline"}),e&&s&&a.jsx("div",{className:be("absolute inset-0 rounded-full animate-ping","bg-green-500 dark:bg-green-400 opacity-75",Aw[n])})]})}function QS({childIds:e,enabled:t=!0,onStatusChange:n}){const[s,i]=p.useState({}),l=p.useRef(new Map),c=p.useRef(n);p.useEffect(()=>{c.current=n},[n]);const u=p.useMemo(()=>[...e].sort().join(","),[e]);p.useEffect(()=>{if(!t)return;const h={};e.forEach(g=>{h[g]={isOnline:!1,lastSeen:null}}),i(h)},[e,t]),p.useEffect(()=>{if(!t||e.length===0)return;const h=l.current;h.size>0&&(h.forEach(v=>{Y.removeChannel(v)}),h.clear());const g=new Map;return e.forEach(v=>{const w=`presence:child:${v}`,x=Y.channel(w,{config:{presence:{key:v}}});x.on("presence",{event:"sync"},()=>{const E=x.presenceState(),C=v in E&&Array.isArray(E[v])&&E[v].length>0,b=E[v],k=b&&b.length>0?b[0]:void 0,_=C?k?.lastSeen||new Date().toISOString():null;i(N=>{const j=N[v]?.isOnline||!1,R=N[v]?.lastSeen||null;if(j===C&&R===_)return N;const T={...N,[v]:{isOnline:C,lastSeen:_||R}};return j!==C&&c.current&&N[v]!==void 0&&c.current(v,C),T})}).on("presence",{event:"join"},({key:E,newPresences:C})=>{if(E!==v)return;const b=C[0];i(k=>{const _=k[v]?.isOnline||!1,N={...k,[v]:{isOnline:!0,lastSeen:b?.lastSeen||new Date().toISOString()}};return!_&&c.current&&c.current(v,!0),N})}).on("presence",{event:"leave"},({key:E,leftPresences:C})=>{E===v&&i(b=>{const k=b[v]?.isOnline||!1,_={...b,[v]:{isOnline:!1,lastSeen:b[v]?.lastSeen||new Date().toISOString()}};return k&&c.current&&c.current(v,!1),_})}).subscribe((E,C)=>{E==="SUBSCRIBED"?setTimeout(()=>{const b=x.presenceState();if(v in b&&Array.isArray(b[v])&&b[v].length>0){const _=b[v],N=_&&_.length>0?_[0]:void 0;i(j=>({...j,[v]:{isOnline:!0,lastSeen:N?.lastSeen||new Date().toISOString()}}))}},500):(E==="CHANNEL_ERROR"||E==="TIMED_OUT")&&console.error(" [CHILDREN PRESENCE] Subscription error",{childId:v,status:E,error:C})}),g.set(v,x)}),l.current=g,()=>{g.forEach(v=>{Y.removeChannel(v)}),g.clear(),l.current.clear()}},[u,t]);const f=p.useCallback(h=>s[h]||{isOnline:!1,lastSeen:null},[s]);return{presence:s,getChildStatus:f,isChildOnline:h=>s[h]?.isOnline||!1}}function DM(){if(typeof window<"u"&&window.Capacitor||typeof window<"u"&&window.cordova||typeof window<"u"&&window.ReactNativeWebView)return!0;if(typeof window<"u"){const e=navigator.userAgent.toLowerCase();if(e.includes("capacitor")||e.includes("cordova")||e.includes("ionic"))return!0}return!1}function ia(){return!DM()}const OM=({childId:e,onCall:t})=>{const n=SC(e);return a.jsxs(ce,{onClick:t,className:"flex-1 relative",variant:"secondary","data-tour":"parent-call-button",children:[a.jsx(em,{className:"mr-2 h-4 w-4"}),"Call",a.jsx("span",{className:`ml-2 bg-destructive text-destructive-foreground text-xs font-bold rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1 ${n===0?"invisible":""}`,children:n>99?"99+":n})]})},LM=({childId:e,onChat:t})=>{const n=Bm(e);return a.jsxs(ce,{onClick:t,className:"flex-1 relative bg-chat-accent text-chat-accent-foreground hover:bg-chat-accent/90",variant:"default","data-tour":"parent-messages",children:[a.jsx(Na,{className:"mr-2 h-4 w-4"}),"Chat",a.jsx("span",{className:`ml-2 bg-destructive text-destructive-foreground text-xs font-bold rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1 ${n===0?"invisible":""}`,children:n>99?"99+":n})]})},MM=()=>{const[e,t]=p.useState([]),[n,s]=p.useState(!0),[i,l]=p.useState(!1),[c,u]=p.useState(null),[f,h]=p.useState(null),[g,v]=p.useState(null),[w,x]=p.useState(null),[E,C]=p.useState(!0),[b,k]=p.useState(null),[_,N]=p.useState(null),[j,R]=p.useState(null),[T,P]=p.useState(!1),[O,G]=p.useState(null),L=p.useRef(null),F=p.useRef(null),I=p.useRef(!1),U=tt(),M=gn(),{toast:B}=Ct(),{handleIncomingCall:V,stopIncomingCall:ee}=Jm({enabled:!0,volume:.7}),z=p.useRef(V),$=p.useMemo(()=>e.map(ae=>ae.id),[e]),{isChildOnline:W}=QS({childIds:$,enabled:e.length>0}),D=bC(),Q=CC(),le=D>0||Q>0,X=p.useCallback(async()=>{const{data:{session:ae}}=await Y.auth.getSession();if(!ae){U("/parent/auth");return}const{data:ve,error:_e}=await Y.from("parents").select("name, family_code, allowed_children").eq("id",ae.user.id).maybeSingle();_e&&(_e.code==="42703"||_e.message?.includes("does not exist")?(console.error(" [PARENT DASHBOARD] Migration not run. Family code column doesn't exist."),console.error("Please run: supabase/migrations/20250121000000_add_family_code.sql")):console.error("Error fetching parent data:",_e)),ve&&(h(ve?.name||null),v(ve?.family_code||null),x(ve?.allowed_children||1));try{const{data:Ue}=await Y.rpc("can_add_child",{p_parent_id:ae.user.id});C(Ue===!0)}catch(Ue){console.warn("Subscription check function not available:",Ue),C(!0)}},[U]),K=p.useCallback(async()=>{try{const{data:{user:ae}}=await Y.auth.getUser();if(ae)try{const{data:Ue}=await Y.rpc("can_add_child",{p_parent_id:ae.id});C(Ue===!0)}catch(Ue){console.warn("Subscription check function not available:",Ue)}const{data:ve,error:_e}=await Y.from("children").select("*").order("created_at",{ascending:!1});if(_e)throw _e;t(ve||[])}catch(ae){const ve=ae instanceof Error?ae.message:"Unknown error occurred";B({title:"Error loading children",description:ve,variant:"destructive"})}finally{s(!1)}},[B]);p.useEffect(()=>{localStorage.getItem("childSession")&&(console.log(" [PARENT DASHBOARD] Clearing childSession for parent user"),localStorage.removeItem("childSession")),X(),K();let ve=null,_e=null;return(async()=>{const{data:{session:ft}}=await Y.auth.getSession();if(!ft?.user?.id)return;const Je=ft.user.id,wt=async He=>{if(He.id===ve||M.pathname.startsWith("/call/"))return;ve=He.id;const{data:$e}=await Y.from("children").select("name, avatar_color").eq("id",He.child_id).single();$e?(u({id:He.id,child_id:He.child_id,child_name:$e.name,child_avatar_color:$e.avatar_color}),z.current({callId:He.id,callerName:$e.name,callerId:He.child_id,url:`/call/${He.child_id}?callId=${He.id}`})):console.error("Failed to fetch child data for call")},at=async()=>{const He=new Date(Date.now()-12e4).toISOString(),{data:$e}=await Y.from("calls").select("*").eq("parent_id",Je).eq("caller_type","child").eq("status","ringing").gte("created_at",He).order("created_at",{ascending:!1}).limit(1);if($e&&$e.length>0){const Mt=$e[0];Mt.id!==ve&&await wt(Mt)}},ht=async()=>{const He=new Date(Date.now()-6e4).toISOString(),{data:$e,error:Mt}=await Y.from("calls").select("*").eq("parent_id",Je).eq("caller_type","child").eq("status","ringing").gte("created_at",He).order("created_at",{ascending:!1}).limit(1);if(Mt){console.error(" [PARENT DASHBOARD] Polling error:",Mt);return}if($e&&$e.length>0){const Tt=$e[0];Tt.id!==ve&&await wt(Tt)}};await at(),_e=setInterval(ht,6e4),F.current=Y.channel("parent-incoming-calls").on("postgres_changes",{event:"INSERT",schema:"public",table:"calls",filter:`parent_id=eq.${Je}`},async He=>{const $e=He.new;$e.caller_type==="child"&&$e.parent_id===Je&&$e.status==="ringing"&&await wt($e)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls",filter:`parent_id=eq.${Je}`},async He=>{const $e=He.new,Mt=He.old;$e.caller_type!=="parent"&&(M.pathname.startsWith("/call/")||(L.current&&L.current.id===$e.id&&($e.status==="active"||$e.status==="ended")&&(u(null),L.current=null),$e.caller_type==="child"&&$e.parent_id===Je&&$e.status==="ringing"&&Mt.status!=="ringing"&&await wt($e)))}).subscribe((He,$e)=>{$e&&console.error(" [PARENT DASHBOARD] Realtime subscription error:",$e)})})(),()=>{F.current&&Y.removeChannel(F.current),_e&&clearInterval(_e)}},[X,K,M.pathname]),p.useEffect(()=>{L.current=c},[c]),p.useEffect(()=>{z.current=V},[V]),p.useEffect(()=>{!c&&L.current&&ee(L.current.id)},[c,ee]);const te=ae=>{U(`/chat/${ae}`)},q=ae=>{navigator.clipboard.writeText(ae),B({title:"Copied!",description:"Login code copied to clipboard"})},se=ae=>{const ve=ae.login_code.split("-");return ve.length===3&&g?ae.login_code:ve.length===2&&g?`${g}-${ae.login_code}`:ae.login_code},fe=ae=>{const ve=se(ae),_e=encodeURIComponent(ve),Ue=`${window.location.origin}/child/login?code=${_e}`;navigator.clipboard.writeText(Ue),B({title:"Copied!",description:"Magic link copied to clipboard"})},ge=ae=>{G(ae)},we=()=>{O&&window.print()},Re=async ae=>{try{const{acknowledgeMissedCalls:ve}=await gr(async()=>{const{acknowledgeMissedCalls:_e}=await import("./acknowledgeMissedCalls-D4lifASh.js");return{acknowledgeMissedCalls:_e}},[]);await ve(ae,"child")}catch(ve){console.error("Error acknowledging missed calls:",ve)}U(`/call/${ae}`)},Be=p.useCallback(async()=>{if(le)try{const{acknowledgeMissedCalls:ae}=await gr(async()=>{const{acknowledgeMissedCalls:at}=await import("./acknowledgeMissedCalls-D4lifASh.js");return{acknowledgeMissedCalls:at}},[]),ve=Ze.getState();let _e=0,Ue=0;for(const at of $){if((ve.unreadMessagesByChild[at]??0)>0)try{const{data:$e,error:Mt}=await Y.from("messages").select("id").eq("child_id",at).eq("sender_type","child").is("read_at",null);if(!Mt&&$e&&$e.length>0){const Tt=$e.map(Mr=>Mr.id),yr=new Date().toISOString(),{error:_s}=await Y.from("messages").update({read_at:yr}).in("id",Tt);_s?console.error(`Error marking messages as read for child ${at}:`,_s):(_e+=Tt.length,console.log(` Marked ${Tt.length} messages as read for child ${at}`))}ve.clearUnreadForChild(at)}catch($e){console.error(`Error processing messages for child ${at}:`,$e),ve.clearUnreadForChild(at)}const He=ve.missedCallsByChild[at]??0;if(He>0){ve.clearMissedForChild(at),Ue+=He;try{await ae(at,"child")}catch($e){console.error(`Error acknowledging missed calls for child ${at}:`,$e)}}}const ft=_e>0?`${_e} unread message${_e!==1?"s":""}`:"",Je=Ue>0?`${Ue} missed call${Ue!==1?"s":""}`:"",wt=[ft,Je].filter(Boolean).join(" and ");B({title:"Notifications cleared",description:wt||"All notifications cleared."})}catch(ae){console.error("Error clearing notifications:",ae),B({title:"Error",description:"Failed to clear some notifications. Please try again.",variant:"destructive"})}},[le,$,B]),We=async()=>{if(_)try{const{error:ae}=await Y.from("children").delete().eq("id",_.id);if(ae)throw ae;B({title:"Child removed",description:`${_.name} has been removed.`}),N(null),K()}catch(ae){const ve=ae instanceof Error?ae.message:"Unknown error occurred";B({title:"Error removing child",description:ve,variant:"destructive"})}},Ge=async()=>{if(j){P(!0);try{const{data:ae,error:ve}=await Y.rpc("generate_unique_login_code");if(ve)throw ve;if(!ae)throw new Error("Failed to generate new code");const{error:_e}=await Y.from("children").update({login_code:ae}).eq("id",j.id);if(_e)throw _e;B({title:"Login code updated",description:`${j.name}'s new login code is: ${ae}`}),R(null),K()}catch(ae){const ve=ae instanceof Error?ae.message:"Unknown error occurred";B({title:"Error updating login code",description:ve,variant:"destructive"})}finally{P(!1)}}},ie=()=>{if(c){ee(c.id),I.current=!0;const ae=c.child_id,ve=c.id;u(null),U(`/call/${ae}?callId=${ve}`),setTimeout(()=>{I.current=!1},2e3)}},Pe=async()=>{if(c){if(I.current)return;try{await Xs({callId:c.id,by:"parent",reason:"declined"})}catch(ae){console.error(" [USER ACTION] Error declining call:",ae);const ve=ae instanceof Error?ae.message:"Unknown error";B({title:"Error",description:"Failed to decline call: "+ve,variant:"destructive"})}ee(c.id),u(null)}};return n?a.jsxs("div",{className:"min-h-[100dvh] bg-background w-full overflow-x-hidden",children:[a.jsx(Ot,{}),a.jsx("div",{className:"p-4",style:{paddingTop:"calc(1rem + 64px + var(--safe-area-inset-top) * 0.15)"},children:a.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[a.jsxs("div",{className:"mt-2",children:[a.jsx("div",{className:"h-9 w-48 bg-muted rounded animate-pulse mb-2"}),a.jsx("div",{className:"h-6 w-96 bg-muted rounded animate-pulse"})]}),a.jsx("div",{className:"h-12 w-full bg-muted rounded animate-pulse"}),a.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:[1,2].map(ae=>a.jsxs(Te,{className:"p-6 space-y-4 min-h-[220px]",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-muted animate-pulse"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"h-6 w-32 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-4 w-24 bg-muted rounded animate-pulse"})]})]})}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("div",{className:"h-10 flex-1 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-10 flex-1 bg-muted rounded animate-pulse"})]})]},ae))})]})})]}):a.jsxs("div",{className:"min-h-[100dvh] bg-background w-full overflow-x-hidden",children:[a.jsx(Ot,{}),a.jsx(Lr,{role:"parent",pageKey:"parent_dashboard"}),a.jsx(Or,{role:"parent",pageKey:"parent_dashboard"}),a.jsx("div",{className:"px-4 pb-4",style:{paddingTop:"calc(0.5rem + 64px + var(--safe-area-inset-top) * 0.15)"},children:a.jsx("div",{className:"max-w-4xl mx-auto",children:a.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Welcome back",f?`, ${f}`:"","!"]})})}),a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[a.jsxs("div",{className:"mt-2 flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold",children:"My Children"}),a.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage your children's profiles, login codes, and settings"})]}),ia()&&a.jsx(ce,{variant:"outline",onClick:()=>U("/parent/upgrade"),className:"flex-shrink-0","data-tour":"parent-upgrade-plan",children:"Upgrade Plan"})]}),g&&a.jsx(Te,{className:"bg-blue-50 dark:bg-blue-950 border-blue-200 dark:border-blue-800 p-4",children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-1",children:"Your Family Code"}),a.jsx("p",{className:"text-2xl font-mono font-bold text-blue-700 dark:text-blue-300",children:g}),a.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-1",children:"Share this code with your children for login"})]}),a.jsxs(ce,{onClick:()=>{navigator.clipboard.writeText(g),B({title:"Copied!",description:"Family code copied to clipboard"})},variant:"outline",size:"sm",className:"flex-shrink-0",children:[a.jsx(xf,{className:"h-4 w-4 mr-2"}),"Copy"]})]})}),!E&&a.jsx(Te,{className:"p-4 bg-yellow-50 dark:bg-yellow-950 border-yellow-200 dark:border-yellow-800 mb-4",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("p",{className:"text-sm text-yellow-900 dark:text-yellow-100",children:[a.jsx("strong",{children:"Subscription Limit Reached:"})," You have"," ",e.length," /"," ",w===999?"":w||1," ","children."]}),ia()?a.jsx(ce,{onClick:()=>U("/parent/upgrade"),variant:"default",size:"sm",className:"w-full sm:w-auto","data-tour":"parent-upgrade-limit",children:"Upgrade Your Plan"}):a.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"Please upgrade through your app store to add more children."})]})}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ce,{onClick:()=>l(!0),className:"flex-1",size:"lg",disabled:!E,children:[a.jsx(jk,{className:"mr-2 h-5 w-5"}),"Add Child"]}),le&&a.jsxs(ce,{onClick:Be,variant:"outline",size:"lg",className:"flex-shrink-0",title:`Clear all notifications (${D} messages, ${Q} missed calls)`,children:[a.jsx(fk,{className:"mr-2 h-5 w-5"}),"Clear All"]})]}),e.length===0?a.jsxs(Te,{className:"p-12 text-center min-h-[220px]",children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:"You haven't added any children yet."}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Click "Add Child" above to create a profile and login code.'})]}):a.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:e.map((ae,ve)=>a.jsxs(Te,{className:"p-6 space-y-4 min-h-[220px]",style:{borderLeft:`4px solid ${ae.avatar_color}`},children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2","data-tour":ve===0?"parent-child-name-status":void 0,children:[a.jsx("h3",{className:"text-2xl sm:text-3xl font-bold",children:ae.name}),a.jsx(Wo,{isOnline:W(ae.id),size:"md",showPulse:W(ae.id)})]}),a.jsxs("div",{className:"bg-muted p-3 rounded-lg relative","data-tour":ve===0?"parent-login-code":void 0,children:[a.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Login Code"}),a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("p",{className:"text-xl sm:text-2xl font-mono font-bold tracking-wider flex-1",children:se(ae)}),a.jsx(ce,{onClick:()=>R(ae),variant:"ghost",size:"icon",className:"h-8 w-8",title:"Generate new login code",children:a.jsx(Pk,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsxs(ce,{onClick:()=>q(se(ae)),variant:"outline",size:"sm",className:"flex-1","data-tour":ve===0?"parent-copy-code":void 0,children:[a.jsx(xf,{className:"mr-2 h-4 w-4"}),"Copy Code"]}),a.jsxs(ce,{onClick:()=>fe(ae),variant:"outline",size:"sm",className:"flex-1","data-tour":ve===0?"parent-copy-link":void 0,children:[a.jsx(kc,{className:"mr-2 h-4 w-4"}),"Copy Link"]}),a.jsxs(ce,{onClick:()=>ge(ae),variant:"outline",size:"sm",className:"flex-1","data-tour":ve===0?"parent-print-code":void 0,children:[a.jsx(Cf,{className:"mr-2 h-4 w-4"}),"Print"]}),a.jsxs(ce,{onClick:()=>k({child:ae}),variant:"outline",size:"sm",className:"flex-1","data-tour":ve===0?"parent-view-qr":void 0,children:[a.jsx(Tk,{className:"mr-2 h-4 w-4"}),"View QR"]})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(OM,{childId:ae.id,onCall:()=>Re(ae.id)}),a.jsx(LM,{childId:ae.id,onChat:()=>te(ae.id)}),a.jsx(ce,{onClick:()=>N(ae),variant:"destructive",size:"icon","data-tour":ve===0?"parent-delete-child":void 0,children:a.jsx(Zh,{className:"h-4 w-4"})})]})]},ae.id))})]}),a.jsx(SO,{open:i,onOpenChange:l,onChildAdded:K}),b&&a.jsx(Xn,{open:!!b,onOpenChange:ae=>!ae&&k(null),children:a.jsxs(_n,{className:"max-w-[calc(100vw-2rem)] sm:max-w-md",children:[a.jsxs("button",{onClick:()=>k(null),className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[a.jsx(Rr,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]}),a.jsxs(Nn,{children:[a.jsxs(jn,{className:"text-lg sm:text-xl",children:[b.child.name,"'s Login Code"]}),a.jsx(Tn,{className:"text-sm",children:"Share this code or QR code with your child to log in"})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"bg-muted p-3 sm:p-4 rounded-lg text-center",children:[a.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Login Code"}),a.jsx("p",{className:"text-2xl sm:text-3xl font-mono font-bold break-all",children:se(b.child)})]}),a.jsx("div",{className:"flex justify-center",children:a.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(`${window.location.origin}/child/login?code=${encodeURIComponent(se(b.child))}`)}`,alt:"QR Code",className:"border-2 border-muted rounded-lg w-[200px] h-[200px] sm:w-[250px] sm:h-[250px] object-contain"})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs(ce,{onClick:()=>q(se(b.child)),variant:"outline",className:"flex-1 w-full sm:w-auto",children:[a.jsx(xf,{className:"mr-2 h-4 w-4"}),"Copy Code"]}),a.jsxs(ce,{onClick:()=>fe(b.child),variant:"outline",className:"flex-1 w-full sm:w-auto",children:[a.jsx(kc,{className:"mr-2 h-4 w-4"}),"Copy Link"]}),a.jsxs(ce,{onClick:()=>ge(b.child),variant:"outline",className:"flex-1 w-full sm:w-auto",children:[a.jsx(Cf,{className:"mr-2 h-4 w-4"}),"Print"]})]})]}),a.jsx(kn,{children:a.jsx(An,{children:"Close"})})]})}),a.jsx(Xn,{open:!!j,onOpenChange:ae=>!ae&&R(null),children:a.jsxs(_n,{children:[a.jsxs("button",{onClick:()=>R(null),className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",disabled:T,children:[a.jsx(Rr,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]}),a.jsxs(Nn,{children:[a.jsx(jn,{children:"Generate New Login Code"}),a.jsxs(Tn,{children:["Are you sure you want to generate a new login code for"," ",j?.name,"? The current code (",j?.login_code,") will no longer work. Make sure to share the new code with your child."]})]}),a.jsxs(kn,{children:[a.jsx(An,{disabled:T,children:"Cancel"}),a.jsx(mr,{onClick:Ge,disabled:T,children:T?"Generating...":"Generate New Code"})]})]})}),a.jsx(Xn,{open:!!_,onOpenChange:ae=>!ae&&N(null),children:a.jsxs(_n,{children:[a.jsxs("button",{onClick:()=>N(null),className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[a.jsx(Rr,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]}),a.jsxs(Nn,{children:[a.jsx(jn,{children:"Remove Child"}),a.jsxs(Tn,{children:["Are you sure you want to remove ",_?.name,"? This action cannot be undone and will delete all associated data including messages and call history."]})]}),a.jsxs(kn,{children:[a.jsx(An,{children:"Cancel"}),a.jsx(mr,{onClick:We,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remove"})]})]})}),a.jsx(Xn,{open:!!c,onOpenChange:ae=>{!ae&&c&&!I.current&&Pe()},children:a.jsxs(_n,{className:"sm:max-w-md",children:[a.jsxs(Nn,{children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-2xl font-bold text-white",style:{backgroundColor:c?.child_avatar_color||"#3B82F6"},children:c?.child_name[0]}),a.jsxs("div",{children:[a.jsx(jn,{className:"text-xl",children:"Incoming Call"}),a.jsxs("p",{className:"text-base font-normal text-muted-foreground",children:[c?.child_name," is calling..."]})]})]}),a.jsxs("div",{className:"pt-4",children:[a.jsxs(Tn,{className:"sr-only",children:["Incoming call from ",c?.child_name]}),a.jsx("div",{className:"flex items-center justify-center gap-2 text-4xl animate-pulse",children:a.jsx(ka,{className:"h-12 w-12"})})]})]}),a.jsxs(kn,{className:"sm:justify-center gap-2",children:[a.jsx(An,{onClick:Pe,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Decline"}),a.jsx(mr,{onClick:ie,className:"bg-green-600 hover:bg-green-700",children:"Answer"})]})]})}),O&&a.jsx(Xn,{open:!!O,onOpenChange:ae=>!ae&&G(null),children:a.jsxs(_n,{className:"max-w-[calc(100vw-2rem)] sm:max-w-md print:hidden",children:[a.jsxs("button",{onClick:()=>G(null),className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none print:hidden",children:[a.jsx(Rr,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]}),a.jsxs(Nn,{children:[a.jsxs(jn,{className:"text-lg sm:text-xl",children:[O.name,"'s Login Code"]}),a.jsx(Tn,{className:"text-sm",children:"Print or share this code with your child"})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"bg-muted p-3 sm:p-4 rounded-lg text-center print:border-2 print:border-gray-800",children:[a.jsx("p",{className:"text-xs text-muted-foreground mb-2 print:text-gray-600",children:"Login Code"}),a.jsx("p",{className:"text-2xl sm:text-3xl font-mono font-bold break-all print:text-3xl",children:se(O)})]}),a.jsx("div",{className:"flex justify-center print:my-4",children:a.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(`${window.location.origin}/child/login?code=${encodeURIComponent(se(O))}`)}`,alt:"QR Code",className:"border-2 border-muted rounded-lg w-[250px] h-[250px] sm:w-[300px] sm:h-[300px] object-contain print:border-gray-800"})}),a.jsxs("div",{className:"instructions print:mt-4 print:text-sm print:text-gray-600",children:[a.jsx("p",{children:"Scan the QR code or use the code above to log in"}),a.jsxs("p",{children:["Visit: ",window.location.origin,"/child/login"]})]})]}),a.jsxs(kn,{className:"print:hidden",children:[a.jsxs(ce,{onClick:we,variant:"default",className:"flex-1",children:[a.jsx(Cf,{className:"mr-2 h-4 w-4"}),"Print"]}),a.jsx(An,{children:"Close"})]})]})})]})]})},$M=()=>{const e=tt();return Ct(),p.useEffect(()=>{(async()=>{const{data:{session:n}}=await Y.auth.getSession();n||e("/parent/auth")})()},[e]),a.jsxs("div",{className:"min-h-[100dvh] bg-background",children:[a.jsx(Ot,{}),a.jsx(Lr,{role:"parent",pageKey:"parent_home"}),a.jsx(Or,{role:"parent",pageKey:"parent_home"}),a.jsx("div",{className:"p-4",style:{paddingTop:"calc(1rem + 64px + var(--safe-area-inset-top) * 0.15)"},children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"mb-8 mt-8",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Parent Home"}),a.jsx("p",{className:"text-muted-foreground mt-2",children:"Quick access to your children and calls"})]}),a.jsx(Te,{className:"p-6",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Quick Actions"}),a.jsxs(ce,{className:"w-full",size:"lg",onClick:()=>e("/parent/children"),"data-tour":"parent-home-view-children",children:[a.jsx(la,{className:"mr-2 h-5 w-5"}),"View Children"]}),a.jsx(ce,{className:"w-full",size:"lg",variant:"outline",onClick:()=>e("/parent/dashboard"),"data-tour":"parent-home-dashboard",children:"Go to Dashboard"})]})})]})})]})},FM=({child:e,onCall:t,onChat:n,isOnline:s,"data-tour":i})=>{const l=Bm(e.id);return a.jsx(Te,{className:"p-6","data-tour":i,children:a.jsxs("div",{className:"flex items-start justify-between flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[a.jsx("div",{className:"aspect-square w-12 rounded-full flex items-center justify-center text-white font-bold text-lg leading-none select-none flex-shrink-0",style:{backgroundColor:e.avatar_color||"#6366f1"},children:a.jsx("span",{className:"leading-none",children:e.name.charAt(0).toUpperCase()})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"text-xl font-semibold",children:e.name}),a.jsx(Wo,{isOnline:s,size:"md",showPulse:s})]}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Code: ",e.login_code]})]})]}),a.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[a.jsxs(ce,{onClick:()=>t(e.id),variant:"secondary",className:"flex-1 sm:flex-none relative","data-tour":i?"parent-children-list-call":void 0,children:[a.jsx(ka,{className:"mr-2 h-4 w-4"}),"Call"]}),a.jsxs(ce,{onClick:()=>n(e.id),className:"flex-1 sm:flex-none relative bg-chat-accent text-chat-accent-foreground hover:bg-chat-accent/90","data-tour":i?"parent-children-list-message":void 0,children:[a.jsx(Na,{className:"mr-2 h-4 w-4"}),"Message",a.jsx("span",{className:`ml-2 bg-destructive text-destructive-foreground text-xs font-bold rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1 ${l===0?"invisible":""}`,children:l>99?"99+":l})]})]})]})})},UM=()=>{const[e,t]=p.useState([]),[n,s]=p.useState(!0),i=tt(),{toast:l}=Ct(),c=p.useMemo(()=>e.map(v=>v.id),[e]),{isChildOnline:u}=QS({childIds:c,enabled:e.length>0});p.useEffect(()=>{(async()=>{const{data:{session:w}}=await Y.auth.getSession();if(!w){i("/parent/auth");return}f()})()},[i]);const f=async()=>{try{const{data:v,error:w}=await Y.from("children").select("*").order("created_at",{ascending:!1});if(w)throw w;t(v||[])}catch(v){const w=v instanceof Error?v.message:"Unknown error occurred";l({title:"Error loading children",description:w,variant:"destructive"})}finally{s(!1)}},h=v=>{i(`/call/${v}`)},g=v=>{i(`/chat/${v}`)};return n?a.jsxs("div",{className:"min-h-[100dvh] bg-background",children:[a.jsx(Ot,{}),a.jsx("div",{className:"p-4",style:{paddingTop:"calc(1rem + 64px + var(--safe-area-inset-top) * 0.15)"},children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"mb-8 mt-8",children:[a.jsx("div",{className:"h-9 w-48 bg-muted rounded animate-pulse mb-2"}),a.jsx("div",{className:"h-6 w-64 bg-muted rounded animate-pulse"})]}),a.jsx("div",{className:"grid gap-4",children:[1,2,3].map(v=>a.jsx(Te,{className:"p-6",children:a.jsxs("div",{className:"flex items-start justify-between flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-muted animate-pulse flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[a.jsx("div",{className:"h-6 w-32 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-4 w-24 bg-muted rounded animate-pulse"})]})]}),a.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[a.jsx("div",{className:"h-10 w-20 bg-muted rounded animate-pulse flex-1 sm:flex-none"}),a.jsx("div",{className:"h-10 w-24 bg-muted rounded animate-pulse flex-1 sm:flex-none"})]})]})},v))})]})})]}):a.jsxs("div",{className:"min-h-[100dvh] bg-background",children:[a.jsx(Ot,{}),a.jsx(Lr,{role:"parent",pageKey:"parent_children_list"}),a.jsx(Or,{role:"parent",pageKey:"parent_children_list"}),a.jsx("div",{className:"p-4",style:{paddingTop:"calc(1rem + 64px + var(--safe-area-inset-top) * 0.15)"},children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"mb-8 mt-8",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Your Children"}),a.jsx("p",{className:"text-muted-foreground mt-2",children:"View and call your children"})]}),e.length===0?a.jsx(Te,{className:"p-6",children:a.jsx("p",{className:"text-muted-foreground",children:"No children added yet."})}):a.jsx("div",{className:"grid gap-4",children:e.map((v,w)=>a.jsx(FM,{child:v,onCall:h,onChat:g,isOnline:u(v.id),"data-tour":w===0?"parent-children-list-card":void 0},v.id))})]})})]})},BM=({isMuted:e,isVideoOff:t,onToggleMute:n,onToggleVideo:s,onEndCall:i})=>a.jsxs("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 flex gap-4",children:[a.jsx(ce,{onClick:n,size:"lg",variant:e?"destructive":"secondary",className:"rounded-full w-16 h-16",children:e?a.jsx(Sk,{className:"h-6 w-6"}):a.jsx(Ek,{className:"h-6 w-6"})}),a.jsx(ce,{onClick:s,size:"lg",variant:t?"destructive":"secondary",className:"rounded-full w-16 h-16",children:t?a.jsx(Ok,{className:"h-6 w-6"}):a.jsx(em,{className:"h-6 w-6"})}),a.jsx(ce,{onClick:i,size:"lg",variant:"destructive",className:"rounded-full w-16 h-16",children:a.jsx(kk,{className:"h-6 w-6"})})]}),Qm=({localVideoRef:e,remoteVideoRef:t,remoteStream:n,isConnecting:s,isMuted:i,isVideoOff:l,onToggleMute:c,onToggleVideo:u,onEndCall:f,peerConnection:h})=>{const[g,v]=p.useState("waiting"),w=p.useRef(!1);p.useEffect(()=>{if(!n||!t.current){v("waiting");return}const b=t.current;b.srcObject!==n&&(console.log(" [VIDEO UI] Setting remote stream to video element"),b.srcObject=n);const k={current:g},_=V=>{k.current=V,v(V)};_("loading");const N=async()=>{if(b.paused)try{console.log(" [VIDEO UI] Attempting to play video"),await b.play(),console.log(" [VIDEO UI] Video started playing"),w.current=!0,_("playing")}catch(V){if(console.log(" [VIDEO UI] Play error:",V.name),V.name==="NotAllowedError"){b.muted=!0;try{await b.play(),console.log(" [VIDEO UI] Playing muted - click to unmute"),_("playing")}catch(ee){console.error(" [VIDEO UI] Even muted play failed:",ee),_("error")}}else V.name==="NotSupportedError"&&(console.error(" [VIDEO UI] Media format not supported"),_("error"))}},j=()=>{console.log(" [VIDEO UI] Video metadata loaded"),_("loading"),N()},R=()=>{console.log(" [VIDEO UI] Video data loaded"),N()},T=()=>{console.log(" [VIDEO UI] Video can play"),N()},P=()=>{console.log(" [VIDEO UI] Video 'playing' event fired"),_("playing"),w.current=!0},O=()=>{console.log(" [VIDEO UI] Video can play through"),b.paused||_("playing")},G=()=>{console.log(" [VIDEO UI] Video 'waiting' event - buffering"),b.paused&&k.current!=="error"&&_("loading")},L=()=>{console.log(" [VIDEO UI] Video paused")},F=V=>{const ee=V.target;console.error(" [VIDEO UI] Video error:",ee.error),_("error")};b.addEventListener("loadedmetadata",j),b.addEventListener("loadeddata",R),b.addEventListener("canplay",T),b.addEventListener("canplaythrough",O),b.addEventListener("playing",P),b.addEventListener("waiting",G),b.addEventListener("pause",L),b.addEventListener("error",F);const I=n.getTracks(),U=new Map,M=()=>{const V=I.some(z=>!z.muted&&z.readyState==="live"),ee=!b.paused;return V&&ee?(console.log(" [VIDEO UI] Tracks unmuted and video playing - marking as playing"),_("playing"),!0):!1};I.forEach(V=>{const ee=()=>{console.log(" [VIDEO UI] Track unmuted:",V.kind,"- ICE connected, media flowing"),b.paused?N():setTimeout(()=>{M()},100)},z=()=>{console.log(" [VIDEO UI] Track muted:",V.kind),I.every(D=>D.muted)&&k.current==="playing"&&(console.log(" [VIDEO UI] All tracks muted, setting to loading"),_("loading"))},$=()=>{console.log(" [VIDEO UI] Track ended:",V.kind)};V.addEventListener("unmute",ee),V.addEventListener("mute",z),V.addEventListener("ended",$),U.set(V,{handleUnmute:ee,handleMute:z,handleEnded:$})});const B=setInterval(()=>{b.paused||I.some(ee=>!ee.muted&&ee.readyState==="live")&&k.current==="loading"&&(console.log(" [VIDEO UI] Video playing with unmuted tracks - updating state"),_("playing"))},500);return N(),()=>{clearInterval(B),b.removeEventListener("loadedmetadata",j),b.removeEventListener("loadeddata",R),b.removeEventListener("canplay",T),b.removeEventListener("canplaythrough",O),b.removeEventListener("playing",P),b.removeEventListener("waiting",G),b.removeEventListener("pause",L),b.removeEventListener("error",F),U.forEach((V,ee)=>{ee.removeEventListener("unmute",V.handleUnmute),ee.removeEventListener("mute",V.handleMute),ee.removeEventListener("ended",V.handleEnded)})}},[n,t]);const x=()=>{if(!t.current||!t.current.srcObject)return;const b=t.current;console.log(" [VIDEO UI] User clicked video area",{paused:b.paused,muted:b.muted,readyState:b.readyState}),b.muted&&(b.muted=!1,console.log(" [VIDEO UI] Video unmuted by user click")),b.paused&&b.play().then(()=>{console.log(" [VIDEO UI] Video started playing after click"),v("playing")}).catch(k=>{console.error(" [VIDEO UI] Click play failed:",k),b.muted=!0,b.play().catch(_=>console.error("Muted play also failed:",_))})},C=n?g==="error"?"Video error - click to retry":g==="loading"?"Connecting to other side...":t.current?.paused&&g!=="playing"?"Click to start video":t.current?.muted?"Video is muted - click to unmute":null:s?"Connecting...":"Waiting for other person...";return a.jsx("div",{className:"fixed inset-0 bg-black",onClick:x,children:a.jsxs("div",{className:"relative h-full w-full",children:[a.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!1,volume:1,className:"w-full h-full object-cover",style:{backgroundColor:"#000"}}),C&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/80 cursor-pointer",onClick:x,children:a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx("div",{className:"text-6xl",children:g==="error"?"":g==="loading"?"":""}),a.jsx("p",{className:"text-white text-2xl",children:C}),n&&a.jsx("p",{className:"text-white text-sm opacity-75",children:g==="loading"?"Establishing connection...":g==="error"?"Check your connection":"Tap anywhere to interact"})]})}),!1,a.jsx("div",{className:"absolute top-4 right-4 w-48 h-36 rounded-2xl overflow-hidden shadow-xl border-2 border-white",children:a.jsx("video",{ref:e,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"})}),a.jsx(BM,{isMuted:i,isVideoOff:l,onToggleMute:c,onToggleVideo:u,onEndCall:f})]})})},XS=(e,t,n,s=!1)=>{const[i,l]=p.useState(null),[c,u]=p.useState(null),[f,h]=p.useState(!0),[g,v]=p.useState(!1),w=p.useRef(null),x=p.useRef(null),E=p.useRef([]),C=p.useRef(null),b=p.useRef(new Set),k=p.useRef(e);p.useEffect(()=>{k.current=e,e&&console.log(" [CALL ID] CallId updated in useWebRTC:",e)},[e]);const _=p.useCallback(async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){const L=/iPad|iPhone|iPod/.test(navigator.userAgent),F=window.location.protocol==="https:",I=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname.startsWith("192.168.")||window.location.hostname.startsWith("10.")||window.location.hostname.startsWith("172.");let U="Camera and microphone access is not available.";throw L&&!F&&!I?U+=`

On iOS Safari, camera/microphone requires HTTPS when accessing via network IP. Options:
1. Use a tunneling service like ngrok (provides HTTPS)
2. Set up local HTTPS certificates
3. Test on the same device using localhost`:L&&!F?U+=`

Note: On iOS, getUserMedia may not work over HTTP on network IPs. Consider using ngrok or testing on the same device.`:L?U+=" On iOS, please use Safari and grant camera/microphone permissions in Settings.":U+=" Please use HTTPS or a modern browser that supports WebRTC.",new Error(U)}let R;try{console.log(" [MEDIA] Requesting camera and microphone access..."),R=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720},facingMode:"user"},audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}}),console.log(" [MEDIA] Media stream obtained:",{audioTracks:R.getAudioTracks().map(F=>({id:F.id,enabled:F.enabled,muted:F.muted,readyState:F.readyState,settings:F.getSettings()})),videoTracks:R.getVideoTracks().map(F=>({id:F.id,enabled:F.enabled,muted:F.muted,readyState:F.readyState,settings:F.getSettings()}))}),console.log("[KCH]",s?"child":"parent","media tracks",{audio:R.getAudioTracks().length,video:R.getVideoTracks().length}),R.getAudioTracks().forEach(F=>{F.muted&&console.warn(" [MEDIA] Local audio track is muted")}),R.getVideoTracks().forEach(F=>{F.muted&&console.warn(" [MEDIA] Local video track is muted")})}catch(L){const F=L;if(console.error(" [MEDIA] Media device access error:",{name:F.name,message:F.message,code:F.code}),F.name==="NotReadableError"||F.name==="NotAllowedError"){console.warn(" [MEDIA] Media device access denied or in use, trying audio-only fallback...");try{R=await navigator.mediaDevices.getUserMedia({video:!1,audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}}),console.log(" [MEDIA] Fell back to audio-only stream")}catch(I){const U=I;throw console.error(" [MEDIA] Audio-only fallback also failed:",{name:U.name,message:U.message}),new Error(`Unable to access camera/microphone: ${F.message}. This may happen if the device is in use by another application or browser tab. On iOS, make sure you've granted camera and microphone permissions in Settings. Error details: ${F.name} - ${F.message}`)}}else throw new Error(`Media access error: ${F.name} - ${F.message}. Please check your camera and microphone permissions.`)}l(R),x.current=R,t.current&&(t.current.srcObject=R,t.current.play().catch(L=>{console.error("Error playing local video:",L)}));const T=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443",username:"openrelayproject",credential:"openrelayproject"}],iceCandidatePoolSize:10});T.onconnectionstatechange=()=>{const L=T.connectionState,F=T.iceConnectionState,I=T.signalingState;if(console.log("[KCH]",s?"child":"parent","connectionState",L),console.log(" [CONNECTION STATE] Peer connection state changed:",{connectionState:L,iceConnectionState:F,signalingState:I,timestamp:new Date().toISOString()}),L==="connected"){if(console.log(" [CONNECTION STATE] Peer connection is now connected!"),console.log(" [CONNECTION STATE] Connection details:",{connectionState:L,iceConnectionState:F,signalingState:I,localDescription:!!T.localDescription,remoteDescription:!!T.remoteDescription,remoteStream:!!C.current}),C.current){const M=C.current.getAudioTracks(),B=C.current.getVideoTracks();console.log(" [CONNECTION STATE] Remote stream tracks when connected:",{audioTracks:M.map(V=>({id:V.id,enabled:V.enabled,muted:V.muted,readyState:V.readyState})),videoTracks:B.map(V=>({id:V.id,enabled:V.enabled,muted:V.muted,readyState:V.readyState}))}),M.forEach(V=>{V.muted&&console.error(" [CONNECTION STATE] Audio track is muted when connected!")}),B.forEach(V=>{V.muted&&V.readyState==="live"&&console.warn(" [CONNECTION STATE] Video track is muted when connected (user may have muted it)",{trackId:V.id,readyState:V.readyState,enabled:V.enabled})})}}else if(L==="failed"||L==="closed"||L==="disconnected"){console.error(" [CONNECTION STATE] Connection problem detected:",{connectionState:L,iceConnectionState:F,signalingState:I,reason:"Connection state changed to problematic state",timestamp:new Date().toISOString()});const M=k.current;M&&(L==="failed"||L==="closed")&&Xs({callId:M,by:s?"child":"parent",reason:L}).catch(()=>{})}};let P=Date.now();const O=3e4;T.oniceconnectionstatechange=()=>{const L=T.iceConnectionState,F=Date.now()-P;if(console.log("[KCH]",s?"child":"parent","iceConnectionState",L),console.log(" [ICE STATE] ICE connection state changed:",{iceConnectionState:L,connectionState:T.connectionState,signalingState:T.signalingState,hasLocalDescription:!!T.localDescription,hasRemoteDescription:!!T.remoteDescription,iceGatheringState:T.iceGatheringState,timeInStateMs:F,timestamp:new Date().toISOString()}),P=Date.now(),L==="connected"||L==="completed"){if(console.log(" [ICE STATE] ICE connection established - media should flow now!"),v(!0),h(!1),C.current&&n.current){const U=C.current,M=n.current;M.srcObject!==U&&(console.log(" [ICE STATE] Setting remote stream to video element"),M.srcObject=U);const B=U.getAudioTracks(),V=U.getVideoTracks();console.log(" [ICE STATE] Tracks after ICE connected:",{audioTracks:B.length,videoTracks:V.length,audioMuted:B.filter($=>$.muted).length,videoMuted:V.filter($=>$.muted).length,videoReadyState:M.readyState,videoPaused:M.paused}),B.forEach($=>{$.enabled=!0,$.muted&&console.warn(" [ICE STATE] Audio track is muted after ICE connected")}),V.forEach($=>{$.enabled=!0,$.muted&&console.warn(" [ICE STATE] Video track is muted after ICE connected")});const ee=()=>{M&&M.srcObject&&M.paused&&(console.log(" [ICE STATE] Attempting to play video after ICE connection"),M.play().then(()=>{console.log(" [ICE STATE] Video started playing after ICE connected")}).catch($=>{console.warn(" [ICE STATE] Play failed, will retry:",$.name),setTimeout(()=>{M&&M.srcObject&&M.paused&&M.play().catch(W=>{W.name!=="AbortError"&&console.error(" [ICE STATE] Retry play failed:",W)})},200)}))};ee();const z=()=>{M.paused&&ee()};M.addEventListener("canplay",z,{once:!0}),M.addEventListener("loadeddata",z,{once:!0}),M.addEventListener("canplaythrough",z,{once:!0}),setTimeout(()=>{const $=U.getAudioTracks().filter(D=>D.muted).length,W=U.getVideoTracks().filter(D=>D.muted).length;($>0||W>0)&&console.error(" [ICE STATE] CRITICAL: Tracks still muted after ICE connected!",{mutedAudio:$,mutedVideo:W,totalAudio:B.length,totalVideo:V.length}),M.paused&&ee()},1e3)}}else if(L==="failed"||L==="disconnected"||L==="closed"){console.error(" [ICE STATE] ICE connection problem:",{iceConnectionState:L,connectionState:T.connectionState,reason:"ICE connection failed or disconnected",timestamp:new Date().toISOString()}),v(!1),h(!1);const U=k.current;U&&(L==="failed"||L==="closed")&&Xs({callId:U,by:s?"child":"parent",reason:L}).catch(()=>{})}else L==="checking"?(v(!1),h(!0),console.log(" [ICE STATE] ICE connection checking - waiting for connection (this is normal)..."),setTimeout(()=>{if(T.iceConnectionState==="checking"&&T.signalingState!=="closed"){console.warn(" [ICE STATE] ICE stuck in 'checking' state for 30+ seconds - this may indicate:",{issue:"ICE candidates may not be exchanging properly or connection is failing",hasLocalDescription:!!T.localDescription,hasRemoteDescription:!!T.remoteDescription,iceGatheringState:T.iceGatheringState,connectionState:T.connectionState,suggestion:"Check that ICE candidates are being sent/received via database and that both peers have remote descriptions set"});const U=T.getSenders(),M=T.getReceivers();console.warn(" [ICE STATE] Current peer connection state:",{senders:U.length,receivers:M.length,localDescription:T.localDescription?{type:T.localDescription.type,sdp:T.localDescription.sdp.substring(0,100)+"..."}:null,remoteDescription:T.remoteDescription?{type:T.remoteDescription.type,sdp:T.remoteDescription.sdp.substring(0,100)+"..."}:null})}},O)):L==="new"&&(console.log(" [ICE STATE] ICE connection new - connection starting (this is normal)..."),v(!1),h(!0),setTimeout(()=>{T.iceConnectionState==="new"&&T.signalingState!=="closed"&&console.warn(" [ICE STATE] ICE stuck in 'new' state for 30+ seconds - this may indicate:",{issue:"ICE candidates may not be exchanging properly",hasLocalDescription:!!T.localDescription,hasRemoteDescription:!!T.remoteDescription,iceGatheringState:T.iceGatheringState,suggestion:"Check that ICE candidates are being sent/received via database"})},O))},T.onicegatheringstatechange=()=>{console.log(" [ICE GATHERING] ICE gathering state:",{iceGatheringState:T.iceGatheringState,timestamp:new Date().toISOString()})},T.onsignalingstatechange=()=>{console.log("Signaling state changed to:",T.signalingState),T.signalingState==="closed"&&console.error("Signaling state is closed!")},w.current=T,b.current.clear(),C.current=null,R.getTracks().forEach(L=>{T.addTrack(L,R)}),T.ontrack=L=>{if(console.log(" [REMOTE TRACK] Received remote track:",{kind:L.track.kind,id:L.track.id,enabled:L.track.enabled,readyState:L.track.readyState,muted:L.track.muted,streams:L.streams.length,connectionState:T.connectionState,iceConnectionState:T.iceConnectionState,timestamp:new Date().toISOString()}),L.track.onmute=()=>{console.warn(" [REMOTE TRACK] Track muted:",{kind:L.track.kind,id:L.track.id,reason:"Track is muted - no data being received",iceConnectionState:T.iceConnectionState,connectionState:T.connectionState})},L.track.onunmute=()=>{if(console.log(" [REMOTE TRACK] Track unmuted - MEDIA IS FLOWING!",{kind:L.track.kind,id:L.track.id,reason:"Track is receiving data - media should be visible/audible now",iceConnectionState:T.iceConnectionState,connectionState:T.connectionState}),L.track.kind==="video"&&n.current){const I=n.current;I.srcObject?(console.log(" [REMOTE TRACK] Video track unmuted - ensuring video plays",{readyState:I.readyState,paused:I.paused,muted:I.muted}),I.paused?I.play().then(()=>{console.log(" [REMOTE TRACK] Video started playing after track unmute")}).catch(U=>{U.name!=="AbortError"&&(console.error(" [REMOTE TRACK] Error playing video after track unmute:",U),setTimeout(()=>{I&&I.srcObject&&I.paused&&I.play().catch(M=>{M.name!=="AbortError"&&console.error(" [REMOTE TRACK] Retry play failed:",M)})},200))}):console.log(" [REMOTE TRACK] Video is already playing")):(console.warn(" [REMOTE TRACK] Video track unmuted but video element has no srcObject - setting it now"),n.current&&C.current&&(n.current.srcObject=C.current,setTimeout(()=>{n.current&&n.current.paused&&n.current.play().catch(U=>{U.name!=="AbortError"&&console.error(" [REMOTE TRACK] Error playing after setting srcObject:",U)})},100)))}},L.track.onended=()=>{console.log(" [REMOTE TRACK] Track ended (expected when call ends):",{kind:L.track.kind,id:L.track.id,reason:"Track has ended - this is normal when call is terminated"})},b.current.has(L.track.id)){console.log("Track already processed, skipping:",L.track.id);return}b.current.add(L.track.id),L.track.enabled=!0;let F=C.current;if(L.streams.length>0){const[I]=L.streams;!F||F.id!==I.id?(F=I,C.current=F):F.getTracks().find(M=>M.id===L.track.id)||(F.addTrack(L.track),console.log("Added track to existing stream:",L.track.kind))}else F?F.getTracks().find(U=>U.id===L.track.id)||(F.addTrack(L.track),console.log("Added track to existing stream:",L.track.kind)):(F=new MediaStream([L.track]),C.current=F,console.log("Created new stream for track:",L.track.kind));if(F){if(F.getAudioTracks().forEach(I=>{I.enabled=!0,I.muted&&T.iceConnectionState==="connected"&&console.warn(" [REMOTE TRACK] Audio track is muted even though ICE is connected - this may indicate no data"),console.log(" [REMOTE TRACK] Enabled remote audio track:",{id:I.id,enabled:I.enabled,muted:I.muted,readyState:I.readyState,iceConnectionState:T.iceConnectionState})}),F.getVideoTracks().forEach(I=>{I.enabled=!0,I.muted&&T.iceConnectionState==="connected"&&console.warn(" [REMOTE TRACK] Video track is muted even though ICE is connected - this may indicate no data"),console.log(" [REMOTE TRACK] Enabled remote video track:",{id:I.id,enabled:I.enabled,muted:I.muted,readyState:I.readyState,iceConnectionState:T.iceConnectionState})}),T.iceConnectionState==="connected"||T.iceConnectionState==="completed"){const I=F.getAudioTracks().filter(M=>M.muted).length,U=F.getVideoTracks().filter(M=>M.muted).length;(I>0||U>0)&&console.error(" [REMOTE TRACK] CRITICAL: Tracks are muted even though ICE is connected!",{mutedAudioTracks:I,mutedVideoTracks:U,totalAudioTracks:F.getAudioTracks().length,totalVideoTracks:F.getVideoTracks().length,iceConnectionState:T.iceConnectionState,connectionState:T.connectionState,signalingState:T.signalingState})}if(console.log("Remote stream updated:",{id:F.id,audioTracks:F.getAudioTracks().length,videoTracks:F.getVideoTracks().length}),u(F),n.current){const I=n.current;I.srcObject!==F?(I.srcObject=F,console.log(" [REMOTE STREAM] Remote stream srcObject set",{streamId:F.id,audioTracks:F.getAudioTracks().length,videoTracks:F.getVideoTracks().length,iceConnectionState:T.iceConnectionState,connectionState:T.connectionState})):console.log(" [REMOTE STREAM] Stream already set, ensuring playback",{streamId:F.id,audioTracks:F.getAudioTracks().length,videoTracks:F.getVideoTracks().length});const M=()=>{if(!I||!I.srcObject){console.warn(" [REMOTE STREAM] Video or srcObject not ready for play");return}console.log(" [REMOTE STREAM] Attempting to play video with tracks",{readyState:I.readyState,paused:I.paused,muted:I.muted,audioTracks:F.getAudioTracks().length,videoTracks:F.getVideoTracks().length,audioMuted:F.getAudioTracks().some(B=>B.muted),videoMuted:F.getVideoTracks().some(B=>B.muted),iceConnectionState:T.iceConnectionState}),I.paused?I.play().then(()=>{console.log(" [REMOTE STREAM] Video started playing"),setTimeout(()=>{const B=F.getAudioTracks().filter(ee=>ee.muted).length,V=F.getVideoTracks().filter(ee=>ee.muted).length;(B>0||V>0)&&console.warn(" [REMOTE STREAM] Some tracks still muted after play - they should unmute when media flows",{audioMuted:B,videoMuted:V,iceConnectionState:T.iceConnectionState})},1e3)}).catch(B=>{console.log(" [REMOTE STREAM] Play failed, will retry:",B.name),setTimeout(()=>{I&&I.srcObject&&I.paused&&I.play().catch(V=>{V.name!=="AbortError"&&console.log(" [REMOTE STREAM] Retry play failed:",V.name)})},200)}):console.log(" [REMOTE STREAM] Video is already playing")};requestAnimationFrame(()=>{M()}),setTimeout(()=>{I&&I.srcObject&&I.paused&&M()},100)}else console.warn(" [REMOTE STREAM] remoteVideoRef.current is null - video element not ready")}};const G=new Set;T.onicecandidate=async L=>{const F=k.current;if(!F){console.warn(" [ICE CANDIDATE] No callId available yet, candidate will be queued");return}try{if(L.candidate===null){console.log(" [ICE CANDIDATE] ICE gathering complete (null candidate received)"),console.log(" [ICE CANDIDATE] Total candidates processed:",G.size);return}if(L.candidate){const I=L.candidate.toJSON(),U=`${I.candidate}-${I.sdpMLineIndex}-${I.sdpMid}`;if(G.has(U))return;G.add(U);const M=G.size,B=s?"child":"parent";M===1&&console.log(" [ICE CANDIDATE] ICE gathering started:",{role:B,callId:F,isChild:s,timestamp:new Date().toISOString()});const V=s?"child_ice_candidates":"parent_ice_candidates";M===1&&console.log(" [ICE CANDIDATE] Role verification:",{isChild:s,role:B,candidateField:V,expectedField:s?"child_ice_candidates":"parent_ice_candidates",matches:V===(s?"child_ice_candidates":"parent_ice_candidates")});const{data:ee,error:z}=await Y.from("calls").select(V).eq("id",F).maybeSingle();if(z){console.error(` [ICE CANDIDATE] Error reading ${V}:`,z);return}if(ee){const $=ee[V]||[];if(!$.some(D=>D.candidate===I.candidate&&D.sdpMLineIndex===I.sdpMLineIndex&&D.sdpMid===I.sdpMid)){const D=[...$,I],{error:Q}=await Y.from("calls").update({[V]:D}).eq("id",F);if(Q)console.error(` [ICE CANDIDATE] Error updating ${V}:`,Q),(Q.message?.includes("column")||Q.code==="PGRST204")&&console.error(` [ICE CANDIDATE] Database column ${V} may not exist. Run fix_ice_candidates_schema.sql migration!`);else{const le=D.length;(le<=3||le%20===0)&&console.log(` [ICE CANDIDATE] Candidate #${le} sent to ${V}`)}}}else console.warn(` [ICE CANDIDATE] Call ${F} not found in database`)}}catch(I){console.error(" [ICE CANDIDATE] Error handling ICE candidate:",I)}}}catch(R){throw console.error("Error initializing WebRTC connection:",R),R}},[e,t,n,s]),N=p.useCallback((R=!1)=>{const T=w.current,P=T?.iceConnectionState,O=T?.connectionState;if(console.log(" [CLEANUP] Cleaning up WebRTC resources...",{timestamp:new Date().toISOString(),connectionState:O,iceConnectionState:P,signalingState:T?.signalingState,hasLocalStream:!!x.current,hasRemoteStream:!!C.current,force:R}),R)console.log(" [CLEANUP] Force cleanup requested (explicit hangup) - cleaning up regardless of ICE state");else{const L=T?Date.now()-T._iceStateStartTime||Date.now():0,F=P==="new"&&L<5e3;if(P==="new"&&F||P==="checking"){console.warn(" [CLEANUP] Skipping cleanup - ICE connection still establishing (state:",P,")"),console.warn(" [CLEANUP] Use force=true to cleanup during explicit hangup");return}P==="new"&&!F&&console.warn(" [CLEANUP] ICE stuck in 'new' for 5+ seconds - allowing cleanup (connection likely failed)")}const G=x.current;G&&(G.getTracks().forEach(L=>{L.stop(),console.log("Stopped track:",L.kind)}),x.current=null,l(null)),t.current?.srcObject&&(t.current.srcObject.getTracks().forEach(F=>{F.stop(),console.log("Stopped track from video element:",F.kind)}),t.current.srcObject=null),n.current?.srcObject&&(n.current.srcObject=null),T&&(T.signalingState!=="closed"&&(console.log("Closing peer connection, current state:",T.signalingState),T.close()),w.current=null),u(null),C.current=null,b.current.clear()},[t,n]),j=p.useCallback(()=>{const R=n.current;if(!R){console.log("Video element not ready yet");return}const T=C.current||c;if(!T){console.log("Remote stream not available yet");return}console.log("playRemoteVideo called",{hasVideo:!!R,hasStream:!!T,currentSrcObject:!!R.srcObject,paused:R.paused,readyState:R.readyState,audioTracks:T.getAudioTracks().length,videoTracks:T.getVideoTracks().length}),R.srcObject!==T&&(console.log("Setting remote video srcObject"),R.srcObject=T);const P=()=>{if(console.log(" [VIDEO PLAY] Attempting to play video:",{hasSrcObject:!!R.srcObject,readyState:R.readyState,paused:R.paused,muted:R.muted,timestamp:new Date().toISOString()}),!R.srcObject){console.log(" [VIDEO PLAY] Video srcObject not set, retrying..."),setTimeout(P,50);return}const O=R.srcObject,G=O&&(O.getAudioTracks().some(L=>!L.muted&&L.readyState==="live")||O.getVideoTracks().some(L=>!L.muted&&L.readyState==="live"));if(R.readyState<2&&!G){console.log(" [VIDEO PLAY] Waiting for video readyState >= 2 or unmuted tracks (current:",R.readyState,")");const L=()=>{const F=O&&(O.getAudioTracks().some(I=>!I.muted&&I.readyState==="live")||O.getVideoTracks().some(I=>!I.muted&&I.readyState==="live"));(R.readyState>=2||F)&&(console.log(" [VIDEO PLAY] Video ready, readyState:",R.readyState,"- attempting play"),R.paused&&R.play().catch(I=>{console.error(" [VIDEO PLAY] Play failed after ready:",I)}))};if(R.addEventListener("loadeddata",L,{once:!0}),R.addEventListener("canplay",L,{once:!0}),R.addEventListener("canplaythrough",L,{once:!0}),O){const F=()=>{(O.getAudioTracks().some(U=>!U.muted&&U.readyState==="live")||O.getVideoTracks().some(U=>!U.muted&&U.readyState==="live"))&&R.paused&&(console.log(" [VIDEO PLAY] Tracks unmuted, attempting play"),R.play().catch(U=>{console.error(" [VIDEO PLAY] Play failed after track unmute:",U)}))};O.getTracks().forEach(I=>{I.addEventListener("unmute",F,{once:!0})})}return}if(G&&R.readyState<2&&console.log(" [VIDEO PLAY] Tracks are unmuted, attempting play despite low readyState:",R.readyState),R.paused){console.log(" [VIDEO PLAY] Video ready (readyState:",R.readyState,"), attempting play");const L=R.play();L!==void 0&&L.then(()=>{console.log(" [VIDEO PLAY] Remote video playing successfully!"),console.log(" [VIDEO PLAY] Video state:",{paused:R.paused,muted:R.muted,volume:R.volume,readyState:R.readyState})}).catch(F=>{F.name==="NotAllowedError"?console.error(" [VIDEO PLAY] Autoplay not allowed - need user interaction"):F.name!=="AbortError"?(console.log(" [VIDEO PLAY] Play failed, retrying after delay:",F.name),setTimeout(()=>{R.readyState>=2&&R.paused&&R.play().catch(I=>{console.error(" [VIDEO PLAY] Retry play failed:",I)})},100)):console.log(" [VIDEO PLAY] Play was interrupted (likely by another play call) - this is OK")})}else console.log(" [VIDEO PLAY] Remote video is already playing")};requestAnimationFrame(()=>{P()})},[c]);return p.useEffect(()=>{if(c&&n.current){n.current.srcObject!==c&&(n.current.srcObject=c,console.log(" [REMOTE STREAM] Remote stream srcObject updated in useEffect"),requestAnimationFrame(()=>{n.current&&n.current.srcObject===c&&n.current.play().then(()=>{console.log(" [REMOTE STREAM] Video started playing in useEffect")}).catch(T=>{console.log(" [REMOTE STREAM] Play failed in useEffect (will retry):",T.name)})}));const R=setInterval(()=>{const T=n.current;if(!T||!T.srcObject)return;const P=T.srcObject,O=P.getAudioTracks(),G=P.getVideoTracks(),L=w.current,F=O.some(ee=>ee.muted),I=G.some(ee=>ee.muted),U=T.paused,M=L?.iceConnectionState,B=L?.connectionState;(M==="failed"||M==="disconnected"||M==="closed"||B==="failed"||B==="disconnected"||B==="closed")&&console.warn(" [MONITOR] Connection issue detected:",{iceConnectionState:M,connectionState:B,videoPaused:U,hasMutedAudio:F&&M==="connected",hasMutedVideo:I&&M==="connected"}),U&&M==="connected"&&T.play().catch(()=>{})},5e3);return console.log(" [REMOTE STREAM] Remote stream in useEffect:",{id:c.id,audioTracks:c.getAudioTracks().map(T=>({id:T.id,enabled:T.enabled,muted:T.muted,readyState:T.readyState})),videoTracks:c.getVideoTracks().map(T=>({id:T.id,enabled:T.enabled,muted:T.muted,readyState:T.readyState}))}),()=>{clearInterval(R)}}},[c]),{peerConnection:w.current,localStream:i,remoteStream:c,isConnecting:f,setIsConnecting:h,isConnected:g,initializeConnection:_,cleanup:N,iceCandidatesQueue:E,peerConnectionRef:w,playRemoteVideo:j}},ZS=({role:e,localProfileId:t,remoteProfileId:n,localVideoRef:s,remoteVideoRef:i})=>{const[l,c]=p.useState("idle"),[u,f]=p.useState(null),[h,g]=p.useState(!1),[v,w]=p.useState(!1),x=tt(),{toast:E}=Ct(),C=p.useRef(null),b=p.useRef(null),k=p.useRef(!1),{localStream:_,remoteStream:N,setIsConnecting:j,initializeConnection:R,cleanup:T,iceCandidatesQueue:P,peerConnectionRef:O}=XS(u,s,i,e==="child");p.useEffect(()=>{!k.current&&l==="idle"&&(k.current=!0,R().catch(B=>{console.error("Failed to initialize WebRTC:",B),E({title:"Connection Error",description:"Failed to initialize video connection",variant:"destructive"})}))},[l,R,E]),p.useEffect(()=>{l==="incoming"&&!_&&(console.log(" [CALL ENGINE] Pre-warming local media for incoming call"),R().catch(B=>{console.error("Failed to pre-warm media:",B)}))},[l,_,R]),p.useEffect(()=>{if(l!=="idle"||!t)return;const B=Y.channel(`incoming-calls:${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"calls",filter:e==="parent"?`parent_id=eq.${t}`:`child_id=eq.${t}`},async V=>{const ee=V.new;ee.status==="ringing"&&ee.caller_type!==e&&ee.offer&&(console.log(" [CALL ENGINE] Incoming call detected:",ee.id),f(ee.id),c("incoming"))}).subscribe();return()=>{Y.removeChannel(B)}},[l,t,e]),p.useEffect(()=>{if(!u)return;const B=Y.channel(`call-status:${u}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls",filter:`id=eq.${u}`},async V=>{const ee=V.new,z=V.old,$=O.current;if(l==="calling"&&ee.answer&&ee.status==="in_call"&&(console.log(" [CALL ENGINE] Answer received, setting remote description"),$&&$.remoteDescription===null)){const W=ee.answer;await $.setRemoteDescription(new RTCSessionDescription(W));for(const D of P.current)try{await $.addIceCandidate(new RTCIceCandidate(D))}catch(Q){const le=Q;!le.message?.includes("duplicate")&&!le.message?.includes("already")&&console.error("Error adding queued ICE candidate:",le.message)}P.current=[]}if((l==="calling"||l==="incoming"||l==="connecting")&&(ee.status==="rejected"||ee.status==="missed")&&(console.log(" [CALL ENGINE] Call rejected or missed"),c("ended"),T()),Yt(ee)&&z&&!Yt(z)&&(console.log(" [CALL ENGINE] Call ended by remote party"),c("ended"),T(),E({title:"Call Ended",description:"The other person ended the call"})),ee.status==="in_call"&&(l==="calling"||l==="incoming"||l==="connecting")&&$){const W=()=>{const D=$.iceConnectionState,Q=$.connectionState;(D==="connected"||D==="completed")&&Q==="connected"&&N&&(console.log(" [CALL ENGINE] Connection established, transitioning to in_call"),c("in_call"),j(!1))};return W(),$.addEventListener("iceconnectionstatechange",W),$.addEventListener("connectionstatechange",W),()=>{$.removeEventListener("iceconnectionstatechange",W),$.removeEventListener("connectionstatechange",W)}}}).subscribe();return C.current=B,()=>{C.current&&(Y.removeChannel(C.current),C.current=null)}},[u,l,N,j,T,E]),p.useEffect(()=>{const B=O.current;if(!B||l!=="calling")return;const V=()=>{const ee=B.iceConnectionState,z=B.connectionState;(ee==="connected"||ee==="completed")&&z==="connected"&&N&&l==="calling"&&(console.log(" [CALL ENGINE] WebRTC connected, transitioning to in_call"),c("in_call"),j(!1))};return B.addEventListener("iceconnectionstatechange",V),B.addEventListener("connectionstatechange",V),()=>{B.removeEventListener("iceconnectionstatechange",V),B.removeEventListener("connectionstatechange",V)}},[l,N,j,O]),p.useEffect(()=>{if(l==="ended"){const B=setTimeout(()=>{x(e==="parent"?"/parent":"/child")},2e3);return()=>clearTimeout(B)}},[l,x,e]);const G=p.useCallback(async B=>{if(l!=="idle"){console.warn("Cannot start call: not in idle state");return}try{c("calling"),j(!0);const V=O.current;if(!V)throw new Error("Peer connection not initialized");const ee=await V.createOffer();await V.setLocalDescription(ee);const z=e,$={[e==="parent"?"parent_id":"child_id"]:t,[e==="parent"?"child_id":"parent_id"]:B,caller_type:z,status:"ringing",offer:{type:ee.type,sdp:ee.sdp}},{data:W,error:D}=await Y.from("calls").insert($).select().single();if(D)throw D;if(!W)throw new Error("Failed to create call");f(W.id),console.log(" [CALL ENGINE] Outgoing call created:",W.id),V.onicecandidate=async le=>{if(le.candidate&&W.id){const X=e==="parent"?"parent_ice_candidates":"child_ice_candidates",{data:K}=await Y.from("calls").select(X).eq("id",W.id).single(),q=[...K?.[X]||[],le.candidate.toJSON()];await Y.from("calls").update({[X]:q}).eq("id",W.id)}};const Q=Y.channel(`call-answer:${W.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls",filter:`id=eq.${W.id}`},async le=>{const X=le.new,K=O.current;if(X.answer&&X.status==="in_call"){if(!K)return;const te=X.answer;await K.setRemoteDescription(new RTCSessionDescription(te));const q=e==="parent"?"child_ice_candidates":"parent_ice_candidates",{data:se}=await Y.from("calls").select(q).eq("id",W.id).single(),fe=se?.[q]||[];if(K)for(const ge of fe)try{await K.addIceCandidate(new RTCIceCandidate(ge))}catch(we){const Re=we;!Re.message?.includes("duplicate")&&!Re.message?.includes("already")&&console.error("Error adding remote ICE candidate:",Re.message)}}}).subscribe();C.current=Q}catch(V){console.error("Error starting outgoing call:",V),E({title:"Call Failed",description:V instanceof Error?V.message:"Failed to start call",variant:"destructive"}),c("idle"),j(!1)}},[l,t,e,j,E]),L=p.useCallback(async B=>{if(l!=="incoming"){console.warn("Cannot accept call: not in incoming state");return}try{c("connecting"),j(!0);const V=O.current;if(!V)throw new Error("Peer connection not initialized");_||(console.log(" [CALL ENGINE] Local stream not ready, initializing now..."),await R());const{data:ee,error:z}=await Y.from("calls").select("*").eq("id",B).single();if(z||!ee)throw new Error("Call not found");if(!ee.offer)throw new Error("Call offer not found");const $=ee.offer;await V.setRemoteDescription(new RTCSessionDescription($));const W=await V.createAnswer();await V.setLocalDescription(W);const{error:D}=await Y.from("calls").update({answer:{type:W.type,sdp:W.sdp},status:"in_call"}).eq("id",B);if(D)throw D;f(B),console.log(" [CALL ENGINE] Call accepted:",B),V&&(V.onicecandidate=async X=>{if(X.candidate&&B){const K=e==="parent"?"parent_ice_candidates":"child_ice_candidates",{data:te}=await Y.from("calls").select(K).eq("id",B).single(),se=[...te?.[K]||[],X.candidate.toJSON()];await Y.from("calls").update({[K]:se}).eq("id",B)}});const le=ee[e==="parent"?"child_ice_candidates":"parent_ice_candidates"]||[];for(const X of le)try{await V.addIceCandidate(new RTCIceCandidate(X))}catch(K){const te=K;!te.message?.includes("duplicate")&&!te.message?.includes("already")&&console.error("Error adding remote ICE candidate:",te.message)}}catch(V){console.error("Error accepting call:",V),E({title:"Call Failed",description:V instanceof Error?V.message:"Failed to accept call",variant:"destructive"}),c("idle"),j(!1)}},[l,_,R,e,j,E,O]),F=p.useCallback(async B=>{if(l!=="incoming"){console.warn("Cannot reject call: not in incoming state");return}try{await Y.from("calls").update({status:"rejected"}).eq("id",B),c("ended"),console.log(" [CALL ENGINE] Call rejected:",B)}catch(V){console.error("Error rejecting call:",V),E({title:"Error",description:"Failed to reject call",variant:"destructive"})}},[l,E]),I=p.useCallback(async()=>{if(u)try{await Xs({callId:u,by:e,reason:"hangup"}),c("ended"),T(),C.current&&(Y.removeChannel(C.current),C.current=null),b.current&&(Y.removeChannel(b.current),b.current=null),console.log(" [CALL ENGINE] Call ended:",u)}catch(B){console.error("Error ending call:",B),E({title:"Error",description:"Failed to end call",variant:"destructive"})}},[u,e,T,E]),U=p.useCallback(()=>{if(_){const B=!h;_.getAudioTracks().forEach(V=>{V.enabled=!B}),g(B)}},[_,h]),M=p.useCallback(()=>{if(_){const B=!v;_.getVideoTracks().forEach(V=>{V.enabled=!B}),w(B)}},[_,v]);return{state:l,callId:u,localStream:_,remoteStream:N,isMuted:h,isVideoOff:v,startOutgoingCall:G,acceptIncomingCall:L,rejectIncomingCall:F,endCall:I,toggleMute:U,toggleVideo:M}},zM=()=>{const{childId:e}=cd(),t=tt(),{toast:n}=Ct(),[s,i]=p.useState(null),[l,c]=p.useState(""),u=p.useRef(null),f=p.useRef(null);p.useEffect(()=>{(async()=>{const{data:{user:v}}=await Y.auth.getUser();if(!v){t("/parent/auth");return}if(i(v.id),e){const{data:w}=await Y.from("children").select("name").eq("id",e).single();w&&c(w.name)}})()},[e,t]);const h=ZS({role:"parent",localProfileId:s||"",remoteProfileId:e||"",localVideoRef:u,remoteVideoRef:f});return p.useEffect(()=>{h.state==="idle"&&s&&e&&h.startOutgoingCall(e).catch(g=>{console.error("Failed to start call:",g),n({title:"Call Failed",description:"Failed to start call",variant:"destructive"})})},[h.state,s,e,h]),p.useEffect(()=>{h.state},[h.state]),!s||!e?a.jsx("div",{className:"min-h-[100dvh] bg-background flex items-center justify-center",children:a.jsx("div",{children:"Loading..."})}):h.state==="calling"?a.jsx("div",{className:"min-h-[100dvh] bg-background flex items-center justify-center",children:a.jsx(Te,{className:"p-8",children:a.jsxs("div",{className:"text-center space-y-4",children:[a.jsxs("h2",{className:"text-2xl font-semibold",children:["Calling ",l,"..."]}),a.jsx("p",{className:"text-muted-foreground",children:"Waiting for answer"})]})})}):h.state==="incoming"?a.jsx("div",{className:"min-h-[100dvh] bg-background flex items-center justify-center",children:a.jsx(Te,{className:"p-8",children:a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx("h2",{className:"text-2xl font-semibold",children:"Incoming Call"}),a.jsxs("div",{className:"flex gap-4 justify-center",children:[a.jsx(ce,{onClick:()=>h.callId&&h.acceptIncomingCall(h.callId),children:"Accept"}),a.jsx(ce,{variant:"destructive",onClick:()=>h.callId&&h.rejectIncomingCall(h.callId),children:"Reject"})]})]})})}):a.jsx(Qm,{localVideoRef:u,remoteVideoRef:f,remoteStream:h.remoteStream,isConnecting:h.state==="calling"||h.state==="connecting",isMuted:h.isMuted,isVideoOff:h.isVideoOff,onToggleMute:h.toggleMute,onToggleVideo:h.toggleVideo,onEndCall:h.endCall})};var _d="Tabs",[VM]=Pn(_d,[bd]),eE=bd(),[HM,Xm]=VM(_d),tE=p.forwardRef((e,t)=>{const{__scopeTabs:n,value:s,onValueChange:i,defaultValue:l,orientation:c="horizontal",dir:u,activationMode:f="automatic",...h}=e,g=xd(u),[v,w]=gs({prop:s,onChange:i,defaultProp:l??"",caller:_d});return a.jsx(HM,{scope:n,baseId:ur(),value:v,onValueChange:w,orientation:c,dir:g,activationMode:f,children:a.jsx(Oe.div,{dir:g,"data-orientation":c,...h,ref:t})})});tE.displayName=_d;var nE="TabsList",rE=p.forwardRef((e,t)=>{const{__scopeTabs:n,loop:s=!0,...i}=e,l=Xm(nE,n),c=eE(n);return a.jsx(TC,{asChild:!0,...c,orientation:l.orientation,dir:l.dir,loop:s,children:a.jsx(Oe.div,{role:"tablist","aria-orientation":l.orientation,...i,ref:t})})});rE.displayName=nE;var sE="TabsTrigger",oE=p.forwardRef((e,t)=>{const{__scopeTabs:n,value:s,disabled:i=!1,...l}=e,c=Xm(sE,n),u=eE(n),f=lE(c.baseId,s),h=cE(c.baseId,s),g=s===c.value;return a.jsx(AC,{asChild:!0,...u,focusable:!i,active:g,children:a.jsx(Oe.button,{type:"button",role:"tab","aria-selected":g,"aria-controls":h,"data-state":g?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:f,...l,ref:t,onMouseDown:ye(e.onMouseDown,v=>{!i&&v.button===0&&v.ctrlKey===!1?c.onValueChange(s):v.preventDefault()}),onKeyDown:ye(e.onKeyDown,v=>{[" ","Enter"].includes(v.key)&&c.onValueChange(s)}),onFocus:ye(e.onFocus,()=>{const v=c.activationMode!=="manual";!g&&!i&&v&&c.onValueChange(s)})})})});oE.displayName=sE;var iE="TabsContent",aE=p.forwardRef((e,t)=>{const{__scopeTabs:n,value:s,forceMount:i,children:l,...c}=e,u=Xm(iE,n),f=lE(u.baseId,s),h=cE(u.baseId,s),g=s===u.value,v=p.useRef(g);return p.useEffect(()=>{const w=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(w)},[]),a.jsx(In,{present:i||g,children:({present:w})=>a.jsx(Oe.div,{"data-state":g?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":f,hidden:!w,id:h,tabIndex:0,...c,ref:t,style:{...e.style,animationDuration:v.current?"0s":void 0},children:w&&l})})});aE.displayName=iE;function lE(e,t){return`${e}-trigger-${t}`}function cE(e,t){return`${e}-content-${t}`}var WM=tE,dE=rE,uE=oE,fE=aE;const qM=WM,hE=p.forwardRef(({className:e,...t},n)=>a.jsx(dE,{ref:n,className:be("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));hE.displayName=dE.displayName;const Lh=p.forwardRef(({className:e,...t},n)=>a.jsx(uE,{ref:n,className:be("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",e),...t}));Lh.displayName=uE.displayName;const Mh=p.forwardRef(({className:e,...t},n)=>a.jsx(fE,{ref:n,className:be("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));Mh.displayName=fE.displayName;function Rw(e,[t,n]){return Math.min(n,Math.max(t,e))}var GM=[" ","Enter","ArrowUp","ArrowDown"],KM=[" ","Enter"],Zs="Select",[Nd,kd,YM]=Yc(Zs),[ai]=Pn(Zs,[YM,ri]),jd=ri(),[JM,Ss]=ai(Zs),[QM,XM]=ai(Zs),mE=e=>{const{__scopeSelect:t,children:n,open:s,defaultOpen:i,onOpenChange:l,value:c,defaultValue:u,onValueChange:f,dir:h,name:g,autoComplete:v,disabled:w,required:x,form:E}=e,C=jd(t),[b,k]=p.useState(null),[_,N]=p.useState(null),[j,R]=p.useState(!1),T=xd(h),[P,O]=gs({prop:s,defaultProp:i??!1,onChange:l,caller:Zs}),[G,L]=gs({prop:c,defaultProp:u,onChange:f,caller:Zs}),F=p.useRef(null),I=b?E||!!b.closest("form"):!0,[U,M]=p.useState(new Set),B=Array.from(U).map(V=>V.props.value).join(";");return a.jsx(a0,{...C,children:a.jsxs(JM,{required:x,scope:t,trigger:b,onTriggerChange:k,valueNode:_,onValueNodeChange:N,valueNodeHasChildren:j,onValueNodeHasChildrenChange:R,contentId:ur(),value:G,onValueChange:L,open:P,onOpenChange:O,dir:T,triggerPointerDownPosRef:F,disabled:w,children:[a.jsx(Nd.Provider,{scope:t,children:a.jsx(QM,{scope:e.__scopeSelect,onNativeOptionAdd:p.useCallback(V=>{M(ee=>new Set(ee).add(V))},[]),onNativeOptionRemove:p.useCallback(V=>{M(ee=>{const z=new Set(ee);return z.delete(V),z})},[]),children:n})}),I?a.jsxs($E,{"aria-hidden":!0,required:x,tabIndex:-1,name:g,autoComplete:v,value:G,onChange:V=>L(V.target.value),disabled:w,form:E,children:[G===void 0?a.jsx("option",{value:""}):null,Array.from(U)]},B):null]})})};mE.displayName=Zs;var pE="SelectTrigger",gE=p.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:s=!1,...i}=e,l=jd(n),c=Ss(pE,n),u=c.disabled||s,f=qe(t,c.onTriggerChange),h=kd(n),g=p.useRef("touch"),[v,w,x]=UE(C=>{const b=h().filter(N=>!N.disabled),k=b.find(N=>N.value===c.value),_=BE(b,C,k);_!==void 0&&c.onValueChange(_.value)}),E=C=>{u||(c.onOpenChange(!0),x()),C&&(c.triggerPointerDownPosRef.current={x:Math.round(C.pageX),y:Math.round(C.pageY)})};return a.jsx(um,{asChild:!0,...l,children:a.jsx(Oe.button,{type:"button",role:"combobox","aria-controls":c.contentId,"aria-expanded":c.open,"aria-required":c.required,"aria-autocomplete":"none",dir:c.dir,"data-state":c.open?"open":"closed",disabled:u,"data-disabled":u?"":void 0,"data-placeholder":FE(c.value)?"":void 0,...i,ref:f,onClick:ye(i.onClick,C=>{C.currentTarget.focus(),g.current!=="mouse"&&E(C)}),onPointerDown:ye(i.onPointerDown,C=>{g.current=C.pointerType;const b=C.target;b.hasPointerCapture(C.pointerId)&&b.releasePointerCapture(C.pointerId),C.button===0&&C.ctrlKey===!1&&C.pointerType==="mouse"&&(E(C),C.preventDefault())}),onKeyDown:ye(i.onKeyDown,C=>{const b=v.current!=="";!(C.ctrlKey||C.altKey||C.metaKey)&&C.key.length===1&&w(C.key),!(b&&C.key===" ")&&GM.includes(C.key)&&(E(),C.preventDefault())})})})});gE.displayName=pE;var vE="SelectValue",yE=p.forwardRef((e,t)=>{const{__scopeSelect:n,className:s,style:i,children:l,placeholder:c="",...u}=e,f=Ss(vE,n),{onValueNodeHasChildrenChange:h}=f,g=l!==void 0,v=qe(t,f.onValueNodeChange);return Lt(()=>{h(g)},[h,g]),a.jsx(Oe.span,{...u,ref:v,style:{pointerEvents:"none"},children:FE(f.value)?a.jsx(a.Fragment,{children:c}):l})});yE.displayName=vE;var ZM="SelectIcon",wE=p.forwardRef((e,t)=>{const{__scopeSelect:n,children:s,...i}=e;return a.jsx(Oe.span,{"aria-hidden":!0,...i,ref:t,children:s||""})});wE.displayName=ZM;var e4="SelectPortal",xE=e=>a.jsx(Ea,{asChild:!0,...e});xE.displayName=e4;var eo="SelectContent",bE=p.forwardRef((e,t)=>{const n=Ss(eo,e.__scopeSelect),[s,i]=p.useState();if(Lt(()=>{i(new DocumentFragment)},[]),!n.open){const l=s;return l?Xo.createPortal(a.jsx(CE,{scope:e.__scopeSelect,children:a.jsx(Nd.Slot,{scope:e.__scopeSelect,children:a.jsx("div",{children:e.children})})}),l):null}return a.jsx(SE,{...e,ref:t})});bE.displayName=eo;var Gn=10,[CE,Es]=ai(eo),t4="SelectContentImpl",n4=Ks("SelectContent.RemoveScroll"),SE=p.forwardRef((e,t)=>{const{__scopeSelect:n,position:s="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:l,onPointerDownOutside:c,side:u,sideOffset:f,align:h,alignOffset:g,arrowPadding:v,collisionBoundary:w,collisionPadding:x,sticky:E,hideWhenDetached:C,avoidCollisions:b,...k}=e,_=Ss(eo,n),[N,j]=p.useState(null),[R,T]=p.useState(null),P=qe(t,q=>j(q)),[O,G]=p.useState(null),[L,F]=p.useState(null),I=kd(n),[U,M]=p.useState(!1),B=p.useRef(!1);p.useEffect(()=>{if(N)return Om(N)},[N]),Dm();const V=p.useCallback(q=>{const[se,...fe]=I().map(Re=>Re.ref.current),[ge]=fe.slice(-1),we=document.activeElement;for(const Re of q)if(Re===we||(Re?.scrollIntoView({block:"nearest"}),Re===se&&R&&(R.scrollTop=0),Re===ge&&R&&(R.scrollTop=R.scrollHeight),Re?.focus(),document.activeElement!==we))return},[I,R]),ee=p.useCallback(()=>V([O,N]),[V,O,N]);p.useEffect(()=>{U&&ee()},[U,ee]);const{onOpenChange:z,triggerPointerDownPosRef:$}=_;p.useEffect(()=>{if(N){let q={x:0,y:0};const se=ge=>{q={x:Math.abs(Math.round(ge.pageX)-($.current?.x??0)),y:Math.abs(Math.round(ge.pageY)-($.current?.y??0))}},fe=ge=>{q.x<=10&&q.y<=10?ge.preventDefault():N.contains(ge.target)||z(!1),document.removeEventListener("pointermove",se),$.current=null};return $.current!==null&&(document.addEventListener("pointermove",se),document.addEventListener("pointerup",fe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",se),document.removeEventListener("pointerup",fe,{capture:!0})}}},[N,z,$]),p.useEffect(()=>{const q=()=>z(!1);return window.addEventListener("blur",q),window.addEventListener("resize",q),()=>{window.removeEventListener("blur",q),window.removeEventListener("resize",q)}},[z]);const[W,D]=UE(q=>{const se=I().filter(we=>!we.disabled),fe=se.find(we=>we.ref.current===document.activeElement),ge=BE(se,q,fe);ge&&setTimeout(()=>ge.ref.current.focus())}),Q=p.useCallback((q,se,fe)=>{const ge=!B.current&&!fe;(_.value!==void 0&&_.value===se||ge)&&(G(q),ge&&(B.current=!0))},[_.value]),le=p.useCallback(()=>N?.focus(),[N]),X=p.useCallback((q,se,fe)=>{const ge=!B.current&&!fe;(_.value!==void 0&&_.value===se||ge)&&F(q)},[_.value]),K=s==="popper"?$h:EE,te=K===$h?{side:u,sideOffset:f,align:h,alignOffset:g,arrowPadding:v,collisionBoundary:w,collisionPadding:x,sticky:E,hideWhenDetached:C,avoidCollisions:b}:{};return a.jsx(CE,{scope:n,content:N,viewport:R,onViewportChange:T,itemRefCallback:Q,selectedItem:O,onItemLeave:le,itemTextRefCallback:X,focusSelectedItem:ee,selectedItemText:L,position:s,isPositioned:U,searchRef:W,children:a.jsx(vd,{as:n4,allowPinchZoom:!0,children:a.jsx(pd,{asChild:!0,trapped:_.open,onMountAutoFocus:q=>{q.preventDefault()},onUnmountAutoFocus:ye(i,q=>{_.trigger?.focus({preventScroll:!0}),q.preventDefault()}),children:a.jsx(Zo,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:q=>q.preventDefault(),onDismiss:()=>_.onOpenChange(!1),children:a.jsx(K,{role:"listbox",id:_.contentId,"data-state":_.open?"open":"closed",dir:_.dir,onContextMenu:q=>q.preventDefault(),...k,...te,onPlaced:()=>M(!0),ref:P,style:{display:"flex",flexDirection:"column",outline:"none",...k.style},onKeyDown:ye(k.onKeyDown,q=>{const se=q.ctrlKey||q.altKey||q.metaKey;if(q.key==="Tab"&&q.preventDefault(),!se&&q.key.length===1&&D(q.key),["ArrowUp","ArrowDown","Home","End"].includes(q.key)){let ge=I().filter(we=>!we.disabled).map(we=>we.ref.current);if(["ArrowUp","End"].includes(q.key)&&(ge=ge.slice().reverse()),["ArrowUp","ArrowDown"].includes(q.key)){const we=q.target,Re=ge.indexOf(we);ge=ge.slice(Re+1)}setTimeout(()=>V(ge)),q.preventDefault()}})})})})})})});SE.displayName=t4;var r4="SelectItemAlignedPosition",EE=p.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:s,...i}=e,l=Ss(eo,n),c=Es(eo,n),[u,f]=p.useState(null),[h,g]=p.useState(null),v=qe(t,P=>g(P)),w=kd(n),x=p.useRef(!1),E=p.useRef(!0),{viewport:C,selectedItem:b,selectedItemText:k,focusSelectedItem:_}=c,N=p.useCallback(()=>{if(l.trigger&&l.valueNode&&u&&h&&C&&b&&k){const P=l.trigger.getBoundingClientRect(),O=h.getBoundingClientRect(),G=l.valueNode.getBoundingClientRect(),L=k.getBoundingClientRect();if(l.dir!=="rtl"){const we=L.left-O.left,Re=G.left-we,Be=P.left-Re,We=P.width+Be,Ge=Math.max(We,O.width),ie=window.innerWidth-Gn,Pe=Rw(Re,[Gn,Math.max(Gn,ie-Ge)]);u.style.minWidth=We+"px",u.style.left=Pe+"px"}else{const we=O.right-L.right,Re=window.innerWidth-G.right-we,Be=window.innerWidth-P.right-Re,We=P.width+Be,Ge=Math.max(We,O.width),ie=window.innerWidth-Gn,Pe=Rw(Re,[Gn,Math.max(Gn,ie-Ge)]);u.style.minWidth=We+"px",u.style.right=Pe+"px"}const F=w(),I=window.innerHeight-Gn*2,U=C.scrollHeight,M=window.getComputedStyle(h),B=parseInt(M.borderTopWidth,10),V=parseInt(M.paddingTop,10),ee=parseInt(M.borderBottomWidth,10),z=parseInt(M.paddingBottom,10),$=B+V+U+z+ee,W=Math.min(b.offsetHeight*5,$),D=window.getComputedStyle(C),Q=parseInt(D.paddingTop,10),le=parseInt(D.paddingBottom,10),X=P.top+P.height/2-Gn,K=I-X,te=b.offsetHeight/2,q=b.offsetTop+te,se=B+V+q,fe=$-se;if(se<=X){const we=F.length>0&&b===F[F.length-1].ref.current;u.style.bottom="0px";const Re=h.clientHeight-C.offsetTop-C.offsetHeight,Be=Math.max(K,te+(we?le:0)+Re+ee),We=se+Be;u.style.height=We+"px"}else{const we=F.length>0&&b===F[0].ref.current;u.style.top="0px";const Be=Math.max(X,B+C.offsetTop+(we?Q:0)+te)+fe;u.style.height=Be+"px",C.scrollTop=se-X+C.offsetTop}u.style.margin=`${Gn}px 0`,u.style.minHeight=W+"px",u.style.maxHeight=I+"px",s?.(),requestAnimationFrame(()=>x.current=!0)}},[w,l.trigger,l.valueNode,u,h,C,b,k,l.dir,s]);Lt(()=>N(),[N]);const[j,R]=p.useState();Lt(()=>{h&&R(window.getComputedStyle(h).zIndex)},[h]);const T=p.useCallback(P=>{P&&E.current===!0&&(N(),_?.(),E.current=!1)},[N,_]);return a.jsx(o4,{scope:n,contentWrapper:u,shouldExpandOnScrollRef:x,onScrollButtonChange:T,children:a.jsx("div",{ref:f,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:j},children:a.jsx(Oe.div,{...i,ref:v,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});EE.displayName=r4;var s4="SelectPopperPosition",$h=p.forwardRef((e,t)=>{const{__scopeSelect:n,align:s="start",collisionPadding:i=Gn,...l}=e,c=jd(n);return a.jsx(fm,{...c,...l,ref:t,align:s,collisionPadding:i,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});$h.displayName=s4;var[o4,Zm]=ai(eo,{}),Fh="SelectViewport",_E=p.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:s,...i}=e,l=Es(Fh,n),c=Zm(Fh,n),u=qe(t,l.onViewportChange),f=p.useRef(0);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),a.jsx(Nd.Slot,{scope:n,children:a.jsx(Oe.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:u,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:ye(i.onScroll,h=>{const g=h.currentTarget,{contentWrapper:v,shouldExpandOnScrollRef:w}=c;if(w?.current&&v){const x=Math.abs(f.current-g.scrollTop);if(x>0){const E=window.innerHeight-Gn*2,C=parseFloat(v.style.minHeight),b=parseFloat(v.style.height),k=Math.max(C,b);if(k<E){const _=k+x,N=Math.min(E,_),j=_-N;v.style.height=N+"px",v.style.bottom==="0px"&&(g.scrollTop=j>0?j:0,v.style.justifyContent="flex-end")}}}f.current=g.scrollTop})})})]})});_E.displayName=Fh;var NE="SelectGroup",[i4,a4]=ai(NE),l4=p.forwardRef((e,t)=>{const{__scopeSelect:n,...s}=e,i=ur();return a.jsx(i4,{scope:n,id:i,children:a.jsx(Oe.div,{role:"group","aria-labelledby":i,...s,ref:t})})});l4.displayName=NE;var kE="SelectLabel",jE=p.forwardRef((e,t)=>{const{__scopeSelect:n,...s}=e,i=a4(kE,n);return a.jsx(Oe.div,{id:i.id,...s,ref:t})});jE.displayName=kE;var qc="SelectItem",[c4,TE]=ai(qc),AE=p.forwardRef((e,t)=>{const{__scopeSelect:n,value:s,disabled:i=!1,textValue:l,...c}=e,u=Ss(qc,n),f=Es(qc,n),h=u.value===s,[g,v]=p.useState(l??""),[w,x]=p.useState(!1),E=qe(t,_=>f.itemRefCallback?.(_,s,i)),C=ur(),b=p.useRef("touch"),k=()=>{i||(u.onValueChange(s),u.onOpenChange(!1))};if(s==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return a.jsx(c4,{scope:n,value:s,disabled:i,textId:C,isSelected:h,onItemTextChange:p.useCallback(_=>{v(N=>N||(_?.textContent??"").trim())},[]),children:a.jsx(Nd.ItemSlot,{scope:n,value:s,disabled:i,textValue:g,children:a.jsx(Oe.div,{role:"option","aria-labelledby":C,"data-highlighted":w?"":void 0,"aria-selected":h&&w,"data-state":h?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...c,ref:E,onFocus:ye(c.onFocus,()=>x(!0)),onBlur:ye(c.onBlur,()=>x(!1)),onClick:ye(c.onClick,()=>{b.current!=="mouse"&&k()}),onPointerUp:ye(c.onPointerUp,()=>{b.current==="mouse"&&k()}),onPointerDown:ye(c.onPointerDown,_=>{b.current=_.pointerType}),onPointerMove:ye(c.onPointerMove,_=>{b.current=_.pointerType,i?f.onItemLeave?.():b.current==="mouse"&&_.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ye(c.onPointerLeave,_=>{_.currentTarget===document.activeElement&&f.onItemLeave?.()}),onKeyDown:ye(c.onKeyDown,_=>{f.searchRef?.current!==""&&_.key===" "||(KM.includes(_.key)&&k(),_.key===" "&&_.preventDefault())})})})})});AE.displayName=qc;var ea="SelectItemText",RE=p.forwardRef((e,t)=>{const{__scopeSelect:n,className:s,style:i,...l}=e,c=Ss(ea,n),u=Es(ea,n),f=TE(ea,n),h=XM(ea,n),[g,v]=p.useState(null),w=qe(t,k=>v(k),f.onItemTextChange,k=>u.itemTextRefCallback?.(k,f.value,f.disabled)),x=g?.textContent,E=p.useMemo(()=>a.jsx("option",{value:f.value,disabled:f.disabled,children:x},f.value),[f.disabled,f.value,x]),{onNativeOptionAdd:C,onNativeOptionRemove:b}=h;return Lt(()=>(C(E),()=>b(E)),[C,b,E]),a.jsxs(a.Fragment,{children:[a.jsx(Oe.span,{id:f.textId,...l,ref:w}),f.isSelected&&c.valueNode&&!c.valueNodeHasChildren?Xo.createPortal(l.children,c.valueNode):null]})});RE.displayName=ea;var PE="SelectItemIndicator",IE=p.forwardRef((e,t)=>{const{__scopeSelect:n,...s}=e;return TE(PE,n).isSelected?a.jsx(Oe.span,{"aria-hidden":!0,...s,ref:t}):null});IE.displayName=PE;var Uh="SelectScrollUpButton",DE=p.forwardRef((e,t)=>{const n=Es(Uh,e.__scopeSelect),s=Zm(Uh,e.__scopeSelect),[i,l]=p.useState(!1),c=qe(t,s.onScrollButtonChange);return Lt(()=>{if(n.viewport&&n.isPositioned){let u=function(){const h=f.scrollTop>0;l(h)};const f=n.viewport;return u(),f.addEventListener("scroll",u),()=>f.removeEventListener("scroll",u)}},[n.viewport,n.isPositioned]),i?a.jsx(LE,{...e,ref:c,onAutoScroll:()=>{const{viewport:u,selectedItem:f}=n;u&&f&&(u.scrollTop=u.scrollTop-f.offsetHeight)}}):null});DE.displayName=Uh;var Bh="SelectScrollDownButton",OE=p.forwardRef((e,t)=>{const n=Es(Bh,e.__scopeSelect),s=Zm(Bh,e.__scopeSelect),[i,l]=p.useState(!1),c=qe(t,s.onScrollButtonChange);return Lt(()=>{if(n.viewport&&n.isPositioned){let u=function(){const h=f.scrollHeight-f.clientHeight,g=Math.ceil(f.scrollTop)<h;l(g)};const f=n.viewport;return u(),f.addEventListener("scroll",u),()=>f.removeEventListener("scroll",u)}},[n.viewport,n.isPositioned]),i?a.jsx(LE,{...e,ref:c,onAutoScroll:()=>{const{viewport:u,selectedItem:f}=n;u&&f&&(u.scrollTop=u.scrollTop+f.offsetHeight)}}):null});OE.displayName=Bh;var LE=p.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:s,...i}=e,l=Es("SelectScrollButton",n),c=p.useRef(null),u=kd(n),f=p.useCallback(()=>{c.current!==null&&(window.clearInterval(c.current),c.current=null)},[]);return p.useEffect(()=>()=>f(),[f]),Lt(()=>{u().find(g=>g.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[u]),a.jsx(Oe.div,{"aria-hidden":!0,...i,ref:t,style:{flexShrink:0,...i.style},onPointerDown:ye(i.onPointerDown,()=>{c.current===null&&(c.current=window.setInterval(s,50))}),onPointerMove:ye(i.onPointerMove,()=>{l.onItemLeave?.(),c.current===null&&(c.current=window.setInterval(s,50))}),onPointerLeave:ye(i.onPointerLeave,()=>{f()})})}),d4="SelectSeparator",ME=p.forwardRef((e,t)=>{const{__scopeSelect:n,...s}=e;return a.jsx(Oe.div,{"aria-hidden":!0,...s,ref:t})});ME.displayName=d4;var zh="SelectArrow",u4=p.forwardRef((e,t)=>{const{__scopeSelect:n,...s}=e,i=jd(n),l=Ss(zh,n),c=Es(zh,n);return l.open&&c.position==="popper"?a.jsx(hm,{...i,...s,ref:t}):null});u4.displayName=zh;var f4="SelectBubbleInput",$E=p.forwardRef(({__scopeSelect:e,value:t,...n},s)=>{const i=p.useRef(null),l=qe(s,i),c=Rb(t);return p.useEffect(()=>{const u=i.current;if(!u)return;const f=window.HTMLSelectElement.prototype,g=Object.getOwnPropertyDescriptor(f,"value").set;if(c!==t&&g){const v=new Event("change",{bubbles:!0});g.call(u,t),u.dispatchEvent(v)}},[c,t]),a.jsx(Oe.select,{...n,style:{...ex,...n.style},ref:l,defaultValue:t})});$E.displayName=f4;function FE(e){return e===""||e===void 0}function UE(e){const t=an(e),n=p.useRef(""),s=p.useRef(0),i=p.useCallback(c=>{const u=n.current+c;t(u),(function f(h){n.current=h,window.clearTimeout(s.current),h!==""&&(s.current=window.setTimeout(()=>f(""),1e3))})(u)},[t]),l=p.useCallback(()=>{n.current="",window.clearTimeout(s.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(s.current),[]),[n,i,l]}function BE(e,t,n){const i=t.length>1&&Array.from(t).every(h=>h===t[0])?t[0]:t,l=n?e.indexOf(n):-1;let c=h4(e,Math.max(l,0));i.length===1&&(c=c.filter(h=>h!==n));const f=c.find(h=>h.textValue.toLowerCase().startsWith(i.toLowerCase()));return f!==n?f:void 0}function h4(e,t){return e.map((n,s)=>e[(t+s)%e.length])}var m4=mE,zE=gE,p4=yE,g4=wE,v4=xE,VE=bE,y4=_E,HE=jE,WE=AE,w4=RE,x4=IE,qE=DE,GE=OE,KE=ME;const hc=m4,mc=p4,ta=p.forwardRef(({className:e,children:t,...n},s)=>a.jsxs(zE,{ref:s,className:be("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,a.jsx(g4,{asChild:!0,children:a.jsx(_x,{className:"h-4 w-4 opacity-50"})})]}));ta.displayName=zE.displayName;const YE=p.forwardRef(({className:e,...t},n)=>a.jsx(qE,{ref:n,className:be("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(hk,{className:"h-4 w-4"})}));YE.displayName=qE.displayName;const JE=p.forwardRef(({className:e,...t},n)=>a.jsx(GE,{ref:n,className:be("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(_x,{className:"h-4 w-4"})}));JE.displayName=GE.displayName;const na=p.forwardRef(({className:e,children:t,position:n="popper",...s},i)=>a.jsx(v4,{children:a.jsxs(VE,{ref:i,className:be("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...s,children:[a.jsx(YE,{}),a.jsx(y4,{className:be("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),a.jsx(JE,{})]})}));na.displayName=VE.displayName;const b4=p.forwardRef(({className:e,...t},n)=>a.jsx(HE,{ref:n,className:be("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));b4.displayName=HE.displayName;const qt=p.forwardRef(({className:e,children:t,...n},s)=>a.jsxs(WE,{ref:s,className:be("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(x4,{children:a.jsx(Jn,{className:"h-4 w-4"})})}),a.jsx(w4,{children:t})]}));qt.displayName=WE.displayName;const C4=p.forwardRef(({className:e,...t},n)=>a.jsx(KE,{ref:n,className:be("-mx-1 my-1 h-px bg-muted",e),...t}));C4.displayName=KE.displayName;function Dt(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function S4(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const pc=43200,Pw=1440;let E4={};function _4(){return E4}function Iw(e){const t=Dt(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function _c(e,t){const n=Dt(e),s=Dt(t),i=n.getTime()-s.getTime();return i<0?-1:i>0?1:i}function N4(e){return S4(e,Date.now())}function k4(e,t){const n=Dt(e),s=Dt(t),i=n.getFullYear()-s.getFullYear(),l=n.getMonth()-s.getMonth();return i*12+l}function j4(e){return t=>{const s=(e?Math[e]:Math.trunc)(t);return s===0?0:s}}function T4(e,t){return+Dt(e)-+Dt(t)}function A4(e){const t=Dt(e);return t.setHours(23,59,59,999),t}function R4(e){const t=Dt(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function P4(e){const t=Dt(e);return+A4(t)==+R4(t)}function I4(e,t){const n=Dt(e),s=Dt(t),i=_c(n,s),l=Math.abs(k4(n,s));let c;if(l<1)c=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-i*l);let u=_c(n,s)===-i;P4(Dt(e))&&l===1&&_c(e,s)===1&&(u=!1),c=i*(l-Number(u))}return c===0?0:c}function D4(e,t,n){const s=T4(e,t)/1e3;return j4(n?.roundingMethod)(s)}const O4={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},L4=(e,t,n)=>{let s;const i=O4[e];return typeof i=="string"?s=i:t===1?s=i.one:s=i.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function Jf(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const M4={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},$4={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},F4={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},U4={date:Jf({formats:M4,defaultWidth:"full"}),time:Jf({formats:$4,defaultWidth:"full"}),dateTime:Jf({formats:F4,defaultWidth:"full"})},B4={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},z4=(e,t,n,s)=>B4[e];function Ki(e){return(t,n)=>{const s=n?.context?String(n.context):"standalone";let i;if(s==="formatting"&&e.formattingValues){const c=e.defaultFormattingWidth||e.defaultWidth,u=n?.width?String(n.width):c;i=e.formattingValues[u]||e.formattingValues[c]}else{const c=e.defaultWidth,u=n?.width?String(n.width):e.defaultWidth;i=e.values[u]||e.values[c]}const l=e.argumentCallback?e.argumentCallback(t):t;return i[l]}}const V4={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},H4={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},W4={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},q4={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},G4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},K4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Y4=(e,t)=>{const n=Number(e),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},J4={ordinalNumber:Y4,era:Ki({values:V4,defaultWidth:"wide"}),quarter:Ki({values:H4,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Ki({values:W4,defaultWidth:"wide"}),day:Ki({values:q4,defaultWidth:"wide"}),dayPeriod:Ki({values:G4,defaultWidth:"wide",formattingValues:K4,defaultFormattingWidth:"wide"})};function Yi(e){return(t,n={})=>{const s=n.width,i=s&&e.matchPatterns[s]||e.matchPatterns[e.defaultMatchWidth],l=t.match(i);if(!l)return null;const c=l[0],u=s&&e.parsePatterns[s]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(u)?X4(u,v=>v.test(c)):Q4(u,v=>v.test(c));let h;h=e.valueCallback?e.valueCallback(f):f,h=n.valueCallback?n.valueCallback(h):h;const g=t.slice(c.length);return{value:h,rest:g}}}function Q4(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function X4(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function Z4(e){return(t,n={})=>{const s=t.match(e.matchPattern);if(!s)return null;const i=s[0],l=t.match(e.parsePattern);if(!l)return null;let c=e.valueCallback?e.valueCallback(l[0]):l[0];c=n.valueCallback?n.valueCallback(c):c;const u=t.slice(i.length);return{value:c,rest:u}}}const e$=/^(\d+)(th|st|nd|rd)?/i,t$=/\d+/i,n$={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},r$={any:[/^b/i,/^(a|c)/i]},s$={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},o$={any:[/1/i,/2/i,/3/i,/4/i]},i$={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},a$={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},l$={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},c$={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},d$={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},u$={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},f$={ordinalNumber:Z4({matchPattern:e$,parsePattern:t$,valueCallback:e=>parseInt(e,10)}),era:Yi({matchPatterns:n$,defaultMatchWidth:"wide",parsePatterns:r$,defaultParseWidth:"any"}),quarter:Yi({matchPatterns:s$,defaultMatchWidth:"wide",parsePatterns:o$,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Yi({matchPatterns:i$,defaultMatchWidth:"wide",parsePatterns:a$,defaultParseWidth:"any"}),day:Yi({matchPatterns:l$,defaultMatchWidth:"wide",parsePatterns:c$,defaultParseWidth:"any"}),dayPeriod:Yi({matchPatterns:d$,defaultMatchWidth:"any",parsePatterns:u$,defaultParseWidth:"any"})},h$={code:"en-US",formatDistance:L4,formatLong:U4,formatRelative:z4,localize:J4,match:f$,options:{weekStartsOn:0,firstWeekContainsDate:1}};function m$(e,t,n){const s=_4(),i=n?.locale??s.locale??h$,l=2520,c=_c(e,t);if(isNaN(c))throw new RangeError("Invalid time value");const u=Object.assign({},n,{addSuffix:n?.addSuffix,comparison:c});let f,h;c>0?(f=Dt(t),h=Dt(e)):(f=Dt(e),h=Dt(t));const g=D4(h,f),v=(Iw(h)-Iw(f))/1e3,w=Math.round((g-v)/60);let x;if(w<2)return n?.includeSeconds?g<5?i.formatDistance("lessThanXSeconds",5,u):g<10?i.formatDistance("lessThanXSeconds",10,u):g<20?i.formatDistance("lessThanXSeconds",20,u):g<40?i.formatDistance("halfAMinute",0,u):g<60?i.formatDistance("lessThanXMinutes",1,u):i.formatDistance("xMinutes",1,u):w===0?i.formatDistance("lessThanXMinutes",1,u):i.formatDistance("xMinutes",w,u);if(w<45)return i.formatDistance("xMinutes",w,u);if(w<90)return i.formatDistance("aboutXHours",1,u);if(w<Pw){const E=Math.round(w/60);return i.formatDistance("aboutXHours",E,u)}else{if(w<l)return i.formatDistance("xDays",1,u);if(w<pc){const E=Math.round(w/Pw);return i.formatDistance("xDays",E,u)}else if(w<pc*2)return x=Math.round(w/pc),i.formatDistance("aboutXMonths",x,u)}if(x=I4(h,f),x<12){const E=Math.round(w/pc);return i.formatDistance("xMonths",E,u)}else{const E=x%12,C=Math.trunc(x/12);return E<3?i.formatDistance("aboutXYears",C,u):E<9?i.formatDistance("overXYears",C,u):i.formatDistance("almostXYears",C+1,u)}}function gc(e,t){return m$(e,N4(e),t)}function p$(e){const t=e.toLowerCase();if(t.includes("edg/")){const n=e.match(/edg\/([\d.]+)/i);return{name:"Edge",version:n?n[1]:null,fullName:n?`Edge ${n[1]}`:"Edge"}}if(t.includes("chrome/")&&!t.includes("edg/")){const n=e.match(/chrome\/([\d.]+)/i);return{name:"Chrome",version:n?n[1]:null,fullName:n?`Chrome ${n[1]}`:"Chrome"}}if(t.includes("safari/")&&!t.includes("chrome/")){const n=e.match(/version\/([\d.]+).*safari/i);return{name:"Safari",version:n?n[1]:null,fullName:n?`Safari ${n[1]}`:"Safari"}}if(t.includes("firefox/")){const n=e.match(/firefox\/([\d.]+)/i);return{name:"Firefox",version:n?n[1]:null,fullName:n?`Firefox ${n[1]}`:"Firefox"}}if(t.includes("opera/")||t.includes("opr/")){const n=e.match(/(?:opera|opr)\/([\d.]+)/i);return{name:"Opera",version:n?n[1]:null,fullName:n?`Opera ${n[1]}`:"Opera"}}if(t.includes("samsungbrowser/")){const n=e.match(/samsungbrowser\/([\d.]+)/i);return{name:"Samsung Internet",version:n?n[1]:null,fullName:n?`Samsung Internet ${n[1]}`:"Samsung Internet"}}if(t.includes("ucbrowser/")){const n=e.match(/ucbrowser\/([\d.]+)/i);return{name:"UC Browser",version:n?n[1]:null,fullName:n?`UC Browser ${n[1]}`:"UC Browser"}}return{name:"Unknown Browser",version:null,fullName:"Unknown Browser"}}function g$(e){const t=e.toLowerCase();if(t.includes("iphone")||t.includes("ipad")||t.includes("ipod")){const n=e.match(/os ([\d_]+)/i);if(n){const s=n[1].replace(/_/g,".");return{name:"iOS",version:s,fullName:`iOS ${s}`}}return{name:"iOS",version:null,fullName:"iOS"}}if(t.includes("android")){const n=e.match(/android ([\d.]+)/i);return n?{name:"Android",version:n[1],fullName:`Android ${n[1]}`}:{name:"Android",version:null,fullName:"Android"}}if(t.includes("windows")){if(t.includes("windows nt 10.0"))return{name:"Windows",version:"10/11",fullName:"Windows 10/11"};if(t.includes("windows nt 6.3"))return{name:"Windows",version:"8.1",fullName:"Windows 8.1"};if(t.includes("windows nt 6.2"))return{name:"Windows",version:"8",fullName:"Windows 8"};if(t.includes("windows nt 6.1"))return{name:"Windows",version:"7",fullName:"Windows 7"};const n=e.match(/windows nt ([\d.]+)/i);return n?{name:"Windows",version:n[1],fullName:`Windows NT ${n[1]}`}:{name:"Windows",version:null,fullName:"Windows"}}if(t.includes("mac os x")||t.includes("macintosh")){const n=e.match(/mac os x ([\d_]+)/i);if(n){const s=n[1].replace(/_/g,".");return{name:"macOS",version:s,fullName:`macOS ${s}`}}return{name:"macOS",version:null,fullName:"macOS"}}return t.includes("linux")?{name:"Linux",version:null,fullName:"Linux"}:{name:"Unknown OS",version:null,fullName:"Unknown OS"}}function v$(e){const t=e;if(t.includes("iPhone")){const n=t.match(/iPhone(\d+,\d+)/i);return n?`iPhone ${n[1]}`:"iPhone"}if(t.includes("iPad")){const n=t.match(/iPad(\d+,\d+)/i);return n?`iPad ${n[1]}`:"iPad"}if(t.includes("Android")){const n=t.match(/android [\d.]+; ([^)]+)\)/i);if(n)return n[1].trim().replace(/^SM-/,"Samsung ").replace(/^LM-/,"LG ")}return t.includes("Macintosh")?"Mac":null}function Dw(e){return e?{browser:p$(e),os:g$(e),deviceModel:v$(e)}:{browser:{name:"Unknown",version:null,fullName:"Unknown Browser"},os:{name:"Unknown",version:null,fullName:"Unknown OS"},deviceModel:null}}function Sa(e){if(!e||e.length!==2)return null;const t=e.toUpperCase().split("").map(n=>127462+(n.charCodeAt(0)-65));return String.fromCodePoint(...t)}async function QE(e){if(!e)return{country:null,countryCode:null,countryFlag:null,city:null,region:null};try{const t=await fetch(`https://ip-api.com/json/${e}?fields=status,message,country,countryCode,city,regionName`,{method:"GET",headers:{Accept:"application/json"}});if(t.ok){const n=await t.json();if(n.status==="success"){const s=n.countryCode||null;return{country:n.country||null,countryCode:s,countryFlag:Sa(s),city:n.city||null,region:n.regionName||null}}}}catch(t){t instanceof TypeError&&!t.message.includes("Failed to fetch")&&console.warn("ip-api.com geolocation failed, trying fallback:",t)}try{const t=await fetch(`https://ipapi.co/${e}/json/`,{method:"GET",headers:{Accept:"application/json"}});if(t.ok){const n=await t.json();if(n.country_code&&!n.error){const s=n.country_code||null;return{country:n.country_name||null,countryCode:s,countryFlag:Sa(s),city:n.city||null,region:n.region||null}}}}catch(t){console.warn("ipapi.co geolocation failed:",t)}return{country:null,countryCode:null,countryFlag:null,city:null,region:null}}async function y$(e){const t=await QE(e);return{countryCode:t.countryCode,countryFlag:t.countryFlag,country:t.country}}const w$=Object.freeze(Object.defineProperty({__proto__:null,countryCodeToFlag:Sa,getCountryFromIP:y$,getIPGeolocation:QE},Symbol.toStringTag,{value:"Module"})),x$=()=>{const[e,t]=p.useState([]),[n,s]=p.useState([]),[i,l]=p.useState([]),[c,u]=p.useState(!0),[f,h]=p.useState(!1),[g,v]=p.useState("active"),[w,x]=p.useState(null),[E,C]=p.useState(null),[b,k]=p.useState(""),[_,N]=p.useState(!1),[j,R]=p.useState(!1),[T,P]=p.useState(""),[O,G]=p.useState("all"),[L,F]=p.useState("all"),[I,U]=p.useState(1),[M,B]=p.useState(!1),V=10,[ee,z]=p.useState("all"),[$,W]=p.useState("all"),{toast:D}=Ct(),Q=p.useRef(null),le=p.useRef(null),X=p.useCallback(async()=>{try{u(!0);const{data:{user:ie}}=await Y.auth.getUser();if(!ie)return;const{data:Pe,error:ae}=await Y.from("devices").select(`
          *,
          children:last_used_child_id (
            name
          )
        `).eq("parent_id",ie.id).eq("is_active",!0).order("last_login_at",{ascending:!1});if(ae&&(ae.code==="42P01"||ae.message?.includes("does not exist"))){D({title:"Database Migration Required",description:"The devices table doesn't exist yet. Please run the migration: supabase/migrations/20250122000000_add_device_management.sql",variant:"destructive",duration:1e4}),console.error(" [DEVICE MANAGEMENT] Migration not run:",ae);return}if(ae)throw ae;const ve=(Pe||[]).map(_e=>({..._e,child_name:_e.children?.name||null}));console.log(" [DEVICE MANAGEMENT] Fetched devices:",{count:ve.length,devices:ve.map(_e=>({id:_e.id,name:_e.device_name,isActive:_e.is_active}))}),t(ve)}catch(ie){console.error("Error fetching devices:",ie),D({title:"Error",description:"Failed to load devices. Please try again.",variant:"destructive"})}finally{u(!1)}},[D]),K=p.useCallback(async()=>{try{const{data:{user:ie}}=await Y.auth.getUser();if(!ie)return;const{data:Pe,error:ae}=await Y.from("children").select("id, name").order("name",{ascending:!0});if(ae)throw ae;l(Pe||[])}catch(ie){console.error("Error fetching children:",ie)}},[]),te=p.useCallback(async()=>{try{h(!0);const{data:{user:ie}}=await Y.auth.getUser();if(!ie)return;const{data:Pe,error:ae}=await Y.from("devices").select(`
          *,
          children:last_used_child_id (
            name
          )
        `).eq("parent_id",ie.id).order("updated_at",{ascending:!1});if(ae)throw ae;const ve=(Pe||[]).map(_e=>({..._e,child_name:_e.children?.name||null}));console.log(" [DEVICE MANAGEMENT] Fetched device history:",{count:ve.length,active:ve.filter(_e=>_e.is_active).length,inactive:ve.filter(_e=>!_e.is_active).length}),s(ve)}catch(ie){console.error("Error fetching device history:",ie),D({title:"Error",description:"Failed to load device history. Please try again.",variant:"destructive"})}finally{h(!1)}},[D]);p.useEffect(()=>(X(),K(),(async()=>{const{data:{user:Pe}}=await Y.auth.getUser();Pe&&(Q.current&&await Y.removeChannel(Q.current),Q.current=Y.channel("device-management-updates").on("postgres_changes",{event:"INSERT",schema:"public",table:"devices",filter:`parent_id=eq.${Pe.id}`},ae=>{console.log(" [DEVICE MANAGEMENT] New device added:",ae.new),X(),g==="history"&&te()}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"devices",filter:`parent_id=eq.${Pe.id}`},ae=>{console.log(" [DEVICE MANAGEMENT] Device updated:",{deviceId:ae.new.id,deviceName:ae.new.device_name,isActive:ae.new.is_active,oldIsActive:ae.old?.is_active}),X(),g==="history"&&te()}).subscribe((ae,ve)=>{ve?console.error(" [DEVICE MANAGEMENT] Subscription error:",ve):ae==="SUBSCRIBED"&&console.log(" [DEVICE MANAGEMENT] Subscribed to device updates")}))})(),()=>{Q.current&&(Y.removeChannel(Q.current),Q.current=null)}),[X,te,g]),p.useEffect(()=>{g==="history"&&n.length===0&&!f&&te()},[g,te,n.length,f]),p.useEffect(()=>{if(g!=="history"){B(!1);return}const ie=()=>{if(le.current){const ae=le.current.scrollTop;B(ae>400)}},Pe=le.current;if(Pe)return Pe.addEventListener("scroll",ie),ie(),()=>Pe.removeEventListener("scroll",ie)},[g]);const q=n.filter(ie=>!(O!=="all"&&ie.last_used_child_id!==O||L!=="all"&&ie.device_type!==L)),se=Math.ceil(q.length/V),fe=q.slice((I-1)*V,I*V);p.useEffect(()=>{U(1)},[O,L]);const ge=()=>{le.current&&le.current.scrollTo({top:0,behavior:"smooth"})},we=e.filter(ie=>!(ee!=="all"&&ie.last_used_child_id!==ee||$!=="all"&&ie.device_type!==$)),Re=async()=>{if(!w){console.warn(" [DEVICE MANAGEMENT] No device selected for removal");return}if(console.log(" [DEVICE MANAGEMENT] Remove device initiated:",{deviceId:w.id,deviceName:w.device_name,requireAuth:j}),!j){console.log(" [DEVICE MANAGEMENT] Showing password prompt");const ie=w.child_name?` (used by ${w.child_name})`:"";D({title:" Warning: Device Removal",description:`You are about to remove "${w.device_name}"${ie}. This action requires password confirmation and cannot be undone.`,variant:"destructive",duration:5e3}),setTimeout(()=>{R(!0)},100);return}if(!T.trim()){D({title:"Password Required",description:"Please enter your password to confirm device removal.",variant:"destructive"});return}try{const{data:{user:ie},error:Pe}=await Y.auth.getUser();if(Pe||!ie)throw console.error(" [DEVICE MANAGEMENT] User auth error:",Pe),new Error("Not authenticated");console.log(" [DEVICE MANAGEMENT] Verifying password for user:",ie.email);const{error:ae}=await Y.auth.signInWithPassword({email:ie.email||"",password:T});if(ae){console.error(" [DEVICE MANAGEMENT] Password verification failed:",ae),D({title:"Authentication Failed",description:"Incorrect password. Please try again.",variant:"destructive"}),P("");return}console.log(" [DEVICE MANAGEMENT] Password verified, calling revoke_device RPC");const{data:ve,error:_e}=await Y.rpc("revoke_device",{p_device_id:w.id,p_parent_id:ie.id});if(console.log(" [DEVICE MANAGEMENT] RPC response:",{revokeResult:ve,error:_e}),_e)throw console.error(" [DEVICE MANAGEMENT] RPC error:",_e),_e;if(ve===!1)throw console.warn(" [DEVICE MANAGEMENT] Device not found or permission denied"),new Error("Device not found or you don't have permission to remove it");console.log(" [DEVICE MANAGEMENT] Device revoked successfully:",{deviceId:w.id,deviceName:w.device_name,revokeResult:ve});const Ue=w.device_name;x(null),R(!1),P(""),D({title:" Device Removed Successfully",description:`${Ue} has been removed and will need to be re-authorized on next login.`,variant:"success",duration:5e3}),console.log(" [DEVICE MANAGEMENT] Refreshing devices list"),await X(),g==="history"&&await te()}catch(ie){console.error(" [DEVICE MANAGEMENT] Error removing device:",ie),D({title:"Error",description:ie.message||"Failed to remove device. Please try again.",variant:"destructive"})}},Be=async()=>{if(!(!E||!b.trim()))try{const{data:{user:ie}}=await Y.auth.getUser();if(!ie)throw new Error("Not authenticated");const{error:Pe}=await Y.from("devices").update({device_name:b.trim()}).eq("id",E.id).eq("parent_id",ie.id);if(Pe)throw Pe;D({title:"Device Renamed",description:`Device renamed to "${b.trim()}"`}),C(null),k(""),X()}catch(ie){console.error("Error renaming device:",ie),D({title:"Error",description:ie.message||"Failed to rename device. Please try again.",variant:"destructive"})}},We=ie=>{switch(ie){case"mobile":return a.jsx(xc,{className:"h-5 w-5"});case"tablet":return a.jsx(Ik,{className:"h-5 w-5"});case"desktop":return a.jsx(_k,{className:"h-5 w-5"});default:return a.jsx(xc,{className:"h-5 w-5"})}},Ge=ie=>(Date.now()-new Date(ie).getTime())/864e5>30;return a.jsxs("div",{className:"min-h-[100dvh] bg-background w-full overflow-x-hidden",children:[a.jsx(Ot,{}),a.jsx(Lr,{role:"parent",pageKey:"parent_devices"}),a.jsx(Or,{role:"parent",pageKey:"parent_devices"}),a.jsx("div",{className:"px-4 pb-4",style:{paddingTop:"calc(0.5rem + 64px + var(--safe-area-inset-top) * 0.15)"},children:a.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[a.jsxs("div",{className:"mt-2",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Device Management"}),a.jsx("p",{className:"text-muted-foreground mt-2",children:"View and manage all devices authorized to access your family account"})]}),a.jsx(Te,{className:"p-4 bg-blue-50 dark:bg-blue-950 border-blue-200 dark:border-blue-800",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Zc,{className:"h-5 w-5 text-blue-700 dark:text-blue-300 mt-0.5 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-1",children:"About Device Management"}),a.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"This page shows all devices that have been used to access your family account. You can remove devices you no longer use or recognize. Removing a device will require re-authorization the next time someone tries to log in from that device."})]})]})}),a.jsxs(qM,{value:g,onValueChange:ie=>{v(ie),ie==="history"&&n.length===0&&te()},children:[a.jsxs(hE,{className:"grid w-full grid-cols-2",children:[a.jsx(Lh,{value:"active",children:"Active Devices"}),a.jsxs(Lh,{value:"history",children:[a.jsx(bf,{className:"h-4 w-4 mr-2"}),"History"]})]}),a.jsxs(Mh,{value:"active",className:"space-y-4",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs(ce,{onClick:X,variant:"outline",size:"sm",children:[a.jsx(ds,{className:"h-4 w-4 mr-2"}),"Refresh"]}),a.jsxs("div",{className:"flex flex-1 gap-2",children:[a.jsxs(hc,{value:ee,onValueChange:z,children:[a.jsxs(ta,{className:"w-full sm:w-[180px]",children:[a.jsx(Xv,{className:"h-4 w-4 mr-2"}),a.jsx(mc,{placeholder:"Filter by child"})]}),a.jsxs(na,{children:[a.jsx(qt,{value:"all",children:"All Children"}),i.map(ie=>a.jsx(qt,{value:ie.id,children:ie.name},ie.id))]})]}),a.jsxs(hc,{value:$,onValueChange:W,children:[a.jsx(ta,{className:"w-full sm:w-[180px]",children:a.jsx(mc,{placeholder:"Filter by device type"})}),a.jsxs(na,{children:[a.jsx(qt,{value:"all",children:"All Types"}),a.jsx(qt,{value:"mobile",children:"Mobile"}),a.jsx(qt,{value:"tablet",children:"Tablet"}),a.jsx(qt,{value:"desktop",children:"Desktop"}),a.jsx(qt,{value:"other",children:"Other"})]})]})]})]}),we.length!==e.length&&e.length>0&&a.jsx(Te,{className:"p-3 bg-muted/50 border-muted",children:a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",we.length," of ",e.length," active devices"]})}),a.jsx("div",{"data-tour":"parent-devices-list",children:c?a.jsxs(Te,{className:"p-12 text-center",children:[a.jsx(ds,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-muted-foreground"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading devices..."})]}):we.length===0?a.jsxs(Te,{className:"p-12 text-center",children:[a.jsx(xc,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),a.jsx("p",{className:"text-muted-foreground mb-2",children:e.length===0?"No devices found":"No devices match your filters"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:e.length===0?"Devices will appear here after they're used to log in":"Try adjusting your filters"})]}):a.jsx("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:we.map(ie=>{const Pe=Ge(ie.last_login_at);return a.jsxs(Te,{className:`p-4 space-y-3 ${ie.is_active?"":"opacity-60"} ${Pe?"border-yellow-200 dark:border-yellow-800":""}`,children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[a.jsx("div",{className:"mt-1",children:We(ie.device_type)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-semibold truncate",children:ie.device_name}),a.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:ie.device_type})]})]}),!ie.is_active&&a.jsx("span",{className:"text-xs text-muted-foreground bg-muted px-2 py-1 rounded",children:"Revoked"})]}),Pe&&a.jsxs("div",{className:"flex items-center gap-2 text-yellow-700 dark:text-yellow-300 text-sm",children:[a.jsx(aa,{className:"h-4 w-4"}),a.jsx("span",{children:"Not used recently"})]}),a.jsxs("div",{className:"space-y-1 text-sm",children:[ie.child_name&&a.jsxs("p",{className:"text-muted-foreground",children:["Last used by: ",a.jsx("span",{className:"font-medium",children:ie.child_name})]}),a.jsxs("p",{className:"text-muted-foreground",children:["Last login:"," ",a.jsx("span",{className:"font-medium",children:gc(new Date(ie.last_login_at),{addSuffix:!0})})]}),ie.country_code&&a.jsxs("p",{className:"text-muted-foreground",children:["Country:"," ",a.jsxs("span",{className:"font-medium text-base",children:[Sa(ie.country_code)||""," ",ie.country_code]})]}),ie.user_agent&&(()=>{const ae=Dw(ie.user_agent);return a.jsxs(a.Fragment,{children:[a.jsxs("p",{className:"text-muted-foreground",children:["Browser: ",a.jsx("span",{className:"font-medium",children:ae.browser.fullName})]}),a.jsxs("p",{className:"text-muted-foreground",children:["OS: ",a.jsx("span",{className:"font-medium",children:ae.os.fullName})]}),ae.deviceModel&&a.jsxs("p",{className:"text-muted-foreground",children:["Model: ",a.jsx("span",{className:"font-medium",children:ae.deviceModel})]})]})})(),ie.mac_address&&a.jsxs("p",{className:"text-muted-foreground",children:["MAC: ",a.jsx("span",{className:"font-mono text-xs",children:ie.mac_address})]}),ie.last_ip_address&&a.jsxs("p",{className:"text-muted-foreground",children:["IP: ",a.jsx("span",{className:"font-mono text-xs",children:ie.last_ip_address})]}),ie.last_location&&a.jsxs("p",{className:"text-muted-foreground",children:["Location Details: ",a.jsx("span",{className:"font-medium",children:ie.last_location})]})]}),ie.is_active&&a.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[a.jsxs(ce,{onClick:()=>{C(ie),k(ie.device_name)},variant:"outline",size:"sm",className:"flex-1",children:[a.jsx(Nk,{className:"h-4 w-4 mr-2"}),"Rename"]}),a.jsxs(ce,{onClick:()=>x(ie),variant:"destructive",size:"sm",className:"flex-1",children:[a.jsx(Zh,{className:"h-4 w-4 mr-2"}),"Remove"]})]})]},ie.id)})})})]}),a.jsxs(Mh,{value:"history",className:"space-y-4",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs(ce,{onClick:te,variant:"outline",size:"sm",disabled:f,children:[a.jsx(ds,{className:`h-4 w-4 mr-2 ${f?"animate-spin":""}`}),"Refresh History"]}),a.jsxs("div",{className:"flex flex-1 gap-2",children:[a.jsxs(hc,{value:O,onValueChange:G,children:[a.jsxs(ta,{className:"w-full sm:w-[180px]",children:[a.jsx(Xv,{className:"h-4 w-4 mr-2"}),a.jsx(mc,{placeholder:"Filter by child"})]}),a.jsxs(na,{children:[a.jsx(qt,{value:"all",children:"All Children"}),i.map(ie=>a.jsx(qt,{value:ie.id,children:ie.name},ie.id))]})]}),a.jsxs(hc,{value:L,onValueChange:F,children:[a.jsx(ta,{className:"w-full sm:w-[180px]",children:a.jsx(mc,{placeholder:"Filter by device type"})}),a.jsxs(na,{children:[a.jsx(qt,{value:"all",children:"All Types"}),a.jsx(qt,{value:"mobile",children:"Mobile"}),a.jsx(qt,{value:"tablet",children:"Tablet"}),a.jsx(qt,{value:"desktop",children:"Desktop"}),a.jsx(qt,{value:"other",children:"Other"})]})]})]})]}),a.jsx(Te,{className:"p-4 bg-muted/50 border-muted",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(bf,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-foreground mb-1",children:"Device History"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["This is a read-only history of all devices that have accessed your account, including removed devices. This history cannot be modified and serves as a security audit trail.",q.length!==n.length&&a.jsxs("span",{className:"block mt-1 font-medium",children:["Showing ",q.length," of ",n.length," devices"]})]})]})]})}),a.jsx("div",{ref:le,className:"max-h-[calc(100vh-400px)] overflow-y-auto space-y-4",style:{scrollBehavior:"smooth"},children:f?a.jsxs(Te,{className:"p-12 text-center",children:[a.jsx(ds,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-muted-foreground"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading device history..."})]}):q.length===0?a.jsxs(Te,{className:"p-12 text-center",children:[a.jsx(bf,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),a.jsx("p",{className:"text-muted-foreground mb-2",children:"No devices found"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:n.length===0?"Device history will appear here as devices are used or removed":"Try adjusting your filters"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:fe.map(ie=>{const Pe=Ge(ie.last_login_at),ae=!ie.is_active;return a.jsxs(Te,{className:`p-4 space-y-3 ${ae?"opacity-75 border-destructive/20 bg-muted/30":""} ${Pe?"border-yellow-200 dark:border-yellow-800":""}`,children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[a.jsx("div",{className:"mt-1",children:We(ie.device_type)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-semibold truncate",children:ie.device_name}),a.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:ie.device_type})]})]}),ae?a.jsx("span",{className:"text-xs text-destructive bg-destructive/10 px-2 py-1 rounded",children:"Removed"}):a.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-950 px-2 py-1 rounded",children:"Active"})]}),Pe&&a.jsxs("div",{className:"flex items-center gap-2 text-yellow-700 dark:text-yellow-300 text-sm",children:[a.jsx(aa,{className:"h-4 w-4"}),a.jsx("span",{children:"Not used recently"})]}),a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsxs("p",{className:"text-muted-foreground",children:["Created:"," ",a.jsx("span",{className:"font-medium",children:gc(new Date(ie.created_at),{addSuffix:!0})})]}),ie.child_name&&a.jsxs("p",{className:"text-muted-foreground",children:["Last used by: ",a.jsx("span",{className:"font-medium",children:ie.child_name})]}),a.jsxs("p",{className:"text-muted-foreground",children:["Last login:"," ",a.jsx("span",{className:"font-medium",children:gc(new Date(ie.last_login_at),{addSuffix:!0})})]}),ae&&a.jsxs("p",{className:"text-muted-foreground",children:["Removed:"," ",a.jsx("span",{className:"font-medium",children:gc(new Date(ie.updated_at),{addSuffix:!0})})]}),ie.country_code&&a.jsxs("p",{className:"text-muted-foreground",children:["Country:"," ",a.jsxs("span",{className:"font-medium text-base",children:[Sa(ie.country_code)||""," ",ie.country_code]})]}),ie.user_agent&&(()=>{const ve=Dw(ie.user_agent);return a.jsxs(a.Fragment,{children:[a.jsxs("p",{className:"text-muted-foreground",children:["Browser: ",a.jsx("span",{className:"font-medium",children:ve.browser.fullName})]}),a.jsxs("p",{className:"text-muted-foreground",children:["OS: ",a.jsx("span",{className:"font-medium",children:ve.os.fullName})]}),ve.deviceModel&&a.jsxs("p",{className:"text-muted-foreground",children:["Model: ",a.jsx("span",{className:"font-medium",children:ve.deviceModel})]})]})})(),ie.mac_address&&a.jsxs("p",{className:"text-muted-foreground",children:["MAC: ",a.jsx("span",{className:"font-mono text-xs",children:ie.mac_address})]}),ie.last_ip_address&&a.jsxs("p",{className:"text-muted-foreground",children:["IP: ",a.jsx("span",{className:"font-mono text-xs",children:ie.last_ip_address})]})]})]},ie.id)})}),se>1&&a.jsxs("div",{className:"flex items-center justify-center gap-2 pt-4",children:[a.jsx(ce,{variant:"outline",size:"sm",onClick:()=>U(ie=>Math.max(1,ie-1)),disabled:I===1,children:"Previous"}),a.jsxs("span",{className:"text-sm text-muted-foreground px-4",children:["Page ",I," of ",se]}),a.jsx(ce,{variant:"outline",size:"sm",onClick:()=>U(ie=>Math.min(se,ie+1)),disabled:I===se,children:"Next"})]})]})}),M&&a.jsxs(ce,{onClick:ge,className:"fixed bottom-6 right-6 rounded-full shadow-lg z-50 h-12 w-12 p-0",size:"icon",variant:"default",children:[a.jsx(Ex,{className:"h-5 w-5"}),a.jsx("span",{className:"sr-only",children:"Back to top"})]})]})]})]})}),a.jsx(Xn,{open:!!w,onOpenChange:ie=>{ie||(x(null),R(!1),P(""))},children:a.jsxs(_n,{children:[a.jsxs(Nn,{children:[a.jsx(jn,{children:j?"Confirm Password":"Remove Device?"}),a.jsx(Tn,{children:j?a.jsxs(a.Fragment,{children:["For security, please enter your password to remove"," ",a.jsx("strong",{children:w?.device_name}),". This device will need to be re-authorized on next login."]}):a.jsxs(a.Fragment,{children:["Removing ",a.jsx("strong",{children:w?.device_name})," will revoke its access. You'll need to re-authorize this device the next time someone tries to log in from it. This action requires password confirmation."]})})]}),j&&a.jsx("div",{className:"space-y-2",children:a.jsx(hr,{type:"password",placeholder:"Enter your password",value:T,onChange:ie=>P(ie.target.value),onKeyDown:ie=>{ie.key==="Enter"&&Re()},autoFocus:!0})}),a.jsxs(kn,{children:[a.jsx(An,{children:"Cancel"}),a.jsx(mr,{onClick:async ie=>{if(!j){ie.preventDefault(),Re();return}await Re()},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:j?"Remove Device":"Continue"})]})]},j?"password":"confirm")}),a.jsx(Bc,{open:!!E,onOpenChange:ie=>!ie&&C(null),children:a.jsxs(ya,{children:[a.jsxs(wa,{children:[a.jsx(xa,{children:"Rename Device"}),a.jsx(zc,{children:"Give this device a friendly name to easily identify it."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx(hr,{placeholder:"Device name",value:b,onChange:ie=>k(ie.target.value),onKeyDown:ie=>{ie.key==="Enter"&&b.trim()&&Be()},autoFocus:!0}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx(ce,{variant:"outline",onClick:()=>C(null),children:"Cancel"}),a.jsx(ce,{onClick:Be,disabled:!b.trim(),children:"Save"})]})]})]})})]})},Ow=[{id:"additional-kid-monthly",name:"Additional Kid Monthly",price:"$2.99",priceValue:2.99,interval:"month",kidsSupported:1,stripeLink:"https://buy.stripe.com/7sYaEX4tHdms9b9fpqfQI05",description:"Add one more child to your account",allowQuantity:!0},{id:"additional-kid-annual",name:"Additional Kid Annual",price:"$29.99",priceValue:29.99,interval:"year",kidsSupported:1,stripeLink:"https://buy.stripe.com/14AdR94tH0zGdrpcdefQI06",description:"Add one more child (save 17% vs monthly)",allowQuantity:!0},{id:"family-bundle-monthly",name:"Family Bundle Monthly",price:"$14.99",priceValue:14.99,interval:"month",kidsSupported:5,stripeLink:"https://buy.stripe.com/aFa00j8JXciogDB3GIfQI07",description:"Perfect for families with up to 5 kids"},{id:"annual-family-plan",name:"Annual Family Plan",price:"$99",priceValue:99,interval:"year",kidsSupported:"unlimited",stripeLink:"https://buy.stripe.com/8x24gz7FT3LS5YXgtufQI08",description:"Best value - unlimited kids for the whole family",recommended:!0}],b$=()=>{const e=tt(),{toast:t}=Ct(),[n,s]=p.useState(!0),[i,l]=p.useState(0),[c,u]=p.useState(1),[f,h]=p.useState("free"),[g,v]=p.useState("active"),[w,x]=p.useState(!1),[E,C]=p.useState(!1),[b,k]=p.useState(null),[_,N]=p.useState(""),[j,R]=p.useState(!0),[T,P]=p.useState(!1),[O,G]=p.useState(!1),[L,F]=p.useState("");p.useEffect(()=>{I(),ia()?U():s(!1);const z=new URLSearchParams(window.location.search),$=z.get("session_id"),W=z.get("canceled");$?(t({title:"Payment Successful!",description:"Your subscription is being activated. Please wait a moment...",variant:"default"}),setTimeout(async()=>{ia()&&await U(),G(!0),F("Your subscription has been activated successfully!")},2e3),window.history.replaceState({},"","/parent/upgrade")):W&&(t({title:"Payment Cancelled",description:"Your payment was cancelled. You can try again anytime.",variant:"default"}),window.history.replaceState({},"","/parent/upgrade"))},[]);const I=async()=>{const{data:{session:z}}=await Y.auth.getSession();if(!z){e("/parent/auth");return}},U=async()=>{try{const{data:{user:z}}=await Y.auth.getUser();if(!z)return;const{data:$,error:W}=await Y.from("parents").select("email, allowed_children, subscription_type, subscription_status, subscription_expires_at").eq("id",z.id).single();if(W){if(W.code==="42703"||W.message?.includes("does not exist")){console.warn("Subscription columns don't exist yet. Migration not run:",W),t({title:"Database Migration Required",description:"Please run the subscription migration: supabase/migrations/20250122000007_add_subscription_system.sql",variant:"destructive",duration:1e4}),u(1),h("free"),N($?.email||""),s(!1);return}console.error("Error loading subscription:",W),t({title:"Error",description:"Failed to load subscription information",variant:"destructive"}),s(!1);return}const D=$?.allowed_children||1,Q=$?.subscription_type||"free",le=$?.subscription_status||"active",X=$?.subscription_expires_at;u(D),h(Q);const K=$?.email||z.email||"";N(K),v(le);const te=le==="active"&&(X===null||new Date(X)>new Date)&&Q!=="free";x(te);const{data:q,error:se}=await Y.from("children").select("id",{count:"exact"}).eq("parent_id",z.id);!se&&q&&l(q.length||0)}catch(z){console.error("Error loading subscription info:",z)}finally{s(!1)}},M=z=>{if(w&&f===z.id){t({title:"Current Plan",description:"You are already subscribed to this plan.",variant:"default"});return}k(z),C(!0)},B=async()=>{if(!b||!_.trim()){t({title:"Error",description:"Please enter your family account email",variant:"destructive"});return}P(!0);try{const{data:z,error:$}=await Y.functions.invoke("create-stripe-subscription",{body:{subscriptionType:b.id,quantity:1}});if($||!z?.success)throw new Error($?.message||z?.error||"Failed to create checkout session");const{url:W}=z;if(!W)throw new Error("No checkout URL returned from subscription creation");window.location.href=W}catch(z){console.error("Error processing payment:",z),t({title:"Payment Error",description:z.message||"Failed to process payment. Please try again.",variant:"destructive"})}finally{P(!1)}},V=async()=>{if(b)try{P(!0);let z=c;b.id==="annual-family-plan"?z=999:b.id==="family-bundle-monthly"?z=5:(b.id==="additional-kid-monthly"||b.id==="additional-kid-annual")&&(z=c+1);const{data:{user:$}}=await Y.auth.getUser();if(!$||$.email!==_.trim()){t({title:"Security Error",description:"Email must match your authenticated account. You can only upgrade your own account.",variant:"destructive"}),P(!1);return}const{data:W,error:D}=await Y.rpc("upgrade_family_subscription",{p_family_email:_.trim(),p_subscription_type:b.id,p_allowed_children:z,p_stripe_checkout_session_id:null});if(D)throw D.code==="PGRST202"||D.message?.includes("Could not find the function")?new Error("Database migration not run. Please run: supabase/migrations/20250122000007_add_subscription_system.sql"):D;if(W?.success)F(`Successfully upgraded! You can now add up to ${z===999?"unlimited":z} children.`),C(!1),G(!0),await U();else throw new Error(W?.error||"Failed to upgrade subscription")}catch(z){console.error("Error upgrading subscription:",z),t({title:"Upgrade Failed",description:z.message||"Failed to upgrade subscription. Please contact support.",variant:"destructive"})}finally{P(!1)}},ee=async()=>{await V()};return ia()?n?a.jsxs("div",{className:"min-h-[100dvh] bg-background w-full overflow-x-hidden",children:[a.jsx(Ot,{}),a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsx(cs,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]}):a.jsxs("div",{className:"min-h-[100dvh] bg-background w-full overflow-x-hidden",children:[a.jsx(Ot,{}),a.jsx(Lr,{role:"parent",pageKey:"parent_upgrade"}),a.jsx(Or,{role:"parent",pageKey:"parent_upgrade"}),a.jsx("div",{className:"px-4 pb-4",style:{paddingTop:"calc(0.5rem + 64px + var(--safe-area-inset-top) * 0.15)"},children:a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"mt-4 mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Upgrade Your Plan"}),a.jsx("p",{className:"text-muted-foreground",children:"Choose a plan that fits your family's needs"})]}),w&&a.jsx(Te,{className:"p-6 mb-8 bg-primary/10 border-primary/20",children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-primary mb-1",children:"Your Current Plan"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:[Ow.find(z=>z.id===f)?.name||f,f==="annual-family-plan"&&" - Unlimited children"]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm font-semibold text-primary",children:"Active Subscription"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:[i," /"," ",c===999?"":c," children"]})]})]})}),!w&&a.jsx(Te,{className:"p-6 mb-8 bg-muted/50",children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Current Plan"}),a.jsx("p",{className:"text-lg font-semibold capitalize",children:"Free Tier"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Children Added"}),a.jsxs("p",{className:"text-lg font-semibold",children:[i," / 1"]})]})]})}),a.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 mb-8","data-tour":"parent-upgrade-plans",children:Ow.map(z=>{const $=f===z.id,W=w&&(z.id==="annual-family-plan"||z.id==="family-bundle-monthly"&&f!=="annual-family-plan"&&f!=="family-bundle-monthly"||z.id.includes("additional")&&!f.includes("additional")),D=w&&f==="annual-family-plan"&&z.id!=="annual-family-plan";return a.jsxs(Te,{className:`p-6 relative ${$?"border-2 border-primary shadow-lg bg-primary/5":z.recommended?"border-2 border-primary/50 shadow-md":"border"}`,children:[z.recommended&&!$&&a.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:a.jsxs("span",{className:"bg-primary text-primary-foreground px-3 py-1 rounded-full text-xs font-semibold flex items-center gap-1",children:[a.jsx(Nc,{className:"h-3 w-3"}),"Best Value"]})}),$&&a.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:a.jsx("span",{className:"bg-primary text-primary-foreground px-3 py-1 rounded-full text-xs font-semibold",children:" Current Plan"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mb-1",children:z.name}),a.jsx("p",{className:"text-sm text-muted-foreground",children:z.description})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-baseline gap-1",children:[a.jsx("span",{className:"text-3xl font-bold",children:z.price}),a.jsxs("span",{className:"text-muted-foreground",children:["/",z.interval==="month"?"mo":"yr"]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(Jn,{className:"h-4 w-4 text-primary"}),a.jsx("span",{children:z.kidsSupported==="unlimited"?"Unlimited children":`Up to ${z.kidsSupported} ${z.kidsSupported===1?"child":"children"}`})]})]}),a.jsx(ce,{className:"w-full",variant:$?"secondary":z.recommended?"default":"outline",onClick:()=>M(z),disabled:T||$,children:T?a.jsxs(a.Fragment,{children:[a.jsx(cs,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):$?"Current Plan":W?"Upgrade":D?"Downgrade":"Select Plan"}),D&&a.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Note: Downgrading will reduce your child limit"})]})]},z.id)})}),a.jsx(Te,{className:"p-6 bg-blue-50 dark:bg-blue-950 border-blue-200 dark:border-blue-800",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Gs,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"font-semibold text-blue-900 dark:text-blue-100",children:"How It Works"}),a.jsxs("ul",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1 list-disc list-inside",children:[a.jsx("li",{children:"Select a plan and complete payment through Stripe"}),a.jsx("li",{children:"Enter your family account email to link the subscription"}),a.jsx("li",{children:"Your account will be upgraded automatically"}),a.jsx("li",{children:"Start adding more children right away!"})]})]})]})})]})}),a.jsx(Bc,{open:E,onOpenChange:C,children:a.jsxs(ya,{children:[a.jsxs(wa,{children:[a.jsx(xa,{children:"Complete Your Upgrade"}),a.jsx(zc,{children:"Enter your family account email to link this subscription to your account."})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Am,{htmlFor:"email",children:"Family Account Email"}),a.jsx(hr,{id:"email",type:"email",placeholder:"your-email@example.com",value:_,onChange:z=>N(z.target.value),disabled:T||j,readOnly:j,className:j?"bg-muted cursor-not-allowed":""}),j&&a.jsx("p",{className:"text-xs text-muted-foreground",children:"Email is locked to your authenticated account for security"})]}),b&&a.jsx(Te,{className:"p-4 bg-muted",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-sm font-semibold",children:b.name}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:[b.price,"/",b.interval==="month"?"month":"year"]})]})})]}),a.jsxs(Rh,{className:"flex-col sm:flex-row gap-2",children:[a.jsx(ce,{variant:"outline",onClick:()=>{C(!1),P(!1)},disabled:T,className:"w-full sm:w-auto",children:"Cancel"}),a.jsx(ce,{onClick:B,disabled:T||!_.trim(),className:"w-full sm:w-auto",children:T?a.jsxs(a.Fragment,{children:[a.jsx(cs,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Proceed to Payment"}),a.jsx(ce,{variant:"secondary",onClick:ee,disabled:T||!_.trim(),className:"w-full sm:w-auto",children:T?a.jsxs(a.Fragment,{children:[a.jsx(cs,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"I Already Paid"})]})]})}),a.jsx(Bc,{open:O,onOpenChange:G,children:a.jsxs(ya,{children:[a.jsxs(wa,{children:[a.jsx(xa,{children:"Upgrade Successful!"}),a.jsx(zc,{children:L})]}),a.jsx(Rh,{children:a.jsx(ce,{onClick:()=>{G(!1),e("/parent/dashboard")},children:"Go to Dashboard"})})]})})]}):a.jsxs("div",{className:"min-h-[100dvh] bg-background w-full overflow-x-hidden",children:[a.jsx(Ot,{}),a.jsx("div",{className:"flex items-center justify-center min-h-[60vh] px-4",children:a.jsxs(Te,{className:"p-8 max-w-md text-center",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"In-App Purchases"}),a.jsx("p",{className:"text-muted-foreground mb-4",children:"This app uses in-app purchases through the App Store or Play Store. Please upgrade your subscription through your device's app store."}),a.jsx(ce,{onClick:()=>e("/parent/dashboard"),children:"Go to Dashboard"})]})})]})},C$=()=>{const e=tt(),{toast:t}=Ct(),[n,s]=p.useState(!0),[i,l]=p.useState(null),[c,u]=p.useState(null),[f,h]=p.useState(null),[g,v]=p.useState("free"),[w,x]=p.useState("active"),[E,C]=p.useState(null),[b,k]=p.useState(1),[_,N]=p.useState(0),[j,R]=p.useState(!1),[T,P]=p.useState(!1);p.useEffect(()=>{O(),G()},[]);const O=async()=>{const{data:{session:F}}=await Y.auth.getSession();if(!F){e("/parent/auth");return}},G=async()=>{try{const{data:{user:F}}=await Y.auth.getUser();if(!F)return;const{data:I,error:U}=await Y.from("parents").select("name, email, family_code, subscription_type, subscription_status, subscription_expires_at, allowed_children").eq("id",F.id).single();if(U){if(U.code==="42703"||U.message?.includes("does not exist")){console.warn("Subscription columns don't exist yet. Migration not run:",U),I&&(l(I?.name||null),u(I?.email||null),h(I?.family_code||null)),v("free"),k(1),s(!1);return}console.error("Error loading account info:",U),t({title:"Error",description:"Failed to load account information",variant:"destructive"}),s(!1);return}l(I?.name||null),u(I?.email||null),h(I?.family_code||null),v(I?.subscription_type||"free"),x(I?.subscription_status||"active"),C(I?.subscription_expires_at||null),k(I?.allowed_children||1);const{data:M}=await Y.from("children").select("id",{count:"exact"}).eq("parent_id",F.id);M&&N(M.length||0)}catch(F){console.error("Error loading account info:",F),t({title:"Error",description:"Failed to load account information",variant:"destructive"})}finally{s(!1)}},L=async()=>{P(!0);try{const{data:{user:F}}=await Y.auth.getUser();if(!F){t({title:"Error",description:"Not authenticated",variant:"destructive"});return}const{data:I,error:U}=await Y.rpc("cancel_subscription",{p_parent_id:F.id,p_cancel_reason:"User requested cancellation"});if(U)throw U;if(I?.success)t({title:"Subscription Cancelled",description:I.message||"Your subscription has been cancelled. Access will continue until expiration."}),R(!1),await G();else throw new Error(I?.error||"Failed to cancel subscription")}catch(F){console.error("Error cancelling subscription:",F),t({title:"Cancellation Failed",description:F.message||"Failed to cancel subscription. Please contact support.",variant:"destructive"})}finally{P(!1)}};return n?a.jsxs("div",{className:"min-h-[100dvh] bg-background w-full overflow-x-hidden",children:[a.jsx(Ot,{}),a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsx(cs,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]}):a.jsxs("div",{className:"min-h-[100dvh] bg-background w-full overflow-x-hidden",children:[a.jsx(Ot,{}),a.jsx(Lr,{role:"parent",pageKey:"parent_settings"}),a.jsx(Or,{role:"parent",pageKey:"parent_settings"}),a.jsx("div",{className:"px-4 pb-4",style:{paddingTop:"calc(0.5rem + 64px + var(--safe-area-inset-top) * 0.15)"},children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"mt-4 mb-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(jx,{className:"h-6 w-6"}),a.jsx("h1",{className:"text-3xl font-bold",children:"Account Settings"})]}),a.jsx("p",{className:"text-muted-foreground",children:"Manage your account and subscription"})]}),a.jsxs(Te,{className:"p-6 mb-6","data-tour":"parent-settings-account",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Account Information"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Name"}),a.jsx("p",{className:"text-base font-medium",children:i||"Not set"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Email"}),a.jsx("p",{className:"text-base font-medium",children:c||"Not set"})]}),f&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Family Code"}),a.jsx("p",{className:"text-base font-mono font-bold",children:f})]})]})]}),a.jsxs(Te,{className:"p-6 mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Subscription"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Current Plan"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("p",{className:"text-base font-medium capitalize",children:g==="free"?"Free":g}),g!=="free"&&w==="active"&&a.jsx(Nc,{className:"h-4 w-4 text-primary"}),w==="cancelled"&&a.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-1 rounded",children:"Cancelled"}),w==="expired"&&a.jsx("span",{className:"text-xs bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 px-2 py-1 rounded",children:"Expired"})]}),w==="cancelled"&&E&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Access until: ",new Date(E).toLocaleDateString()]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Children Limit"}),a.jsxs("p",{className:"text-base font-medium",children:[_," /"," ",b===999?" Unlimited":b]})]}),g!=="free"&&w==="active"&&a.jsx("div",{className:"pt-2 border-t",children:a.jsxs(ce,{variant:"outline",onClick:()=>R(!0),className:"w-full",children:[a.jsx(Rr,{className:"mr-2 h-4 w-4"}),"Cancel Subscription"]})})]})]}),(g==="free"||w==="expired"||w==="cancelled")&&a.jsx(Te,{className:"p-6 bg-gradient-to-br from-primary/10 to-primary/5 border-primary/20",children:a.jsx("div",{className:"flex items-start gap-4",children:a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Gs,{className:"h-5 w-5 text-primary"}),a.jsx("h2",{className:"text-xl font-semibold",children:w==="cancelled"?"Resubscribe":"Upgrade Your Plan"})]}),a.jsx("p",{className:"text-muted-foreground mb-4",children:w==="cancelled"?"Your subscription is cancelled but you still have access. Resubscribe to continue after expiration.":"Unlock more features and add more children to your account. Choose from flexible monthly or annual plans."}),a.jsxs(ce,{onClick:()=>e("/parent/upgrade"),className:"w-full sm:w-auto","data-tour":"parent-settings-upgrade",children:[w==="cancelled"?"Resubscribe":"View Plans",a.jsx(uk,{className:"ml-2 h-4 w-4"})]})]})})})]})}),a.jsx(Xn,{open:j,onOpenChange:R,children:a.jsxs(_n,{children:[a.jsxs(Nn,{children:[a.jsx(jn,{children:"Cancel Subscription"}),a.jsxs(Tn,{children:["Are you sure you want to cancel your subscription? You'll continue to have access until"," ",E?new Date(E).toLocaleDateString():"the end of your billing period",". After that, your account will revert to the free tier (1 child limit).",_>1&&a.jsxs("span",{className:"block mt-2 font-semibold text-yellow-600 dark:text-yellow-400",children:["Note: You currently have ",_," children. After expiration, you won't be able to add more children, but existing children can still use the app."]})]})]}),a.jsxs(kn,{children:[a.jsx(An,{disabled:T,children:"Keep Subscription"}),a.jsx(mr,{onClick:L,disabled:T,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:T?a.jsxs(a.Fragment,{children:[a.jsx(cs,{className:"mr-2 h-4 w-4 animate-spin"}),"Cancelling..."]}):"Yes, Cancel Subscription"})]})]})})]})},XE="kidscallhome_authorized_devices";function ep(){try{const e=localStorage.getItem(XE);return e?JSON.parse(e):[]}catch{return[]}}function S$(e){try{localStorage.setItem(XE,JSON.stringify(e))}catch(t){console.warn("Failed to save authorized devices:",t)}}function E$(e){const t=ii();return ep().some(s=>s.deviceId===t&&s.childId===e)}function Lw(e){const t=ii(),n=ep(),s=n.findIndex(l=>l.deviceId===t&&l.childId===e);s>=0?n[s].authorizedAt=new Date().toISOString():n.push({deviceId:t,childId:e,authorizedAt:new Date().toISOString()});const i=n.filter(l=>l.childId===e);i.length>10&&(i.sort((c,u)=>new Date(c.authorizedAt).getTime()-new Date(u.authorizedAt).getTime()),i.slice(0,i.length-10).forEach(c=>{const u=n.findIndex(f=>f.deviceId===c.deviceId&&f.childId===c.childId);u>=0&&n.splice(u,1)})),S$(n)}function Mw(){const e=ii(),n=ep().filter(s=>s.deviceId===e);return n.length===0?null:(n.sort((s,i)=>new Date(i.authorizedAt).getTime()-new Date(s.authorizedAt).getTime()),n[0].childId)}const vc=[{name:"red",color:"#EF4444"},{name:"blue",color:"#3B82F6"},{name:"green",color:"#10B981"},{name:"yellow",color:"#FBBF24"},{name:"orange",color:"#F97316"},{name:"purple",color:"#A855F7"},{name:"pink",color:"#EC4899"},{name:"brown",color:"#92400E"},{name:"black",color:"#1F2937"},{name:"white",color:"#F3F4F6"}],$w=[{name:"cat",emoji:""},{name:"dog",emoji:""},{name:"bird",emoji:""},{name:"fish",emoji:""},{name:"bear",emoji:""},{name:"lion",emoji:""},{name:"tiger",emoji:""},{name:"elephant",emoji:""},{name:"monkey",emoji:""},{name:"rabbit",emoji:""},{name:"horse",emoji:""},{name:"duck",emoji:""},{name:"cow",emoji:""},{name:"pig",emoji:""},{name:"sheep",emoji:""}],Lo=[{id:0,label:"A-I",chars:["A","B","C","D","E","F","G","H","I"]},{id:1,label:"J-R",chars:["J","K","L","M","N","O","P","Q","R"]},{id:2,label:"S-Z",chars:["S","T","U","V","W","X","Y","Z"]},{id:3,label:"0-9",chars:["0","1","2","3","4","5","6","7","8","9"]}],_$=()=>{const[e]=L0(),[t,n]=p.useState("familyCode"),[s,i]=p.useState(""),[l,c]=p.useState(0),[u,f]=p.useState("color"),[h,g]=p.useState(""),[v,w]=p.useState(""),[x,E]=p.useState(!1),[C,b]=p.useState(null),[k,_]=p.useState(!1),N=tt(),{toast:j}=Ct(),R=p.useRef(null),T=p.useRef(0),P=p.useRef(0),O=p.useRef(0),G=p.useRef(!1),L=p.useRef(0),F=p.useRef(0),I=async X=>{E(!0);try{const K=X.split("-");let te=X;if(K.length===3){const[fe,ge,we]=K;te=`${fe.toUpperCase()}-${ge.toLowerCase()}-${we}`}const{data:q,error:se}=await Y.from("children").select("id, name, avatar_color, parent_id").eq("login_code",te).maybeSingle();if(se){console.error("Login error:",se),console.error("Error details:",JSON.stringify(se,null,2)),console.error("Attempted code:",te),j({title:"Login error",description:se.message||"Failed to verify login code. Please try again.",variant:"destructive"}),w(""),i(""),n("familyCode"),E(!1);return}if(!q){console.error("No data returned for code:",te),j({title:"Code not found",description:"Please check your code and try again",variant:"destructive"}),w(""),i(""),n("familyCode"),E(!1);return}if(b(q),n("success"),localStorage.setItem("childSession",JSON.stringify(q)),k||Lw(q.id),q.parent_id)try{const{generateDeviceIdentifierAsync:fe,detectDeviceType:ge,getDeviceName:we,getClientIP:Re,getDeviceMacAddress:Be,getCountryFromIP:We}=await gr(async()=>{const{generateDeviceIdentifierAsync:wt,detectDeviceType:at,getDeviceName:ht,getClientIP:He,getDeviceMacAddress:$e,getCountryFromIP:Mt}=await Promise.resolve().then(()=>Oh);return{generateDeviceIdentifierAsync:wt,detectDeviceType:at,getDeviceName:ht,getClientIP:He,getDeviceMacAddress:$e,getCountryFromIP:Mt}},void 0),Ge=await fe(),ie=ge(),Pe=we(),ae=navigator.userAgent,ve=await Re(),_e=await Be(),Ue=await We(ve);console.log(" [DEVICE TRACKING] Attempting to track device:",{parent_id:q.parent_id,child_id:q.id,device_identifier:Ge,device_type:ie,device_name:Pe,is_native:Ge.startsWith("native-")||Ge.startsWith("cordova-")||Ge.startsWith("mac-"),mac_address:_e||"not available",country_code:Ue||"not available"});let{data:ft,error:Je}=await Y.rpc("update_device_login",{p_parent_id:q.parent_id,p_device_identifier:Ge,p_device_name:Pe,p_device_type:ie,p_user_agent:ae,p_ip_address:ve||null,p_mac_address:_e||null,p_country_code:Ue||null,p_child_id:q.id});if(Je&&(Je.code==="42883"||Je.message?.includes("function")||Je.message?.includes("does not exist"))){console.warn(" [DEVICE TRACKING] Function signature mismatch, trying without country_code:",Je.message);const wt=await Y.rpc("update_device_login",{p_parent_id:q.parent_id,p_device_identifier:Ge,p_device_name:Pe,p_device_type:ie,p_user_agent:ae,p_ip_address:ve||null,p_mac_address:_e||null,p_child_id:q.id});if(wt.error)throw console.error(" [DEVICE TRACKING] Error (fallback also failed):",wt.error),wt.error;ft=wt.data,Je=null,console.log(" [DEVICE TRACKING] Device tracked successfully (without country_code):",ft)}else{if(Je)throw console.error(" [DEVICE TRACKING] Error:",Je),Je;console.log(" [DEVICE TRACKING] Device tracked successfully:",ft)}}catch(fe){console.error(" [DEVICE TRACKING] Failed to track device:",fe)}setTimeout(()=>{N("/child/dashboard")},2e3)}catch(K){console.error("Login exception:",K),j({title:"Error",description:K.message||"An error occurred during login",variant:"destructive"}),n("familyCode"),E(!1)}};p.useEffect(()=>{(async()=>{const K=Mw();if(K&&E$(K)){const te=localStorage.getItem("childSession");if(te)try{if(JSON.parse(te).id===K){N("/child/dashboard");return}}catch{}try{const{data:q}=await Y.from("children").select("login_code").eq("id",K).maybeSingle();if(q?.login_code){const se=q.login_code.split("-");if(se.length===3){const[,fe,ge]=se;g(fe),w(ge);const we=vc.some(Re=>Re.name===fe);f(we?"color":"animal"),_(!0),n("select")}}}catch(q){console.warn("Failed to fetch child data for authorized device:",q)}}})()},[N]),p.useEffect(()=>{const X=e.get("code");if(X&&X.trim()!==""&&t==="familyCode"){const K=decodeURIComponent(X.trim()),te=K.split("-");if(te.length===3){const[q,se,fe]=te;if(q&&se&&fe&&q.length>0&&se.length>0&&fe.length>0){i(q.toUpperCase()),g(se),w(fe);const ge=vc.some(we=>we.name===se);f(ge?"color":"animal"),_(!1),setTimeout(()=>{I(K)},500)}else j({title:"Invalid login code",description:"The login code format is incorrect. Please check and try again.",variant:"destructive"})}else j({title:"Invalid login code",description:"The login code format is incorrect. Expected: familyCode-color/animal-number",variant:"destructive"})}},[e]);const U=(X,K)=>{g(X),f(K),n("number")},M=X=>{const K=v+X;K.length<=2&&parseInt(K)<=99&&w(K)},B=()=>{w(v.slice(0,-1))},V=()=>{t==="number"?(n("select"),w("")):t==="select"&&(n("familyCode"),g(""))},ee=()=>{if(!s||s.trim().length<3){j({title:"Family code required",description:"Please enter your family code (6 characters)",variant:"destructive"});return}n("select")},z=X=>{const K=X.toUpperCase().replace(/[^A-Z0-9]/g,"").slice(0,6);i(K)},$=X=>{X>=0&&X<Lo.length&&c(X)},W=X=>{if(G.current)return;T.current=X.touches[0].clientX,O.current=Date.now();const K=X.target;console.log(" [SWIPE] Start:",{x:T.current,target:K.tagName,isButton:K.closest("button")!==null})},D=X=>{T.current!==0&&(P.current=X.touches[0].clientX)},Q=X=>{if(T.current===0||P.current===0)return;const K=T.current-P.current,te=Date.now()-O.current,q=30,se=600;console.log(" [SWIPE] End:",{distance:Math.abs(K),duration:te,startX:T.current,endX:P.current,buttonFlag:G.current,meetsDistance:Math.abs(K)>q,meetsDuration:te<se}),Math.abs(K)>q&&te<se&&T.current!==0&&P.current!==0&&(!G.current||Math.abs(K)>50)&&(K>0?(console.log(" [SWIPE] Moving to next block"),$(Math.min(l+1,Lo.length-1))):(console.log(" [SWIPE] Moving to previous block"),$(Math.max(l-1,0)))),T.current=0,P.current=0,O.current=0},le=async()=>{let X;if(k&&h&&v){const K=Mw();if(K)try{const{data:te}=await Y.from("children").select("login_code").eq("id",K).maybeSingle();if(te?.login_code)X=te.login_code;else{j({title:"Error",description:"Could not find your login code. Please enter your family code.",variant:"destructive"}),n("familyCode"),_(!1);return}}catch{j({title:"Error",description:"Could not verify your login code. Please enter your family code.",variant:"destructive"}),n("familyCode"),_(!1);return}else{j({title:"Incomplete code",description:"Please enter your family code, select a color/animal, and enter your number",variant:"destructive"});return}}else{if(!s||!h||!v){j({title:"Incomplete code",description:"Please enter your family code, select a color/animal, and enter your number",variant:"destructive"});return}X=`${s.toUpperCase()}-${h}-${v}`}E(!0);try{const{data:K,error:te}=await Y.from("children").select("id, name, avatar_color, parent_id").eq("login_code",X).single();if(te||!K){j({title:"Code not found",description:"Please check your code and try again",variant:"destructive"}),w("");return}if(b(K),n("success"),localStorage.setItem("childSession",JSON.stringify(K)),k||Lw(K.id),K.parent_id)try{const{generateDeviceIdentifierAsync:q,detectDeviceType:se,getDeviceName:fe,getClientIP:ge,getDeviceMacAddress:we,getCountryFromIP:Re}=await gr(async()=>{const{generateDeviceIdentifierAsync:ft,detectDeviceType:Je,getDeviceName:wt,getClientIP:at,getDeviceMacAddress:ht,getCountryFromIP:He}=await Promise.resolve().then(()=>Oh);return{generateDeviceIdentifierAsync:ft,detectDeviceType:Je,getDeviceName:wt,getClientIP:at,getDeviceMacAddress:ht,getCountryFromIP:He}},void 0),Be=await q(),We=se(),Ge=fe(),ie=navigator.userAgent,Pe=await ge(),ae=await we(),ve=await Re(Pe);console.log(" [DEVICE TRACKING] Attempting to track device:",{parent_id:K.parent_id,child_id:K.id,device_identifier:Be,device_type:We,device_name:Ge,is_native:Be.startsWith("native-")||Be.startsWith("cordova-")||Be.startsWith("mac-"),mac_address:ae||"not available",country_code:ve||"not available"});let{data:_e,error:Ue}=await Y.rpc("update_device_login",{p_parent_id:K.parent_id,p_device_identifier:Be,p_device_name:Ge,p_device_type:We,p_user_agent:ie,p_ip_address:Pe||null,p_mac_address:ae||null,p_country_code:ve||null,p_child_id:K.id});if(Ue&&(Ue.code==="42883"||Ue.message?.includes("function")||Ue.message?.includes("does not exist"))){console.warn(" [DEVICE TRACKING] Function signature mismatch, trying without country_code:",Ue.message);const ft=await Y.rpc("update_device_login",{p_parent_id:K.parent_id,p_device_identifier:Be,p_device_name:Ge,p_device_type:We,p_user_agent:ie,p_ip_address:Pe||null,p_mac_address:ae||null,p_child_id:K.id});if(ft.error)throw console.error(" [DEVICE TRACKING] Error (fallback also failed):",ft.error),ft.error;_e=ft.data,Ue=null,console.log(" [DEVICE TRACKING] Device tracked successfully (without country_code):",_e)}else{if(Ue)throw console.error(" [DEVICE TRACKING] Error:",Ue),Ue;console.log(" [DEVICE TRACKING] Device tracked successfully:",_e)}}catch(q){console.error(" [DEVICE TRACKING] Failed to track device:",q)}setTimeout(()=>{N("/child/dashboard")},2e3)}catch(K){j({title:"Error",description:K.message,variant:"destructive"}),w("")}finally{E(!1)}};if(t==="success"&&C)return a.jsx("div",{className:"min-h-[100dvh] flex items-center justify-center bg-primary/5 p-4",children:a.jsx(Te,{className:"w-full max-w-md p-8 space-y-6 text-center",children:a.jsxs("div",{className:"space-y-4 animate-bounce",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"w-24 h-24 rounded-full flex items-center justify-center text-4xl font-bold text-white shadow-lg",style:{backgroundColor:C.avatar_color},children:C.name[0].toUpperCase()})}),a.jsxs("div",{className:"flex justify-center gap-2",children:[a.jsx(Gs,{className:"h-8 w-8 text-yellow-500 animate-pulse"}),a.jsxs("h1",{className:"text-4xl font-bold text-primary",children:["Welcome, ",C.name,"!"]}),a.jsx(Gs,{className:"h-8 w-8 text-yellow-500 animate-pulse"})]}),a.jsx("p",{className:"text-xl text-muted-foreground",children:"You're all set! "})]})})});if(t==="number"){const X=u==="color"?vc.find(K=>K.name===h):$w.find(K=>K.name===h);return a.jsx("div",{className:"min-h-[100dvh] flex items-center justify-center bg-primary/5 p-4",children:a.jsxs(Te,{className:"w-full max-w-md p-8 space-y-6",children:[a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx(ce,{variant:"ghost",onClick:V,className:"absolute top-4 left-4",children:" Back"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[u==="color"&&X?a.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-primary",style:{backgroundColor:X.color}}):X?a.jsx("div",{className:"text-6xl",children:X.emoji}):null,a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold capitalize",children:h}),a.jsxs("p",{className:"text-muted-foreground",children:["Family: ",a.jsx("span",{className:"font-mono font-semibold",children:s})]}),a.jsx("p",{className:"text-muted-foreground",children:"Now enter your number"})]})]})]}),a.jsx("div",{className:"bg-muted p-6 rounded-2xl",children:a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx("div",{className:"w-32 h-20 rounded-xl bg-card flex items-center justify-center border-2 border-primary/20",children:a.jsx("span",{className:"text-5xl font-bold text-primary",children:v||"?"})})})}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[[1,2,3,4,5,6,7,8,9].map(K=>a.jsx(ce,{onClick:()=>M(K.toString()),size:"lg",variant:"outline",className:"h-16 text-2xl font-bold rounded-xl",children:K},K)),a.jsxs(ce,{onClick:B,size:"lg",variant:"outline",className:"h-16 rounded-xl col-span-2",disabled:!v,children:[a.jsx(Jv,{className:"h-6 w-6 mr-2"}),"Delete"]}),a.jsx(ce,{onClick:()=>M("0"),size:"lg",variant:"outline",className:"h-16 text-2xl font-bold rounded-xl",children:"0"})]}),a.jsx(ce,{onClick:le,disabled:!v||x,size:"lg",className:"w-full text-xl h-14 rounded-xl",children:x?"Checking...":"Go!"})]})})}if(t==="familyCode"){const X=Lo[l],K=l===0,te=l===Lo.length-1;return a.jsx("div",{className:"min-h-[100dvh] flex items-center justify-center bg-primary/5 p-4",children:a.jsxs(Te,{className:"w-full max-w-md p-6 space-y-3",children:[a.jsxs("div",{className:"text-center space-y-2",children:[a.jsx(ty,{className:"h-16 w-16 text-primary mx-auto"}),a.jsx("h1",{className:"text-3xl font-bold text-primary",children:"Hi There!"}),a.jsx("p",{className:"text-lg",children:"Enter your family code"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Ask a parent for your 6-character family code"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"bg-muted p-4 rounded-2xl",children:a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"w-full max-w-xs h-16 rounded-xl bg-card flex items-center justify-center border-2 border-primary/20",children:a.jsx("span",{className:"text-3xl font-bold text-primary font-mono tracking-wider",children:s||"______"})})})}),a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx(ce,{onClick:()=>$(l-1),disabled:K,variant:"outline",size:"sm",className:"flex-shrink-0","aria-label":"Previous block",children:a.jsx(Nx,{className:"h-5 w-5"})}),a.jsx("div",{className:"flex items-center gap-2 flex-1 justify-center",children:Lo.map((q,se)=>a.jsx("button",{onClick:()=>$(se),className:`transition-all duration-200 rounded-full ${se===l?"w-3 h-3 bg-primary scale-125":"w-2 h-2 bg-muted-foreground/30 hover:bg-muted-foreground/50"}`,"aria-label":`Go to ${q.label} block`,"aria-current":se===l?"true":"false"},q.id))}),a.jsx(ce,{onClick:()=>$(l+1),disabled:te,variant:"outline",size:"sm",className:"flex-shrink-0","aria-label":"Next block",children:a.jsx(Xh,{className:"h-5 w-5"})})]}),a.jsx("div",{className:"text-center -mt-1",children:a.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:X.label})}),a.jsxs("div",{ref:R,className:"relative overflow-hidden",style:{touchAction:"pan-x"},children:[a.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-16 z-0 pointer-events-auto",onTouchStart:W,onTouchMove:D,onTouchEnd:q=>Q()}),a.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-16 z-0 pointer-events-auto",onTouchStart:W,onTouchMove:D,onTouchEnd:q=>Q()}),a.jsx("div",{className:"relative z-10",onTouchStart:W,onTouchMove:D,onTouchEnd:q=>Q(),children:Lo.map((q,se)=>a.jsxs("div",{className:`grid grid-cols-3 gap-3 transition-all duration-300 ease-in-out ${se===l?"opacity-100 translate-x-0 pointer-events-auto":se<l?"opacity-0 -translate-x-full absolute inset-0 pointer-events-none":"opacity-0 translate-x-full absolute inset-0 pointer-events-none"}`,children:[q.chars.map(fe=>a.jsx(ce,{onClick:()=>z(s+fe),onTouchStart:ge=>{L.current=ge.touches[0].clientX,F.current=Date.now()},onTouchMove:ge=>{Math.abs(ge.touches[0].clientX-L.current)>10?G.current=!1:G.current=!0},onTouchEnd:ge=>{const we=Math.abs(ge.changedTouches[0].clientX-L.current),Re=Date.now()-F.current;we<10&&Re<300?(G.current=!0,setTimeout(()=>{G.current=!1},100)):G.current=!1},onTouchCancel:ge=>{G.current=!1,L.current=0,F.current=0},size:"lg",variant:"outline",className:"h-14 sm:h-16 text-xl sm:text-2xl font-bold rounded-xl hover:bg-primary hover:text-primary-foreground transition-all active:scale-95 border-2 pointer-events-auto relative z-10",disabled:s.length>=6,"aria-label":`Enter ${fe}`,style:{touchAction:"manipulation",WebkitTouchCallout:"none",WebkitUserSelect:"none"},children:fe},fe)),q.chars.length%3===1&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"col-span-1"}),a.jsx("div",{className:"col-span-1"})]}),q.chars.length%3===2&&a.jsx("div",{className:"col-span-1"})]},q.id))})]}),a.jsxs("div",{className:"space-y-2 -mt-1",children:[a.jsxs(ce,{onClick:()=>i(s.slice(0,-1)),size:"lg",variant:"outline",className:"w-full h-11 rounded-xl",disabled:!s,children:[a.jsx(Jv,{className:"h-4 w-4 mr-2"}),"Delete"]}),a.jsx(ce,{onClick:ee,disabled:s.length<3||x,size:"lg",className:"w-full text-lg h-11 rounded-xl",children:x?"Checking...":"Next"})]})]})]})})}return a.jsx("div",{className:"min-h-[100dvh] flex items-center justify-center bg-primary/5 p-4",children:a.jsxs(Te,{className:"w-full max-w-2xl p-8 space-y-6",children:[a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx(ce,{variant:"ghost",onClick:V,className:"absolute top-4 left-4",children:" Back"}),a.jsx(ty,{className:"h-20 w-20 text-primary mx-auto"}),a.jsx("h1",{className:"text-4xl font-bold text-primary",children:"Hi There!"}),a.jsxs("p",{className:"text-xl",children:["Family Code: ",a.jsx("span",{className:"font-mono font-bold text-primary",children:s})]}),a.jsx("p",{className:"text-lg",children:"Pick your color or animal"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(ce,{variant:u==="color"?"default":"outline",onClick:()=>f("color"),className:"flex-1",size:"lg",children:"Colors"}),a.jsx(ce,{variant:u==="animal"?"default":"outline",onClick:()=>f("animal"),className:"flex-1",size:"lg",children:"Animals"})]}),u==="color"?a.jsx("div",{className:"grid grid-cols-5 gap-3",children:vc.map(X=>a.jsx("button",{onClick:()=>U(X.name,"color"),className:"h-20 rounded-xl border-2 border-transparent hover:border-primary transition-all flex items-center justify-center hover:scale-105",style:{backgroundColor:X.color},children:a.jsx("span",{className:"text-white font-bold text-sm capitalize drop-shadow-lg",children:X.name})},X.name))}):a.jsx("div",{className:"grid grid-cols-5 gap-3",children:$w.map(X=>a.jsxs("button",{onClick:()=>U(X.name,"animal"),className:"h-20 rounded-xl border-2 border-transparent hover:border-primary transition-all flex flex-col items-center justify-center hover:scale-105 hover:bg-muted",children:[a.jsx("span",{className:"text-3xl",children:X.emoji}),a.jsx("span",{className:"text-xs font-medium capitalize mt-1",children:X.name})]},X.name))})]})]})})};function Gc({userId:e,userType:t,name:n,enabled:s=!0}){const i=p.useRef(null),l=p.useRef(null),c=p.useRef(!1);p.useEffect(()=>{if(!s||!e)return;const u=`presence:${t}:${e}`,f=Y.channel(u,{config:{presence:{key:e}}}),h={userId:e,userType:t,name:n,lastSeen:new Date().toISOString()};f.on("presence",{event:"sync"},()=>{}).subscribe(async w=>{w==="SUBSCRIBED"?(c.current=!0,await f.track(h),l.current=setInterval(()=>{c.current&&i.current&&i.current.track({...h,lastSeen:new Date().toISOString()})},6e4)):w==="CHANNEL_ERROR"||w==="TIMED_OUT"?(c.current=!1,console.error(" [PRESENCE] Presence channel error",{status:w,channelName:u,userId:e})):w==="CLOSED"&&(c.current=!1)}),i.current=f;const g=()=>{document.hidden||i.current&&c.current&&i.current.track({...h,lastSeen:new Date().toISOString()})};document.addEventListener("visibilitychange",g);const v=()=>{i.current&&i.current.untrack()};return window.addEventListener("beforeunload",v),()=>{i.current&&(i.current.untrack(),Y.removeChannel(i.current)),l.current&&clearInterval(l.current),document.removeEventListener("visibilitychange",g),window.removeEventListener("beforeunload",v),c.current=!1,i.current=null}},[e,t,n,s])}function ZE({parentId:e,enabled:t=!0,onStatusChange:n}){const[s,i]=p.useState({isOnline:!1,lastSeen:null}),l=p.useRef(null),c=p.useRef(n);return p.useEffect(()=>{c.current=n},[n]),p.useEffect(()=>{if(!t||!e)return;const u=`presence:parent:${e}`,f=Y.channel(u,{config:{presence:{key:e}}});return f.on("presence",{event:"sync"},()=>{const h=f.presenceState(),g=e in h&&Array.isArray(h[e])&&h[e].length>0,v=h[e],w=v&&v.length>0?v[0]:void 0,x=g?w?.lastSeen||new Date().toISOString():null;i(E=>{const C=E.isOnline,b=E.lastSeen||null;if(C===g&&b===x)return E;const k={isOnline:g,lastSeen:x||b};return C!==g&&c.current&&E.lastSeen!==null&&c.current(g),k})}).on("presence",{event:"join"},({key:h,newPresences:g})=>{if(h!==e)return;const v=g[0];i(w=>{const x=w.isOnline,E={isOnline:!0,lastSeen:v?.lastSeen||new Date().toISOString()};return!x&&c.current&&c.current(!0),E})}).on("presence",{event:"leave"},({key:h,leftPresences:g})=>{h===e&&i(v=>{const w=v.isOnline,x={isOnline:!1,lastSeen:v.lastSeen||new Date().toISOString()};return w&&c.current&&c.current(!1),x})}).subscribe((h,g)=>{h==="SUBSCRIBED"?setTimeout(()=>{const v=f.presenceState();if(e in v&&Array.isArray(v[e])&&v[e].length>0){const x=v[e],E=x&&x.length>0?x[0]:void 0;i({isOnline:!0,lastSeen:E?.lastSeen||new Date().toISOString()})}},500):(h==="CHANNEL_ERROR"||h==="TIMED_OUT")&&console.error(" [PARENT PRESENCE] Subscription error",{parentId:e,status:h,error:g})}),l.current=f,()=>{l.current&&(Y.removeChannel(l.current),l.current=null)}},[e,t]),{isOnline:s.isOnline,lastSeen:s.lastSeen}}const N$=()=>{const[e,t]=p.useState(null),[n,s]=p.useState(null),[i,l]=p.useState("Parent"),[c,u]=p.useState(null),f=p.useRef("Parent"),h=SC(e?.id||null),g=Bm(e?.id||null),v=p.useRef(null),w=p.useRef(null),x=p.useRef(!1),E=tt(),C=gn(),{toast:b}=Ct(),{handleIncomingCall:k,stopIncomingCall:_}=Jm({enabled:!0,volume:.7}),N=p.useRef(k);p.useEffect(()=>{const G=localStorage.getItem("childSession");if(!G){E("/child/login");return}const L=JSON.parse(G);t(L);const F=localStorage.getItem("selectedParentId");F&&u(F),(async()=>{try{let V;if(F)V=F;else{const{data:$,error:W}=await Y.from("children").select("parent_id").eq("id",L.id).single();if(W||!$){console.error("Error fetching child record:",W);return}V=$.parent_id,u(V)}const{data:ee,error:z}=await Y.from("parents").select("name").eq("id",V).maybeSingle();if(z){console.error("Error fetching parent name:",z);return}ee?.name?(l(ee.name),f.current=ee.name):(l("Parent"),f.current="Parent")}catch(V){console.error("Error fetching parent name:",V)}})();let U=null,M=null;return(async()=>{const V=async $=>{$.id!==U&&(C.pathname.startsWith("/call/")||(U=$.id,s({id:$.id,parent_id:$.parent_id}),N.current({callId:$.id,callerName:f.current,callerId:$.parent_id,url:`/call/${L.id}?callId=${$.id}`})))},ee=async()=>{const $=new Date(Date.now()-12e4).toISOString(),{data:W}=await Y.from("calls").select("*").eq("child_id",L.id).eq("caller_type","parent").eq("status","ringing").gte("created_at",$).order("created_at",{ascending:!1}).limit(1);if(W&&W.length>0){const D=W[0];D.id!==U&&await V(D)}},z=async()=>{const $=new Date(Date.now()-6e4).toISOString(),{data:W}=await Y.from("calls").select("*").eq("child_id",L.id).eq("caller_type","parent").eq("status","ringing").gte("created_at",$).order("created_at",{ascending:!1}).limit(1);if(W&&W.length>0){const D=W[0];D.id!==U&&await V(D)}};await ee(),M=setInterval(z,6e4),w.current=Y.channel("child-incoming-calls").on("postgres_changes",{event:"INSERT",schema:"public",table:"calls",filter:`child_id=eq.${L.id}`},async $=>{const W=$.new;W.caller_type==="parent"&&W.child_id===L.id&&W.status==="ringing"&&await V(W)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls",filter:`child_id=eq.${L.id}`},async $=>{const W=$.new,D=$.old;W.caller_type!=="child"&&(C.pathname.startsWith("/call/")||(v.current&&v.current.id===W.id&&(W.status==="active"||W.status==="ended")&&(s(null),v.current=null),W.caller_type==="parent"&&W.child_id===L.id&&W.status==="ringing"&&D.status!=="ringing"&&await V(W)))}).subscribe(($,W)=>{W&&console.error(" [CHILD DASHBOARD] Realtime subscription error:",W)})})(),()=>{w.current&&Y.removeChannel(w.current),M&&clearInterval(M)}},[E,C.pathname]),p.useEffect(()=>{v.current=n},[n]),p.useEffect(()=>{N.current=k},[k]),Gc({userId:e?.id||"",userType:"child",name:e?.name,enabled:!!e});const{isOnline:j}=ZE({parentId:c||e?.parent_id||"",enabled:!!(c||e?.parent_id)});p.useEffect(()=>{!n&&v.current&&_(v.current.id)},[n,_]);const R=async()=>{if(e&&c){try{const{acknowledgeMissedCalls:G}=await gr(async()=>{const{acknowledgeMissedCalls:L}=await import("./acknowledgeMissedCalls-D4lifASh.js");return{acknowledgeMissedCalls:L}},[]);await G(e.id,"parent")}catch(G){console.error("Error acknowledging missed calls:",G)}E(`/call/${e.id}`)}else c||E("/child/parents")},T=()=>{e&&c?E(`/chat/${e.id}`):c||E("/child/parents")},P=()=>{if(n&&e){_(n.id),x.current=!0;const G=n.id;s(null),E(`/call/${e.id}?callId=${G}`),setTimeout(()=>{x.current=!1},2e3)}},O=async()=>{if(n){if(x.current)return;try{await Xs({callId:n.id,by:"child",reason:"declined"})}catch(G){console.error(" [USER ACTION] Error declining call:",G);const L=G instanceof Error?G.message:"Unknown error";b({title:"Error",description:"Failed to decline call: "+L,variant:"destructive"})}_(n.id),s(null)}};return e?a.jsxs("div",{className:"min-h-[100dvh] bg-primary/5",children:[a.jsx(Ot,{}),a.jsx(Lr,{role:"child",pageKey:"child_dashboard"}),a.jsx(Or,{role:"child",pageKey:"child_dashboard"}),a.jsx("div",{className:"p-4",style:{paddingTop:"calc(1rem + 64px + var(--safe-area-inset-top) * 0.15)"},children:a.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[a.jsx("div",{className:"mt-8",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center text-3xl font-bold text-white",style:{backgroundColor:e.avatar_color},children:e.name[0]}),a.jsxs("div",{children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("h1",{className:"text-3xl font-bold",children:["Hi ",e.name,"!"]})}),a.jsx("div",{className:"text-muted-foreground",children:c?a.jsxs("span",{className:"flex items-center gap-2",children:["Ready to connect with ",i,"?",c&&a.jsx(Wo,{isOnline:j,size:"sm",showPulse:j})]}):"Select a parent to contact"})]})]})}),c?a.jsxs("div",{className:"grid gap-4",children:[a.jsxs(Te,{className:"p-8 cursor-pointer hover:shadow-lg transition-all border-4 relative",style:{borderColor:e.avatar_color},onClick:R,"data-tour":"child-answer-button",children:[h>0&&a.jsx("span",{className:"absolute top-4 right-4 bg-destructive text-destructive-foreground text-xs font-bold rounded-full min-w-[24px] h-6 flex items-center justify-center px-2 border-2 border-background",children:h>99?"99+":h}),a.jsxs("div",{className:"flex items-center gap-6",children:[a.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center",style:{backgroundColor:e.avatar_color},children:a.jsx(em,{className:"h-10 w-10 text-white"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Call ",i]}),a.jsx(Wo,{isOnline:j,size:"md",showPulse:j})]}),a.jsx("p",{className:"text-muted-foreground",children:j?"Parent is online":"Parent is offline"})]})]})]}),a.jsxs(Te,{className:"p-8 cursor-pointer hover:shadow-lg transition-all border-4 relative",style:{borderColor:e.avatar_color},onClick:T,"data-tour":"child-messages",children:[g>0&&a.jsx("span",{className:"absolute top-4 right-4 bg-destructive text-destructive-foreground text-xs font-bold rounded-full min-w-[24px] h-6 flex items-center justify-center px-2 border-2 border-background",children:g>99?"99+":g}),a.jsxs("div",{className:"flex items-center gap-6",children:[a.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center",style:{backgroundColor:e.avatar_color},children:a.jsx(Na,{className:"h-10 w-10 text-white"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-3xl font-bold mb-2",children:"Send Message"}),a.jsx(Wo,{isOnline:j,size:"md",showPulse:j})]}),a.jsxs("p",{className:"text-muted-foreground",children:["Chat with ",i," ",j?"(online)":"(offline)"]})]})]})]})]}):a.jsxs(Te,{className:"p-6 text-center",children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:"Please select a parent first"}),a.jsx(ce,{onClick:()=>E("/child/parents"),size:"lg",children:"Select Parent"})]})]})}),a.jsx(Xn,{open:!!n,onOpenChange:G=>{!G&&n&&!x.current&&O()},children:a.jsxs(_n,{className:"sm:max-w-md",children:[a.jsxs(Nn,{children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-2xl font-bold text-white",style:{backgroundColor:e?.avatar_color||"#3B82F6"},children:""}),a.jsxs("div",{children:[a.jsx(jn,{className:"text-xl",children:"Incoming Call"}),a.jsxs("p",{className:"text-base font-normal text-muted-foreground",children:[i," is calling..."]})]})]}),a.jsxs("div",{className:"pt-4",children:[a.jsxs(Tn,{className:"sr-only",children:["Incoming call from ",i]}),a.jsx("div",{className:"flex items-center justify-center gap-2 text-4xl animate-pulse",children:a.jsx(ka,{className:"h-12 w-12"})})]})]}),a.jsxs(kn,{className:"sm:justify-center gap-2",children:[a.jsx(An,{onClick:O,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Decline"}),a.jsx(mr,{onClick:P,className:"bg-green-600 hover:bg-green-700",children:"Answer"})]})]})})]}):null},k$=()=>{const e=tt();Ct();const[t,n]=p.useState(null);return p.useEffect(()=>{const s=localStorage.getItem("childSession");if(!s){e("/child/login");return}const i=JSON.parse(s);n(i)},[e]),Gc({userId:t?.id||"",userType:"child",name:t?.name,enabled:!!t}),t?a.jsxs("div",{className:"min-h-[100dvh] bg-background",children:[a.jsx(Ot,{}),a.jsx(Lr,{role:"child",pageKey:"child_home"}),a.jsx(Or,{role:"child",pageKey:"child_home"}),a.jsx("div",{className:"p-4",style:{paddingTop:"calc(1rem + 64px + var(--safe-area-inset-top) * 0.15)"},children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"mb-8 mt-8",children:[a.jsxs("h1",{className:"text-3xl font-bold",children:["Hi, ",t.name,"!"]}),a.jsx("p",{className:"text-muted-foreground mt-2",children:"Quick access to call your parent"})]}),a.jsx(Te,{className:"p-6 min-h-[176px]",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Quick Actions"}),a.jsxs(ce,{className:"w-full",size:"lg",onClick:()=>e("/child/parents"),"data-tour":"child-home-parents",children:[a.jsx(la,{className:"mr-2 h-5 w-5"}),"Select Parent"]}),a.jsx(ce,{className:"w-full",size:"lg",variant:"outline",onClick:()=>e("/child/dashboard"),children:"Go to Dashboard"})]})})]})})]}):a.jsxs("div",{className:"min-h-[100dvh] bg-background",children:[a.jsx(Ot,{}),a.jsx("div",{className:"p-4",style:{paddingTop:"calc(1rem + 64px + var(--safe-area-inset-top) * 0.15)"},children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"mb-8 mt-8",children:[a.jsx("div",{className:"h-9 w-48 bg-muted rounded animate-pulse mb-2"}),a.jsx("div",{className:"h-6 w-64 bg-muted rounded animate-pulse"})]}),a.jsx(Te,{className:"p-6 min-h-[176px]",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"h-6 w-32 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-10 w-full bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-10 w-full bg-muted rounded animate-pulse"})]})})]})})]})},j$=()=>{const[e,t]=p.useState(null),[n,s]=p.useState(null),[i,l]=p.useState(!0),c=tt(),{toast:u}=Ct(),{isOnline:f}=ZE({parentId:n?.id||"",enabled:!!n?.id});p.useEffect(()=>{(async()=>{const{data:w}=await Y.auth.getSession();w?.session&&await Y.auth.signOut();const x=localStorage.getItem("childSession");if(!x){c("/child/login");return}let E;try{E=JSON.parse(x)}catch(b){console.error(" [ChildParentsList] Error parsing session data:",b),c("/child/login");return}t(E);let C=E.parent_id;if(!C&&E.id)try{const{data:b,error:k}=await Y.from("children").select("parent_id").eq("id",E.id).single();if(k)throw console.error(" [ChildParentsList] Error fetching child record:",k),k;b?.parent_id&&(C=b.parent_id)}catch(b){console.error(" [ChildParentsList] Error fetching child's parent_id:",b)}C?await h(C):(u({title:"Error",description:"Could not find parent information",variant:"destructive"}),l(!1))})()},[c,u]);const h=async v=>{try{if(!v||v==="undefined"||v==="null")throw new Error("Invalid parent ID");try{const{data:E,error:C}=await Y.rpc("get_parent_name_for_child",{parent_uuid:v});if(E&&(!Array.isArray(E)||E.length>0)){const b=Array.isArray(E)?E[0]:E;s(b),l(!1);return}}catch{}const{data:w,error:x}=await Y.from("parents").select("id, name").eq("id",v).maybeSingle();if(x)throw console.error(" [ChildParentsList] Supabase error:",x),x;if(!w)throw new Error("Parent not found. The RLS policy may be blocking access.");s(w)}catch(w){const x=w instanceof Error?w.message:"Unknown error occurred";console.error(" [ChildParentsList] Error in fetchParent:",x),u({title:"Error loading parent",description:x,variant:"destructive"})}finally{l(!1)}},g=v=>{localStorage.setItem("selectedParentId",v),c("/child/dashboard")};return i||!e?a.jsxs("div",{className:"min-h-[100dvh] bg-background w-full overflow-x-hidden",children:[a.jsx(Ot,{}),a.jsx("div",{className:"p-4 sm:p-6",style:{paddingTop:"calc(1rem + 64px + var(--safe-area-inset-top) * 0.15)"},children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"mb-6 sm:mb-8 mt-4 sm:mt-6",children:[a.jsx("div",{className:"h-9 w-48 bg-muted rounded animate-pulse mb-2"}),a.jsx("div",{className:"h-6 w-64 bg-muted rounded animate-pulse"})]}),a.jsx(Te,{className:"p-4 sm:p-6",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4 flex-1 min-w-0",children:[a.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 rounded-full bg-muted animate-pulse flex-shrink-0"}),a.jsxs("div",{className:"space-y-2 min-w-0 flex-1",children:[a.jsx("div",{className:"h-7 w-32 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-4 w-40 bg-muted rounded animate-pulse"})]})]}),a.jsx("div",{className:"h-10 w-full sm:w-24 bg-muted rounded animate-pulse"})]})})]})})]}):a.jsxs("div",{className:"min-h-[100dvh] bg-background w-full overflow-x-hidden",children:[a.jsx(Ot,{}),a.jsx(Lr,{role:"child",pageKey:"child_parents_list"}),a.jsx(Or,{role:"child",pageKey:"child_parents_list"}),a.jsx("div",{className:"p-4 sm:p-6",style:{paddingTop:"calc(1rem + 64px + var(--safe-area-inset-top) * 0.15)"},children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"mb-6 sm:mb-8 mt-4 sm:mt-6",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Select Parent"}),a.jsx("p",{className:"text-muted-foreground mt-2 text-sm sm:text-base",children:"Choose a parent to contact"})]}),n?a.jsx(Te,{"data-tour":"child-parents-list-card",className:"p-4 sm:p-6 cursor-pointer hover:shadow-lg transition-all",onClick:()=>g(n.id),children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4 flex-1 min-w-0",children:[a.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 rounded-full bg-primary flex items-center justify-center text-white font-bold text-xl sm:text-2xl flex-shrink-0",children:n.name?.charAt(0).toUpperCase()||"P"}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("h3",{className:"text-xl sm:text-2xl font-semibold truncate",children:n.name||"Parent"}),a.jsx(Wo,{isOnline:f,size:"md",showPulse:f})]}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:f?"Online - Tap to call or message":"Offline - Tap to call or message"})]})]}),a.jsxs(ce,{onClick:v=>{v.stopPropagation(),g(n.id)},className:"w-full sm:w-auto flex-shrink-0",children:[a.jsx(ka,{className:"mr-2 h-4 w-4"}),"Contact"]})]})}):a.jsx(Te,{className:"p-6",children:a.jsx("p",{className:"text-muted-foreground",children:"No parent found."})})]})})]})},T$=()=>{const{parentId:e}=cd(),t=tt(),{toast:n}=Ct(),[s,i]=p.useState(null),[l,c]=p.useState("Parent"),u=p.useRef(null),f=p.useRef(null);p.useEffect(()=>{(async()=>{const v=localStorage.getItem("childSession");if(!v){t("/child/login");return}const w=JSON.parse(v);if(i(w.id),e){const{data:x}=await Y.from("parents").select("name").eq("id",e).single();x?.name&&c(x.name)}})()},[e,t]);const h=ZS({role:"child",localProfileId:s||"",remoteProfileId:e||"",localVideoRef:u,remoteVideoRef:f});return p.useEffect(()=>{h.state==="idle"&&s&&e&&h.startOutgoingCall(e).catch(g=>{console.error("Failed to start call:",g),n({title:"Call Failed",description:"Failed to start call",variant:"destructive"})})},[h.state,s,e,h]),p.useEffect(()=>{h.state},[h.state]),!s||!e?a.jsx("div",{className:"min-h-[100dvh] bg-background flex items-center justify-center",children:a.jsx("div",{children:"Loading..."})}):h.state==="calling"?a.jsx("div",{className:"min-h-[100dvh] bg-background flex items-center justify-center",children:a.jsx(Te,{className:"p-8",children:a.jsxs("div",{className:"text-center space-y-4",children:[a.jsxs("h2",{className:"text-2xl font-semibold",children:["Calling ",l,"..."]}),a.jsx("p",{className:"text-muted-foreground",children:"Waiting for answer"})]})})}):h.state==="incoming"?a.jsx("div",{className:"min-h-[100dvh] bg-background flex items-center justify-center",children:a.jsx(Te,{className:"p-8",children:a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx("h2",{className:"text-2xl font-semibold",children:"Incoming Call"}),a.jsxs("p",{className:"text-muted-foreground",children:["From ",l]}),a.jsxs("div",{className:"flex gap-4 justify-center",children:[a.jsx(ce,{onClick:()=>h.callId&&h.acceptIncomingCall(h.callId),children:"Accept"}),a.jsx(ce,{variant:"destructive",onClick:()=>h.callId&&h.rejectIncomingCall(h.callId),children:"Reject"})]})]})})}):a.jsx(Qm,{localVideoRef:u,remoteVideoRef:f,remoteStream:h.remoteStream,isConnecting:h.state==="calling"||h.state==="connecting",isMuted:h.isMuted,isVideoOff:h.isVideoOff,onToggleMute:h.toggleMute,onToggleVideo:h.toggleVideo,onEndCall:h.endCall})},A$=async(e,t,n,s,i,l,c)=>{let u=null;if(c){console.log(" [PARENT CALL] Looking for specific call:",c);const{data:g,error:v}=await Y.from("calls").select("*").eq("id",c).eq("parent_id",n).maybeSingle();v&&console.error("Error fetching specific call:",v),g&&(u=g,console.log(" [PARENT CALL] Found specific call:",{id:u.id,caller_type:u.caller_type,status:u.status,hasOffer:!!u.offer}),u.caller_type==="child"&&u.offer?u.status==="ringing"||u.status==="active"?(console.log(" [PARENT CALL] Answering incoming call from child (status:",u.status+", hasOffer: true)"),s(u.id)):(console.log(" [PARENT CALL] Specific call is ended (status:",u.status+"), cannot answer."),u=null):u.caller_type==="parent"&&(u.status==="ringing"||u.status==="active")&&(console.log(" [PARENT CALL] Using existing parent-initiated call"),u=null))}let f=null;if(!u||u.caller_type!=="child"){const{data:g}=await Y.from("calls").select("*").eq("child_id",t).eq("parent_id",n).in("status",["ringing","active"]).eq("caller_type","parent").order("created_at",{ascending:!1}).limit(1).maybeSingle();f=g}if(f){if(console.log(" [PARENT CALL] Using existing parent-initiated call:",f.id),s(f.id),f.answer&&e.remoteDescription===null){console.log(" [PARENT CALL] Existing call has answer, setting remote description...");const g=f.answer;await e.setRemoteDescription(new RTCSessionDescription(g));for(const v of l.current)try{await e.addIceCandidate(new RTCIceCandidate(v))}catch(w){const x=w;!x.message?.includes("duplicate")&&!x.message?.includes("already")&&console.error("Error adding queued ICE candidate:",x.message)}l.current=[],i(!1)}else if(f.offer){if(f.offer){const g=f.offer,v=e.localDescription!==null,w=e.signalingState,x=e.getSenders().length>0;if(console.log(" [PARENT CALL] Checking existing offer:",{hasLocalDescription:v,signalingState:w,hasTracks:x,offerType:g.type,offerSdpLength:g.sdp?.length}),x&&v)console.log(" [PARENT CALL] Peer connection already initialized with tracks and local description. Skipping setLocalDescription - connection is already in progress.");else if(!v&&w==="stable"&&!x){console.log(" [PARENT CALL] Setting local description from existing offer...");try{await e.setLocalDescription(new RTCSessionDescription(g)),console.log(" [PARENT CALL] Successfully set local description from existing offer")}catch(E){const C=E;if(C.message?.includes("does not match")||C.message?.includes("SDP")||C.message?.includes("InvalidModificationError"))console.warn(" [PARENT CALL] Could not set local description - already set with different SDP. This may indicate the connection was already initialized. Continuing without error...");else throw console.error(" [PARENT CALL] Unexpected error setting local description:",C),E}}else v?e.localDescription.sdp!==g.sdp?console.warn(` [PARENT CALL] Local description already set but doesn't match existing offer. Current SDP length: ${e.localDescription.sdp?.length}, Offer SDP length: ${g.sdp?.length}. This may indicate a race condition. Skipping setLocalDescription and continuing.`):console.log(" [PARENT CALL] Local description already matches existing offer"):console.warn(` [PARENT CALL] Cannot set local description - signaling state is "${w}", hasTracks: ${x}. This may indicate the connection is already in progress. Skipping setLocalDescription.`)}}else{console.log(" [PARENT CALL] Existing call has no offer, creating one...");const g=await e.createOffer();console.log("[KCH]","parent","created offer",!!g?.sdp),await e.setLocalDescription(g),console.log("[KCH]","parent","saving offer for call",f.id),await Y.from("calls").update({offer:{type:g.type,sdp:g.sdp}}).eq("id",f.id)}return Y.channel(`call:${f.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls",filter:`id=eq.${f.id}`},async g=>{try{const v=g.new,w=g.old;if(Yt(v)){const E=e.iceConnectionState;console.error(" [CALL LIFECYCLE] Call ended by remote party (parent handler - existing call)",{callId:v.id,oldStatus:w?.status,newStatus:v.status,reason:"Status changed to 'ended' in database",timestamp:new Date().toISOString(),connectionState:e.connectionState,iceConnectionState:E,signalingState:e.signalingState}),e.signalingState!=="closed"&&e.close();return}if(v.answer&&e.remoteDescription===null)try{console.log(" [PARENT HANDLER] Parent received answer from child (existing call), setting remote description...");const E=v.answer;await e.setRemoteDescription(new RTCSessionDescription(E));for(const C of l.current)try{await e.addIceCandidate(new RTCIceCandidate(C))}catch(b){const k=b;!k.message?.includes("duplicate")&&!k.message?.includes("already")&&console.error(" [PARENT HANDLER] Error adding queued ICE candidate:",k.message)}l.current=[],i(!1)}catch(E){console.error(" [PARENT HANDLER] Error setting remote description:",E)}const x=v.child_ice_candidates;if(x&&Array.isArray(x))for(const E of x)try{if(!E.candidate)continue;if(e.remoteDescription){const C=new RTCIceCandidate(E);await e.addIceCandidate(C)}else l.current.push(E)}catch(C){const b=C;!b.message?.includes("duplicate")&&!b.message?.includes("already")&&console.error(" [PARENT HANDLER] Error adding ICE candidate:",b.message)}}catch(v){console.error("Error in parent call update handler:",v)}}).subscribe()}let h=u&&u.caller_type==="child"?u:null;if(!h){const{data:g}=await Y.from("calls").select("*").eq("child_id",t).eq("parent_id",n).eq("status","ringing").eq("caller_type","child").order("created_at",{ascending:!1}).limit(1).maybeSingle();h=g}if(h){if(i(!1),s(h.id),!h.offer)return console.log("Incoming call has no offer yet, waiting for offer..."),Y.channel(`call:${h.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls",filter:`id=eq.${h.id}`},async R=>{const T=R.new;if(T.offer&&e.remoteDescription===null){console.log("Received offer, setting remote description...");const P=T.offer;await e.setRemoteDescription(new RTCSessionDescription(P)),await new Promise(G=>{const L=()=>{e.signalingState==="have-remote-offer"||e.signalingState==="have-local-pranswer"?G():setTimeout(L,100)};L()});const O=await e.createAnswer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});console.log("[KCH]","parent","created answer",!!O?.sdp),await e.setLocalDescription(O),console.log("[KCH]","parent","saving answer for call",h.id),await Y.from("calls").update({answer:{type:O.type,sdp:O.sdp},status:"active",ended_at:null}).eq("id",h.id),i(!1)}}).subscribe();const g=h.offer;console.log(" [PARENT HANDLER] Setting remote description with child's offer..."),await e.setRemoteDescription(new RTCSessionDescription(g)),await new Promise((j,R)=>{const T=setTimeout(()=>{R(new Error("Timeout waiting for signaling state change"))},5e3),P=()=>{e.signalingState==="have-remote-offer"||e.signalingState==="have-local-pranswer"?(clearTimeout(T),j()):setTimeout(P,100)};P()});const v=e.getSenders().map(j=>j.track).filter(Boolean);if(console.log(" [PARENT HANDLER] Tracks in peer connection before answer:",{audioTracks:v.filter(j=>j?.kind==="audio").length,videoTracks:v.filter(j=>j?.kind==="video").length,totalTracks:v.length,senders:e.getSenders().length,trackDetails:v.map(j=>({kind:j.kind,id:j.id,enabled:j.enabled,muted:j.muted}))}),v.length===0)throw console.error(" [PARENT HANDLER] NO TRACKS FOUND in peer connection! This will cause no video/audio. Make sure initializeConnection() was called and tracks were added."),new Error("Cannot create answer: no media tracks found. Please ensure camera/microphone permissions are granted.");const w=v.filter(j=>j?.kind==="audio"),x=v.filter(j=>j?.kind==="video");if(w.length===0&&x.length===0)throw console.error(" [PARENT HANDLER] No audio or video tracks found!"),new Error("Cannot create answer: no media tracks available.");console.log(" [PARENT HANDLER] Creating answer, current state:",e.signalingState);const E=await e.createAnswer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});console.log("[KCH]","parent","created answer",!!E?.sdp),console.log(" [PARENT HANDLER] Answer created, setting local description..."),await e.setLocalDescription(E);const C=E.sdp?.includes("m=audio"),b=E.sdp?.includes("m=video");if(console.log(" [PARENT HANDLER] Answer SDP verification:",{type:E.type,sdpLength:E.sdp?.length,hasAudio:C,hasVideo:b,sdpPreview:E.sdp?.substring(0,200)}),!C&&!b)throw console.error(" [PARENT HANDLER] CRITICAL: Answer SDP has no media tracks! This will cause no video/audio."),new Error("Answer SDP missing media tracks - ensure tracks are added before creating answer");console.log(" [PARENT HANDLER] Updating call with answer...",{callId:h.id,answerType:E.type}),console.log("[KCH]","parent","saving answer for call",h.id);const{error:k}=await Y.from("calls").update({answer:{type:E.type,sdp:E.sdp},status:"active",ended_at:null}).eq("id",h.id);if(k)throw console.error(" [PARENT HANDLER] Error updating call with answer:",k),new Error(`Failed to send answer: ${k.message}`);console.log(" [PARENT HANDLER] Answer sent successfully to child");const _=l.current.length;if(_>0){console.log(` [PARENT HANDLER] Processing ${_} queued ICE candidates after answer`);for(const j of l.current)try{await e.addIceCandidate(new RTCIceCandidate(j))}catch(R){const T=R;!T.message?.includes("duplicate")&&!T.message?.includes("already")&&console.error(" [PARENT HANDLER] Error processing queued ICE candidate:",T.message)}l.current=[]}return i(!1),console.log(" [PARENT HANDLER] Call connected! Parent answered child's call."),(async()=>{try{const{data:j}=await Y.from("calls").select("child_ice_candidates").eq("id",h.id).maybeSingle();if(j){const R=j.child_ice_candidates;if(R&&Array.isArray(R)&&R.length>0){console.log(" [PARENT HANDLER] Processing existing ICE candidates from child (immediate):",{count:R.length,hasRemoteDescription:!!e.remoteDescription,iceConnectionState:e.iceConnectionState});for(const T of R)try{if(!T.candidate)continue;e.remoteDescription?await e.addIceCandidate(new RTCIceCandidate(T)):l.current.push(T)}catch(P){const O=P;!O.message?.includes("duplicate")&&!O.message?.includes("already")&&console.error(" [PARENT HANDLER] Error adding existing ICE candidate:",O.message)}console.log(" [PARENT HANDLER] Finished processing existing ICE candidates from child")}}}catch(j){console.error(" [PARENT HANDLER] Error fetching existing ICE candidates:",j)}})(),Y.channel(`call:${h.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls",filter:`id=eq.${h.id}`},async j=>{const R=j.new;if(R.status==="ended"){const P=e.iceConnectionState;console.error(" [CALL LIFECYCLE] Call ended by remote party (parent handler)",{callId:R.id,oldStatus:j.old?.status,newStatus:R.status,reason:"Status changed to 'ended' in database",timestamp:new Date().toISOString(),connectionState:e.connectionState,iceConnectionState:P,signalingState:e.signalingState}),console.log(" [CALL LIFECYCLE] Call ended - closing peer connection immediately",{iceState:P,reason:"Call status changed to 'ended' - closing regardless of ICE state"}),e.signalingState!=="closed"&&e.close();return}const T=R.child_ice_candidates;if(T&&Array.isArray(T)){const P=l.current.length,O=T.length;O>0&&(O<=5||O%5===0)&&console.log(" [PARENT HANDLER] Processing ICE candidates (from child):",{count:O,queued:P,hasRemoteDescription:!!e.remoteDescription,iceConnectionState:e.iceConnectionState,source:"child_ice_candidates"});for(const G of T)try{if(!G.candidate)continue;if(e.remoteDescription){const L=new RTCIceCandidate(G);await e.addIceCandidate(L),O<=3&&console.log(" [PARENT HANDLER] Added ICE candidate #"+O)}else l.current.push(G),P<3&&console.log(" [PARENT HANDLER] Queued ICE candidate (waiting for remote description)")}catch(L){const F=L;!F.message?.includes("duplicate")&&!F.message?.includes("already")&&console.error(" [PARENT HANDLER] Error adding ICE candidate:",F.message)}}}).subscribe()}else{console.log("Parent initiating call to child:",t);const{data:g,error:v}=await Y.from("calls").insert({child_id:t,parent_id:n,caller_type:"parent",status:"ringing"}).select().single();if(v)throw console.error("Call creation error:",v),new Error(`Failed to create call: ${v.message}`);if(!g)throw new Error("Failed to create call: No call data returned");console.log("Call created successfully:",g.id),s(g.id);const w=e.getSenders().map(T=>T.track).filter(Boolean);if(console.log(" [PARENT CALL] Tracks in peer connection before offer:",{audioTracks:w.filter(T=>T?.kind==="audio").length,videoTracks:w.filter(T=>T?.kind==="video").length,totalTracks:w.length,senders:e.getSenders().length,trackDetails:w.map(T=>({kind:T.kind,id:T.id,enabled:T.enabled,muted:T.muted}))}),w.length===0)throw console.error(" [PARENT CALL] NO TRACKS FOUND in peer connection! This will cause no video/audio. Make sure initializeConnection() was called and tracks were added."),new Error("Cannot create offer: no media tracks found. Please ensure camera/microphone permissions are granted.");const x=w.filter(T=>T?.kind==="audio"),E=w.filter(T=>T?.kind==="video");if(x.length===0&&E.length===0)throw console.error(" [PARENT CALL] No audio or video tracks found!"),new Error("Cannot create offer: no media tracks available.");console.log("Creating offer, current signaling state:",e.signalingState);const C=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});console.log("[KCH]","parent","created offer",!!C?.sdp);const b=C.sdp?.includes("m=audio"),k=C.sdp?.includes("m=video");if(console.log(" [PARENT CALL] Offer SDP verification:",{hasAudio:b,hasVideo:k,sdpLength:C.sdp?.length,sdpPreview:C.sdp?.substring(0,200)}),!b&&!k)throw console.error(" [PARENT CALL] CRITICAL: Offer SDP has no media tracks! This will cause no video/audio."),new Error("Offer SDP missing media tracks - ensure tracks are added before creating offer");console.log("Offer created, setting local description..."),await e.setLocalDescription(C);const _={type:C.type,sdp:C.sdp};console.log("Updating call with offer:",{callId:g.id,offerData:_}),console.log("[KCH]","parent","saving offer for call",g.id);const{data:N,error:j}=await Y.from("calls").update({offer:_}).eq("id",g.id).select();if(console.log("Update response:",{data:N,error:j}),j)throw console.error("Error updating call with offer:",j),console.error("Error code:",j.code),console.error("Error message:",j.message),console.error("Error details:",JSON.stringify(j,null,2)),console.error("Call ID:",g.id),console.error("Offer data:",_),j.code==="PGRST204"||j.message?.includes("Could not find the 'offer' column")?new Error("Database schema cache is out of sync. Please refresh the page or contact support."):j.code==="42501"||j.code==="PGRST301"||j.message?.includes("permission denied")||j.message?.includes("new row violates row-level security")?new Error(`Permission denied: ${j.message}. Check RLS policies.`):new Error(`Failed to set offer: ${j.message}`);return console.log(" [PARENT CALL] Offer sent successfully, waiting for child's answer..."),Y.channel(`call:${g.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls",filter:`id=eq.${g.id}`},async T=>{try{console.log(" [PARENT HANDLER] UPDATE event received:",{callId:g.id,hasNew:!!T.new,hasOld:!!T.old,timestamp:new Date().toISOString()});const P=T.new,O=T.old;console.log(" [PARENT HANDLER] Update details:",{hasAnswer:!!P.answer,hadAnswer:!!O?.answer,status:P.status,oldStatus:O?.status,hasRemoteDesc:!!e.remoteDescription}),O?.status!==P.status&&(P.status==="ended"||P.status==="active")&&(console.log(" [PARENT HANDLER] Call status changed:",{callId:P.id,oldStatus:O?.status,newStatus:P.status}),P.status==="active"&&O?.status!=="active"&&(console.log(" [PARENT HANDLER] Call status changed to active - stopping ringtone"),i(!1))),P.answer&&!O?.answer&&(console.log(" [PARENT HANDLER] Answer received from child"),i(!1));const L=Yt(P),F=O?Yt(O):null;if(L&&O!==void 0&&F===!1){const U=e.iceConnectionState;console.info(" [CALL LIFECYCLE] Call ended by remote party (parent handler - parent initiated)",{callId:P.id,oldStatus:O?.status,newStatus:P.status,reason:"Status changed to 'ended' in database",timestamp:new Date().toISOString(),connectionState:e.connectionState,iceConnectionState:U,signalingState:e.signalingState}),console.log(" [CALL LIFECYCLE] Call ended - closing peer connection immediately",{iceState:U,reason:"Call status changed to 'ended' - closing regardless of ICE state"}),e.signalingState!=="closed"&&e.close();return}if(P.answer&&e.remoteDescription===null)try{i(!1),console.log(" [PARENT HANDLER] Parent received answer from child, setting remote description...",{callId:P.id,hasAnswer:!!P.answer,answerType:P.answer?.type,currentRemoteDesc:!!e.remoteDescription,signalingState:e.signalingState});const U=P.answer;await e.setRemoteDescription(new RTCSessionDescription(U)),console.log(" [PARENT HANDLER] Remote description set successfully from child's answer",{signalingState:e.signalingState,iceConnectionState:e.iceConnectionState});const M=l.current.length;if(M>0){console.log(` [PARENT HANDLER] Processing ${M} queued ICE candidates after answer`);for(const V of l.current)try{await e.addIceCandidate(new RTCIceCandidate(V))}catch(ee){const z=ee;!z.message?.includes("duplicate")&&!z.message?.includes("already")&&console.error(" [PARENT HANDLER] Error adding queued ICE candidate:",z.message)}l.current=[]}i(!1),console.log(" [PARENT HANDLER] Call connected! Parent received answer from child.",{signalingState:e.signalingState,iceConnectionState:e.iceConnectionState,iceGatheringState:e.iceGatheringState,hasRemoteDescription:!!e.remoteDescription,hasLocalDescription:!!e.localDescription});const B=P.child_ice_candidates;B&&Array.isArray(B)&&B.length>0&&(console.log(" [PARENT HANDLER] Processing existing ICE candidates from child (immediate after answer):",{count:B.length,hasRemoteDescription:!!e.remoteDescription,iceConnectionState:e.iceConnectionState}),(async()=>{for(const V of B)try{if(!V.candidate)continue;e.remoteDescription?(await e.addIceCandidate(new RTCIceCandidate(V)),console.log(" [PARENT HANDLER] Added existing ICE candidate from child")):l.current.push(V)}catch(ee){const z=ee;!z.message?.includes("duplicate")&&!z.message?.includes("already")&&console.error(" [PARENT HANDLER] Error adding existing ICE candidate:",z.message)}})())}catch(U){console.error(" [PARENT HANDLER] Error setting remote description:",U)}else P.answer&&e.remoteDescription!==null&&console.log(" [PARENT HANDLER] Answer received but remote description already set");const I=P.child_ice_candidates||P.ice_candidates;if(I&&Array.isArray(I)){const U=I.length;U>0&&U%10===0&&console.log(" [PARENT HANDLER] Processing ICE candidates (from child):",{count:U,iceConnectionState:e.iceConnectionState});const M=new Set;for(const B of I)try{if(!B.candidate)continue;const V=`${B.candidate}-${B.sdpMLineIndex}-${B.sdpMid||""}`;if(M.has(V))continue;if(M.add(V),e.remoteDescription){const ee=new RTCIceCandidate(B);await e.addIceCandidate(ee)}else l.current.push(B)}catch(V){const ee=V;!ee.message?.includes("duplicate")&&!ee.message?.includes("already")&&console.error(" [PARENT HANDLER] Error adding ICE candidate:",ee.message)}M.size>0&&M.size%10===0&&console.log(" [PARENT HANDLER] Processed",M.size,"ICE candidates from child",{iceConnectionState:e.iceConnectionState,connectionState:e.connectionState})}}catch(P){console.error("Error in parent call update handler:",P)}}).subscribe(T=>{console.log(" [PARENT CALL] Realtime subscription status:",T,{callId:g.id}),T==="SUBSCRIBED"?console.log(" [PARENT CALL] Successfully subscribed to realtime updates for answer"):T==="CHANNEL_ERROR"&&console.error(" [PARENT CALL] Realtime subscription error - answer may not be received!")})}},R$=async(e,t,n,s,i,l,c)=>{if(c){console.log(" [CHILD CALL] Looking for specific call:",c);const{data:g,error:v}=await Y.from("calls").select("*").eq("id",c).eq("child_id",t.id).maybeSingle();if(v&&console.error("Error fetching specific call:",v),g){if(console.log(" [CHILD CALL] Found specific call:",{id:g.id,caller_type:g.caller_type,status:g.status,hasOffer:!!g.offer}),g.caller_type==="parent"&&g.offer){if(g.status==="ringing"||g.status==="active")return console.log(" [CHILD CALL] Answering incoming call from parent (status:",g.status+", hasOffer: true)"),Qf(e,g,s,i,l);console.log(" [CHILD CALL] Specific call is ended (status:",g.status+"), cannot answer. Creating new call instead.")}if(g.caller_type==="child"&&(g.status==="ringing"||g.status==="active"))return console.log(" [CHILD CALL] Using existing child-initiated call"),Fw(e,g,s,i,l);Yt(g)&&console.log(" [CHILD CALL] Specific call is ended, checking for other incoming calls...")}}const{data:u,error:f}=await Y.from("calls").select("*").eq("child_id",t.id).eq("caller_type","parent").eq("status","ringing").not("offer","is",null).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(f&&console.error("Error checking for incoming call:",f),u){if(u.offer&&u.status==="ringing")return console.log(" [CHILD CALL] Found incoming RINGING call from parent with offer:",{callId:u.id,status:u.status,hasOffer:!0}),Qf(e,u,s,i,l);if(u.status!=="ringing")console.log(" [CHILD CALL] Found call from parent but status is",u.status+", not ringing. Creating new call instead.");else{console.log(" [CHILD CALL] Found incoming call from parent but offer not ready yet, waiting...",u.id),s(u.id);const g=Y.channel(`call:${u.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls",filter:`id=eq.${u.id}`},async v=>{const w=v.new;if(w.offer&&e.remoteDescription===null)return console.log(" [CHILD CALL] Offer received, answering incoming call from parent"),Y.removeChannel(g),Qf(e,w,s,i,l)}).subscribe();return g}}const{data:h}=await Y.from("calls").select("*").eq("child_id",t.id).eq("parent_id",n.parent_id).in("status",["ringing","active"]).eq("caller_type","child").order("created_at",{ascending:!1}).limit(1).maybeSingle();return h?(console.log(" [CHILD CALL] Found existing child-initiated call, continuing it:",h.id),Fw(e,h,s,i,l)):(console.log(" [CHILD CALL] No existing or incoming call found - child initiating new call"),P$(e,t,n.parent_id,s,i,l))},Fw=async(e,t,n,s,i)=>{console.log("Using existing call:",t.id),n(t.id);let l=!1;if(t.status==="ended"||t.status==="active"){console.log("Resetting existing call to ringing status (was:",t.status,")...");const{error:c}=await Y.from("calls").update({status:"ringing",ended_at:null,offer:null,answer:null,parent_ice_candidates:null,child_ice_candidates:null}).eq("id",t.id);c?console.error("Error resetting call status:",c):(t.status="ringing",t.offer=void 0,t.answer=void 0,l=!0)}if(l){console.log("Call was reset, creating fresh offer...");const c=await e.createOffer();await e.setLocalDescription(c);const u={type:c.type,sdp:c.sdp},{error:f}=await Y.from("calls").update({offer:u}).eq("id",t.id);if(f)throw console.error("Error updating call with new offer:",f),new Error(`Failed to create offer: ${f.message}`);console.log("Fresh offer created and set for reset call")}else if(t.answer&&e.remoteDescription===null){if(e.localDescription===null){console.log("Existing call has answer but no local offer - creating offer first...");const u=await e.createOffer();await e.setLocalDescription(u);const f={type:u.type,sdp:u.sdp};await Y.from("calls").update({offer:f}).eq("id",t.id),console.log("Created and set local offer, now setting remote answer")}const c=t.answer;await e.setRemoteDescription(new RTCSessionDescription(c));for(const u of i.current)await e.addIceCandidate(new RTCIceCandidate(u));i.current=[],s(!1)}else if(t.offer&&!l)if(console.log("Existing call has offer, but creating fresh offer for new peer connection..."),e.localDescription===null){const c=await e.createOffer();await e.setLocalDescription(c);const u={type:c.type,sdp:c.sdp},{error:f}=await Y.from("calls").update({offer:u}).eq("id",t.id);if(f)throw console.error("Error updating call with fresh offer:",f),new Error(`Failed to create offer: ${f.message}`);console.log("Fresh offer created and set for existing call")}else console.log("Peer connection already has local description, skipping");else{console.log("Existing call has no offer, creating one...");const{data:c,error:u}=await Y.from("calls").select("id, status, caller_type").eq("id",t.id).single();if(u||!c)throw console.error("Call verification failed:",u),new Error(`Call ${t.id} no longer exists or cannot be accessed`);if(Yt(c))throw new Error("Call has already ended");const f=await e.createOffer();await e.setLocalDescription(f);const h={type:f.type,sdp:f.sdp};console.log("Updating call with offer:",{callId:t.id,offerData:h});const{data:g,error:v}=await Y.from("calls").update({offer:h}).eq("id",t.id).select();if(console.log("Update response:",{data:g,error:v}),v)throw console.error("Error updating call with offer:",v),console.error("Error code:",v.code),console.error("Error message:",v.message),console.error("Error details:",JSON.stringify(v,null,2)),console.error("Call ID:",t.id),console.error("Offer data:",h),console.error("Offer data type:",typeof h),console.error("Offer data JSON:",JSON.stringify(h)),v.code==="PGRST204"||v.message?.includes("Could not find the 'offer' column")?new Error("Database schema cache is out of sync. Please refresh the page or contact support."):v.code==="42501"||v.code==="PGRST301"||v.message?.includes("permission denied")||v.message?.includes("new row violates row-level security")?new Error(`Permission denied: ${v.message}. Check RLS policies.`):v.code==="PGRST204"||v.code==="23514"?new Error(`Validation error: ${v.message}. Check data format.`):new Error(`Failed to send offer: ${v.message||JSON.stringify(v)}`);console.log("Offer created and sent for existing call")}return Y.channel(`call:${t.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls",filter:`id=eq.${t.id}`},async c=>{try{const u=c.new,f=c.old,h=Yt(u),g=f?Yt(f):null;if(h&&f!==void 0&&g===!1){const w=e.iceConnectionState;console.info(" [CALL LIFECYCLE] Call ended by remote party (child handler - existing call)",{callId:u.id,oldStatus:f?.status,newStatus:u.status,ended_at:u.ended_at,reason:"Status changed to terminal state in database",timestamp:new Date().toISOString(),connectionState:e.connectionState,iceConnectionState:w,signalingState:e.signalingState}),console.log(" [CALL LIFECYCLE] Call ended - closing peer connection immediately",{iceState:w,reason:"Call status changed to terminal - closing regardless of ICE state"}),e.signalingState!=="closed"&&e.close();return}if(u.status==="active"&&f?.status!=="active"&&console.log("Call status changed to active - parent answered the call!"),u.answer&&e.remoteDescription===null){console.log("Received answer from parent, setting remote description...");const w=u.answer;try{await e.setRemoteDescription(new RTCSessionDescription(w)),console.log("Remote description set successfully");for(const x of i.current)try{await e.addIceCandidate(new RTCIceCandidate(x))}catch{}i.current=[],s(!1),console.log("Call connected!")}catch(x){console.error("Error setting remote description:",x)}}const v=u.parent_ice_candidates;if(v&&Array.isArray(v)){const w=v.length;w>0&&w%10===0&&console.log(" [CHILD HANDLER] Processing ICE candidates (from parent):",{count:w,iceConnectionState:e.iceConnectionState});for(const x of v)try{if(!x.candidate){console.warn(" [CHILD HANDLER] Skipping invalid candidate (no candidate field)");continue}if(e.remoteDescription){const E=new RTCIceCandidate(x);await e.addIceCandidate(E)}else i.current.push(x)}catch(E){const C=E;C.message?.includes("duplicate")||C.message?.includes("already")||console.error(" [CHILD HANDLER] Error adding ICE candidate:",C.message)}}}catch(u){console.error("Error in call update handler:",u)}}).subscribe()},Qf=async(e,t,n,s,i)=>{if(console.log(" [CHILD HANDLER] Answering incoming call from parent:",{callId:t.id,hasOffer:!!t.offer,offerType:t.offer?.type}),n(t.id),!t.offer)throw new Error("Cannot answer call: offer not found");const l=t.offer;console.log(" [CHILD HANDLER] Setting remote description with parent's offer..."),await e.setRemoteDescription(new RTCSessionDescription(l)),await new Promise((E,C)=>{const b=setTimeout(()=>{C(new Error("Timeout waiting for signaling state change"))},5e3),k=()=>{e.signalingState==="have-remote-offer"||e.signalingState==="have-local-pranswer"?(clearTimeout(b),E()):setTimeout(k,100)};k()});const c=e.getSenders().map(E=>E.track).filter(Boolean);if(console.log(" [CHILD HANDLER] Tracks in peer connection before answer:",{audioTracks:c.filter(E=>E?.kind==="audio").length,videoTracks:c.filter(E=>E?.kind==="video").length,totalTracks:c.length,senders:e.getSenders().length,trackDetails:c.map(E=>({kind:E.kind,id:E.id,enabled:E.enabled,muted:E.muted}))}),c.length===0)throw console.error(" [CHILD HANDLER] NO TRACKS FOUND in peer connection! This will cause no video/audio. Make sure initializeConnection() was called and tracks were added."),new Error("Cannot create answer: no media tracks found. Please ensure camera/microphone permissions are granted.");const u=c.filter(E=>E?.kind==="audio"),f=c.filter(E=>E?.kind==="video");if(u.length===0&&f.length===0)throw console.error(" [CHILD HANDLER] No audio or video tracks found!"),new Error("Cannot create answer: no media tracks available.");console.log(" [CHILD HANDLER] Creating answer, current state:",e.signalingState);const h=await e.createAnswer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});console.log("[KCH]","child","created answer",!!h?.sdp),console.log(" [CHILD HANDLER] Answer created, setting local description..."),await e.setLocalDescription(h);const g=h.sdp?.includes("m=audio"),v=h.sdp?.includes("m=video");if(console.log(" [CHILD HANDLER] Answer SDP verification:",{type:h.type,sdpLength:h.sdp?.length,hasAudio:g,hasVideo:v,sdpPreview:h.sdp?.substring(0,200)}),!g&&!v)throw console.error(" [CHILD HANDLER] CRITICAL: Answer SDP has no media tracks! This will cause no video/audio."),new Error("Answer SDP missing media tracks - ensure tracks are added before creating answer");console.log(" [CHILD HANDLER] Updating call with answer...",{callId:t.id,answerType:h.type}),console.log("[KCH]","child","saving answer for call",t.id);const{error:w}=await Y.from("calls").update({answer:{type:h.type,sdp:h.sdp},status:"active",ended_at:null}).eq("id",t.id);if(w)throw console.error(" [CHILD HANDLER] Error updating call with answer:",w),new Error(`Failed to send answer: ${w.message}`);console.log(" [CHILD HANDLER] Answer sent successfully to parent");const x=i.current.length;if(x>0){console.log(` [CHILD HANDLER] Processing ${x} queued ICE candidates after answer`);for(const E of i.current)try{await e.addIceCandidate(new RTCIceCandidate(E))}catch(C){const b=C;!b.message?.includes("duplicate")&&!b.message?.includes("already")&&console.error(" [CHILD HANDLER] Error processing queued ICE candidate:",b.message)}i.current=[]}return s(!1),console.log(" [CHILD HANDLER] Call connected! Child answered parent's call."),(async()=>{try{const{data:E}=await Y.from("calls").select("parent_ice_candidates").eq("id",t.id).maybeSingle();if(E){const C=E.parent_ice_candidates;if(C&&Array.isArray(C)&&C.length>0){console.log(" [CHILD HANDLER] Processing existing ICE candidates from parent (immediate):",{count:C.length,hasRemoteDescription:!!e.remoteDescription,iceConnectionState:e.iceConnectionState});for(const b of C)try{if(!b.candidate)continue;e.remoteDescription?(await e.addIceCandidate(new RTCIceCandidate(b)),console.log(" [CHILD HANDLER] Added existing ICE candidate from parent")):i.current.push(b)}catch(k){const _=k;!_.message?.includes("duplicate")&&!_.message?.includes("already")&&console.error(" [CHILD HANDLER] Error adding existing ICE candidate:",_.message)}}}}catch(E){console.error(" [CHILD HANDLER] Error fetching existing ICE candidates:",E)}})(),Y.channel(`call:${t.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls",filter:`id=eq.${t.id}`},async E=>{const C=E.new,b=E.old,k=Yt(C),_=b?Yt(b):null;if(k&&b!==void 0&&_===!1){const j=e.iceConnectionState;console.info(" [CALL LIFECYCLE] Call ended by remote party (child handler - incoming call)",{callId:C.id,oldStatus:b?.status,newStatus:C.status,ended_at:C.ended_at,reason:"Status changed to terminal state in database",timestamp:new Date().toISOString(),connectionState:e.connectionState,iceConnectionState:j,signalingState:e.signalingState}),console.log(" [CALL LIFECYCLE] Call ended - closing peer connection immediately",{iceState:j,reason:"Call status changed to terminal - closing regardless of ICE state"}),e.signalingState!=="closed"&&e.close();return}const N=C.parent_ice_candidates;if(N&&Array.isArray(N)){i.current.length;const j=N.length;j>0&&j%10===0&&console.log(" [CHILD HANDLER] Processing ICE candidates (incoming call, from parent):",{count:j,iceConnectionState:e.iceConnectionState});const R=new Set;for(const T of N)try{if(!T.candidate)continue;const P=`${T.candidate}-${T.sdpMLineIndex}-${T.sdpMid||""}`;if(R.has(P))continue;if(R.add(P),e.remoteDescription){const O=new RTCIceCandidate(T);await e.addIceCandidate(O)}else i.current.push(T)}catch(P){const O=P;!O.message?.includes("duplicate")&&!O.message?.includes("already")&&console.error(" [CHILD HANDLER] Error adding ICE candidate:",O.message)}j>0&&R.size>0&&R.size%10===0&&console.log(" [CHILD HANDLER] Processed",R.size,"ICE candidates from parent",{iceConnectionState:e.iceConnectionState})}}).subscribe()},P$=async(e,t,n,s,i,l)=>{console.log(" [CHILD CALL] Creating call for child:",t.id,"parent:",n);const{data:c,error:u}=await Y.from("children").select("id, parent_id").eq("id",t.id).eq("parent_id",n).single();if(u||!c)throw console.error(" [CHILD CALL] Child verification failed:",{childId:t.id,parentId:n,error:u,childData:c}),new Error(`Child verification failed: ${u?.message||"Child not found or parent mismatch"}`);console.log(" [CHILD CALL] Child verified, attempting insert:",{childId:t.id,parentId:n,childData:c});const{data:f,error:h}=await Y.from("calls").insert({child_id:t.id,parent_id:n,caller_type:"child",status:"ringing"}).select().single();if(h)throw console.error(" [CHILD CALL] Call creation error:",{error:h,code:h.code,message:h.message,details:h.details,hint:h.hint,insertData:{child_id:t.id,parent_id:n,caller_type:"child",status:"ringing"}}),new Error(`Failed to create call: ${h.message}`);if(!f)throw new Error("Failed to create call: No call data returned");if(console.log(" [CHILD CALL] Call created successfully:",{callId:f.id,childId:f.child_id,parentId:f.parent_id,callerType:f.caller_type,status:f.status,createdAt:f.created_at}),s(f.id),e.signalingState==="closed")throw new Error("Peer connection is closed. Please try again.");if(e.connectionState==="closed"||e.connectionState==="failed")throw new Error(`Peer connection is in ${e.connectionState} state. Please try again.`);const g=e.getSenders().map(N=>N.track).filter(Boolean);if(console.log(" [CHILD CALL] Tracks in peer connection before offer:",{audioTracks:g.filter(N=>N?.kind==="audio").length,videoTracks:g.filter(N=>N?.kind==="video").length,totalTracks:g.length,senders:e.getSenders().length,trackDetails:g.map(N=>({kind:N.kind,id:N.id,enabled:N.enabled,muted:N.muted}))}),g.length===0)throw console.error(" [CHILD CALL] NO TRACKS FOUND in peer connection! This will cause no video/audio. Make sure initializeConnection() was called and tracks were added."),new Error("Cannot create offer: no media tracks found. Please ensure camera/microphone permissions are granted.");const v=g.filter(N=>N?.kind==="audio"),w=g.filter(N=>N?.kind==="video");if(v.length===0&&w.length===0)throw console.error(" [CHILD CALL] No audio or video tracks found!"),new Error("Cannot create offer: no media tracks available.");console.log("Creating offer, current signaling state:",e.signalingState);const x=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});console.log("[KCH]","child","created offer",!!x?.sdp);const E=x.sdp?.includes("m=audio"),C=x.sdp?.includes("m=video");if(console.log(" [CHILD CALL] Offer SDP verification:",{hasAudio:E,hasVideo:C,sdpLength:x.sdp?.length,sdpPreview:x.sdp?.substring(0,200)}),!E&&!C)throw console.error(" [CHILD CALL] CRITICAL: Offer SDP has no media tracks! This will cause no video/audio."),new Error("Offer SDP missing media tracks - ensure tracks are added before creating offer");console.log("Offer created, setting local description..."),await e.setLocalDescription(x);const b={type:x.type,sdp:x.sdp};console.log("Updating call with offer:",{callId:f.id,offerData:b}),console.log("[KCH]","child","saving offer for call",f.id);const{data:k,error:_}=await Y.from("calls").update({offer:b}).eq("id",f.id).select();if(console.log("Update response:",{data:k,error:_}),_)throw console.error("Error updating call with offer:",_),console.error("Error code:",_.code),console.error("Error message:",_.message),console.error("Error details:",JSON.stringify(_,null,2)),console.error("Call ID:",f.id),console.error("Offer data:",b),console.error("Offer data type:",typeof b),console.error("Offer data JSON:",JSON.stringify(b)),_.code==="PGRST204"||_.message?.includes("Could not find the 'offer' column")?new Error("Database schema cache is out of sync. Please refresh the page or contact support."):_.code==="42501"||_.code==="PGRST301"||_.message?.includes("permission denied")||_.message?.includes("new row violates row-level security")?new Error(`Permission denied: ${_.message}. Check RLS policies.`):_.code==="PGRST204"||_.code==="23514"?new Error(`Validation error: ${_.message}. Check data format.`):new Error(`Failed to send offer: ${_.message||JSON.stringify(_)}`);return console.log("Offer sent successfully"),Y.channel(`call:${f.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls",filter:`id=eq.${f.id}`},async N=>{const j=N.new,R=N.old,T=Yt(j),P=R?Yt(R):null;if(T&&R!==void 0&&P===!1){const G=e.iceConnectionState;console.info(" [CALL LIFECYCLE] Call ended by remote party (child handler - child initiated)",{callId:j.id,oldStatus:R?.status,newStatus:j.status,ended_at:j.ended_at,reason:"Status changed to terminal state in database",timestamp:new Date().toISOString(),connectionState:e.connectionState,iceConnectionState:G,signalingState:e.signalingState}),console.log(" [CALL LIFECYCLE] Call ended - closing peer connection immediately",{iceState:G,reason:"Call status changed to terminal - closing regardless of ICE state"}),e.signalingState!=="closed"&&e.close();return}if(j.answer&&e.remoteDescription===null)try{console.log(" [CHILD HANDLER] Received answer from parent, setting remote description...",{callId:j.id,hasAnswer:!!j.answer,answerType:j.answer?.type,currentRemoteDesc:!!e.remoteDescription});const G=j.answer;await e.setRemoteDescription(new RTCSessionDescription(G)),console.log(" [CHILD HANDLER] Remote description set successfully from parent's answer");for(const L of l.current)try{await e.addIceCandidate(new RTCIceCandidate(L))}catch(F){const I=F;!I.message?.includes("duplicate")&&!I.message?.includes("already")&&console.error(" [CHILD HANDLER] Error adding queued ICE candidate:",I.message)}l.current=[],i(!1),console.log(" [CHILD HANDLER] Call connected! Child received answer from parent."),(async()=>{try{const{data:L}=await Y.from("calls").select("parent_ice_candidates").eq("id",j.id).maybeSingle();if(L){const F=L.parent_ice_candidates;if(F&&Array.isArray(F)&&F.length>0){console.log(" [CHILD HANDLER] Processing existing ICE candidates from parent (immediate after answer):",{count:F.length,hasRemoteDescription:!!e.remoteDescription,iceConnectionState:e.iceConnectionState});for(const I of F)try{if(!I.candidate)continue;e.remoteDescription?await e.addIceCandidate(new RTCIceCandidate(I)):l.current.push(I)}catch(U){const M=U;!M.message?.includes("duplicate")&&!M.message?.includes("already")&&console.error(" [CHILD HANDLER] Error adding existing ICE candidate:",M.message)}console.log(" [CHILD HANDLER] Finished processing existing ICE candidates from parent")}}}catch(L){console.error(" [CHILD HANDLER] Error fetching existing ICE candidates:",L)}})()}catch(G){console.error(" [CHILD HANDLER] Error setting remote description from answer:",G)}const O=j.parent_ice_candidates;if(O&&Array.isArray(O)){l.current.length;const G=O.length;G>0&&G%10===0&&console.log(" [CHILD HANDLER] Processing ICE candidates (child initiated, from parent):",{count:G,iceConnectionState:e.iceConnectionState});for(const L of O)try{if(!L.candidate)continue;if(e.remoteDescription){const F=new RTCIceCandidate(L);await e.addIceCandidate(F)}else l.current.push(L)}catch(F){const I=F;!I.message?.includes("duplicate")&&!I.message?.includes("already")&&console.error(" [CHILD HANDLER] Error adding ICE candidate:",I.message)}}}).subscribe()},I$=()=>{const{childId:e}=cd(),[t]=L0(),n=tt(),{toast:s}=Ct(),{playRingtone:i,stopRingtone:l,playCallAnswered:c}=Ym({enabled:!0,volume:.7}),u=p.useRef(!1),f=window.location.pathname.includes("/child/"),h=window.location.pathname.includes("/parent/"),[g]=p.useState(()=>{if(f)return!0;if(h)return!1;const X=localStorage.getItem("childSession");return X&&window.location.pathname.match(/^\/call\/([^/?]+)/)?!0:!(document.cookie.includes("sb-")||localStorage.getItem("sb-"))&&!!X}),[v,w]=p.useState(null),[x,E]=p.useState(!1),[C,b]=p.useState(!1),k=p.useRef(null),_=p.useRef(null),N=p.useRef(null),j=p.useRef(null);console.log(" [ROLE DETECTION] useVideoCall role:",{isChild:g,route:window.location.pathname,isChildRoute:f,isParentRoute:h,timestamp:new Date().toISOString()});const{localStream:R,remoteStream:T,isConnecting:P,setIsConnecting:O,initializeConnection:G,cleanup:L,iceCandidatesQueue:F,peerConnectionRef:I,playRemoteVideo:U,isConnected:M}=XS(v,k,_,g),B=p.useRef(!1);p.useEffect(()=>{B.current=!1},[v]),p.useEffect(()=>(P&&!T&&v?(console.log(" [AUDIO] Outgoing call - starting ringtone"),i()):(T||!P)&&(console.log(" [AUDIO] Call answered or connected - stopping ringtone"),l(),T&&!B.current&&c()),()=>{l()}),[P,T,v,i,l,c]),p.useEffect(()=>{if(T&&_.current&&!B.current){const K=I.current?.iceConnectionState,te=_.current,q=M&&!!T;if(console.log(" [VIDEO PLAY] Attempting to play remote video:",{hasRemoteStream:!!T,hasVideoElement:!!te,iceState:K,isConnecting:P,callIsConnected:q,videoReadyState:te.readyState,videoPaused:te.paused,videoSrcObject:!!te.srcObject}),q&&(K==="connected"||K==="completed"))if(te.readyState>=2)B.current=!0,console.log(" [VIDEO PLAY] Stream available, call connected, ICE connected, video ready (readyState:",te.readyState,")"),U();else{console.log(" [VIDEO PLAY] Waiting for video readyState >= 2 (current:",te.readyState,")");const se=()=>{te.readyState>=2&&!B.current&&(B.current=!0,console.log(" [VIDEO PLAY] Video ready (readyState:",te.readyState,"), attempting play"),U())};te.addEventListener("loadeddata",se,{once:!0}),te.addEventListener("canplay",se,{once:!0}),te.addEventListener("canplaythrough",se,{once:!0})}else if(q&&(K==="new"||K==="checking"))if(console.log(" [VIDEO PLAY] Call connected but ICE still establishing - attempting play anyway (state:",K,")"),te.readyState>=2)B.current=!0,console.log(" [VIDEO PLAY] Video ready, attempting play (ICE still:",K,")"),U();else{const se=()=>{te.readyState>=2&&!B.current&&(B.current=!0,console.log(" [VIDEO PLAY] Video ready, attempting play (ICE still:",K,")"),U())};te.addEventListener("loadeddata",se,{once:!0}),te.addEventListener("canplay",se,{once:!0}),te.addEventListener("canplaythrough",se,{once:!0});const fe=setInterval(()=>{const we=I.current?.iceConnectionState;(we==="connected"||we==="completed")&&(clearInterval(fe),!B.current&&te.readyState>=2&&(B.current=!0,console.log(" [VIDEO PLAY] ICE connected, video ready, attempting play"),U()))},500);return setTimeout(()=>{clearInterval(fe),B.current||(console.warn(" [VIDEO PLAY] Timeout waiting for video readyState, attempting play anyway"),B.current=!0,U())},5e3),()=>clearInterval(fe)}else if(!q&&(K==="new"||K==="checking")){console.log(" [VIDEO PLAY] Waiting for call to connect and ICE connection - current state:",K);const se=setInterval(()=>{const ge=I.current?.iceConnectionState;if(!P&&(ge==="connected"||ge==="completed")){if(clearInterval(se),te.readyState>=2&&!B.current)B.current=!0,console.log(" [VIDEO PLAY] Call connected, ICE connected, video ready (readyState:",te.readyState,"), attempting play"),U();else if(!B.current){const Re=()=>{te.readyState>=2&&!B.current&&(B.current=!0,console.log(" [VIDEO PLAY] Video ready after call and ICE connected (readyState:",te.readyState,")"),U())};te.addEventListener("loadeddata",Re,{once:!0}),te.addEventListener("canplay",Re,{once:!0}),te.addEventListener("canplaythrough",Re,{once:!0})}}else(ge==="failed"||ge==="closed")&&(clearInterval(se),console.error(" [VIDEO PLAY] ICE connection failed, cannot play media"))},500);return setTimeout(()=>{clearInterval(se),!B.current&&te.readyState>=2&&(console.warn(" [VIDEO PLAY] Connection timeout but video is ready, attempting play"),B.current=!0,U())},15e3),()=>clearInterval(se)}else console.error(" [VIDEO PLAY] ICE connection in terminal state:",K)}},[T,U,P]),p.useEffect(()=>u.current?void 0:((async()=>{const{data:{session:K}}=await Y.auth.getSession(),te=localStorage.getItem("childSession"),q=window.location.pathname.match(/^\/call\/([^/?]+)/);if(te&&q)return g!==!0&&console.warn(" [ROLE DETECTION] Role mismatch detected (correcting to child):",{isChildState:g,isChildUser:!0,route:window.location.pathname,reason:"childSession exists and on call page"}),!0;const se=!K&&!!te;return se!==g&&console.warn(" [ROLE DETECTION] Role mismatch detected:",{isChildState:g,isChildUser:se,route:window.location.pathname,hasSession:!!K,hasChildSession:!!te}),se})().then(K=>{u.current=!0,V(K).catch(te=>{{console.error("Call initialization error:",te),u.current=!1;const q=te instanceof Error?te.message:"Unknown error occurred";s({title:"Connection Error",description:q,variant:"destructive"})}})}).catch(K=>{console.error("Error determining user type:",K)}),()=>{}),[e]);const V=async X=>{console.log(" [INITIALIZE CALL] ===== INITIALIZE CALL ENTRY =====",{isChildUser:X,childId:e,timestamp:new Date().toISOString()});try{console.log(" [INITIALIZE CALL] Initializing WebRTC connection..."),await G();const K=I.current;if(!K)throw new Error("Failed to create peer connection");console.log(" [INITIALIZE CALL] WebRTC connection initialized:",{signalingState:K.signalingState,senders:K.getSenders().length,tracks:K.getSenders().map(q=>q.track).filter(Boolean).length});let te;X?(console.log(" [INITIALIZE CALL] Setting up child call flow..."),te=await z(K)):(console.log(" [INITIALIZE CALL] Setting up parent call flow..."),te=await ee(K)),console.log(" [INITIALIZE CALL] Call flow setup complete:",{hasChannel:!!te,isChildUser:X}),te&&(N.current=te)}catch(K){const te=K instanceof Error?K.message:"Unknown error occurred";throw s({title:"Connection Error",description:te,variant:"destructive"}),O(!1),K}},ee=async X=>{console.log(" [PARENT CALL FLOW] ===== PARENT CALL FLOW ENTRY =====",{childId:e,timestamp:new Date().toISOString(),signalingState:X.signalingState,senders:X.getSenders().length,tracks:X.getSenders().map(K=>K.track).filter(Boolean).length});try{const{data:{user:K},error:te}=await Y.auth.getUser();if(console.log(" [PARENT CALL FLOW] Auth check complete:",{hasUser:!!K,userId:K?.id,hasAuthError:!!te}),te)return console.error("Auth error in parent call flow:",te),s({title:"Authentication Error",description:"Please log in again to make calls",variant:"destructive"}),null;if(!K||!e)return console.error("Missing user or childId in parent call flow"),s({title:"Error",description:"Unable to start call. Please try again.",variant:"destructive"}),null;console.log(" [PARENT CALL FLOW] Calling handleParentCall...",{childId:e,userId:K.id,timestamp:new Date().toISOString()});const q=t.get("callId"),se=await A$(X,e,K.id,fe=>{console.log(" [PARENT CALL FLOW] CallId set:",fe),w(fe);const ge=D(fe);ge&&(j.current=ge)},O,F,q);return console.log(" [PARENT CALL FLOW] handleParentCall returned:",{hasChannel:!!se,timestamp:new Date().toISOString()}),se}catch(K){const te=K instanceof Error?K.message:"Unknown error occurred",q=te.includes("Database schema cache");throw s({title:q?"Database Schema Error":"Error",description:q?"The database schema cache needs to be refreshed. Please contact support or try refreshing the page.":te,variant:"destructive"}),O(!1),K}},z=async X=>{try{const K=t.get("callId"),te=!!K,q=localStorage.getItem("childSession");if(!q)if(te&&e)console.warn(" [CHILD CALL FLOW] No child session but answering call - attempting to continue with childId from URL");else{console.error(" [CHILD CALL FLOW] No child session and not answering call - redirecting to login"),n("/child/login");return}const se=JSON.parse(q||"{}");if(!se.id&&te&&e&&(console.warn(" [CHILD CALL FLOW] Invalid child session but answering call - using childId from URL"),se.id=e),!se.id)if(console.error(" [CHILD CALL FLOW] No valid child ID found"),te)console.warn(" [CHILD CALL FLOW] Continuing call without valid child ID");else{n("/child/login");return}const{data:fe,error:ge}=await Y.from("children").select("parent_id").eq("id",se.id).single();if(ge||!fe)if(console.error("Child not found in database:",ge),!v&&!te){localStorage.removeItem("childSession"),s({title:"Session expired",description:"Please log in again with your code",variant:"destructive"}),n("/child/login");return}else console.warn(" [CHILD CALL FLOW] Child verification failed but continuing call",{isAnsweringCall:te,hasCallId:!!v,reason:"Call is active or answering - don't navigate away"});let we=fe?.parent_id;if(!we&&se.parent_id&&(we=se.parent_id,console.warn(" [CHILD CALL FLOW] Using parent_id from child session cache")),!we)if(console.error(" [CHILD CALL FLOW] Unable to determine parent ID",{hasChildData:!!fe,hasChildSession:!!se,childId:se.id}),K)console.warn(" [CHILD CALL FLOW] Continuing call without parent_id - call handler may have it");else throw new Error("Unable to determine parent ID for call. Please log in again.");if(!we&&K){console.log(" [CHILD CALL FLOW] No parentId but answering call - fetching from call record");try{const{data:We}=await Y.from("calls").select("parent_id").eq("id",K).maybeSingle();We?.parent_id&&(we=We.parent_id,console.log(" [CHILD CALL FLOW] Got parentId from call record:",we))}catch(We){console.warn(" [CHILD CALL FLOW] Could not fetch parentId from call record:",We)}}return await R$(X,se,{parent_id:we||"unknown"},We=>{w(We);const Ge=D(We);Ge&&(j.current=Ge)},O,F,K)}catch(K){const te=K instanceof Error?K.message:"Unknown error occurred",q=te.includes("Database schema cache"),se=t.get("callId"),fe=!!se;throw console.error(" [CHILD CALL FLOW] Error in handleChildCallFlow:",{errorMessage:te,isAnsweringCall:fe,urlCallId:se,hasChildSession:!!localStorage.getItem("childSession")}),s({title:q?"Database Schema Error":"Connection Error",description:q?"The database schema cache needs to be refreshed. Please contact support or try refreshing the page.":fe?"Failed to connect to call. Please try again.":te,variant:"destructive"}),O(!1),fe||n("/child/dashboard"),K}},$=()=>{if(R){const X=!x;R.getAudioTracks().forEach(K=>{K.enabled=!X}),E(X)}},W=()=>{if(R){const X=!C;R.getVideoTracks().forEach(K=>{K.enabled=!X}),b(X)}},D=X=>Y.channel(`call-termination:${X}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls",filter:`id=eq.${X}`},async te=>{try{const q=te.new,se=te.old;se?.status!==void 0&&se.status!==q.status&&console.log(" [CALL LIFECYCLE] Call status update received:",{callId:q.id,oldStatus:se?.status,newStatus:q.status,timestamp:new Date().toISOString()});const ge=Yt(q),we=se?Yt(se):null;if(console.log(" [TERMINATION LISTENER] Checking termination conditions:",{isTerminal:ge,hasOldCall:se!==void 0,wasTerminal:we,callIdMatch:q.id===X,oldStatus:se?.status,newStatus:q.status,oldEndedAt:se?.ended_at,newEndedAt:q.ended_at}),ge&&se!==void 0&&we===!1&&q.id===X){const Re=I.current,Be=Re?.iceConnectionState;console.info(" [CALL LIFECYCLE] Call ended by remote party - cleaning up",{callId:X,oldStatus:se?.status,newStatus:q.status,ended_at:q.ended_at,ended_by:q.ended_by,reason:"Call reached terminal state (ended or ended_at set) in database",timestamp:new Date().toISOString(),connectionState:Re?.connectionState,iceConnectionState:Be,hasRemoteStream:!!T,remoteVideoReadyState:_.current?.readyState});const We=Be!=="new"&&Be!=="checking";console.log(" [CALL LIFECYCLE] Call ended by remote party - cleaning up immediately",{iceState:Be,reason:"Call reached terminal state - cleaning up regardless of ICE state"}),s({title:"Call Ended",description:"The other person ended the call",variant:"default"}),L(),N.current&&(Y.removeChannel(N.current),N.current=null),j.current&&(Y.removeChannel(j.current),j.current=null);const{data:{session:Ge}}=await Y.auth.getSession(),ie=localStorage.getItem("childSession"),Pe=window.location.pathname.match(/^\/call\/([^/?]+)/);let ae=!1;ie&&Pe?ae=!0:ae=!Ge&&!!ie,console.log(" [USER TYPE DETECTION] Termination listener - determining user type:",{hasAuthSession:!!Ge,hasChildSession:!!ie,isChildUser:ae,route:window.location.pathname,isCallPage:!!Pe,userId:Ge?.user?.id||null,timestamp:new Date().toISOString()}),n(ae?"/child/dashboard":Ge?"/parent/dashboard":"/")}}catch(q){console.error(" [CALL LIFECYCLE] Error in termination listener:",q)}}).subscribe(),Q=p.useRef(null);return p.useEffect(()=>{M&&T&&v&&!Q.current&&(Q.current=Date.now(),console.log(" [CALL LIFECYCLE] Call started (ICE connected)",{callId:v,timestamp:new Date().toISOString(),iceState:I.current?.iceConnectionState,connectionState:I.current?.connectionState}))},[M,T,v,I]),p.useEffect(()=>{!P&&v&&!Q.current&&!M&&console.log(" [CALL LIFECYCLE] Call signaling complete (waiting for ICE)",{callId:v,timestamp:new Date().toISOString()})},[P,v]),{localVideoRef:k,remoteVideoRef:_,localStream:R,remoteStream:T,isConnecting:P,isMuted:x,isVideoOff:C,isChild:g,toggleMute:$,toggleVideo:W,endCall:async()=>{const X=Q.current?Date.now()-Q.current:null;console.log(" [USER ACTION] User ended call",{callId:v,callDurationMs:X,callDurationSeconds:X?Math.round(X/1e3):null,timestamp:new Date().toISOString(),connectionState:I.current?.connectionState,iceConnectionState:I.current?.iceConnectionState,hasRemoteStream:!!T,remoteVideoReadyState:_.current?.readyState}),X&&X<5e3&&console.warn(" [USER ACTION] Call ended very quickly - might be accidental",{durationMs:X,durationSeconds:Math.round(X/1e3)});const{data:{session:K}}=await Y.auth.getSession(),te=localStorage.getItem("childSession"),q=!K&&!!te,se=q?"child":"parent";if(console.log(" [USER TYPE DETECTION] End call - determining user type:",{hasAuthSession:!!K,hasChildSession:!!te,isChildUser:q,by:se,userId:K?.user?.id||null,timestamp:new Date().toISOString()}),v)try{await Xs({callId:v,by:se,reason:"hangup"})}catch(fe){console.error(" [USER ACTION] Error ending call:",fe)}Q.current=null,l(),L(!0),N.current&&(Y.removeChannel(N.current),N.current=null),j.current&&(Y.removeChannel(j.current),j.current=null),n(q?"/child/dashboard":"/parent/dashboard")}}},D$=()=>{const{localVideoRef:e,remoteVideoRef:t,remoteStream:n,isConnecting:s,isMuted:i,isVideoOff:l,toggleMute:c,toggleVideo:u,endCall:f,callStartTime:h}=I$();return a.jsx(Qm,{localVideoRef:e,remoteVideoRef:t,remoteStream:n,isConnecting:s,isMuted:i,isVideoOff:l,onToggleMute:c,onToggleVideo:u,onEndCall:f,callStartTime:h})},O$=()=>{const{childId:e}=cd(),[t,n]=p.useState([]),[s,i]=p.useState(""),[l,c]=p.useState(!1),[u,f]=p.useState(null),[h,g]=p.useState(null),[v,w]=p.useState(!1),[x,E]=p.useState("Mom/Dad"),C=p.useRef(null),b=p.useRef(null),k=tt(),{toast:_}=Ct();p.useEffect(()=>((async()=>{let G=null;try{const{data:{session:L}}=await Y.auth.getSession();if(L?.user)if(c(!1),e)G=e,j(e),N(e);else{k("/parent/children");return}else{const F=localStorage.getItem("childSession");if(F)try{const I=JSON.parse(F);c(!0),f(I),G=I.id,j(I.id),Y.from("children").select("parent_id").eq("id",I.id).single().then(({data:U,error:M})=>{if(M||!U){console.error("Error fetching child record:",M);return}return Y.from("parents").select("id, name").eq("id",U.parent_id).maybeSingle()}).then(U=>{U?.data?(E(U.data.name),g({name:U.data.name,id:U.data.id})):U?.error&&console.error("Error fetching parent data:",U.error)}).catch(U=>{console.error("Error fetching parent data:",U)})}catch(I){console.error("Error parsing childSession:",I),k("/");return}else if(e){k("/");return}else{k("/");return}}}catch(L){console.error("Error checking auth session:",L),k("/");return}if(G){console.log(" [CHAT] Setting up realtime subscription for messages",{childId:G,isChild:l,timestamp:new Date().toISOString()});const L=`messages-${G}`;console.log(" [CHAT] Creating realtime channel:",{channelName:L,targetChildId:G,filter:`child_id=eq.${G}`,isChild:l}),b.current=Y.channel(L).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`child_id=eq.${G}`},F=>{console.log(" [CHAT] Received new message via realtime:",{messageId:F.new.id,senderType:F.new.sender_type,childId:F.new.child_id,filterChildId:G,matches:F.new.child_id===G,timestamp:new Date().toISOString()}),F.new.child_id===G?n(I=>I.some(M=>M.id===F.new.id)?(console.warn(" [CHAT] Duplicate message detected, ignoring:",F.new.id),I):[...I,F.new]):console.warn(" [CHAT] Received message for different child_id, ignoring:",{received:F.new.child_id,expected:G})}).subscribe((F,I)=>{console.log(" [CHAT] Realtime subscription status:",{status:F,channel:L,childId:G,isChild:l,error:I,timestamp:new Date().toISOString()}),F==="SUBSCRIBED"?(console.log(" [CHAT] Successfully subscribed to messages"),console.log(" [CHAT] Will receive INSERT events for child_id:",G)):F==="CHANNEL_ERROR"?(console.error(" [CHAT] Realtime subscription error:",I),console.error(" [CHAT] This usually means:"),console.error("   1. RLS policies are blocking SELECT access"),console.error("   2. Realtime is not enabled for messages table"),console.error("   3. WebSocket connection failed"),console.error(" [CHAT] Falling back to polling (checking every 3 seconds)")):F==="TIMED_OUT"?console.warn(" [CHAT] Realtime subscription timed out - using polling fallback"):F==="CLOSED"?console.warn(" [CHAT] Realtime subscription closed - using polling fallback"):console.log(" [CHAT] Realtime subscription status:",F)})}})(),()=>{b.current&&(console.log(" [CHAT] Cleaning up realtime subscription"),Y.removeChannel(b.current),b.current=null)}),[e,k]),p.useEffect(()=>{T()},[t]),p.useEffect(()=>{if(!u)return;(async()=>{try{const L=!!localStorage.getItem("childSession"),F=L?u.id:e;if(!F){console.log(" [CHAT READ] No targetChildId, skipping mark as read");return}console.log(" [CHAT READ] Starting mark as read process",{targetChildId:F,isChild:L,timestamp:new Date().toISOString()});let I=Y.from("messages").select("id, sender_type, read_at").eq("child_id",F).is("read_at",null);L?I=I.eq("sender_type","parent"):I=I.eq("sender_type","child");const{data:U,error:M}=await I;if(M){console.error(" [CHAT READ] Error fetching unread messages:",M);return}if(!U||U.length===0){console.log(" [CHAT READ] No unread messages found"),Ze.getState().clearUnreadForChild(F);return}const B=U.map(z=>z.id);console.log(` [CHAT READ] Found ${B.length} unread messages to mark as read`,{messageIds:B.slice(0,5),totalCount:B.length});const V=new Date().toISOString(),{error:ee}=await Y.from("messages").update({read_at:V}).in("id",B);if(ee){console.error(" [CHAT READ] Error marking messages as read:",ee);return}console.log(` [CHAT READ] Successfully marked ${B.length} messages as read`,{readAt:V}),n(z=>z.map($=>B.includes($.id)?{...$,read_at:V}:$)),Ze.getState().clearUnreadForChild(F),console.log(` [CHAT READ] Badge cleared immediately for child ${F}`)}catch(G){console.error(" [CHAT READ] Error in markMessagesAsRead:",G)}})()},[u,e]),p.useEffect(()=>()=>{const L=!!localStorage.getItem("childSession")?u?.id||null:e;L&&(console.log(" [CHAT CLEANUP] Clearing badge on chat exit",{targetChildId:L}),Ze.getState().clearUnreadForChild(L))},[u,e]),p.useEffect(()=>{if(!u)return;const O=l?u.id:e;if(!O)return;const G=setInterval(async()=>{try{const{data:L,error:F}=await Y.from("messages").select("*").eq("child_id",O).order("created_at",{ascending:!0});!F&&L&&n(I=>{const U=new Set(I.map(B=>B.id)),M=L.filter(B=>!U.has(B.id));return M.length>0?(console.log(" [CHAT] Polling found new messages:",M.length),[...I,...M]):I})}catch(L){console.error(" [CHAT] Polling error:",L)}},15e3);return()=>clearInterval(G)},[u,e,l]);const N=async O=>{const{data:G}=await Y.from("children").select("*").eq("id",O).single();G&&f(G)},j=async O=>{const{data:G,error:L}=await Y.from("messages").select("*").eq("child_id",O).order("created_at",{ascending:!0});if(L){_({title:"Error loading messages",description:L.message,variant:"destructive"});return}n(G||[])},R=async O=>{if(O.preventDefault(),!(!s.trim()||!u)){w(!0);try{const G=l?u.id:e;let L,F;if(l)L=u.id,F=void 0;else{const{data:{user:B},error:V}=await Y.auth.getUser();if(V||!B)throw new Error("Not authenticated. Please log in again.");L=B.id,F=B.id}if(!L)throw new Error("Missing sender_id");if(!G)throw new Error("Missing child_id");const I={child_id:G,sender_id:L,sender_type:l?"child":"parent",content:s.trim()};Qn.log(" [MESSAGE INSERT] Payload:",{child_id:I.child_id,sender_id:I.sender_id,sender_type:I.sender_type,content_length:I.content.length,isChild:l,auth_uid:F,sender_id_matches_auth_uid:l?"N/A (anon)":L===F});const{data:U,error:M}=await Y.from("messages").insert(I).select().single();if(M)throw Qn.error(" [MESSAGE INSERT] Error:",{message:M.message,code:M.code,details:M.details?ps(M.details):void 0,hint:M.hint,payload_metadata:{child_id:I.child_id,sender_type:I.sender_type,content_length:I.content.length}}),M;if(Qn.log(" [MESSAGE INSERT] Success",{messageId:U?.id}),U){const B={id:U.id,sender_type:U.sender_type,content:U.content,created_at:U.created_at};n(V=>V.some(z=>z.id===B.id)?(Qn.log(" [MESSAGE INSERT] Message already in state (realtime beat us), skipping optimistic update"),V):(Qn.log(" [MESSAGE INSERT] Adding message to local state (optimistic update)"),[...V,B]))}i("")}catch(G){Qn.error(" [MESSAGE INSERT] Exception:",Qi(G)),_({title:"Error sending message",description:G.message||"Failed to send message",variant:"destructive"})}finally{w(!1)}}},T=()=>{C.current?.scrollIntoView({behavior:"smooth"})},P=()=>{k(l?"/child/dashboard":"/parent/children")};return a.jsxs("div",{className:"min-h-[100dvh] flex flex-col bg-background relative",children:[a.jsxs("div",{className:"bg-chat-accent p-4 flex items-center gap-4 fixed top-0 left-0 right-0 z-10",children:[a.jsx(ce,{onClick:P,variant:"ghost",size:"sm",className:"text-white",children:a.jsx(Sx,{className:"h-5 w-5"})}),a.jsxs("div",{className:"flex items-center gap-3",children:[l?h&&a.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold bg-primary",children:h.name[0].toUpperCase()}):u&&a.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold",style:{backgroundColor:u.avatar_color},children:u.name[0]}),a.jsx("h1",{className:"text-xl font-bold text-white",children:l?x:u?.name})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{paddingTop:"80px",paddingBottom:"100px"},children:[t.map(O=>{const G=l?O.sender_type==="child":O.sender_type==="parent";return a.jsx("div",{className:`flex ${G?"justify-end":"justify-start"}`,children:a.jsxs(Te,{className:`max-w-xs p-3 ${G?"bg-chat-accent text-chat-accent-foreground":"bg-muted"}`,children:[a.jsx("p",{className:"break-words",children:O.content}),a.jsx("p",{className:`text-xs mt-1 ${G?"text-white/70":"text-muted-foreground"}`,children:new Date(O.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},O.id)}),a.jsx("div",{ref:C})]}),a.jsx("form",{onSubmit:R,className:"p-4 bg-card border-t fixed bottom-0 left-0 right-0 z-10",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(hr,{value:s,onChange:O=>i(O.target.value),placeholder:"Type a message...",disabled:v,className:"flex-1"}),a.jsx(ce,{type:"submit",disabled:v||!s.trim(),className:"bg-chat-accent text-chat-accent-foreground hover:bg-chat-accent/90",children:a.jsx(Rk,{className:"h-4 w-4"})})]})})]})};var L$="Separator",Uw="horizontal",M$=["horizontal","vertical"],e_=p.forwardRef((e,t)=>{const{decorative:n,orientation:s=Uw,...i}=e,l=$$(s)?s:Uw,u=n?{role:"none"}:{"aria-orientation":l==="vertical"?l:void 0,role:"separator"};return a.jsx(Oe.div,{"data-orientation":l,...u,...i,ref:t})});e_.displayName=L$;function $$(e){return M$.includes(e)}var t_=e_;const Gt=p.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...s},i)=>a.jsx(t_,{ref:i,decorative:n,orientation:t,className:be("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...s}));Gt.displayName=t_.displayName;const F$=Fm,U$=yC,B$=Um,n_=p.forwardRef(({className:e,...t},n)=>a.jsx(Ra,{className:be("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));n_.displayName=Ra.displayName;const z$=Xc("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),r_=p.forwardRef(({side:e="right",className:t,children:n,...s},i)=>a.jsxs(B$,{children:[a.jsx(n_,{}),a.jsxs(Pa,{ref:i,className:be(z$({side:e}),t),...s,children:[n,a.jsxs(wd,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[a.jsx(Rr,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));r_.displayName=Pa.displayName;const s_=({className:e,...t})=>a.jsx("div",{className:be("flex flex-col space-y-2 text-center sm:text-left",e),...t});s_.displayName="SheetHeader";const o_=p.forwardRef(({className:e,...t},n)=>a.jsx(Ia,{ref:n,className:be("text-lg font-semibold text-foreground",e),...t}));o_.displayName=Ia.displayName;const V$=p.forwardRef(({className:e,...t},n)=>a.jsx(Da,{ref:n,className:be("text-sm text-muted-foreground",e),...t}));V$.displayName=Da.displayName;const H$=()=>{const e=tt();gn();const[t,n]=p.useState(!1),[s,i]=p.useState(!1),[l,c]=p.useState(null),[u,f]=p.useState(!0);p.useEffect(()=>{(async()=>{try{const{data:{session:C}}=await Y.auth.getSession(),b=localStorage.getItem("childSession");if(C)c("parent");else if(b)try{JSON.parse(b),c("child")}catch{c(null)}else c(null)}catch(C){console.error("Error determining user type:",C),c(null)}finally{f(!1)}})()},[]);const h=()=>l==="parent"?"/parent":l==="child"?"/child":"/",g=p.useMemo(()=>l==="parent",[l]);p.useEffect(()=>{const E=()=>{const C=window.scrollY;n(C>300)};return window.addEventListener("scroll",E),()=>window.removeEventListener("scroll",E)},[]);const v=E=>{const C=document.getElementById(E);C&&(C.scrollIntoView({behavior:"smooth",block:"start"}),i(!1))},w=()=>{window.scrollTo({top:0,behavior:"smooth"})},x=[{id:"description",label:"App Description"},{id:"pricing",label:"Pricing & Subscription"},{id:"terms",label:"Terms & Conditions"},{id:"privacy",label:"Privacy Policy"},{id:"cancel",label:"Cancellation Policy"},{id:"removal",label:"Personal Information Removal"},{id:"contact",label:"Contact & Support"},{id:"demo",label:"Demo / Test Account"}];return a.jsxs("div",{className:"min-h-[100dvh] bg-background w-full overflow-x-hidden",children:[a.jsx(Ot,{}),a.jsx("div",{className:"px-4 pb-8",style:{paddingTop:"calc(0.5rem + 64px + var(--safe-area-inset-top) * 0.15)"},children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsx("div",{className:"mt-4 mb-8",children:a.jsxs("div",{className:"flex items-start justify-between gap-4 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("img",{src:"/icon-192x192.png",alt:"Kids Call Home",className:"w-16 h-16 rounded-xl shadow-md",width:"64",height:"64"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(jc,{className:"h-6 w-6 flex-shrink-0"}),a.jsx("h1",{className:"text-3xl font-bold",children:"App Information"})]}),a.jsx("p",{className:"text-muted-foreground",children:"Important information about Kids Call Home"})]})]}),!u&&a.jsxs(ce,{onClick:()=>e(h()),variant:"default",size:"lg",className:"flex-shrink-0 shadow-md",children:[a.jsx(Sx,{className:"h-4 w-4 mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:l==="parent"?"Back to Parent Home":l==="child"?"Back to Kid Home":"Back to App"}),a.jsx(Ys,{className:"h-4 w-4 sm:hidden"})]})]})}),a.jsx(Te,{className:"p-4 mb-6 sticky top-4 z-10 bg-background/95 backdrop-blur-sm",children:a.jsxs("div",{className:"flex flex-wrap gap-2 text-sm",children:[a.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>v("description"),children:"Description"}),a.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>v("pricing"),children:"Pricing"}),a.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>v("terms"),children:"Terms"}),a.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>v("privacy"),children:"Privacy"}),a.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>v("cancel"),children:"Cancellation"}),a.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>v("removal"),children:"Data Removal"}),a.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>v("contact"),children:"Contact"})]})}),a.jsx("section",{id:"description",className:"mb-8 scroll-mt-20",children:a.jsxs(Te,{className:"p-6",children:[a.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center gap-2",children:[a.jsx(jc,{className:"h-5 w-5"}),"App Description"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Short Description"}),a.jsx("p",{className:"text-muted-foreground",children:"Stay connected with your family through simple video calls and messaging."})]}),a.jsx(Gt,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Full Description"}),a.jsx("p",{className:"text-muted-foreground leading-relaxed",children:"Kids Call Home is a family communication app that enables secure video calls and messaging between parents and children. Parents can create accounts and manage their children's access, while kids can easily call and message their parents using a special login code. The app works on WiFi-only devices (no SIM card required) and also supports devices with cellular data (LTE, 3G, 4G, 5G). Perfect for tablets, Chromebooks, and mobile devices."})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Key Features"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 text-muted-foreground",children:[a.jsx("li",{children:"Video calls between parents and children"}),a.jsx("li",{children:"Secure messaging"}),a.jsx("li",{children:"Simple login codes for kids"}),a.jsx("li",{children:"Parent account management"}),a.jsx("li",{children:"Real-time notifications"}),a.jsx("li",{children:"Mobile-friendly interface"}),a.jsx("li",{children:"Progressive Web App (PWA)"}),a.jsx("li",{children:"Works without SIM card or phone number"}),a.jsx("li",{children:"Low-bandwidth optimization"})]})]})]})]})}),a.jsx("section",{id:"pricing",className:"mb-8 scroll-mt-20",children:a.jsxs(Te,{className:"p-6",children:[a.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center gap-2",children:[a.jsx(yk,{className:"h-5 w-5"}),"Pricing & Subscription Terms"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-primary/10 p-4 rounded-lg border border-primary/20",children:[a.jsx("p",{className:"font-semibold text-primary mb-2",children:"Free Tier Available"}),a.jsx("p",{className:"text-muted-foreground",children:"The app allows 1 parent and 1 child account for free. Charges apply for each additional child account."})]}),a.jsx(Gt,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Subscription Plans"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium",children:"Additional Kid Monthly"}),a.jsx("span",{className:"text-lg font-bold",children:"$2.99/month"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Add one more child to your account"})]}),a.jsxs("div",{className:"border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium",children:"Additional Kid Annual"}),a.jsx("span",{className:"text-lg font-bold",children:"$29.99/year"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Add one more child (save 17% vs monthly)"})]}),a.jsxs("div",{className:"border rounded-lg p-4 border-primary/50",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h4",{className:"font-medium",children:"Family Bundle Monthly"}),a.jsx(Nc,{className:"h-4 w-4 text-primary"})]}),a.jsx("span",{className:"text-lg font-bold",children:"$14.99/month"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Perfect for families with up to 5 kids"})]}),a.jsxs("div",{className:"border-2 border-primary rounded-lg p-4 bg-primary/5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h4",{className:"font-medium",children:"Annual Family Plan"}),a.jsx(Nc,{className:"h-4 w-4 text-primary"}),a.jsx("span",{className:"text-xs bg-primary text-primary-foreground px-2 py-0.5 rounded",children:"Best Value"})]}),a.jsx("span",{className:"text-lg font-bold",children:"$99/year"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Best value - unlimited kids for the whole family"})]})]})]}),g&&a.jsx("div",{className:"pt-4",children:a.jsxs(ce,{onClick:()=>e("/parent/upgrade"),className:"w-full sm:w-auto",children:["View Full Pricing Details",a.jsx(kc,{className:"ml-2 h-4 w-4"})]})})]})]})}),a.jsx("section",{id:"terms",className:"mb-8 scroll-mt-20",children:a.jsxs(Te,{className:"p-6",children:[a.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center gap-2",children:[a.jsx(wk,{className:"h-5 w-5"}),"Terms & Conditions"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-muted-foreground",children:"By using Kids Call Home, you agree to the following terms and conditions:"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Account Responsibility"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Parents are responsible for maintaining the security of their account and managing their children's access. You must provide accurate information when creating an account."})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Acceptable Use"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"The app is intended for family communication only. Users must not use the service for any illegal, harmful, or unauthorized purposes. Harassment, abuse, or inappropriate content is strictly prohibited."})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Service Availability"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"We strive to maintain service availability but do not guarantee uninterrupted access. The service may be temporarily unavailable due to maintenance, updates, or technical issues."})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Age Requirements"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Parents must be at least 18 years old to create an account. Children's accounts are managed by their parents."})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Limitation of Liability"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Kids Call Home is provided "as is" without warranties. We are not liable for any damages arising from use of the service, including but not limited to communication failures or data loss.'})]})]}),a.jsx("div",{className:"pt-4 border-t",children:a.jsx("p",{className:"text-xs text-muted-foreground",children:"These terms may be updated from time to time. Continued use of the service constitutes acceptance of updated terms."})})]})]})}),a.jsx("section",{id:"privacy",className:"mb-8 scroll-mt-20",children:a.jsxs(Te,{className:"p-6",children:[a.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center gap-2",children:[a.jsx(Zc,{className:"h-5 w-5"}),"Privacy Policy"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Data Collection"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Kids Call Home collects the following information:"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-muted-foreground ml-4",children:[a.jsx("li",{children:"Account information (email, name) for parent accounts"}),a.jsx("li",{children:"Child profile information (name, login code) managed by parents"}),a.jsx("li",{children:"Device information for security and device management"}),a.jsx("li",{children:"Call and message data for service functionality"})]})]}),a.jsx(Gt,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Data Usage"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"We use collected data solely to provide and improve the service. Data is not sold to third parties. We use industry-standard security measures to protect your information."})]}),a.jsx(Gt,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Data Storage"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Data is stored securely using Supabase (PostgreSQL database) with encryption at rest. Video calls use WebRTC peer-to-peer connections when possible, minimizing data transmission through our servers."})]}),a.jsx(Gt,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Children's Privacy"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"We comply with COPPA (Children's Online Privacy Protection Act). All children's accounts are created and managed by parents. We do not knowingly collect personal information from children without parental consent."})]}),a.jsx(Gt,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Data Queries & Requests"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"For questions about your data or to request access, correction, or deletion, please contact us at:"}),a.jsx("div",{className:"bg-muted p-3 rounded-lg",children:a.jsx("p",{className:"font-mono text-sm",children:"support@kidscallhome.com"})})]})]})]})}),a.jsx("section",{id:"cancel",className:"mb-8 scroll-mt-20",children:a.jsxs(Te,{className:"p-6",children:[a.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center gap-2",children:[a.jsx(pk,{className:"h-5 w-5"}),"Cancellation Policy"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"How to Cancel Subscription"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"You can cancel your subscription at any time through your Account Settings:"}),a.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm text-muted-foreground ml-4",children:[a.jsx("li",{children:"Navigate to Account Settings (accessible from the main menu)"}),a.jsx("li",{children:"Find the Subscription section"}),a.jsx("li",{children:'Click "Cancel Subscription"'}),a.jsx("li",{children:"Confirm the cancellation"})]}),g&&a.jsx("div",{className:"mt-4",children:a.jsxs(ce,{variant:"outline",onClick:()=>e("/parent/settings"),className:"w-full sm:w-auto",children:["Go to Account Settings",a.jsx(kc,{className:"ml-2 h-4 w-4"})]})})]}),a.jsx(Gt,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Access After Cancellation"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"When you cancel your subscription, you will continue to have access to all premium features until the end of your current billing period. After expiration, your account will automatically revert to the free tier (1 child limit). Existing children can still use the app, but you won't be able to add more children until you resubscribe."})]}),a.jsx(Gt,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Refund Policy"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Subscriptions are billed in advance. Refunds are not available for partial billing periods. If you cancel during a billing period, you retain access until the period ends without additional charges."})]}),a.jsx(Gt,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Account Deletion"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["To delete your account completely, please contact support at"," ",a.jsx("a",{href:"mailto:support@kidscallhome.com",className:"text-primary hover:underline",children:"support@kidscallhome.com"}),". Account deletion will permanently remove all your data, including children's accounts, messages, and call history."]})]})]})]})}),a.jsx("section",{id:"removal",className:"mb-8 scroll-mt-20",children:a.jsxs(Te,{className:"p-6",children:[a.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center gap-2",children:[a.jsx(Zh,{className:"h-5 w-5"}),"Personal Information Removal"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Requesting Data Deletion"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"You can request deletion of your personal information and account data in the following ways:"}),a.jsxs("ul",{className:"list-disc list-inside space-y-2 text-sm text-muted-foreground ml-4",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Email Request:"})," Send an email to"," ",a.jsx("a",{href:"mailto:support@kidscallhome.com",className:"text-primary hover:underline",children:"support@kidscallhome.com"})," ",'with the subject "Account Deletion Request" and include your account email address.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"In-App Request:"})," Contact support through the app's support section (see Contact & Support below)."]})]})]}),a.jsx(Gt,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"What Gets Deleted"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"When you request account deletion, the following data will be permanently removed:"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-muted-foreground ml-4",children:[a.jsx("li",{children:"Parent account information (email, name, profile data)"}),a.jsx("li",{children:"All children's accounts associated with your parent account"}),a.jsx("li",{children:"All messages and call history"}),a.jsx("li",{children:"Device registration information"}),a.jsx("li",{children:"Subscription and payment information (after required retention period)"})]})]}),a.jsx(Gt,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Response Time"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["We typically process deletion requests within"," ",a.jsx("strong",{children:"7-14 business days"}),". You will receive a confirmation email once your data has been deleted. Some data may be retained for legal or regulatory compliance purposes for a limited time, but will not be used for service purposes."]})]}),a.jsx(Gt,{}),a.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[a.jsx("p",{className:"text-sm font-semibold mb-1",children:"Important Note"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Account deletion is permanent and cannot be undone. Make sure you want to delete your account before submitting a request."})]})]})]})}),a.jsx("section",{id:"contact",className:"mb-8 scroll-mt-20",children:a.jsxs(Te,{className:"p-6",children:[a.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center gap-2",children:[a.jsx(bk,{className:"h-5 w-5"}),"Contact & Support"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Support Email"}),a.jsx("div",{className:"bg-muted p-4 rounded-lg mb-3",children:a.jsx("p",{className:"font-mono text-base",children:"support@kidscallhome.com"})}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"For technical support, account questions, billing inquiries, or data deletion requests, please email us at the address above. We aim to respond within 24-48 hours."})]}),a.jsx(Gt,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"What to Include in Support Emails"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-muted-foreground ml-4",children:[a.jsx("li",{children:"Your account email address"}),a.jsx("li",{children:"Description of the issue or request"}),a.jsx("li",{children:"Device type and browser/app version (if reporting a technical issue)"}),a.jsx("li",{children:"Screenshots (if applicable)"})]})]}),a.jsx(Gt,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Common Support Topics"}),a.jsxs("div",{className:"grid sm:grid-cols-2 gap-2 text-sm text-muted-foreground",children:[a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Jn,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:"Account setup and login issues"})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Jn,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:"Subscription and billing questions"})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Jn,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:"Video call connection problems"})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Jn,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:"Data deletion requests"})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Jn,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:"Privacy and security concerns"})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Jn,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:"Feature requests and feedback"})]})]})]})]})]})}),a.jsx("section",{id:"demo",className:"mb-8 scroll-mt-20",children:a.jsxs(Te,{className:"p-6 border-dashed",children:[a.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Demo / Test Account"}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"For app store reviewers: The app requires account creation to use. You can create a free parent account and add one child account at no cost. For testing premium features, please contact support for test account credentials."}),a.jsx("div",{className:"bg-muted p-4 rounded-lg",children:a.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.jsx("strong",{children:"Note:"})," Test account information is available upon request for app store review purposes. Please contact"," ",a.jsx("a",{href:"mailto:support@kidscallhome.com",className:"text-primary hover:underline",children:"support@kidscallhome.com"})," ","with your review request."]})})]})]})}),a.jsx("div",{className:"text-center pt-8",children:a.jsx(ce,{variant:"outline",onClick:w,children:"Back to Top"})})]})}),t&&a.jsxs("div",{className:"fixed right-6 z-50 flex flex-col gap-2",style:{bottom:"calc(1.5rem + var(--safe-area-inset-bottom))"},children:[!u&&a.jsx(ce,{onClick:()=>e(h()),size:"lg",className:"h-14 w-14 rounded-full shadow-lg","aria-label":"Back to App",title:l==="parent"?"Back to Parent Home":l==="child"?"Back to Kid Home":"Back to App",children:a.jsx(Ys,{className:"h-6 w-6"})}),a.jsxs(F$,{open:s,onOpenChange:i,children:[a.jsx(U$,{asChild:!0,children:a.jsx(ce,{size:"lg",className:"h-14 w-14 rounded-full shadow-lg","aria-label":"Open navigation menu",children:a.jsx(Ck,{className:"h-6 w-6"})})}),a.jsxs(r_,{side:"right",className:"w-80",children:[a.jsx(s_,{children:a.jsx(o_,{children:"Navigate to Section"})}),a.jsxs("div",{className:"mt-6 space-y-2",children:[x.map(E=>a.jsx(ce,{variant:"ghost",className:"w-full justify-start",onClick:()=>v(E.id),children:E.label},E.id)),a.jsx("div",{className:"pt-4 border-t mt-4",children:a.jsxs(ce,{variant:"outline",className:"w-full",onClick:w,children:[a.jsx(Ex,{className:"mr-2 h-4 w-4"}),"Back to Top"]})})]})]})]})]})]})};function W$(){p.useEffect(()=>{let e=!0;return(async()=>{try{const n=Oa();e&&(Object.keys(n.unreadMessagesByChild).length>0||Object.keys(n.missedCallsByChild).length>0)&&(console.log(" [BADGE INIT] Loading cached badge state from local storage"),Ze.getState().setInitialUnread(n.unreadMessagesByChild),Ze.getState().setInitialMissed(n.missedCallsByChild));const s=localStorage.getItem("childSession");if(!!s){const c=JSON.parse(s).id,u=Fo(c,"messages"),f=Fo(c,"calls");let h=Y.from("messages").select("child_id, created_at").eq("child_id",c).eq("sender_type","parent").is("read_at",null);u&&(h=h.gt("created_at",u));const{data:g,error:v}=await h;if(v)throw v;let w=Y.from("calls").select("child_id, created_at").eq("child_id",c).eq("caller_type","parent").eq("missed_call",!0).is("missed_call_read_at",null);f&&(w=w.gt("created_at",f));const{data:x,error:E}=await w;if(E)throw E;if(e){const C=g?.length??0,b=x?.length??0;console.log(` [BADGE INIT] Child ${c}: ${C} new unread messages, ${b} new missed calls`,{lastClearedMessages:u,lastClearedCalls:f}),Ze.getState().setInitialUnread({[c]:C}),Ze.getState().setInitialMissed({[c]:b})}}else{const{data:{user:l}}=await Y.auth.getUser();if(!l)return;const{data:c,error:u}=await Y.from("children").select("id").eq("parent_id",l.id);if(u)throw u;if(!c||c.length===0)return;const f=c.map(v=>v.id),h={},g={};for(const v of f){const w=Fo(v,"messages"),x=Fo(v,"calls");let E=Y.from("messages").select("child_id, created_at").eq("child_id",v).eq("sender_type","child").is("read_at",null);w&&(E=E.gt("created_at",w));const{data:C}=await E;h[v]=C?.length??0;let b=Y.from("calls").select("child_id, created_at").eq("child_id",v).eq("caller_type","child").eq("missed_call",!0).is("missed_call_read_at",null);x&&(b=b.gt("created_at",x));const{data:k}=await b;g[v]=k?.length??0}e&&(console.log(` [BADGE INIT] Parent: loaded badge counts for ${f.length} children`,{unreadByChild:h,missedByChild:g}),Ze.getState().setInitialUnread(h),Ze.getState().setInitialMissed(g))}}catch(n){console.error("Error fetching initial badge counts:",n)}})(),()=>{e=!1}},[])}function q$(){const e=p.useRef(null),t=p.useRef(null);return p.useEffect(()=>{const s=!!localStorage.getItem("childSession");return e.current=Y.channel("badge-messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},i=>{const l=i.new,c=Fo(l.child_id,"messages");c&&l.created_at<=c||(s?l.sender_type==="parent"&&!l.read_at&&Ze.getState().incrementUnread(l.child_id):l.sender_type==="child"&&!l.read_at&&Ze.getState().incrementUnread(l.child_id))}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"messages"},i=>{const l=i.old,c=i.new,u=!l.read_at,f=!!c.read_at;u&&f&&(s?l.sender_type==="parent"&&Ze.getState().decrementUnread(l.child_id):l.sender_type==="child"&&Ze.getState().decrementUnread(l.child_id))}).subscribe((i,l)=>{l?console.error(" [BADGE REALTIME] Messages subscription error:",l):(i==="CHANNEL_ERROR"||i==="TIMED_OUT")&&console.error(" [BADGE REALTIME] Messages subscription failed:",i)}),t.current=Y.channel("badge-calls").on("postgres_changes",{event:"INSERT",schema:"public",table:"calls"},i=>{const l=i.new,c=Fo(l.child_id,"calls");c&&l.created_at<=c||l.missed_call&&!l.missed_call_read_at&&(s?l.caller_type==="parent"&&Ze.getState().incrementMissed(l.child_id):l.caller_type==="child"&&Ze.getState().incrementMissed(l.child_id))}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls"},i=>{const l=i.old,c=i.new,u=!l.missed_call_read_at,f=!!c.missed_call_read_at;u&&f&&l.missed_call&&(s?l.caller_type==="parent"&&Ze.getState().decrementMissed(l.child_id):l.caller_type==="child"&&Ze.getState().decrementMissed(l.child_id)),c.status==="active"&&l.status!=="active"&&(console.log(" [BADGE REALTIME] Call became active - clearing missed call badge",{childId:c.child_id,callerType:c.caller_type}),s?c.caller_type==="parent"&&Ze.getState().clearMissedForChild(c.child_id):c.caller_type==="child"&&Ze.getState().clearMissedForChild(c.child_id)),!l.missed_call&&c.missed_call&&!c.missed_call_read_at&&(s?c.caller_type==="parent"&&Ze.getState().incrementMissed(c.child_id):c.caller_type==="child"&&Ze.getState().incrementMissed(c.child_id))}).subscribe((i,l)=>{l?console.error(" [BADGE REALTIME] Calls subscription error:",l):(i==="CHANNEL_ERROR"||i==="TIMED_OUT")&&console.error(" [BADGE REALTIME] Calls subscription failed:",i)}),()=>{e.current&&Y.removeChannel(e.current),t.current&&Y.removeChannel(t.current)}},[]),null}const G$=e=>{const t=new Map;t.set("web",{name:"web"});const n=e.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:t},s=(l,c)=>{n.platforms.set(l,c)},i=l=>{n.platforms.has(l)&&(n.currentPlatform=n.platforms.get(l))};return n.addPlatform=s,n.setPlatform=i,n},K$=e=>e.CapacitorPlatforms=G$(e),i_=K$(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});i_.addPlatform;i_.setPlatform;var Jo;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(Jo||(Jo={}));class Xf extends Error{constructor(t,n,s){super(t),this.message=t,this.code=n,this.data=s}}const Y$=e=>{var t,n;return e?.androidBridge?"android":!((n=(t=e?.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},J$=e=>{var t,n,s,i,l;const c=e.CapacitorCustomPlatform||null,u=e.Capacitor||{},f=u.Plugins=u.Plugins||{},h=e.CapacitorPlatforms,g=()=>c!==null?c.name:Y$(e),v=((t=h?.currentPlatform)===null||t===void 0?void 0:t.getPlatform)||g,w=()=>v()!=="web",x=((n=h?.currentPlatform)===null||n===void 0?void 0:n.isNativePlatform)||w,E=P=>{const O=j.get(P);return!!(O?.platforms.has(v())||k(P))},C=((s=h?.currentPlatform)===null||s===void 0?void 0:s.isPluginAvailable)||E,b=P=>{var O;return(O=u.PluginHeaders)===null||O===void 0?void 0:O.find(G=>G.name===P)},k=((i=h?.currentPlatform)===null||i===void 0?void 0:i.getPluginHeader)||b,_=P=>e.console.error(P),N=(P,O,G)=>Promise.reject(`${G} does not have an implementation of "${O}".`),j=new Map,R=(P,O={})=>{const G=j.get(P);if(G)return console.warn(`Capacitor plugin "${P}" already registered. Cannot register plugins twice.`),G.proxy;const L=v(),F=k(P);let I;const U=async()=>(!I&&L in O?I=typeof O[L]=="function"?I=await O[L]():I=O[L]:c!==null&&!I&&"web"in O&&(I=typeof O.web=="function"?I=await O.web():I=O.web),I),M=(W,D)=>{var Q,le;if(F){const X=F?.methods.find(K=>D===K.name);if(X)return X.rtype==="promise"?K=>u.nativePromise(P,D.toString(),K):(K,te)=>u.nativeCallback(P,D.toString(),K,te);if(W)return(Q=W[D])===null||Q===void 0?void 0:Q.bind(W)}else{if(W)return(le=W[D])===null||le===void 0?void 0:le.bind(W);throw new Xf(`"${P}" plugin is not implemented on ${L}`,Jo.Unimplemented)}},B=W=>{let D;const Q=(...le)=>{const X=U().then(K=>{const te=M(K,W);if(te){const q=te(...le);return D=q?.remove,q}else throw new Xf(`"${P}.${W}()" is not implemented on ${L}`,Jo.Unimplemented)});return W==="addListener"&&(X.remove=async()=>D()),X};return Q.toString=()=>`${W.toString()}() { [capacitor code] }`,Object.defineProperty(Q,"name",{value:W,writable:!1,configurable:!1}),Q},V=B("addListener"),ee=B("removeListener"),z=(W,D)=>{const Q=V({eventName:W},D),le=async()=>{const K=await Q;ee({eventName:W,callbackId:K},D)},X=new Promise(K=>Q.then(()=>K({remove:le})));return X.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await le()},X},$=new Proxy({},{get(W,D){switch(D){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return F?z:V;case"removeListener":return ee;default:return B(D)}}});return f[P]=$,j.set(P,{name:P,proxy:$,platforms:new Set([...Object.keys(O),...F?[L]:[]])}),$},T=((l=h?.currentPlatform)===null||l===void 0?void 0:l.registerPlugin)||R;return u.convertFileSrc||(u.convertFileSrc=P=>P),u.getPlatform=v,u.handleError=_,u.isNativePlatform=x,u.isPluginAvailable=C,u.pluginMethodNoop=N,u.registerPlugin=T,u.Exception=Xf,u.DEBUG=!!u.DEBUG,u.isLoggingEnabled=!!u.isLoggingEnabled,u.platform=u.getPlatform(),u.isNative=u.isNativePlatform(),u},Q$=e=>e.Capacitor=J$(e),Qo=Q$(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),li=Qo.registerPlugin;Qo.Plugins;class a_{constructor(t){this.listeners={},this.retainedEventArguments={},this.windowListeners={},t&&(console.warn(`Capacitor WebPlugin "${t.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=t)}addListener(t,n){let s=!1;this.listeners[t]||(this.listeners[t]=[],s=!0),this.listeners[t].push(n);const l=this.windowListeners[t];l&&!l.registered&&this.addWindowListener(l),s&&this.sendRetainedArgumentsForEvent(t);const c=async()=>this.removeListener(t,n);return Promise.resolve({remove:c})}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,n,s){const i=this.listeners[t];if(!i){if(s){let l=this.retainedEventArguments[t];l||(l=[]),l.push(n),this.retainedEventArguments[t]=l}return}i.forEach(l=>l(n))}hasListeners(t){return!!this.listeners[t].length}registerWindowListener(t,n){this.windowListeners[n]={registered:!1,windowEventName:t,pluginEventName:n,handler:s=>{this.notifyListeners(n,s)}}}unimplemented(t="not implemented"){return new Qo.Exception(t,Jo.Unimplemented)}unavailable(t="not available"){return new Qo.Exception(t,Jo.Unavailable)}async removeListener(t,n){const s=this.listeners[t];if(!s)return;const i=s.indexOf(n);this.listeners[t].splice(i,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const n=this.retainedEventArguments[t];n&&(delete this.retainedEventArguments[t],n.forEach(s=>{this.notifyListeners(t,s)}))}}const Bw=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),zw=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class X$ extends a_{async getCookies(){const t=document.cookie,n={};return t.split(";").forEach(s=>{if(s.length<=0)return;let[i,l]=s.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");i=zw(i).trim(),l=zw(l).trim(),n[i]=l}),n}async setCookie(t){try{const n=Bw(t.key),s=Bw(t.value),i=`; expires=${(t.expires||"").replace("expires=","")}`,l=(t.path||"/").replace("path=",""),c=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${n}=${s||""}${i}; path=${l}; ${c};`}catch(n){return Promise.reject(n)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const n of t)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}li("CapacitorCookies",{web:()=>new X$});const Z$=async e=>new Promise((t,n)=>{const s=new FileReader;s.onload=()=>{const i=s.result;t(i.indexOf(",")>=0?i.split(",")[1]:i)},s.onerror=i=>n(i),s.readAsDataURL(e)}),eF=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(i=>i.toLocaleLowerCase()).reduce((i,l,c)=>(i[l]=e[t[c]],i),{})},tF=(e,t=!0)=>e?Object.entries(e).reduce((s,i)=>{const[l,c]=i;let u,f;return Array.isArray(c)?(f="",c.forEach(h=>{u=t?encodeURIComponent(h):h,f+=`${l}=${u}&`}),f.slice(0,-1)):(u=t?encodeURIComponent(c):c,f=`${l}=${u}`),`${s}&${f}`},"").substr(1):null,nF=(e,t={})=>{const n=Object.assign({method:e.method||"GET",headers:e.headers},t),i=eF(e.headers)["content-type"]||"";if(typeof e.data=="string")n.body=e.data;else if(i.includes("application/x-www-form-urlencoded")){const l=new URLSearchParams;for(const[c,u]of Object.entries(e.data||{}))l.set(c,u);n.body=l.toString()}else if(i.includes("multipart/form-data")||e.data instanceof FormData){const l=new FormData;if(e.data instanceof FormData)e.data.forEach((u,f)=>{l.append(f,u)});else for(const u of Object.keys(e.data))l.append(u,e.data[u]);n.body=l;const c=new Headers(n.headers);c.delete("content-type"),n.headers=c}else(i.includes("application/json")||typeof e.data=="object")&&(n.body=JSON.stringify(e.data));return n};class rF extends a_{async request(t){const n=nF(t,t.webFetchExtra),s=tF(t.params,t.shouldEncodeUrlParams),i=s?`${t.url}?${s}`:t.url,l=await fetch(i,n),c=l.headers.get("content-type")||"";let{responseType:u="text"}=l.ok?t:{};c.includes("application/json")&&(u="json");let f,h;switch(u){case"arraybuffer":case"blob":h=await l.blob(),f=await Z$(h);break;case"json":f=await l.json();break;case"document":case"text":default:f=await l.text()}const g={};return l.headers.forEach((v,w)=>{g[w]=v}),{data:f,headers:g,status:l.status,url:l.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}li("CapacitorHttp",{web:()=>new rF});const sF=li("App",{web:()=>gr(()=>import("./web-DPiwP7vi.js"),[]).then(e=>new e.AppWeb)});var Vh;(function(e){e.Heavy="HEAVY",e.Medium="MEDIUM",e.Light="LIGHT"})(Vh||(Vh={}));var Vw;(function(e){e.Success="SUCCESS",e.Warning="WARNING",e.Error="ERROR"})(Vw||(Vw={}));const oF=li("Haptics",{web:()=>gr(()=>import("./web-C3lEwkHx.js"),[]).then(e=>new e.HapticsWeb)}),fs=li("PushNotifications",{});var Hw;(function(e){e[e.Sunday=1]="Sunday",e[e.Monday=2]="Monday",e[e.Tuesday=3]="Tuesday",e[e.Wednesday=4]="Wednesday",e[e.Thursday=5]="Thursday",e[e.Friday=6]="Friday",e[e.Saturday=7]="Saturday"})(Hw||(Hw={}));const l_=li("LocalNotifications",{web:()=>gr(()=>import("./web-DOwnM_-Y.js"),[]).then(e=>new e.LocalNotificationsWeb)});function tp(){return Qo.getPlatform()==="android"}function Td(){return Qo.isNativePlatform()}async function c_(e=[200,100,200,100,200]){if(tp())try{for(let t=0;t<e.length;t+=2)await oF.impact({style:Vh.Heavy}),e[t+1]&&await new Promise(n=>setTimeout(n,e[t+1]))}catch(t){console.warn("Vibration pattern not available:",t)}}async function d_(){if(!Td())return!1;try{return(await fs.requestPermissions()).receive==="granted"}catch(e){return console.error("Failed to request push notification permission:",e),!1}}async function iF(e,t,n,s,i){if(Td())try{if(!await d_()){console.warn("Push notification permission not granted");return}fs.addListener("registration",c=>{console.log("Push registration success, token: "+c.value)}),fs.addListener("registrationError",c=>{console.error("Push registration error:",c)}),fs.addListener("pushNotificationActionPerformed",c=>{const u=c.notification.data;u?.action==="accept"?s():u?.action==="decline"&&i()}),await l_.schedule({notifications:[{title:"Incoming Call",body:`${t} is calling...`,id:parseInt(e.slice(0,8),16)||Date.now(),sound:"default",attachments:void 0,actionTypeId:"INCOMING_CALL",extra:{callId:e,callerName:t,callerId:n,action:"incoming_call"},schedule:{at:new Date(Date.now()+100)}}]}),await c_([200,100,200,100,200])}catch(l){console.error("Failed to show incoming call notification:",l)}}async function aF(e){if(Td())try{const t=parseInt(e.slice(0,8),16)||Date.now();await l_.cancel({notifications:[{id:t}]})}catch(t){console.error("Failed to cancel notification:",t)}}async function lF(){if(Td())try{fs.addListener("registration",e=>{console.log(" Push registration success, token: "+e.value)}),fs.addListener("registrationError",e=>{console.error(" Push registration error:",e)}),fs.addListener("pushNotificationReceived",e=>{console.log(" Push notification received:",e)}),fs.addListener("pushNotificationActionPerformed",e=>{console.log(" Push notification action performed:",e),e.notification.data?.url}),sF.addListener("appStateChange",({isActive:e})=>{console.log("App state changed. Is active?",e)}),await d_()}catch(e){console.error("Failed to initialize native Android features:",e)}}function cF({callId:e,callerName:t,callerId:n,onAccept:s,onDecline:i,isActive:l}){const c=p.useRef(null),{playRingtone:u,stopRingtone:f}=Ym({enabled:!0,volume:.8});return p.useEffect(()=>!tp()||!l?void 0:(iF(e,t,n,s,i).catch(g=>{console.error("Failed to show native call notification:",g)}),(async()=>{for(;l;)await c_([200,100,200,100,200]),await new Promise(g=>setTimeout(g,2e3))})(),u().catch(g=>{console.error("Failed to play ringtone:",g)}),()=>{c.current&&clearInterval(c.current),f(),aF(e).catch(()=>{})}),[e,t,n,l,s,i,u,f]),null}const dF=()=>{const[e,t]=p.useState(null),n=p.useRef(null),s=p.useRef(null),i=p.useRef(!1),l=tt(),c=gn(),{handleIncomingCall:u,stopIncomingCall:f}=Jm({enabled:!0,volume:.7}),h=p.useRef(u);p.useEffect(()=>{n.current=e},[e]),p.useEffect(()=>{h.current=u},[u]),p.useEffect(()=>{let w=null,x=null,E=null;(async()=>{const{data:{session:b}}=await Y.auth.getSession(),k=localStorage.getItem("childSession"),_=!b&&!!k;if(!b&&!k)return;!_&&b?.user?.id&&(E=b.user.id);const N=async T=>{if(T.id!==w&&!c.pathname.startsWith("/call/"))if(w=T.id,_){const{data:P}=await Y.from("parents").select("name").eq("id",T.parent_id).maybeSingle();t({id:T.id,parent_id:T.parent_id,parent_name:P?.name||"Parent"}),h.current({callId:T.id,callerName:P?.name||"Parent",callerId:T.parent_id,url:`/call/${T.child_id}?callId=${T.id}`})}else{const{data:P}=await Y.from("children").select("name, avatar_color").eq("id",T.child_id).single();P&&(t({id:T.id,child_id:T.child_id,child_name:P.name,child_avatar_color:P.avatar_color}),h.current({callId:T.id,callerName:P.name,callerId:T.child_id,url:`/call/${T.child_id}?callId=${T.id}`}))}},j=async()=>{const T=new Date(Date.now()-12e4).toISOString();if(_){const P=JSON.parse(k),{data:O}=await Y.from("calls").select("*").eq("child_id",P.id).eq("caller_type","parent").eq("status","ringing").gte("created_at",T).order("created_at",{ascending:!1}).limit(1);if(O&&O.length>0){const G=O[0];G.id!==w&&await N(G)}}else{if(!E){const{data:{session:O}}=await Y.auth.getSession();if(!O?.user?.id)return;E=O.user.id}const{data:P}=await Y.from("calls").select("*").eq("parent_id",E).eq("caller_type","child").eq("status","ringing").gte("created_at",T).order("created_at",{ascending:!1}).limit(1);if(P&&P.length>0){const O=P[0];O.id!==w&&await N(O)}}},R=async()=>{const T=new Date(Date.now()-6e4).toISOString();if(_){const P=JSON.parse(k),{data:O}=await Y.from("calls").select("*").eq("child_id",P.id).eq("caller_type","parent").eq("status","ringing").gte("created_at",T).order("created_at",{ascending:!1}).limit(1);if(O&&O.length>0){const G=O[0];G.id!==w&&await N(G)}}else{if(!E){const{data:{session:O}}=await Y.auth.getSession();if(!O?.user?.id)return;E=O.user.id}const{data:P}=await Y.from("calls").select("*").eq("parent_id",E).eq("caller_type","child").eq("status","ringing").gte("created_at",T).order("created_at",{ascending:!1}).limit(1);if(P&&P.length>0){const O=P[0];O.id!==w&&await N(O)}}};if(await j(),x=setInterval(R,6e4),_){const T=JSON.parse(k);s.current=Y.channel("global-child-incoming-calls").on("postgres_changes",{event:"INSERT",schema:"public",table:"calls",filter:`child_id=eq.${T.id}`},async P=>{const O=P.new;O.caller_type==="parent"&&O.child_id===T.id&&O.status==="ringing"&&await N(O)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls",filter:`child_id=eq.${T.id}`},async P=>{const O=P.new,G=P.old;O.caller_type!=="child"&&(n.current&&n.current.id===O.id&&(O.status==="active"||O.status==="ended")&&(t(null),n.current=null),O.caller_type==="parent"&&O.child_id===T.id&&O.status==="ringing"&&G.status!=="ringing"&&await N(O))}).subscribe()}else{if(!E){const{data:{session:T}}=await Y.auth.getSession();if(!T?.user?.id)return;E=T.user.id}s.current=Y.channel("global-parent-incoming-calls").on("postgres_changes",{event:"INSERT",schema:"public",table:"calls",filter:`parent_id=eq.${E}`},async T=>{const P=T.new;P.caller_type==="child"&&P.parent_id===E&&P.status==="ringing"&&await N(P)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"calls",filter:`parent_id=eq.${E}`},async T=>{const P=T.new,O=T.old;P.caller_type!=="parent"&&(n.current&&n.current.id===P.id&&(P.status==="active"||P.status==="ended")&&(t(null),n.current=null),P.caller_type==="child"&&P.parent_id===E&&P.status==="ringing"&&O.status!=="ringing"&&await N(P))}).subscribe()}return()=>{s.current&&Y.removeChannel(s.current),x&&clearInterval(x)}})()},[c.pathname]);const g=()=>{if(e){f(e.id),i.current=!0;const w=e.id;if(e.child_id)l(`/call/${e.child_id}?callId=${w}`);else if(e.parent_id){const x=localStorage.getItem("childSession");if(x){const E=JSON.parse(x);l(`/call/${E.id}?callId=${w}`)}}t(null),setTimeout(()=>{i.current=!1},2e3)}},v=async()=>{if(e){const{data:{session:w}}=await Y.auth.getSession(),x=localStorage.getItem("childSession"),C=!w&&!!x?"child":"parent";try{await Xs({callId:e.id,by:C,reason:"declined"})}catch(b){console.error("Error declining call:",b)}f(e.id),t(null)}};return p.useEffect(()=>{!e&&n.current&&f(n.current.id)},[e,f]),e?a.jsxs(a.Fragment,{children:[tp()&&a.jsx(cF,{callId:e.id,callerName:e.child_name||e.parent_name||"Caller",callerId:e.child_id||e.parent_id||"",onAccept:g,onDecline:v,isActive:!!e}),a.jsx(Xn,{open:!!e,onOpenChange:w=>{!w&&e&&!i.current&&v()},children:a.jsxs(_n,{className:"sm:max-w-md",children:[a.jsxs(Nn,{children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-2xl font-bold text-white",style:{backgroundColor:e.child_avatar_color||"#3B82F6"},children:e.child_name?.[0]||""}),a.jsxs("div",{children:[a.jsx(jn,{className:"text-xl",children:"Incoming Call"}),a.jsxs("p",{className:"text-base font-normal text-muted-foreground",children:[e.child_name||e.parent_name," is calling..."]})]})]}),a.jsxs("div",{className:"pt-4",children:[a.jsxs(Tn,{className:"sr-only",children:["Incoming call from ",e.child_name||e.parent_name]}),a.jsx("div",{className:"flex items-center justify-center gap-2 text-4xl animate-pulse",children:a.jsx(ka,{className:"h-12 w-12"})})]})]}),a.jsxs(kn,{className:"sm:justify-center gap-2",children:[a.jsx(An,{onClick:v,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Decline"}),a.jsx(mr,{onClick:g,className:"bg-green-600 hover:bg-green-700",children:"Answer"})]})]})})]}):null},uF=()=>{const e=gn(),t=tt(),{toast:n}=Ct(),s=p.useRef(null),i=p.useRef(null),l=p.useRef(null);return p.useEffect(()=>{const c=e.pathname.match(/^\/chat\/(.+)$/);l.current=c?c[1]:null},[e.pathname]),p.useEffect(()=>{let c=null,u=null,f=null,h=null,g=0;const v=300*1e3;(async()=>{const{data:{session:x}}=await Y.auth.getSession(),E=localStorage.getItem("childSession");if(!x&&!E)return;const C=!x&&!!E;!C&&x?.user?.id&&(f=x.user.id);const b=async _=>{if(_.id===i.current)return;if(l.current===_.child_id){console.log(" [GLOBAL MESSAGE] User is actively chatting with this child, not showing notification",{childId:_.child_id,activeChat:l.current});return}if(C&&_.sender_type==="child"||!C&&_.sender_type==="parent")return;i.current=_.id;let N="Someone",j=null,R=null;try{if(_.sender_type==="parent"){const{data:O}=await Y.from("parents").select("name").eq("id",_.sender_id).maybeSingle();O?.name?N=O.name:N="Parent",C&&(R="hsl(213, 94%, 68%)")}else{const{data:O}=await Y.from("children").select("name, avatar_color").eq("id",_.sender_id).maybeSingle();O?.name?N=O.name:N="Child",!C&&O?.avatar_color&&(j=O.avatar_color)}}catch(O){console.error("Error fetching sender name:",O)}const T=_.content.length>50?`${_.content.substring(0,50)}...`:_.content,P=C?R?{style:{backgroundColor:R,borderColor:R,color:"#ffffff"},className:"border-2 shadow-lg ring-2 ring-opacity-30 custom-parent-color"}:void 0:j?{style:{backgroundColor:j,borderColor:j,color:"#ffffff"},className:"border-2 shadow-lg ring-2 ring-opacity-30 custom-child-color"}:void 0;n({title:`New message from ${N}`,description:T,variant:void 0,...P,action:a.jsxs(ce,{variant:C?"default":"secondary",size:"sm",onClick:()=>{t(`/chat/${_.child_id}`)},className:C?"ml-2 bg-primary hover:bg-primary/90":"ml-2 bg-white/20 hover:bg-white/30 text-white border-white/30",style:!C&&j?{borderColor:"rgba(255,255,255,0.3)"}:void 0,children:[a.jsx(Na,{className:"h-4 w-4 mr-1"}),"Open"]})})},k=async()=>{try{const _=new Date(Date.now()-6e4).toISOString();if(C){const N=JSON.parse(E),{data:j}=await Y.from("messages").select("*").eq("child_id",N.id).eq("sender_type","parent").is("read_at",null).gte("created_at",_).order("created_at",{ascending:!1}).limit(5);if(j&&j.length>0){for(const R of j.reverse())if(R.id!==u&&R.id!==i.current){await b(R),u=R.id;break}}}else{if(!f){const{data:{session:R}}=await Y.auth.getSession();if(!R?.user?.id)return;f=R.user.id}const N=Date.now();if(!h||N-g>v){const{data:R}=await Y.from("children").select("id").eq("parent_id",f);if(!R||R.length===0)return;h=R.map(T=>T.id),g=N}if(!h||h.length===0)return;const{data:j}=await Y.from("messages").select("*").in("child_id",h).eq("sender_type","child").is("read_at",null).gte("created_at",_).order("created_at",{ascending:!1}).limit(5);if(j&&j.length>0){for(const R of j.reverse())if(R.id!==u&&R.id!==i.current){await b(R),u=R.id;break}}}}catch(_){console.error(" [GLOBAL MESSAGE] Polling error:",_)}};if(C){const _=JSON.parse(E);s.current=Y.channel("global-child-messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`child_id=eq.${_.id}`},async N=>{const j=N.new;j.sender_type==="parent"&&!j.read_at&&await b(j)}).subscribe((N,j)=>{j?console.error(" [GLOBAL MESSAGE] Child subscription error:",j):(N==="CHANNEL_ERROR"||N==="TIMED_OUT")&&console.error(" [GLOBAL MESSAGE] Child subscription failed:",N)})}else{if(!f){const{data:{session:j}}=await Y.auth.getSession();if(!j?.user?.id)return;f=j.user.id}const{data:_}=await Y.from("children").select("id").eq("parent_id",f);if(!_||_.length===0)return;const N=_.map(j=>j.id);h=N,g=Date.now(),s.current=Y.channel("global-parent-messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},async j=>{const R=j.new;R.sender_type==="child"&&!R.read_at&&N.includes(R.child_id)&&await b(R)}).subscribe((j,R)=>{R?console.error(" [GLOBAL MESSAGE] Parent subscription error:",R):(j==="CHANNEL_ERROR"||j==="TIMED_OUT")&&console.error(" [GLOBAL MESSAGE] Parent subscription failed:",j)})}return c=setInterval(k,6e4),setTimeout(k,2e3),()=>{s.current&&Y.removeChannel(s.current),c&&clearInterval(c)}})()},[t,n]),null},fF=()=>{const[e,t]=p.useState(null),[n,s]=p.useState(null),[i,l]=p.useState(null);return p.useEffect(()=>{const c=async()=>{const{data:{session:h}}=await Y.auth.getSession();if(h?.user){s(h.user.id),t(null);const{data:g}=await Y.from("parents").select("name").eq("id",h.user.id).maybeSingle();l(g?.name||null)}else{const g=localStorage.getItem("childSession");if(g)try{const v=JSON.parse(g);t(v),s(null),l(null)}catch(v){console.error(" [GLOBAL PRESENCE] Error parsing child session:",v),t(null),s(null),l(null)}else t(null),s(null),l(null)}};c();const u=h=>{h.key==="childSession"&&c()},{data:{subscription:f}}=Y.auth.onAuthStateChange(()=>{c()});return window.addEventListener("storage",u),()=>{window.removeEventListener("storage",u),f.unsubscribe()}},[]),Gc({userId:e?.id||"",userType:"child",name:e?.name,enabled:!!e}),Gc({userId:n||"",userType:"parent",name:i||void 0,enabled:!!n}),null},Zf="kch_cookie_consent",Ww="1.0",hF=()=>{const[e,t]=p.useState(!1),n=tt();p.useEffect(()=>{if(!localStorage.getItem(Zf)){const u=setTimeout(()=>{t(!0)},1e3);return()=>clearTimeout(u)}},[]);const s=()=>{localStorage.setItem(Zf,JSON.stringify({accepted:!0,version:Ww,timestamp:new Date().toISOString()})),t(!1)},i=()=>{localStorage.setItem(Zf,JSON.stringify({accepted:!1,version:Ww,timestamp:new Date().toISOString()})),t(!1)},l=()=>{n("/info#privacy"),t(!1)};return e?a.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 p-4",style:{paddingBottom:"calc(1rem + var(--safe-area-inset-bottom))"},children:a.jsx(Te,{className:"max-w-4xl mx-auto shadow-lg border-2 p-4 md:p-6",children:a.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4",children:[a.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[a.jsx("div",{className:"mt-1",children:a.jsx(Zc,{className:"h-5 w-5 text-primary"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("h3",{className:"font-semibold mb-1 flex items-center gap-2",children:[a.jsx(vk,{className:"h-4 w-4"}),"Privacy & Cookie Consent"]}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["We use essential cookies and local storage to provide our service (authentication, preferences). We do not use tracking cookies or third-party analytics. By using this app, you agree to our"," ",a.jsx("button",{onClick:l,className:"text-primary hover:underline font-medium",children:"Privacy Policy"}),"."]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full md:w-auto",children:[a.jsx(ce,{variant:"outline",size:"sm",onClick:l,className:"w-full sm:w-auto",children:"Learn More"}),a.jsx(ce,{size:"sm",onClick:s,className:"w-full sm:w-auto",children:"Accept"}),a.jsx(ce,{variant:"ghost",size:"sm",onClick:i,className:"w-full sm:w-auto text-muted-foreground",children:"Decline"})]})]})})}):null},mF=new sR,pF=()=>(W$(),q$(),null),gF=()=>(p.useEffect(()=>{lF().catch(e=>{console.error("Failed to initialize native Android features:",e)})},[]),null),vF=()=>(p.useEffect(()=>{if(sessionStorage.getItem("clearSessionOnClose")==="true"){const t=()=>{Object.keys(localStorage).filter(l=>l.startsWith("sb-")||l.includes("supabase")).forEach(l=>localStorage.removeItem(l)),Y.auth.signOut().catch(()=>{})},n=()=>{t()},s=()=>{t()};return window.addEventListener("pagehide",n),window.addEventListener("beforeunload",s),()=>{window.removeEventListener("pagehide",n),window.removeEventListener("beforeunload",s)}}},[]),null),yF=()=>a.jsx($2,{children:a.jsx(iR,{client:mF,children:a.jsxs(DA,{children:[a.jsx(pF,{}),a.jsx(vF,{}),a.jsx(gF,{}),a.jsx(yj,{}),a.jsx(Jj,{}),a.jsx(fP,{className:"w-full overflow-x-hidden",children:a.jsxs(sP,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[a.jsx(dF,{}),a.jsx(uF,{}),a.jsx(fF,{}),a.jsx(hF,{}),a.jsxs(YR,{children:[a.jsx(yt,{path:"/",element:a.jsx(F2,{})}),a.jsx(yt,{path:"/parent/auth",element:a.jsx(wD,{})}),a.jsx(yt,{path:"/parent",element:a.jsx($M,{})}),a.jsx(yt,{path:"/parent/children",element:a.jsx(UM,{})}),a.jsx(yt,{path:"/parent/call/:childId",element:a.jsx(zM,{})}),a.jsx(yt,{path:"/parent/dashboard",element:a.jsx(MM,{})}),a.jsx(yt,{path:"/parent/devices",element:a.jsx(x$,{})}),a.jsx(yt,{path:"/parent/upgrade",element:a.jsx(b$,{})}),a.jsx(yt,{path:"/parent/settings",element:a.jsx(C$,{})}),a.jsx(yt,{path:"/child/login",element:a.jsx(_$,{})}),a.jsx(yt,{path:"/child",element:a.jsx(k$,{})}),a.jsx(yt,{path:"/child/parents",element:a.jsx(j$,{})}),a.jsx(yt,{path:"/child/call/:parentId",element:a.jsx(T$,{})}),a.jsx(yt,{path:"/child/dashboard",element:a.jsx(N$,{})}),a.jsx(yt,{path:"/call/:childId",element:a.jsx(D$,{})}),a.jsx(yt,{path:"/chat/:childId",element:a.jsx(O$,{})}),a.jsx(yt,{path:"/info",element:a.jsx(H$,{})}),a.jsx(yt,{path:"/error/server",element:a.jsx(B2,{})}),a.jsx(yt,{path:"/error/network",element:a.jsx(z2,{})}),a.jsx(yt,{path:"*",element:a.jsx(U2,{})})]})]})})]})})});console.log(" [APP INIT] Starting application...",{mode:"production",dev:!1,prod:!0});const Hh=document.getElementById("root");if(!Hh){const e=new Error("Root element not found. Make sure index.html has a <div id='root'></div> element.");throw console.error(" [APP INIT]",e),document.body.innerHTML=`
    <div style="padding: 2rem; font-family: system-ui; max-width: 600px; margin: 2rem auto;">
      <h1 style="color: #dc2626;">Application Error</h1>
      <p style="color: #6b7280;">Root element not found.</p>
      <pre style="background: #f3f4f6; padding: 1rem; border-radius: 0.5rem; overflow: auto; margin-top: 1rem;">
${e.message}
      </pre>
    </div>
  `,e}console.log(" [ENV] Environment variables check:",{hasSupabaseUrl:!0,hasSupabaseKey:!0,urlLength:40,keyLength:208});try{console.log(" [APP INIT] Creating React root...");const e=fN.createRoot(Hh);console.log(" [APP INIT] Rendering App component..."),e.render(a.jsx(yF,{})),console.log(" [APP INIT] App rendered successfully")}catch(e){throw console.error(" [APP INIT] Failed to render app:",e),Hh.innerHTML=`
    <div style="padding: 2rem; font-family: system-ui; max-width: 600px; margin: 2rem auto;">
      <h1 style="color: #dc2626;">Application Error</h1>
      <p style="color: #6b7280;">Failed to initialize the application.</p>
      <pre style="background: #f3f4f6; padding: 1rem; border-radius: 0.5rem; overflow: auto; margin-top: 1rem; white-space: pre-wrap;">
${e instanceof Error?e.message+`

`+e.stack:String(e)}
      </pre>
      <button 
        onclick="window.location.reload()" 
        style="margin-top: 1rem; padding: 0.5rem 1rem; background: #3b82f6; color: white; border: none; border-radius: 0.25rem; cursor: pointer;"
      >
        Reload Page
      </button>
      <p style="margin-top: 1rem; font-size: 0.875rem; color: #6b7280;">
        Check the browser console (F12) for more details.
      </p>
    </div>
  `,e}export{Vh as I,Vw as N,a_ as W,Y as s};
